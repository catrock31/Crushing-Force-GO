; Jumbo Elephant's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 1300
Power = 5000
;attack power (more is stronger)400
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 65
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 30
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 1
;Volume offset (negative for softer)
volume = 40
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1.10 ;1         ;Horizontal scaling factor.
yscale = 1.10 ;1        ;Vertical scaling factor.
ground.back = 260     ;Player width (back, ground)
ground.front = 220   ;Player width (front, ground)
air.back = 40         ;Player width (back, air)
air.front = 80       ;Player width (front, air)
height = 555     ;Height of player (for opponent to jump over)
attack.dist = 320    ;Default attack distance
proj.attack.dist = 90 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = 72, -650   ;Approximate position of head
mid.pos = 4, -310   ;Approximate position of midsection
shadowoffset = -5     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 6      ;Walk forward
walk.back = -4.0     ;Walk backward
run.fwd  = 12.0, 0    ;Run forward (x, y)
run.back = -9,-16 ;Hop backward (x, y)
jump.neu = 0,-33 ;y = -13    ;Neutral jumping velocity (x, y)
jump.back = -7  ;Jump back Speed (x, y)
jump.fwd = 7        ;Jump forward Speed (x, y)
runjump.back = -5,-12 ;Running jump speeds (opt)
runjump.fwd = 10.5,-17      ;.
airjump.neu = 0,-8.1      ;.
airjump.back = -2.55      ;Air jump speeds (opt)
airjump.fwd = 2.5         ;.
air.gethit.groundrecover = -.15,-3.5  ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-4.5    ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -1       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -2         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 3      ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 0       ;Number of air jumps allowed (opt)
airjump.height = 35   ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.8;.6;0.8;.75    ;.44      ;Vertical acceleration
stand.friction = 0.775 ;.85              ;Friction coefficient when standing
crouch.friction = 0.770                ;.82 ;Friction coefficient when crouching
stand.friction.threshold = 2          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .05       ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 25           ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -20 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 10   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -1  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.8 ;.35    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 15      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 20            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.8 ;.4               ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 12          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .05         ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes (optional).  **MUGEN 1.0**
;If this section is included, the default language victory quotes must be in English.
[Quotes]
; Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory1 = "Its not that I do too much damage.  You are just far too puny to even be in a match with me."
victory2 = "You need a lot more mass. I at least outweigh you ten times over."
victory3 = "Everyone has a plan until they get sat on."
victory4 = "Attack me if you dare I will squash you."
Victory5 = "Size and strength are everything, anything else is just for convenience"


; Vs Jiggly

Victory6 = "Where are you gonna go with all that speed?  I take up half the screen."
Victory7 = "It is a challenge to get my hands on you.  But when I do you are done!"
Victory8 = "You got the right body type but you're still too small to compete with me."
Victory9 = "Your speed may be annoying, but eventually I will always crush you."

; vs Ryu

victory10 = "You really are a pure warriors spirit, but I'm just far out of your weight class."
victory11 = "You must defeat my ass to stand a chance."

; vs Ken

victory12 = "Do you have really have absolute faith in your uppercut?  If I'm coming down very few things will change that."
Victory13 = "'Attack me if you dare, I will crush you.'  That's gonna be my win quote from now on Ken."

; vs Hulk
Victory14 = "You're strength is incredible, you picked me up like I were an calf."
Victory15 = "I'm not stupid I know what anger does to you in that state, how about we go get a few drinks now."

; vs Juggernaut
victory16 = "Immovable object beats Unstoppable force, thats good since I was worried we'd make a black hole or something."
victory17 = "I would love to copy that Headcrush of yours."

; vs KFM
victory18 = "I'm grateful to have met you, still not gonna stop me from sitting on you again if we meet."
victory19 = "You are simply too small, how do you expect to be this suave dude with your current size."

; vs Zangief
victory20 = "Out of all the humanoids I fought, I respect you the most."
victory21 = "How the hell did you lift me?!  Your strength must be much greater than most."
victory22 = "My size is much greater than yours."

; vs Jumbo Elephant
victory23 = "You're quite the handsome elephant.  Dang shame I still had to crush you."
victory24 = "Wow!  Seeing it from this point of view makes me realize that my butt is far bigger than I thought."

;vs Katrina Crocodile
victory25 = "Wow...your back pains must be unreal."
victory26 = "Can you even see anything short and directly in front of you?"
victory27 = "Your bite can not begin to intimidate someone of my size."

;vs Bertha
victory28 = "You got the right idea about size."
victory29 = "You don't own crushing attacks Hippo!  I'll do what I please."
victory30 = "I really figured you would be more of a challenge."

;Vs Enorma Pig
victory31 = "That was too close. You were almost a ham sandwich."
victory32 = "Your guns don't really scare me Pig."
victory33 = "You can zone if you want but I will kill you when I get in."

;vs Aroma Skunk
victory34 = "Your tactics are disgusting."
victory35 = "That's interesting.  A zoning character from a species no one wants to be around.  Clever."
victory36 = "I'm sure that smell will come off with a nice shower."

;vs Lardo Rat
victory37 = "You had no chance of winning but I admire your willingness to fight against an overwhelming foe."
victory38 = "If your trying to startle me rodent it's not gonna work."
victory39 = "Would you really try to swallow me whole?!   How would that even work."

;Vs Zafta Giraffe
victory40 = "You may have range but you don't have the weight to be a heavy hitter."
victory41 = "You may have a range advantage on me but if you let me get in its over."
victory42 = "You got range down but what about power and health?"

; vs Makuyama
victory43 = "What we had together was good Maku.  I didn't wish for you to be an obstacle in my path. "
victory44 = "If it means anything,  I do miss your bear hugs.  But if you can't see my vision then I'll have to crush you like all the others."
victory45 = "You're still the best looking panda in a mawashi.  Take care of yourself and stay out of my way."

; Vs Pastilla Skunk
victory46 = "Your sorcery is effective at spamming. But everything falls shortly after I crush them."
victory47 = "The form of two in one but you still crushed just as easily under me."
victory48 = "You are an intersting hybrid.  But against me you're just more bones to break."

; vs Jumba Elephant, His sister
victory49 = "I didn't mean to hurt you too badly.  Now will you stop with this ninjitsu nonsense?"
victory50 = "Come on sis, our bodies aren't meant for stealth or speed.  I'm still proud of you for trying but give up on the ninja stuff."
Victory51 = "As unlikely as your chances at stealth are.  I'm super proud of you getting as far with the ninja training."

; vs Twiggi
victory52 = "You have the exact opposite of a body meant for combat."
victory53 = "You better bulk up, not just for fighting but just cause."
victory54 = "I feel sorry crushing someone as tiny as you.  You're body stands no chance of survival."

; vs Ra Lord
victory55 = "You got 3 heads and still not enough sense to not fight me."
victory56 = "You're not even long enough to be my belt, snake man."
victory57 = "All those options you got and you don't have anything to stop my strength."

;vs Violet
victory58 = "Your legs definitely are impressive but they won't do much damage to me."
victory59 = "Your mix up attempts are annoying, but one grab is all I need to put fear into you."
victory60 = "Consider not being a smear stain a gift for being friends with my sister."

;vs Julian
victory61 = "Its such a treat to see such a handsome hippo as yourself."
victory62 = "You are suprisingly effective in combat, I would of never thought that by how you portray  yourself."
victory63 = "If I had my way there would be way more models like you."

;vs Rapid
victory64 = "You're a good man.  So I want you to take this mercy to leave and never interfer with my business again."
Victory65 = "Its not if I crush you.  Its how bad it will be.  I don't want to send your flattened corpse to that hippo of yours via an envelope."
victory66 = "All that speed an no sense.  You could easily catch up to me whenever you want but then what?"

;vs Noah
victory67 = "Your associates can help me with my vision of a better society for all of us.  Instead of fighting me why not join me?"
victory68 = "Arrows?  Against me?!  I should crush you just to end these hopeful delusions of yours."
victory69 = "Your associates were fighting a losing cause trying to protect you from me.  They never had a chance of succeeding."

;vs Akai
victory70 = "Red is one of my favorite colors.  I think I would look great in red spandex."
victory71 = "I help get loan sharks off you and this is how you repay me?!"
victory72 = "You should stick to being an attractive speedster.  Fighting is for bigger bodies than you."

Victory73 = "You're not the only one who looks good in red."

;vs Andy
victory74 = "That suit of yours may as well be an iron coffin after I flatten you."
victory75 = "I've destroyed tanks with my mass, You don't stand a chance when I come down on you."
victory76 = "You only assumed you were durable because you haven't been sat on by me.  You were crushed like everything else."

;vs Montana
Victory77 = "You're mobility in the air in fantastic but if you try to take me on like that I'll reintroduce you to the ground real quick."
Victory78 = "You're a beautiful lady I would hate to have to squash someone like you."
Victory79 = "You're beauty really mades your stink all the more suprising."

;Vs Texas
Victory80 = "The long arm of the law, crushed under the fat ass of the visionary."
victory81 = "I'm kinda insulted that the law tried to stop me with a sheriff as puny as you."
Victory82 = "Unless you wanna get real well acquainted with my ass I suggest you stick to Gold Springs."
;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
;var(4) - Supercombo check
; var(5)  - previous state no
; Var(9) - Air trap
; Var(10) - Weight Detection
; Var(11) - Wall Bounce Limiter
; Var(12) - Ground Bounce Limiter
; Var(13) - Stun Limiter
; Var(15) - Height fall damage multiplier
; Var(18) - Combo score multiplier
; Var(20) - Armor counter
; Var(21) - Armor Inhibitor
; Var(22) - Frame Identifier
; var(23) - butt hit counter
; Var(25) - Butt squash finish
; Var(26) - combo check for excessive damage
; Var(28) - Random cameo number
; Var(30) - AI activation
; Var(32) - Simple Counter
; Var(31-35) - Combo checks for AI
; Var(40-49) - Detect Enemy Projectile helper
;--------------------------------------------------------------------------



;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S
ctrl = 0


[state 18500, width]
type = width
trigger1 = 1
edge = 100,400

;Wedge
[state 180, 4]
type = changestate
trigger1 = time >= 2
trigger1 = var(25) = 1
value = 18500

;sit on
;[state 180, 3]
;type = changestate
;trigger1 = time >= 2
;trigger1 = random >= 666
;trigger1 = var(25) != 1
;value = 18300

;sumo stomp
[state 180, 2]
type = changestate
trigger1 = time >= 2
trigger1 = var(25) != 1
value = 181;182

;---------------------------------------------------------------------------

; Win pose 2 - Sumo
; CNS difficulty: basic
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0
sprpriority = -5

[state 181, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(180)
anim = 182
scale = const(size.xscale),const(size.yscale)
bindtime = -1
id = 180
sprpriority = 1

[state 181, playerpush]
type = playerpush
trigger1 = 1
value = 0

[State 181, 4]
type = EnvShake
trigger1 = animelemtime(7) = 0
time = 40
ampl = -35
freq = 60
phase = 60

[state 182, width]
type = width
trigger1 = 1
edge = 200,200


[state 52, 4]
type = playsnd
trigger1 = animelemtime(7) = 0
value = S0,0

[state 52, 4]
type = playsnd
trigger1 = animelemtime(7) = 0
value = S0,0

[state 52, 4]
type = playsnd
trigger1 = animelemtime(7) = 0
value = S0,0

[state 181, announce]
type = playsnd
triggerall = teammode = Single
trigger1 = time = 20
trigger1 = life != lifemax
value = S180,1

[state 181, announce]
type = playsnd
triggerall = teammode = Single
trigger1 = time = 20
trigger1 = life = lifemax
value = S180,1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win - Winners Seat
[Statedef 183]
type = S
movetype = A
ctrl = 0
physics = N
velset = 0,0

[state 183, no push]
type = playerpush
trigger1 = 1
value = 0

[State 183, front walk back dust 1]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 2 
trigger1 = command = "holdfwd"
pos = 30, 0
spacing = 1

[State 20, front walk front dust 1]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 2
trigger1 = command = "holdfwd"
pos = 70, 0
spacing = 1

[State 20, front walk balk dust 2]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 10
trigger1 = command = "holdfwd"
pos = 40, 0
spacing = 1

[State 20, front walk front dust 2]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 10
trigger1 = command = "holdfwd"
pos = 90, 0
spacing = 1

[state 20, quake]
type = envshake
triggerall = anim = 20
trigger1 = animelem = 2
time = 15
ampl = 10
freq = 200
phase = 100

[state 20, sound1]
type = playsnd
triggerall = anim = 20
trigger1 = animelem = 2
value = S0,1

[state 20, quake]
type = envshake
triggerall = anim = 20
trigger1 = animelem = 10
time = 15
ampl = 10
freq = 200
phase = 100

[state 20, sound1]
type = playsnd
triggerall = anim = 20
trigger1 = animelem = 10
value = S0,1

[state 183, start walk]
type = changeanim
trigger1 = time = 3
value = 20

[state 183, walk]
type = velset
trigger1 = anim = 20
x = const(velocity.walk.fwd.x)

[state 183, endwalk]
type = velset
triggerall = anim = 20
trigger1 = Abs(pos x - helper(185),pos x) = [-1,1]
x = 0

[state 183, end]
type = changeanim
trigger1 = anim = 20
trigger1 = Abs(pos x - helper(185),pos x) = [-1,1]
value = 41 

[state 183, jump move]
type = velset
triggerall = anim = 41
trigger1 = Abs(pos x - helper(185),pos x) = [-1,1]
y = -12
x = 2
persistent = 0


[state 183, grav]
type = gravity
trigger1 = anim = 41 || anim = 640


[state 183, change anim]
type = changeanim
trigger1 = anim = 41
trigger1 = vel y > 0
value = 640

[state 183, landing]
type = velset
triggerall = anim = 640
trigger1 = pos y > -vel y
trigger1 = vel y >= 0
y = 0 
x =0

[state 183, sit pose]
type = changestate
triggerall = anim = 640
trigger1 = vel y = 0
value = 184

[state 642, dust]
type = explod
trigger1 = anim = 184
anim = 1500
pos = 40,0
ontop = 1
persistent = 0
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = anim = 184
anim = 1501
pos = 40,0
sprpriority = -3
persistent = 0
ownpal = 1



;---------------------------------------------------------------------------
;Win - Victory landing
[statedef 184]
type = S
anim = 184
ctrl = 0


[state 184, 1]
type = velset
trigger1 = 1
y = 0

[state 184, dust 2]
type = explod
trigger1 = time = 1
anim = 1501
pos = 40,0
sprpriority = -4
persistent = 0
ownpal = 1

[state 184, quake]
type = envshake
trigger1 = time = 1
time = 30
ampl = 30
freq = 100
phase = 100
persistent = 0

[state 184, sound1]
type = playsnd
trigger1 = anim = 184
value = S0,0
persistent = 0
;---------------------------------------------------------------------------
;Win - Wedge
[Statedef 185]
Type = S
sprpriority = -3
ctrl = 0

[state 185, target]
trigger1 = time = 0
type = targetstate
ID = 30
value = 651

[state 185, nopush]
trigger1 = 1
type = playerpush
value = 0


[state 185, 1]
type = changeAnim
trigger1 = anim != 185
value = 185



[state 185, 2 back portions]
type = explod
trigger1 = !numexplod(186)
trigger1 = anim = 185
trigger1 = animelemtime(2) = 0
anim = 186
ID = 186
sprpriority = 4
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)










;---------------------------------------------------------------------------
;Opponent: getting sat on 
[statedef 8000] 
type = L
movetype = H
physics = N

;[state 184, 1]
;type = changeanim2
;trigger1 = anim = 184
;value = 5110
;persistent = 0

[state 8000, 2]
type = playsnd
trigger1 = 1
value = S11, 0
persistent = 0

[State 8000, flatten]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1.25,0.2


;---------------------------------------------------------------------------
; Introduction
; Suit
[Statedef 191]
type = S
ctrl = 0
velset = 0,0
sprpriority = -1

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 1,1
postype = Back
pos = ifelse(facing =1, 20, 157),360 ; Nice!
ontop = 1

[state 191, anim]
type = changeanim
trigger1 = time = 0 
value = 191

[state 191, random number]
type = varset
trigger1 = time = 0
var(28) = (random%101)
persistent = 0

[state 191, draw Pin]
type = explod
triggerall = time = 1
trigger1 = var(28) = [0,29]
triggerall = !Numexplod(192)
trigger2 = var(28) = [90,100]
anim = 192
id = 192
postype = p1
pos = 0,0
shadow = -1
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

[state 191, Pin exit]
type = playsnd
triggerall = Numexplod(192)
trigger1 = time = 186
value = S192,0


[state 191, draw Yin]
type = explod
triggerall = time = 1
trigger1 = var(28) = [30,59]
triggerall = !Numexplod(193)
trigger2 = var(28) = [90,100]
anim = 193
id = 193
postype = p1
pos = 0,0
shadow = -1
sprpriority = 1
scale = const(size.xscale),const(size.yscale)

[state 191, Pin exit]
type = playsnd
triggerall = Numexplod(193)
trigger1 = time = 196
value = S192,0

[state 191, draw Cinna]
type = explod
triggerall = time = 1
trigger1 = var(28) = [60,89]
triggerall = !Numexplod(194)
trigger2 = var(28) = [90,100]
anim = 194
id = 194
postype = p1
pos = 0,0
shadow = -1
sprpriority = 3
scale = const(size.xscale),const(size.yscale)

[state 191, Pin exit]
type = playsnd
triggerall = Numexplod(194)
trigger1 = time = 206
value = S192,1


[state 190, explod]
type = explod
triggerall = anim = 191
trigger1 = animelemtime(9) = 0
anim = 1910
postype = p1
pos = 0,0
sprpriority = 1
removetime = -2
bindtime = 1
id = 19000
vel = -1.0,-4.5
accel = 0,0.08

[state 190, explod]
type = explod
triggerall = anim = 191
trigger1 = animelemtime(9) = 0
anim = 1911
postype = p1
pos = 0,0
sprpriority = 1
removetime = -2
bindtime = 1
id = 19000
vel = 1.0,-4.5
accel = 0,0.08

[state 190, snd]
type = playsnd
trigger1 = animelemtime(9)=0
value = S190,0

[state 190, snd]
type = playsnd
trigger1 = animelemtime(9)=0
value = S190,0

[state 190, snd]
type = playsnd
trigger1 = animelemtime(9)=0
value = S190,0

[state 190, Voice]
type = playsnd
trigger1 = enemy,name != "Enorma Pig" || enemy,name != "Twiggi Bunny" || enemy,name != "Pastilla Skunk" || enemy,name != "Noah Sharker"
trigger1 = animelemtime(1) = 120
value = 191,random%2
channel = 1


[state 190, Voice]
type = playsnd
trigger1 = enemy,name = "Enorma Pig" || enemy,name = "Twiggi Bunny" || enemy,name = "Pastilla Skunk" || enemy,name = "Noah Sharker"
trigger1 = animelemtime(1) = 120
value = 193,0
channel = 1

[state 191, varset]
type = varset
trigger1 = time = 0
V = 10
value = 0

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = animtime = 0
value = 0

;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S 
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[state 195, power]
type = poweradd
trigger1 = time = 1
value = 100

[state 195, power]
type = poweradd
trigger1 = time = 82
value = 250

[state 195, power]
type = poweradd
trigger1 = time = 60
value = 400

[State 191, 4]
type = EnvShake
trigger1 = animelem = 9
time = 30
ampl = -16


[state 52, 4]
type = playsnd
trigger1 = animelem = 9
value = S0,0



[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;[state 195, joke attack]
;type = changestate
;triggerall = time > 12 && time < 40
;trigger1 = command = "a"
;trigger2 = command = "b"
;trigger3 = command = "c"
;trigger4 = command = "x"
;trigger5 = command = "y"
;trigger6 = command = "z"
;value = 196

;---------------------------------------------------------------------------
;Joke Butt Bump - A joke attack that will give you a lot of meter if it connects.
[Statedef 196]
type = S
movetype = A
physics = S
anim = 196

[state 196, movement]
type = velset
trigger1 = time = 1
x = 25

[state 196, buttryuken]
type = nothitby
trigger1 = time = 0
value = , NA, AP
time = 12

[state 196, Hit]
type = HitDef
trigger1 = AnimElem = 3
persistent = 0
attr = S, NA                     
damage = 80                  
animtype = Heavy                 
guardflag = MA                   
hitflag = MAF                    
priority = 3, Hit                
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 24, 24                
sparkno = 0                   
sparkxy = -10, -76               
hitsound = 5, 1                  
guardsound = 6, 0                
ground.type = High               
ground.slidetime = 5             
ground.hittime  = 18             
ground.velocity = -18, -6 
guard.velocity = -8            
airguard.velocity = -1.9,-.8     
air.type = High                  
air.velocity = -18,-6           
air.hittime = 1

[state 196, targetstate]
type = targetstate
triggerall = movehit
trigger1 = hitpausetime = 23
ignorehitpause = 1
persistent = 0
value = 670

[state 196, shake]
type = envshake
trigger1 = movecontact
time = 10
ampl = 10
freq = 100
phase = 100

[state 196, poweradd]
type = poweradd
trigger1 = movecontact = 1
persistent = 0
value = 0

[state 196, poweradd just for animation]
type = poweradd
trigger1 = animtime = 0
value = 250
persistent = 0

[state 196, poweradd]
type = poweradd
trigger1 = movehit = 1
persistent = 0
value = 1000

[State 196, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air                    
;Commonly-used controllers:
velset = 0,0                    
ctrl = 0                         
anim = 200                      
poweradd = 30                   
sprpriority = 2                  

[State 200, 1]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 35, 4                 
animtype = Heavy               
guardflag = MA                  
hitflag = MAF                    
priority = 3, Hit                
pausetime = 12,12
guard.pausetime = 8,8
sparkno = 1                     
sparkxy = -20, -400   
guard.kill = 0          
hitsound = 5, 1                  ;Sound to play on hit
guardsound = 6, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 16             ;Time that the opponent slides back
ground.hittime  = 16            ;Time opponent is in hit state
ground.velocity = -18   
guard.velocity = -18             
guard.hittime = 15
guard.slidetime = 15
airguard.velocity = -24,-.8     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -8,-3             ;X-velocity at which opponent is pushed,
;Y-velocity at which opponent is pushed
air.hittime = 21               
guard.dist = 800
guard.kill = 0

[State 200, 2]
type = PlaySnd
trigger1 = Time = 1
value = 0, 2

[state 0, combo check]
type = varset
trigger1 = movehit 
v = 31
value = 1

[state 200,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I


[state 200, sprpriority]
type = sprpriority
trigger1 = animelemtime(4) = 0
value = -1
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong punch Startup
[Statedef 210]
type    = S
movetype= A
physics = S
poweradd= 80
ctrl = 0
velset = 0,0
sprpriority = -1

[state 210, anim]
type = changeanim
trigger1 = anim != 210
value = 210

[state 210, armor counter]
type = varset
triggerall = prevstateno != 210
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 1
V = 20
value = 40

[state 210, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 210, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = -gethitvar(damage)
persistent = 1

[state 210, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -floor(gethitvar(damage))
persistent = 1
ignorehitpause

;determine what frame
[state 240, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.9)
value = anim
elem = var(22)

[state 240, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.9)
value = 1
;--------------------------

[state 210, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 210
time = 1
persistent = 1
ignorehitpause = 1

[State 210, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 210, width]
type = width
trigger1 = 1
value = 50,0

[state 210, Armor add helper]
type = helper
triggerall = !numhelper(21000)
trigger1 = animtime = 0 
trigger1 = command = "holdy"
name = "Standing Fierce Add Armor"
stateno = 21000
id = 21000
postype = p1
pos = 0,0

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = command = "holdy"
value = 212

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = command != "holdy"
value = 211

;--------------------------------------------------------------------------
;Increase armor on charge
[Statedef 21000]
type = S
movetype = I
anim = 9999
ctrl = 0

[state 21000]
type = parentvaradd
trigger1 = time = 0
v = 20
value = 80
persistent = 0

[state 21000]
type = destroyself
trigger1 = time = 10


;--------------------------------------------------------------------------
; Standing strong punch tap
[Statedef 211]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
sprpriority = -1

[state 211, anim]
type = changeanim
trigger1 = anim != 211
value = 211

[state 210, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = -gethitvar(damage)
persistent = 1

[state 210, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 1
ignorehitpause

[state 210, playsnd]
type = playsnd
trigger1 = animelemtime(1) = 1
value = S210,1
persistent = 0
channel = 0

;determine what frame
[state 210, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

[state X, Armor off]
type = varset
trigger1 = animelemtime(5) = 0
v = 20
value = 0

;delay effect
[state 210, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 210, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 210, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
trigger1 = animelemtime(5) < 0
attr = SCA, AA, AP
stateno = 211
time = 1
persistent = 1
ignorehitpause = 1

[State 210, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1


[state 211, width]
type = width
trigger1 = 1
value = 50,0

[state 211, front foot front dust]
type = explod
trigger1 = animelem = 3
anim = F120
pos = 530,-10
scale = 2, 2
ontop = 1
ownpal = 1

[state 211, front foot back dust]
type = explod
trigger1 = animelem = 3
anim = F120
pos = 386,-10
scale = 2, 2
ontop = 1
ownpal = 1

[State 211, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, NA
animtype  = Heavy
damage    = 100,10
Hitflag = HAF
ID = 211
guardflag = MA
ground.type = High
pausetime = 14,14
guard.pausetime = 2,12
guard.kill = 0   
sparkno = 3
envshake.ampl = 12
envshake.time = 14
sparkxy = -20,-544
hitsound   = F5,3
guardsound = 6,0
ground.Velocity = -60,24
ground.slidetime = 24
ground.hittime = 24
air.Velocity = -60, 24
air.hittime = 22
airguard.velocity = -12, -6
guard.velocity = -36              
guard.hittime = 27
guard.slidetime = 27
guard.dist = 1280
guard.kill = 0
fall = 1
fall.recover = 1
fall.recovertime = 45
down.bounce = 1
fall.xvelocity = -4
fall.yvelocity = -16

[State 211, 4]
type = EnvShake
trigger1 = animelem = 3
time = 15
ampl = 10
freq = 100
phase = 100
persistent = 0

[State 211, footstep]
type = PlaySnd
trigger1 = animelem = 3
value = S0,1
persistent = 0

[State 211, whoosh]
type = PlaySnd
trigger1 = animelem = 4
value = S0,5
persistent = 0

[state x, armor over]
type = varset
trigger1 = animelem = 5
v = 20
value = 0
ignorehitpause 

[state 210,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I


[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[State 211, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
; Standing Strong Punch Hold
[Statedef 212]
type    = S
movetype= A
physics = S
poweradd= 80
ctrl = 0
velset = 0,0
sprpriority = -1

[state x, armor over]
type = varset
trigger1 = animelem = 5
v = 20
value = 0
ignorehitpause 

[state 212, anim]
type = changeanim
trigger1 = anim != 212
value = 212

[state 212, armor countdown]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1
ignorehitpause

[state X, Armor off]
type = varset
trigger1 = animelemtime(5) = 0
v = 20
value = 0

;determine what frame
[state 240, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

[state 210, playsnd]
type = playsnd
trigger1 = animelemtime(1) = 1
value = S210,2
persistent = 0
channel = 0

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.4)
value = anim
elem = var(22)

[state 240, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.4)
value = 1
;--------------------------

[state 212, width]
type = width
trigger1 = 1
value = 50,0


[state 211, front foot front dust]
type = explod
trigger1 = animelem = 3
anim = F120
pos = 530,-10
scale = 2, 2
ontop = 1
ownpal = 1

[state 211, front foot back dust]
type = explod
trigger1 = animelem = 3
anim = F120
pos = 386,-10
scale = 2, 2
ontop = 1
ownpal = 1

[State 212]
type = PalFX
trigger1 = gethitvar(damage) != 0
time = 6
add = 150,0,0
IgnoreHitPause = 1

[State 212, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, NA
animtype  = Back
damage    = ifelse(var(11) > 1,140, 160),ifelse(var(11) > 1, 28, 32)
Hitflag = HAF
guardflag = MA
ID = 212
pausetime = 24,24
guard.pausetime = 20,20
guard.velocity = -64              
guard.hittime = 30
guard.slidetime = 30
sparkno = 3
sparkxy = -20,-544
hitsound   = F5,4
guardsound = 6,0
ground.Velocity = -100, ifelse(var(11) > 1, -18, -4)
ground.slidetime = 30
ground.hittime = 30
air.Velocity = -100, ifelse(var(11) > 1, -18, 8)
air.hittime = 33
airguard.velocity = -18, -6
envshake.ampl = 16
envshake.time = 24
guard.dist = 1280
fall = 1
fall.recover = 0

[state 212, wall bounce counter]
type = varadd
trigger1 = movehit
trigger1 = numtarget(212)
var(11) = -1
persistent = 0
ignorehitpause = 1

[state 212,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 212, targetstate]
type = targetstate
triggerall = var(11) > 0
trigger1 = movehit
trigger1 = numtarget(212)
trigger1 = hitpausetime = 23
id = 212
ignorehitpause = 1
value = 670
persistent = 0

[state 212, armor]
type = hitoverride
trigger1 = Life > 1
trigger1 = animelemtime(5) < 0
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 212
time = 1

[state 212, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = -gethitvar(damage)
kill = 0
persistent = 1


[State 211, 4]
type = EnvShake
trigger1 = animelem = 3
time = 15
ampl = 10
freq = 100
phase = 100
persistent = 0

[State 211, footstep]
type = PlaySnd
trigger1 = animelem = 3
value = S0,1
persistent = 0

[State 211, whoosh]
type = PlaySnd
trigger1 = animelem = 4
value = S0,5
persistent = 0

[state 211, combo check]
type = varset
trigger1 = movehit
v = 31
value = 1

[state x, combo dampener]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[State 211, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Standing Headbutt Startup
[Statedef 215]
type    = S
movetype= A
physics = S
poweradd= 80
ctrl = 0
velset = 0,0
sprpriority = -1

[state 215, anim]
type = changeanim
trigger1 = anim != 215
value = 215

[state 215, armor counter]
type = varset
triggerall = prevstateno != 215
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 2
V = 20
value = 80

[state 215, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 215, armor countdown]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
ignorehitpause = 1

[state 215, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = -gethitvar(damage)
persistent = 1

;determine what frame
[state 215, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 215, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 215, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 215, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 215
time = 1
persistent = 1
ignorehitpause = 1


[state 215, width]
type = width
trigger1 = 1
value = 50,0

[state 215, helper armor]
type = helper
triggerall = !numhelper(21500)
trigger1 = animtime = 0
trigger1 = command = "holdy"
name = "Headbutt Armor add"
stateno = 21500
id = 21500
postype = p1
pos = 0,0

[State 215, 5]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = command != "holdy"
value = 218
ignorehitpause = 1

[State 215, 5]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = command = "holdy"
value = 219
ignorehitpause = 1
;---------------------------------------------------------------------------
;Addition armor Headbutt helper
[statedef 21500]
type = S
movetype = I
anim = 9999
ctrl = 0

[state 21500]
type = parentvaradd
trigger1 = time = 0
v = 20
value = 40

[state 21500]
type = destroyself
trigger1 = time = 10




;---------------------------------------------------------------------------
;Lesser Bounce
[statedef 216]
;Custom Hit state, ground bounce
type = U
movetype = H
physics = N
anim = 5030

[state 245, velocity]
type = hitvelset
trigger1 = time = 0
y = 15


[state 245, stop x]
type = velset
trigger1 = time = 0
x = 0


[state 245]
type = gravity
trigger1 = 1

[state 245, changestate]
type = changestate
trigger1 = pos y >= 0
value = 217

;-----------------------------------------------------------------------------
;bounce portion
[statedef 217]
type = A
movetype = H
physics = N
anim = 5100

[state 246, impact]
type = velset
trigger1 = time = 0
y = 0

[State 246, 8]
type = Explod
trigger1 = Time = 1
anim = F62 
pos = 0, 0
ontop = 1
scale = 1.7, 0.5

[State 246, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7,2

[state 240, shake]
type = envshake
trigger1 = time = 0
ampl = 4
time = 10

[state 246, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 246, bounce]
type = velset
trigger1 = time = 6
y = -12

[state 246, gravity]
type = gravity
trigger1 = time > 7

[State 821, 2] ; Recover near ground (use ChangeState)
type = ChangeState
triggerall = alive
triggerall = CanRecover
triggerall = time < 7
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[state 246, down]
type = selfstate
trigger1 = time >= 7 && pos y >= 0
value = 5110
;---------------------------------------------------------------------------
;Headbutts
;Standing Headbutt tap
[Statedef 218]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
sprpriority = -1

[state 218, playsnd]
type = playsnd
trigger1 = time = 0
trigger1 = var(20) > 1
value = S218,0
channel = 1


;----------------
;1 hit armor
;----------------

[state 218, anim]
type = changeanim
trigger1 = anim != 216
value = 216

;determine what frame
[state 219 remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

[state 219, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = 1

;delay effect
[state 219, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 218, excessive armor check]
type = varset
trigger1 = var(20) > 1
var(20) = 1
persistent = 1

[state 218, armor minus]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -gethitvar(damage)

[state 218, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = -gethitvar(damage)
kill = 0
persistent = 1

[state 218, armor]
type = hitoverride
triggerall = animelemtime(6) < 0
trigger1 = VAR(20) > 0
trigger1 = alive
attr = SA,AA,AP
stateno = 218
time = 1
ignorehitpause = 1


; •  While on one foot his balance is lowered, so armor breaks on lows.



[State 218, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 218, get energy]
type = poweradd
trigger1 = gethitvar(damage) != 0
value = 150
persistent = 0





[state 218, width]
type = width
trigger1 = 1
value = 30,0

[state 218, front foot front dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = 442,2
scale = 2, 2
ontop = 1

[state 218, front foot back dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = 260,2
scale = 2, 2
ontop = 1

[State 218, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, NA
animtype  = Heavy
damage    = 120,24
id = 218
nochainid = 218
Hitflag = MAF
guardflag = MA
pausetime = 24,24
guard.pausetime = 20,20
guard.velocity = -30             
guard.hittime = 28
guard.slidetime = 28
air.fall = 1
fall.recover = 1
fall.recovertime = 20
sparkno = 3
guard.kill = 0   
sparkxy = -20,-307
hitsound   = S0,8
guardsound = 6,0
ground.velocity = -32,0
ground.slidetime = 35 
ground.hittime = 35
envshake.ampl = -12
envshake.time = 12
p2facing = 1
air.velocity = -4,45
airguard.velocity = -12,4
guard.dist = 840
guard.kill = 0


[state 218, targetstate]
type = targetstate
trigger1 = movehit = 1  
trigger1 = hitpausetime = 19
trigger1 = p2statetype = A
ignorehitpause = 1
value = 216

[State 218, 4]
type = EnvShake
trigger1 = animelem = 4
time = 15
ampl = 8
persistent = 0

[State 218, footstep]
type = PlaySnd
trigger1 = animelem = 4
value = S0,1
persistent = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[state 218,  Not active]
trigger1 = animelemtime(6) = 0
type = statetypeset
movetype = I

[State 218, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Standing Headbutt Hold
[Statedef 219]
type    = S
movetype= A
physics = S
juggle  = 4
velset = 0,0
sprpriority = -1

[state 218, playsnd]
type = playsnd
trigger1 = time = 0
trigger1 = var(20) > 1
value = S219,0
channel = 1

[state 219, excessive armor check]
type = varset
trigger1 = var(20) > 2
var(20) = 2
persistent = 1

[state 218, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = -gethitvar(damage)
kill = 0
persistent = 1

[state 218, armor minus]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -gethitvar(damage)

[state 219, anim]
type = changeanim
trigger1 = anim != 217
value = 217

[state 219, width]
type = width
trigger1 = 1
value = 30,0

;determine what frame
[state 219 remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1



[state 219, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.4)
value = 1

;delay effect
[state 219, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.4)
value = anim
elem = var(22)
;--------------------------


[state 219, front foot front dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = 442,2
scale = 2, 2
ontop = 1

[state 219, front foot back dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = 260,2
scale = 2, 2
ontop = 1

[State 219]
type = PalFX
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 219, 2]
type = HitDef
trigger1 = !movecontact
trigger1 = p2stateno != 690
persistent = 0
attr = S, NA
animtype  = Back
damage    = 150,30
id = 219
Hitflag = MAF
guardflag = MA
pausetime = 30,30
guard.pausetime = 13,22
guard.velocity = -50             
guard.hittime = 30
guard.slidetime = 30
fall.recover = 0
sparkno = 3
guard.kill = 0   
sparkxy = -20,-307
hitsound   = 5,4
guardsound = 6,0
ground.velocity = -32,0
ground.slidetime = 6 
ground.hittime = 6
air.velocity = -24,45
airguard.velocity = -16,-6
down.bounce = 1
p2facing = 1
envshake.phase = 50
envshake.freq = 50
envshake.ampl = -8
envshake.time = 24
fall.yvelocity = -24
fall.xvelocity = 6
guard.dist = 840
fall = ifelse(var(13) > 1, 0,1)
guard.kill = 0

[state 219, targetstate]
type = targetstate
triggerall = numtarget
trigger1 = movehit  
trigger1 = hitpausetime = 24
trigger1 = var(13) > 0
trigger1 = !target(219),hitfall 
ignorehitpause = 1
id = 219
value = 690

[state 219, stun limiter]
type = varadd
trigger1 = movehit
var(13) = -1
ignorehitpause = 1
persistent = 0

[state 219, armor]
type = hitoverride
trigger1 = alive
trigger1 = animelemtime(8) < 0
trigger1 = var(20) > 0
attr = SA, AA,AP
stateno = 219
time = 1
ignorehitpause = 1

[State 219, 4]
type = EnvShake
trigger1 = animelem = 4
time = 15
ampl = 8
persistent = 0

[State 219, footstep]
type = PlaySnd
trigger1 = animelem = 4
value = S0,1
persistent = 0

[state 219, nothitby]
type = nothitby
trigger1 = numhelper(220)
value = ,AP
ignorehitpause = 1
time = 1
persistent = 1


[state 219, helper]
type = helper
trigger1 = animelemtime(5) = 0
trigger1 = !numhelper(220)
postype = p1
pos = 0,0
stateno = 220
id = 220
name = "Jumbo Headbutt Proj null"

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[state 219, ctrlset]
type = ctrlset
trigger1 = movehit
trigger1 = animelemtime(9) =0
value = 1

[state 219,  Not active]
trigger1 = animelemtime(6) = 0
type = statetypeset
movetype = I

[State 219, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Headbutt helper
[statedef 220]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 218

[state 220, width]
type = width
trigger1 = 1
value = 0,0

[state 220, HB]
type = hitby
trigger1 = 1
Value = ,AP

[State 220, NHB]
type = NotHitBy
Trigger1 = 1
value = SCA ,AA, AT
Time = 1

[state 220, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 220
ignorehitpause = 1

[State 220, End]
type = DestroySelf
trigger1 = movereversed
trigger2 = animtime = 0
ignorehitpause = 1

;---------------------------------------------------------------------------
[statedef 221]
type    = S
movetype= I
physics = N


[state 221, end]
type = destroyself
trigger1 = time = 0
ignorehitpause = 1

;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 2]
type = PlaySnd
trigger1 = animelem = 2
value = 0, 2
volumescale = 50

[State 240, 4]
type = EnvShake
trigger1 = animelem = 2
time = 8
ampl = 4
persistent = 0

[state 230, posadd]
type = posadd
trigger1 = animelem = 1
x = 25
persistent = 0

[state 230, posadd]
type = posadd
trigger1 = animtime = 0
x = -25
persistent = 0

[State 230, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, NA
animtype  = up
damage    = 50
guardflag = MA
hitflag = MAF
pausetime = 12,12
guard.pausetime = 8,8
sparkno = 2
sparkxy = -20,-570
hitsound   = S0,8
guardsound = 6,0
animtype = Up
guard.kill = 0
ground.type = Low
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -4,-28
guard.velocity = -15              
guard.hittime = 23
guard.slidetime = 23
air.velocity = -4,-26
air.hittime = 23
ground.cornerpush.veloff = -8
guard.dist = 640
guard.kill = 0
forcestand = 1
yaccel = 1.4
fall.recover = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -18
persistent = 0
ignorehitpause =1 

[state 230,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
poweradd= 80
ctrl = 0
velset = 0,0
sprpriority = 2

[state 240, animation]
type = changeanim
trigger1 = anim != 240
value = 240

;one hit of armor
[state 240, armor counter]
type = varset
trigger1 = time = 0
trigger1 = Var(21) = 1
trigger2 = var(20) > 2
V = 20
value = 2
persistent = 0
ignorehitpause = 1

[state 240, unthrowable time]
type = nothitby
trigger1 = animelemtime(4) > 0 && animelemtime(14) < 0
value = ,NT
ignorehitpause = 1


[state 240, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0
persistent = 0
ignorehitpause = 1

[state 240, var]
type = varadd
trigger1 = movehit
v = 12
value = -1
persistent = 0
ignorehitpause = 1


[state 240, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1
ignorehitpause = 1

[state 240, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = - 1
persistent = 1
ignorehitpause = 1

;determine what frame
[state 240, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.9)
value = anim
elem = var(22)

[state 240, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.9)
value = 1
;--------------------------

;[state 1050, display]
;type = displaytoclipboard
;trigger1 = 1
;text = "armor count is %d and damage taken is %d"
;params = var(20), gethitvar(damage)


[state 1050, Unstoppable]
type = hitoverride
triggerall = gethitvar(groundtype) != 3
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 240
time = 1
persistent = 1
ignorehitpause = 1



[State 1050, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 240, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 3
persistent = 0

[State 240, 1]
type = PlaySnd
trigger1 = animelem = 11
value = 0, 0
persistent = 0

[State 240, 4]
type = EnvShake
trigger1 = animelem = 11
time = 20
ampl = 12
persistent = 0

[state 240, fx]
type = explod
trigger1 = animelem = 11
anim = F61
pos = 322,-5
scale = const(size.xscale)*1.5,const(size.yscale)*1.5

[state 240, dust]
type = explod
trigger1 = animelem = 11
anim = 2000
pos = 304,0
scale = const(size.xscale)*0.5,const(size.yscale)*0.5
sprpriority = 3
ownpal = 1

[state 240, dust 2]
type = explod
trigger1 = animelem = 11
anim = 2001
pos = 304,0
scale = const(size.xscale)*0.5,const(size.yscale)*0.5
sprpriority = -3
ownpal = 1


;Movement
[state 240, frame 2]
type = posadd
trigger1 = animelemtime(2) = 0
trigger1 = p2dist x != [0, 120]
persistent = 0
ignorehitpause
x = 120

;Movement
[state 240, frame 3]
type = posadd
trigger1 = animelemtime(3) = 0
trigger1 = p2dist x != [0, 160]
persistent = 0
ignorehitpause
x = 160

[state 240, frame 8]
type = posadd
trigger1 = animelemtime(8) = 0
trigger1 = p2dist x != [0, 70]
persistent = 0
ignorehitpause
x = 75

[state 240, frame 9]
type = posadd
trigger1 = animelemtime(9) = 0
trigger1 = p2dist x != [0, 280]
persistent = 0
ignorehitpause
x = 260


[state 240, frame 10]
type = posadd
trigger1 = animtime = -48
trigger1 = p2dist x != [0, 10]
persistent = 0
ignorehitpause
x = 10


[State 240, hit without bounce]
type = HitDef
trigger1 = animelem = 8
trigger2 = animelem = 9
trigger3 = animelem = 10
persistent = 0
attr = S, NA
hitflag = MAF
id = 240
nochainid = 240, 800
Guardflag = HA
animtype  = Heavy
damage    = 125,25
guardflag = MA
pausetime = 14,14
guard.pausetime = 12,12
sparkno = 3
sparkxy = -20,-100
hitsound   = 5,4
guardsound = 6,0
ground.type = Low
guard.kill = 0
ground.slidetime = 16
ground.hittime  = 60
air.hittime = 60
ground.velocity = -6, 120
air.velocity = -3, 120
airguard.velocity = -20, 8
guard.velocity = -48              
guard.hittime = 25
guard.slidetime = 25
airguard.hittime = 30
fall = 1
fall.recover = 0
fall.recovertime = 30
yaccel = 1.4
guard.slidetime = 20
envshake.ampl = 12
envshake.time = 14
guard.dist = 920
guard.kill = 0



[state 240, targetstate]
type = targetstate
triggerall = movehit
triggerall = p2statetype != L
triggerall = var(12) > 0
trigger1 = hitpausetime = 13
ignorehitpause = 1
value = 245
persistent = 0

[state 240, ctrl]
type = ctrlset
trigger1 = movehit
trigger1 = animelemtime(13) > 0
trigger1 = p2stateno != [660,669]
value = 1
ignorehitpause = 1


;[state 240, targetstate]
;type = targetstate
;triggerall = movehit
;triggerall = p2statetype != L
;triggerall = var(12) <= 0
;trigger1 = hitpausetime = 7
;ignorehitpause = 1
;value = 216
;persistent = 0



[state 240, armor over]
type = varset
trigger1 = animelem = 12
v = 20
value = 0
ignorehitpause

;width
[state 210, width]
type = width
trigger1 = animelemtime(12) >= 0 
value = 30,0
ignorehitpause = 1

[State 240, 2]
type = HitDef
trigger1 = animelem = 11
trigger1 = !movecontact
persistent = 0
attr = S, NA
hitflag = FD
animtype  = Heavy
damage    = 180
guardflag = MA
pausetime = 20,20
id = 241
nochainid = 1400
sparkno = 1
p2stateno = 660
sparkxy = -10,-60
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 17
ground.velocity = -6
guard.hittime = 10
guard.velocity = -6
air.velocity = -4.2,-3.2

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 240,  Not active]
trigger1 = animelemtime(12) = 0
type = statetypeset
movetype = I

[State 240, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
;Groundbounce
[statedef 245]
type = A
movetype = H
physics = N

[State 2452, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 245]
type = changeanim
trigger1 = 1
value = 5061
ignorehitpause = 1

[state 245, changestate]
type = changestate
trigger1 = hitshakeover
value = 246



;-------------------------------------
[statedef 246]
;Custom Hit state, ground bounce
type = A
movetype = H
physics = N

[state 246, anim]
type = changeanim
trigger1 = time = 0
value = 5160

[state 246, velocity]
type = velset
trigger1 = time = 0
y = 120
x = 0

;[state 246, stop x]
;type = velset
;trigger1 = time = 0
;x = 0


[state 246]
type = gravity
trigger1 = 1
;y = 1.44

[state 246, changestate]
type = changestate
trigger1 = pos y >= 0
value = 247

;-----------------------------------------------------------------------------
;bounce portion
[statedef 247]
type = A
movetype = H
physics = N

[state 247, impact]
type = velset
trigger1 = time = 0
y = 0

[State 247, 8]
type = Explod
trigger1 = Time = 1
anim = F62 
pos = 0, 0
ontop = 1
scale = 1.7, 0.5

[State 247, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7,2

[state 247, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10

[state 247, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 247, bounce]
type = velset
trigger1 = time = 6
y = -35

[state 247, gravity]
type = gravity
trigger1 = time > 7
;y = .44

[state 247, down]
type = selfstate
trigger1 = time >= 7 && pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;Crouching light punch

[Statedef 400]
type    = C
movetype= A
physics = C
poweradd= 8
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = C, NA
damage    = 30
priority  = 3
animtype  = Heavy
hitflag = MAF
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,8
guard.kill = 0
sparkno = 1
sparkxy = -10,-350
hitsound   = 5,1
guardsound = 6,0
guard.velocity = -17              
guard.hittime = 15
guard.slidetime = 15
ground.type = Low
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -18
air.velocity = -12,-8
guard.dist = 640
guard.kill = 0

[State 400, 2]
type = PlaySnd
trigger1 = Time = 1
value = 0, 2

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 400,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I


[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching strong punch
[Statedef 410]
type    = C
movetype= A
physics = C
poweradd= 25
ctrl = 0
anim = 410
sprpriority = 2

[State 410, 2]
type = HitDef
trigger1 = !movecontact
attr = C, NA
persistent = 0
damage    = 82,8
animtype  = UP
hitflag = MAF
guardflag = MA
pausetime = 18,18
guard.pausetime = 7,12
guard.kill = 0
sparkno = 3
fall.recover = 0
sparkxy = -20,-90
hitsound   = 5,4
guardsound = 6,0
ground.type = high
ground.slidetime = 8
ground.hittime  = 47
ground.velocity = 0,ifelse(var(7)>0,-40,-10)
air.velocity = 0,ifelse(var(7)>0,-30,-7)
air.hittime = 47
guard.velocity = -24  
airguard.velocity = -16,-12        
guard.hittime = 24
airguard.hittime = 28
guard.slidetime = 24
guard.dist = 720
guard.kill = 0
fall = ifelse(var(7) > 0, 0,1)

[state 410, launcher limiter]
type = varadd
trigger1 = movehit
v = 7
value = -1
persistent = 0

[state 410, sound fx]
type = playsnd
trigger1 = time = 5
value = S0,6

[state 410, jump out]
type = changestate
triggerall = movehit
trigger1 = command = "holdup"
trigger2 = ailevel > 0
value = 42
ctrl = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = 9
persistent = 0
ignorehitpause =1 

[state 410,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
juggle  = 15
poweradd= 11
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 2]
type = PlaySnd
trigger1 = animelem = 1
value = 0, 2
volumescale = 25

[State 430, 2]
type = HitDef
trigger1 = !movecontact
attr = C, NA
damage    = ifelse(p2statetype = L, 80,ifelse(p2statetype != A, 100, 50))
animtype  = Heavy
hitflag = MAFD
guardflag = L
persistent = 0
guard.pausetime = 12,12
pausetime = 18,18
guard.kill = 0
sparkno = 1
id = 430
nochainid = 1400
sparkxy = -10,-82
hitsound   = 5,4
guardsound = 6,0
ground.type = trip
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -4,-15
air.velocity = -4,-15
down.velocity = -60,0
down.hittime = 16
guard.velocity = -40              
guard.hittime = 19
guard.slidetime = 19
guard.dist = 640
guard.kill = 0
fall = 1
fall.recover = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[state 430,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;===========================================================================
;--------------------------------Earthquake---------------------------------
;Initiation: 440
;Landing: 441
;===========================================================================



;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = C
poweradd= 70
ctrl = 0
velset = 0,0
anim = 440
sprpriority = 2

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[state 440, statetypeset]
type = statetypeset
trigger1 = animtime = 0 
statetype = A

[state 440, movement]
type = velset
trigger1 = animtime = 0
y = -20;-22.5
persistent = 0

[state 440, armor count]
type = varset
trigger1 = time = 0
v = 20
value = 60

[state 440, anim change]
type = changestate
trigger1 = animtime = 0
value = 441




;--------------------------------------------------------------------------
;Armored fall
[statedef 441]
type = A
movetype = A
physics = N

;Armor
[state 441, anim]
type = changeanim
trigger1 = anim != 441
value = 441

[state 441, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 441, still take damage]
type = varadd
trigger1 = gethitvar(damage) != 0
v = 20
value = -gethitvar(damage)
persistent = 1



;determine what frame
[state 441, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 441, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.01)
value = anim
elem = var(22)

[state 441, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.01)
value = 1
;--------------------------

[state 441, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
attr = SCA, AP
stateno = 441
time = 1
persistent = 1
ignorehitpause = 1

[State 441, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;Armor end

[state 441, no push]
type = playerpush
trigger1 = 1
value = 0

[state 441, grav]
type = gravity
trigger1 = pos y < -1



[state 441, spike down]
type = veladd
trigger1 = vel y > 1
y = 18
persistent = 0

[state 441, foward]
type = veladd
trigger1 = command = "holdfwd"
x = 0.40

[state 441, backward]
type = veladd
trigger1 = command = "holdback"
x = -0.40


[State 441, 3]
type = HitDef
trigger1 = 1
persistent = 0
attr = C, SA
getpower = 250
HitFlag = LD
damage    = 160
guardflag = MA
priority = 2, miss
fall = 1
id = 641
nochainid = 641
fall.recover = 0
pausetime = 2,2
sparkno = -1
guardsound = 6,0
animtype = Heavy
ground.type = High
ground.slidetime = 30
ground.hittime  = 30
ground.velocity = -2,5
air.velocity = -6,10
guard.velocity = -120           
guard.hittime = 60
guard.slidetime = 60
airguard.velocity = -54,2
airguard.hittime = 35
guard.dist = 240
guard.cornerpush.veloff = -120



;Ride down mechanic
[state 441, Ride down]
type = targetbind
trigger1 = movehit
pos = 94, -166

[state 441, state of ride down]
type = targetstate
trigger1 = movehit
value = 1006

[state 441, end]
type = targetstate
trigger1 = pos y > -10
trigger1 = enemy,stateno = 1006
value = 660
;-------------------

[state 441, targetstate]
type = targetstate
triggerall = numtarget(641)
trigger1 = movehit
trigger1 = enemy, statetype != A 
trigger1 = target(641),life > 0
value = 660
ignorehitpause = 1

[state 441, wedge]
type = targetstate
triggerall = numtarget(641)
trigger1 = movehit
trigger1 = target(641),life <= 0
value = 650

[state 441, wedge var]
type = varset
trigger1 = enemynear,life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 441, bind]
type = targetbind
trigger1 = movehit
trigger1 = enemynear,life <= 0
ID = 30
time = 1000
pos = 0,0


[State 440, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y  > -vel y
value = 442
ctrl = 0


;---------------------------------------------------------------------------
;earthquake
[statedef 442]
type    = C
movetype= A
physics = N
juggle  = 5
poweradd= 0
ctrl = 0
sprpriority = 2


[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

;Armor
[state 442, anim]
type = changeanim
trigger1 = anim != 442
value = 442

[state 442, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 442, still take damage]
type = varadd
trigger1 = gethitvar(damage) != 0
v = 20
value = -1

;determine what frame
[state 442, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 442, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 442, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = 1
;--------------------------

[state 442, Unstoppable]
type = hitoverride
trigger1 = alive
triggerall = var(20) > 0
attr = SCA, AP
stateno = 442
time = 1
persistent = 1
ignorehitpause = 1

[State 442, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;Armor end

[state 442, end movement]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 442, on ground]
type = posset
trigger1 = time = 0
y = 0

[State 442, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 16
ampl = -8

[state 442, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,-5
scale = 3,3

[State 442, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0


[State 442, hit]
type = HitDef
trigger1 = animelem = 1
persistent = 0
attr = C, NA
damage    = 160
guardflag = 
Hitflag = D
priority = 4 
nochainid = 1400
hitsound = S1,2
guardsound = S120, 0
pausetime = 12,12
guard.pausetime = 12,8
guard.hittime = 12
sparkno = 3
sparkxy = 0,0
animtype = Up
ground.type = High
p2stateno = 660
ground.slidetime = 4
ground.hittime  = 30
guard.velocity = 4
ground.velocity = 2.5, -6
air.velocity = -1.3,-3
air.hittime = 14


[State 442, hit]
type = HitDef
trigger1 = animelem = 2
persistent = 0
attr = C, NP
damage    = 80,8
guardflag = L
Hitflag = M
priority = 4 
hitsound = F5, 4
pausetime = 12,12
guard.kill = 0
sparkno = 3
sparkxy = 0,0
guardsound = S120, 0
animtype = UP
fall = 1
fall.recover = 0
fall.recovertime = 30
ground.type = Trip
ground.slidetime = 20
ground.hittime  = 60
ground.velocity = abs(p2bodydist x*0.033),-19.5
air.hittime = 60
guard.velocity = (p2dist x*0.01)              
guard.hittime = 22
guard.slidetime = 22
guard.dist = 0
guard.kill = 0
guard.dist = 2560

[state 442,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[state 442, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
poweradd= 20
ctrl = 0
anim = 600
sprpriority = -1

[State 600, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, NA
damage = 20
guardflag = HA
Hitflag = MAF
priority = 3
pausetime = 8,8
guard.pausetime = 12,8
guard.hittime = 8
guard.kill = 0
sparkno = 0
hitsound   = 5,0
sparkxy = -10,-472
guardsound = 6,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -12
air.velocity = -4,-7
air.hittime = 26
guard.velocity = -16              
guard.hittime = 12
guard.slidetime = 12
airguard.velocity = -16,-16
airguard.hittime = 16
guard.dist = 640
fall.recover = 0


[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 600,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[state 600, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jumping Strong punch - Punch
[Statedef 610]
type    = A
movetype= A
physics = A
poweradd= 60
ctrl = 0
sprpriority = 2

[state 610, wall bounce counter]
type = varadd
trigger1 = movehit
trigger1 = p2statetype = A
var(11) = -1
persistent = 0
ignorehitpause = 1

[state 610, animation]
type = changeanim
trigger1 = anim != 610
value = 610

[state 610, playsnd]
type = playsnd
trigger1 = time = 2
value = S610,0
channel = 0



[state 610, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = S0,9

[State 610, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 92, 9
guardflag = HA
priority = 4
pausetime = 18,18
guard.kill = 0
sparkno = 3
id = 610
sparkxy = -10,-634
hitsound   = 5,4
guardsound = 6,0
animtype = Heavy
fall.recover = 0
ground.type = High
ground.hittime = 35
ground.slidetime = 20
ground.velocity = -45
guard.velocity = -39              
guard.hittime = 24
guard.slidetime = 20
airguard.velocity = -16,-12
airguard.hittime = 26
air.hittime = 22
air.velocity = -100,ifelse(var(11) > 1,-12, 32)
envshake.ampl = 18
envshake.time = 12
guard.dist = 320
Fall = ifelse(var(11) > 1,0,1)
fall.recover = 1
fall.recovertime = 30
guard.kill = 0


[state 610, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype = A
trigger1 = hitpausetime = 17
triggerall = var(11) > 0
value = 675
ignorehitpause = 1

[state 600,  Not active]
trigger1 = animelemtime(7) = 0
type = statetypeset
movetype = I



[state 610, combo damage score]
type = varadd
trigger1 = movehit =1
trigger1 = enemy,statetype = A
v = 18
value = -9
persistent = 0
ignorehitpause = 1





;============================================================================
;------------------------------Belly Splash----------------------------------
; Start            : 611
; impact           : 612
; Bouncing airborn : 613
; Landing          : 614
; jump to feet     : 615
;=============================================================================

;Jump Belly Splash
; CNS difficulty: easy
[Statedef 611]
type    = A
movetype= A
physics = N
poweradd= 50
ctrl = 0
sprpriority = 2

[state 641, afterimage]
type = afterimage
trigger1 = 1
;length = 1
time = 1
timegap = 1

[state 611, animation]
type = changeanim
trigger1 = anim != 610
value = 610

[state 611, elephant sfx]
type = playsnd
trigger1 = var(15) = 1
trigger1 = animtime = 1
persistent = 0
value = S1,0

;1 hits of armor
[state 611, armor counter]
type = varset
trigger1 = time = 0
trigger1 = Var(21) = 1
V = 20
value = 1
persistent = 0

[state 611, armor counter]
type = varset
trigger1 = var(20) > 1
V = 20
value = 1
persistent = 0

[state 611, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 611, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = -gethitvar(damage)
persistent = 1

[state 611, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

[state 611, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 611
time = 1
persistent = 1

[State 611, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 240, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*1.25)
value = anim
elem = var(22)

[state 240, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*1.25)
value = 1
;--------------------------

[State 611, 3]
type = HitDef
trigger1 = vel y > 5
trigger1 = var(15) != 1
persistent = 0
attr = A, NA
damage = ifelse(enemy,movetype = H, 100,120), 24
guardflag = HA
priority = 3,miss
pausetime = 6,6
sparkno = 2
sparkxy = 0,-10
hitsound   = 5,3
guardsound = 6,0
animtype = Heavy
fall = 1
fall.recover = 0
ground.type = High
ground.hittime = 25
ground.slidetime = 14
ground.velocity = -3,7
air.velocity = -3,7
guard.velocity = -16            
guard.hittime = 30
guard.slidetime = 30
airguard.velocity = -8,2
airguard.hittime = 30
guard.dist = 280

[State 611, 3]
type = HitDef
trigger1 = vel y > 5
Trigger1 = Var(15) = 1
persistent = 0
attr = A, NA
damage = ifelse(enemy,movetype = H, 150,180), 36
guardflag = HA
priority = 3,miss
pausetime = 6,6
sparkno = -1
sparkxy = -10,-55
;hitsound   = 5,3
guardsound = 6,0
animtype = Heavy
fall = 1
fall.recover = 0
ground.type = High
ground.hittime = 30
ground.slidetime = 20
ground.velocity = -3,7
air.velocity = -3,7
guard.velocity = -16            
guard.hittime = 30
guard.slidetime = 30
airguard.velocity = -16,-8
airguard.hittime = 30
guard.dist = 280

[state 610, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = p2statetype != A
value = 661
ignorehitpause = 1
persistent = 0

[state 611, playerpush]
type = playerpush
trigger1 = 1 
value = 0

[state 611, gravity]
type = gravity
trigger1 = 1

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -6
persistent = 0
ignorehitpause =1 

[state 610, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 612
;---------------------------------------------------------------------------
;bounce
[Statedef 612]
type    = A
movetype= A
physics = N
anim = 611
sprpriority = 4

[state 612, width]
type = width
trigger1 = 1
value = 0,0

[state 612, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 642, dust]
type = explod
trigger1 = time = 0
anim = 1510
pos = 0,0
ontop = 1
ownpal = 1

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state 642, dust]
type = explod
trigger1 = time = 0
anim = 1511
pos = 0,0
sprpriority = -2 
ownpal = 1

[State 611, 3]
type = HitDef
trigger1 = Time = 0
trigger1 = var(15) != 1
attr = A, NA
HitFlag = D
getpower = 200
damage    = 150
guardflag = HA
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = 6,0
animtype = Heavy
ground.type = High
p2stateno = 661
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -7
air.velocity = -3,-4

[State 611, 3]
type = HitDef
trigger1 = Time = 0
trigger1 = var(15) = 1
attr = A, NA
HitFlag = D
getpower = 0
hitsound = S1,2
damage    = 300
guardflag = HA
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = 6,0
animtype = Heavy
ground.type = High
p2stateno = 661
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -7
air.velocity = -3,-4

[state 610, movehit energy]
type = poweradd
trigger1 = movehit = 1
value = 250


[state 611, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 611, slow down x]
type = velmul
trigger1 = time = 0
x = 0.5

[State 611, gravity]
type = gravity
trigger1 = time > 10

[State 611, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 16



[State 611, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0


[state 611, 2]
type = velset
trigger1 = time = 10
trigger1 = var(15) != 1
y = -2

[state 611, 2]
type = velset
trigger1 = time = 10
trigger1 = var(15) = 1
y = -4

[state 611, no push]
type = playerpush
trigger1 = 1
value = 0

[state 611, 3]
type = ChangeState
trigger1 = time = 11
value = 613
;--------------------------------------------------------------------------
; air again
[statedef 613]
type    = A
movetype= I
physics = N
anim = 612
sprpriority = 2

[state 613, 1]
type = ChangeState
trigger1 = pos y >= 0
value = 614 ;5121

[state 612, width]
type = width
trigger1 = 1
value = 0,0

[state 612, no push]
type = playerpush
trigger1 = time >= 0
value = 0
time = 600

[state 612, gravity]
type = gravity
trigger1 = time > 0

;------------------------------------------------------------------------------------
;Landed
[Statedef 614]
type  = C
movetype = I
physics = C
anim = 613
velset = 0,0
sprpriority = 2

[state 614, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 613, 1]
type = ChangeState
trigger1 = AnimTime = 0
value = 615

[state 614, heigh var]
type = varset
trigger1 = 1
v = 15
value = 0

[state 613, width]
type = width
trigger1 = 1
value = 0,0

[State 613, thud]
type = PlaySnd
trigger1 = time = 1
value = 0, 0

[state 613, Can't be thrown]
type = NotHitBy
trigger1 = 1
value = ,AT,NT,ST,HT
ignorehitpause = 1
time = 1

[state 613, no push]
type = playerpush
trigger1 = time >= 0
value = 0
time = 600

[State 613, shake]
type = EnvShake
trigger1 = Time = 1
time = 10
ampl = 8


;--------------------------------------------------------------------------
;bounce back up
[Statedef 615]
type  = A
movetype = I
physics = A
anim = 41
velset = 0,0
sprpriority = 2

[state 615, bounce]
type = velset
trigger1 = time = 0
x = -3
y = -6






;---------------------------------------------------------------------------
;Jumping light kick - stomp
[Statedef 630]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
sprpriority = 2

[state 630, animation]
type = changeanim
trigger1 = anim != 630
value = 630

[State 630, 3]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = A, NA
damage = 42, 4
guardflag = HA
priority = 4
pausetime = 14,14
guard.kill = 0
sparkno = 3
sparkxy = -10,-284
hitsound   = 5,3
guardsound = 6,0
animtype = Heavy
fall.recover = 0
ground.type = High
ground.hittime = 30
ground.slidetime = 16
ground.velocity = -18
air.velocity = -8,-12
guard.velocity = -36           
guard.hittime = 18
guard.slidetime = 18
air.hittime = 28
airguard.velocity = -24,-3
airguard.hittime = 24
guard.dist = 640
guard.kill = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 630,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[state x, movecontact]
type = playerpush
trigger1 = movehit = 1
value = 0
ignorehitpause = 1


[state 630, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1
;---------------------------------------------------------------------------
;Jumping Strong Kick
[Statedef 640]
type    = A
movetype= A
physics = A
ctrl = 0
juggle = 5
sprpriority = 2

[state 640, animation]
type = changeanim
trigger1 = anim != 650
value = 650

[state 640, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 640, playsnd]
type = playsnd
trigger1 = time = 2
value = S640,0
channel = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[State 640, 3]
type = HitDef
trigger1 = animelem = 6
persistent = 0
attr = A, NA
HitFlag = MAFD
damage    = ifelse(enemynear,statetype = L, 160,120),12
guardflag = HA
priority = 4
pausetime = 18,18
guard.kill = 0
hitsound   = 5,4
sparkno = 3
id = 640
nochainid = 1400
sparkxy = -10,64
guardsound = 6,0
animtype = Heavy
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -6,120
air.velocity = -3,120
guard.velocity = -45         
guard.hittime = 24
guard.slidetime = 24
airguard.velocity = -25, 2
airguard.hittime = 28
envshake.freq = 60
envshake.ampl = 12
envshake.time = 18
DOWN.velocity = 0,0
down.hittime = 18
yaccel = 1.4
guard.dist = 640
guard.kill = 0
fall = 1

[state 640, varadd]
type = varadd
trigger1 = movehit
trigger1 = numtarget(640)
trigger1 = target(640),statetype != L
var(12) = -1
persistent = 0
ignorehitpause = 1

[state 640, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 17
trigger1 = var(12) > 0
trigger1 = numtarget(640)
trigger1 = target(640),statetype != L
value = 245
ignorehitpause = 1

[state 640,  Not active]
trigger1 = animelemtime(7) = 0
type = statetypeset
movetype = I

[state 640, targetstate]
type = null
trigger1 = movehit
trigger1 = hitpausetime = 17
trigger1 = numtarget(640)
trigger1 = target(640),statetype = L
value = 660
ignorehitpause = 1



 

;==========================================================================
;----------------------------------Butt Drop-------------------------------
; Start 	:	641
; Impact	: 	642
; Airborn	: 	643
; Seated	:	644
; Harmless	:	645
; Get up	:	646
; Rec B.bump	:	647
; Armor 	:	648
;===========================================================================

; CNS difficulty: easy
[Statedef 641]
type    = A
movetype= A
physics = N
juggle  = 0
ctrl = 0
sprpriority = 2

[state 641, animation]
type = changeanim
trigger1 = anim != 640
value = 640

[state 641, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(6400)
anim = 6400
id = 6400
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
removetime = -1
ignorehitpause = 1
sprpriority = 2

[state 641, sprpriority]
type = sprpriority
trigger1 = movehit
value = -2
ignorehitpause = 1

;=================================
;-      Damage Set
;=================================

;Out of range, moreso Max damage
;Out of Range
[state 650, damage set]
type = varset
trigger1 = ceil(pos y) <= -1000 
trigger1 = time = 0
var(14) = 1300

;Out of Range
[state 650, damage set]
type = varset
trigger1 = ceil(pos y) <= -600 && ceil(pos y) > -1000
trigger1 = time = 0
trigger1 = var(21) = 1
var(14) = 500

; Peak Super Jump
[state 650, damage set]
type = varset
trigger1 = ceil(pos y) <= -400  && ceil(pos y) > -600
trigger1 = time = 0
trigger1 = var(21) = 1
var(14) = 260

; Super Jump
[state 650, damage set]
type = varset
trigger1 = ceil(pos y) <= -320 && ceil(pos y) > -400
trigger1 = time = 0
trigger1 = var(21) = 1
var(14) = 240

; Peak Normal Jump
[state 650, damage set]
type = varset
trigger1 = ceil(pos y) <= -220 && ceil(pos y) > -320
trigger1 = time = 0
trigger1 = var(21) = 1
var(14) = 220


; small Normal Jump
[state 650, damage set]
type = varset
trigger1 = ceil(pos y) <= 0 && ceil(pos y) > -250
trigger1 = time = 0
trigger1 = var(21) = 1
var(14) = 200

[state 641, afterimage]
type = afterimage
trigger1 = 1
;length = 1
time = 1
timegap = 1

[state 641, elephant sfx]
type = playsnd
trigger1 = var(15) = 1
trigger1 = animtime = 1
persistent = 0
value = S1,0

[state 641, armor counter]
type = varset
trigger1 = time = 0
trigger1 = Var(21) = 1
V = 20
value = 1   ; +to get through projectiles and anti airs. - Move has a ton of recovery
persistent = 0

[state 641, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 641, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = -gethitvar(damage)
persistent = 1

[state 641, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

;[state 641, display]
;type = displaytoclipboard
;trigger1 = 1
;text = "armor count is %d and damage taken is %d"
;params = var(20), gethitvar(damage)


[state 641, Unstoppable]
type = hitoverride
trigger1 = Life > 1
;trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 641
time = 1
persistent = 1

[State 611, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 641, gravity]
type = gravity
trigger1 = 1

[state 641, width]
type = width
trigger1 = 1
value = 0,0

[State 641, 3]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
getpower = 250
HitFlag = MA
damage    = var(14),ifelse(var(14) > 331, floor(var(14)*0.1),floor(var(14)*0.3))
guardflag = HA
priority = 7
fall = 1
id = 641
nochainid = 641
fall.recover = 0
pausetime = 2,2
sparkno = -1
guardsound = 6,0
animtype = Heavy
ground.type = High
ground.slidetime = 18
ground.hittime  = 30
ground.velocity = -2,5
air.velocity = -6,10
guard.velocity = -120           
guard.hittime = 60
guard.slidetime = 60
airguard.velocity = -54,2
airguard.hittime = 35
guard.dist = 240
guard.cornerpush.veloff = -120



;Ride down mechanic
[state 641, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = 44, -112

[state 641, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1006
id = 641

[state 641, end]
type = targetstate
trigger1 = pos y > -10
trigger1 = enemy,stateno = 1006
value = 660
id = 641
;-------------------

[state 641, targetstate]
type = targetstate
triggerall = numtarget(641)
trigger1 = movehit
trigger1 = enemy, statetype != A 
trigger1 = target(641),life > 0
value = 660
ignorehitpause = 1

[state 641, wedge]
type = targetstate
triggerall = numtarget(641)
trigger1 = movehit
trigger1 = target(641),life <= 0
value = 650

[state 641, wedge var]
type = varset
trigger1 = enemynear,life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 642, bind]
type = targetbind
trigger1 = movehit
trigger1 = enemynear,life <= 0
ID = 30
time = 1000
pos = 0,0

[state 641, playpush]
type = playerpush
trigger1 = 1
value = 0

[state 641, end miss]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
trigger1 = movehit = 0
value = 642

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[State 641, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = Movehit != 0
value = 645


;---------------------------------------------------------------------------
;Bounce
[Statedef 642]
type    = C
movetype= A
physics = N
sprpriority = 2

[state 642, removexplod]
type = removeexplod
trigger1 = time = 0
id = 6400

[state 642, anim]
type = changeanim
trigger1 = time = 0
value = 641

[state 642, width]
type = width
trigger1 = 1
value = 0,0

[state 642, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 642, Thwomp Grunt]
type = playsnd
trigger1 = time = 4
value = S641,0

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[State 642, 3]
type = HitDef
trigger1 = animelem = 1
attr = A, SA
getpower = 210
HitFlag = FD
hitsound = S1,2
damage    = var(14)
guardflag = 
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = 6,0
animtype = Heavy
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
fall.recover = 0

;[State 642, Earthquake]
;type = Helper
;trigger1 = Time = 3
;trigger1 = var(15) = 1
;ignorehitpause = 1
;ID = 649
;name = "Earthquake"
;pos = 0,0
;postype = p1
;stateno = 649
;keyctrl = 0
;ownpal = 1
;helpertype = normal

[state 642, flatten]
type = targetstate
triggerall = animelem = 2 && movehit
trigger1 = p2life > 0
value = 660

[state 642, flatten]
type = targetstate
trigger1 = animelem = 2 && movehit
trigger1 = p2life <= 0
value = 650

[state 642, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 642, bind]
type = targetbind
trigger1 = movehit
trigger1 = p2life <= 0
ID = 30
time = 1000
pos = 0,0

[state 642, movehit energy]
type = poweradd
trigger1 = movehit = 1
value = 250

[state 642, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 642, slow down x]
type = velmul
trigger1 = time = 0
x = 0.5

[State 642, gravity]
type = gravity
trigger1 = time > 10

[State 642, 1]
type = EnvShake
trigger1 = time = 0
trigger1 = var(14) < 640
persistent = 0
time = 24
ampl = -18


[State 642, 1]
type = EnvShake
trigger1 = time = 0
trigger1 = var(14) >= 640
persistent = 0
time = 48
ampl = -24

[state 642, statetypeset]
type = statetypeset
trigger1 = time = 10
statetype = A



[State 641, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0


[state 641, 2]
type = velset
trigger1 = time = 10
trigger1 = var(15) != 1
y = -12

[state 641, 2]
type = velset
trigger1 = time = 10
trigger1 = var(15) = 1
y = -18

[state 641, no push]
type = playerpush
trigger1 = 1
value = 0


[state 641, 3]
type = ChangeState
trigger1 = time = 11
value = 643
;--------------------------------------------------------------------------
; air again
[statedef 643]
type    = A
movetype= I
physics = N
sprpriority = 2

[state 643, anim]
type = null
trigger1 = time = 0
value = 642

[state 642, 1]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 644 ;5121

[state 640, width]
type = width
trigger1 = 1
value = 0,0

[state 642, no push]
type = playerpush
trigger1 = 1
value = 0


[state 642, gravity]
type = gravity
trigger1 = 1

;------------------------------------------------------------------------------------
;seated
[Statedef 644]
type  = C
movetype = I
physics = C
velset = 0,0
sprpriority = 2

[state 643, anim]
type = changeanim
trigger1 = time = 0
value = 643

[state 643, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = animtime = 3
value = S641,0


[state 643, 1]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = p2life > 0
persistent = 1
value = 646
ctrl = 0

[state 643, 2]
type = changestate
trigger1 = animtime = 0
trigger1 = p2life <= 0
value = 648
ctrl = 0

[state 643, width]
type = width
trigger1 = 1
value = 0,0

[State 643, thud]
type = PlaySnd
trigger1 = time = 1
value = 0, 0

[state 643, Can't be thrown]
type = NotHitBy
trigger1 = 1
value = ,AT,NT,ST,HT
ignorehitpause = 1
time = 1

[state 643, no push]
type = playerpush
trigger1 = time >= 0
value = 0
time = 600

[State 643, shake]
type = EnvShake
trigger1 = Time = 1
time = 10
ampl = 8


;---------------------------------------------------------------------------
;Harmless bounce
;Bounce
[Statedef 645]
type    = C
movetype= I
physics = N
anim = 641
sprpriority = 2

[state 645, removexplod]
type = removeexplod
trigger1 = time = 0
id = 6400

[state 645, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 645, anim]
type = changeanim
trigger1 = time =0
value = 641

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state 1001, invun]
type = nothitby
trigger1 = 1
value = , AP
time = 1

[state 644, width]
type = width
trigger1 = 1
value = 0,0

[state 644, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 644, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 644, slow down x]
type = velmul
trigger1 = time = 0
x = 0.5

[State 644, gravity]
type = gravity
trigger1 = time > 10

[State 644, 1]
type = EnvShake
trigger1 = time = 0
trigger1 = var(15) != 1
persistent = 0
time = 25
ampl = 10
freq = 100
phase = 100

[State 644, 1]
type = EnvShake
trigger1 = time = 0
trigger1 = var(15) = 1
persistent = 0
time = 35
ampl = 20
freq = 100
phase = 100

[State 644, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0

[state 642, statetypeset]
type = statetypeset
trigger1 = time = 10
statetype = A


[state 644, 2]
type = velset
trigger1 = time = 10
trigger1 = var(15) != 1
y = -12

[state 641, 2]
type = velset
trigger1 = time = 10
trigger1 = var(15) = 1
y = -18



[state 644, no push]
type = playerpush
trigger1 = 1
value = 0


[state 644, 3]
type = ChangeState
trigger1 = time = 11
value = 643

;---------------------------------------------------------------------------
;Get up Animation
[statedef 646]
type = C
movetype = I
physics = C


[state 645, anim]
type = changeanim
trigger1 = time = 0
value = 5120

[State 645, x movement]
type = velset
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(4) < 0
x = -15

[State 645, x movement]
type = velset
trigger1 = AnimElemtime(5) = 0 
x = 0


[State 645, x movement]
type = velset
trigger1 = AnimElemtime(6) >= 0 
x = -15 

[state 44, height indicator]
type = varset
trigger1 = time = 1
V = 15
value = 0


[state 645, 1]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;get up animation - butt bump
[statedef 647]
type = C
movetype = I
physics = C

[state 646, anim]
type = changeanim
trigger1 = time = 0
value = ifelse (prevstateno = 1043,4001,4003)

[State 645, x movement]
type = velset
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
x = -6

[state 44, height indicator]
type = varset
trigger1 = 1
V = 15
value = 0

[state 646, 1]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Get up animation - Wedge
[statedef 648]
type = A
movetype = I
physics = A

[state 646, anim]
type = changeanim
trigger1 = anim!= 41
value = 41

[state 648, frame1]
type = posset
trigger1 = time = 0
y = 0

[state 646, movement]
type = velset
trigger1 = time = 2
x = 2
y = -14
;---------------------------------------------------------------------------
;Earthquake helper
[statedef 649]
type = C
movetype = A
physics = C
velset = 0,0
anim = 648

[State 441, hit]
type = HitDef
trigger1 = 1
persistent = 0
attr = C, SP
damage    = 0,0
guardflag = M
Hitflag = H
priority = 1,miss
;hitsound   = 
pausetime = 6,6
guard.pausetime = 12,12
guard.hittime = 12
sparkno = 2
sparkxy = 0,0
guardsound = 6,0
animtype = Up
fall.recover = 0
ground.type = trip
ground.slidetime = 20
guard.velocity = 1.5
ground.hittime  = 45
ground.velocity = -0.2, -6
air.velocity = 0,0
air.hittime = 45

[State 345, End]
type = DestroySelf
trigger1 = Time = 3



;---------------------------------------------------------------------------
;Win - Wedged State
[statedef 650]
type = L
movetype = H

;state 650, velset]
[state 650, stop]
type = velset 
trigger1 = 1
y = 0
x = 0

;[state 650, hide]
;type = Assertspecial
;trigger1 = p2stateno != 185
;flag = Invisible

[state 650, anim]
type = changeanim2
trigger1 = anim != 9999
value = 9999

[state 650, end]
type = changestate
trigger1 = time = 20
value = 5150

;[state 650, end round]
;type = assertspecial
;trigger1 = time = 20
;flag = roundover

;[State 650, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050

;[state 650, changestate]
;type = selfstate
;trigger1 = time = 30
;value = 5050

[state 650, end match]
type = changestate
trigger1 = roundstate = 4
value = 651

;----------------------------------------------------------------------------
[statedef 651]
type = A
movetype = H
physics = N
sprpriority = 0

[state 651, anim]
type = changeanim2
trigger1 = anim != 187
value = 187

[state 185, nopush]
trigger1 = 1
type = playerpush
value = 0

[state 185, bind 1 alt]
type = posset
trigger1 = enemy, animelem =1
x = enemy, pos x - (enemy, facing*10)
y = const(size.mid.pos.y)/8


[state 185, bind 2 alt]
type = posset
trigger1 = enemy, animelem =2
x = enemy, pos x - (enemy,facing*200)

[state 185, bind 3 alt]
type = posset
trigger1 = enemy, animelem =3
x = enemy, pos x - (enemy, facing*220)

[state 185, bind 4 alt]
type = posset
trigger1 = enemy, animelem =4
x = enemy, pos x - (enemy, facing*280)

[state 185, bind 5 alt]
type = posset
trigger1 = enemy, animelem =5
x = enemy, pos x - (enemy, facing*290)

[state 185, bind 6 alt]
type = posset
trigger1 = enemy, animelem =6
x = enemy, pos x - (enemy, facing*280)

[state 185, bind 7 alt]
type = posset
trigger1 = enemy, animelem =7
x = enemy, pos x - (enemy, facing*240)

[state 185, bind 8 alt]
type = posset
trigger1 = enemy, animelem =8
x = enemy, pos x - (enemy, facing*180)

[state 185, bind 9 alt] ;Base
type = posset
trigger1 = enemy, animelem =9
x = enemy, pos x - (enemy, facing*160)

[state 185, bind 10 alt]
type = posset
trigger1 = enemy, animelem =10
x = enemy, pos x - (enemy, facing*150)

[state 185, bind 11 alt]
type = posset
trigger1 = enemy, animelem =11
x = enemy, pos x - (enemy, facing*140) 

[state 185, bind 12 alt]
type = posset
trigger1 = enemy, animelem =12
x = enemy, pos x - (enemy, facing*150)

[state 185, bind 13 alt]
type = posset
trigger1 = enemy, animelem =13
x = enemy, pos x - (enemy, facing*160) ;base

[state 185, bind 14 alt]
type = posset
trigger1 = enemy, animelem =14
x = enemy, pos x - (enemy, facing*170)

[state 185, bind 15 alt]
type = posset
trigger1 = enemy, animelem =15
x = enemy, pos x - (enemy, facing*160)

[state 185, bind 16 alt]
type = posset
trigger1 = enemy, animelem =16
x = enemy, pos x - (enemy, facing*150)

[state 185, bind 17 alt]
type = posset
trigger1 = enemy, animelem =17
x = enemy, pos x - (enemy, facing*160)



;[state 650, hide]
;type = Assertspecial
;trigger1 = animelemtime(1) >= 0 || animelemtime(2) < 0
;trigger2 = animelemtime(2) >= 0 || animelemtime(3) < 0
;flag = Invisible



 

;===========================================================================
;---------------------------Crushed State-----------------------------------
;===========================================================================
; Moderate Crushed State
[statedef 660]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -1

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.3,0.1
ignorehitpause = 1
persistent = 1

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 660, invunerability]
type = nothitby
trigger1 = 1
value = SCA



[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0



[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0



;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 105 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150

;---------------------------------------------------------------------------
;Brief Crushed State
[statedef 661]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 661, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.25,0.2

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0

[State 661, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 660, invunerability]
type = nothitby
trigger1 = time > 50
value = SCA


[State 661, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 661, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 661, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 661, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 661, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 661, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 661, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 661, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 80
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 30
value = 5150


;---------------------------------------------------------------------------
;Super Crushed State
[statedef 662]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 661, flatten]
type = AngleDraw
trigger1 = time > 0  && time <25
triggerall = prevstateno != 3050
value = 0
scale = 1.25,0.2
ignorehitpause

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 661, Width]
type = Width
trigger1 = time > 0
value = 1,1

[state 662, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 662, screenbound]
type = screenbound
trigger1 = (enemy,stateno = [3000,3010])
value = 0
movecamera = 0,0


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 661, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 661, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

;[state 662, hitby]
;type = hitby
;trigger1 = 1
;value = SCA,AA

[State 662, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 662, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 662, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 300
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 150
value = 5150

;---------------------------------------------------------------------------
;Winning Crushed State
[statedef 665]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 665, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[state 665, scream]
type = playsnd
trigger1 = 1
value = 11,0
persistent = 0


[State 665, flatten]
type = AngleDraw
trigger1 = time > 0  && time <25
value = 0
scale = 1.3,0.1

[state 665, on ground]
type = posset
trigger1 = 1
y = 0

[state 665, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 665, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 665, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 665, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 665, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 665, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 665, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 665, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 665, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 665, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 665, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 665, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 665, hitby]
type = hitby
trigger1 = time > 0
value = SCA, AA
ignorehitpause = 1

[State 665, get up]
type = selfstate
triggerall = life >= 1
trigger1 = time > 600
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 300
value = 5150



;---------------------------------------------------------------------------
;===========================================================================
;------------------------------Wall Bounce State
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670, anim]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 690, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

[State 670, Velocity]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[state 670, anim]
type = changeanim
trigger1 = time = 0
value = 5030

[State 670, Gravity]
type = veladd
trigger1 = 1
y = 1.25

[State 670, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3
ownpal = 1

[State 671, Anim]
type = ChangeAnim
trigger1 = Time = 0
value = 5030

[State 671, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 671, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 672, 1]
type = NotHitBy
trigger1 = 1
value = , NP

[State 672, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -24

[State 672, Vel X]
type = VelSet
trigger1 = Time = 0
x = abs(p2dist x*0.02)

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = 1.25

[State 672, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 672, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 672, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 672, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 672, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;===========================================================================
; Neutral Wall Bounce State
;===========================================================================

[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 690, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 1

[state 675, anim]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 675, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[State 676, Velocity]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[state 676, anim]
type = changeanim
trigger1 = time = 0
value = 5030

[State 676, Gravity]
type = veladd
trigger1 = 1
y = 1.25

[State 676, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 676, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3
ownpal = 1

[State 677, Anim]
type = ChangeAnim
trigger1 = Time = 0
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

[State 678, 1]
type = NotHitBy
trigger1 = 1
value = , NP

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -18

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 2

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 678, Gravity]
type = VelAdd
trigger1 = 1
y = 1.25

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 678, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;==========================================================================
;Stun
;==========================================================================
;--------------------------------------------------------------------------
;Stun Knockback
[statedef 690]
type = A
movetype = H
physics = N
anim = 5061

[state 690, hitvelset]
type = hitvelset
trigger1 = time = 0
x = 1
y = 1

[state 690, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 1


[state 690, gravity]
type = gravity
trigger1 = 1

[state 690, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 691
persistent = 0

;---------------------------------------------------------------------------
; Downed get-hit (hit ground from fall)
[Statedef 691]
type    = L
movetype= H
physics = N

[state 691, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 0

[State 691, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 691, 2] ;Hit ground anim (normal)
type = ChangeAnim
trigger1 = time = 0
value = 5100

[State 691, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 691, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 691, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.5

[state 691, shockwave]
type = explod
trigger1 = time = 0
anim = F61
scale = 2,2
pos = 0,0
postype = p1

[State 691, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7, 1

[State 691, 11]
type = PosFreeze
trigger1 = 1

[State 691, 12]
type = ChangeState
trigger1 = time = 4
value = 692 ;Downed get-hit (bounce off ground)

[State 691, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; Downed get-hit (bounce off ground)
[Statedef 692]
type    = L
movetype= H
physics = N

[State 692, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 692, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 692, 4]
type = PosSet
trigger1 = Time = 0
y = -8;Const(movement.down.bounce.offset.y)

[State 692, 5]
type = PosAdd
trigger1 = Time = 0
x = 0;Const(movement.down.bounce.offset.x)

[State 692, 6] ;Acceleration
type = VelAdd
trigger1 = 1
y = Const(movement.down.bounce.yaccel)

[State 692, 7] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= Const(movement.down.bounce.groundlevel)
type = ChangeState
value = 693

;---------------------------------------------------------------------------
; Downed get-hit (lying down)
[Statedef 693]
type    = L
movetype= H
physics = N

[State 693, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 693, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = time = 0
value = 5110

[State 693, 5]
type = PosSet
trigger1 = Time = 0
y = 0


[State 693, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > Const720p(20)) + (sysvar(1) > Const720p(56))

[State 693, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 693, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 693, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 693, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 693, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 693, 14] ;Friction
type = VelSet
trigger1 = abs(Vel x) < Const(movement.down.friction.threshold)
persistent = 0
x = 0

[State 693, 15]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 693, 16]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 5110, 11] ;If just died
type = ChangeState
trigger1 = time = 4
;trigger1 = AnimTime = 0
;trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
;trigger3 = Anim = [5110,5119]
value = 694

;---------------------------------------------------------------------------
; Downed get-hit (getting up)
[Statedef 694]
type    = L
movetype= H
physics = N

[State 694, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 694, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 694, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 694, 3]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[state 690, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 0

[State 694, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 695
;--------------------------------------------------------------------------
;Stun
[statedef 695]
type = S
movetype = H
physics = S
anim = 5300
velset = 0,0

[state 695, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 695, end]
type = selfstate
trigger1 = time = 120
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 4

; Notes: The '-' symbol in the hitflag field means that it only affects
;   players who are not in a hit state. This prevents KFM from combo-ing
;   into the throw. The priority should be set to a low number, such as
;   1 or 2, so that the throw does not take precedence over normal attacks.
;   The type of priority must always be set to "Miss" or "Dodge" for throws,
;   otherwise strange behavior can result.

[State 800, 1]
type = HitDef
triggerall = p2movetype != A
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-         
priority = 1, Miss   
sparkno = -1         
id = 800                    
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 820       
guard.dist = 0        
fall = 1        

[State 800, 1]
type = HitDef
triggerall = p2movetype = A
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-         
priority = 1, Miss   
sparkno = -1         
id = 800                    
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 822       
guard.dist = 0        
fall = 1      

[State 800, 1]
type = HitDef
triggerall = enemynear,anim = 5300
Trigger1 = Time = 0
attr = S, NT          
hitflag = M         
priority = 1, Miss   
sparkno = -1         
id = 800                    
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 822       
guard.dist = 0        
fall = 1  

[state 800, miss voice]
type = playsnd
trigger1 = animelemtime(3) = 2
value = S5000,0

[state 800,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - P2 No effects
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
sprpriority = 4

[state 805, pos y set]
type =posset
trigger1 = time = 0
y = 0

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120


;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -12


[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Grab Escape - P1 - Effects go here FX
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0
sprpriority = -1

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(120)
value = 120

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 806, velset]
type = velset
trigger1 = time = 1
x= -12

[state 806, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 806, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1






;---------------------------------------------------------------------------
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 150
sprpriority = -2


[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target,stateno != [820,829]
value = 806
persistent = 1

[State 810, Holding Direction?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdfwd"


[state 810, width]
type = width
trigger1 = 1
edge = 420,420

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[state 810, posadd]
type = posadd
trigger1 = animelem = 1
x = 120

[state 810, sprp]
type = sprpriority
trigger1 = animelem = 2
value = 2

[state 810, sprp]
type = sprpriority
trigger1 = animelem = 10
value = -2

[state 810, footstep]
type = playsnd
trigger1 = animelem = 3
value = S0,1

[state 20, quake]
type = envshake
trigger1 = animelem = 3
time = 12
ampl = 8

[state 810, grunt]
type = playsnd
trigger1 = animelemtime(6) = 10
value = S800,(random%2)
persistent = 0

[state 810, footstep]
type = playsnd
trigger1 = animelem = 7
value = S0,1

[state 20, quake]
type = envshake
trigger1 = animelem = 7
time = 16
ampl = 12


[state 810, footstep]
type = playsnd
trigger1 = animelem = 10
value = S0,1

[state 20, quake]
type = envshake
trigger1 = animelem = 10
time = 12
ampl = 8


[state 810, posadd]
type = posadd
trigger1 = animelem = 2
x = 140

[state 810, posadd]
type = posadd
trigger1 = animelem = 3
x = 120

[state 810, posadd]
type = posadd
trigger1 = animelem = 8
x = -160

[state 810, posadd]
type = posadd
trigger1 = animelem = 9
x = -240



[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 454, -540

[State 810, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 460, -546

[State 810, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 434, -698

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = 480, -720

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = 388, -724

[State 810, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = 394, -728

[State 810, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = 362, -722



[State 810, holdfwd - Turn 7] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 6

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElemtime(6) = 3
x = -37

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 6
value = -1


[State 810, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -310, -672


[State 810, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) = 0 
pos = -520, -160


[State 810, Hurt 14]
type = TargetLifeAdd
trigger1 = AnimElem = 10
value = -160

[State 810, Throw 14]
type = TargetState
trigger1 = AnimElemtime(9) = 1
value = 821

[State 810, 7 quake]
type = EnvShake
trigger1 = animelem = 7
persistent = 0
time = 15
ampl = 10
freq = 200
phase = 100

[state 810, front foot front dust]
type = explod
trigger1 = animelem = 3
anim = F120
pos = 84,6
scale = 2, 2
ontop = 1
ownpal = 1

[state 810, front foot back dust]
type = explod
trigger1 = animelem = 3
anim = F120
pos = 266,6
scale = 2, 2
ontop = 1
ownpal = 1

[state 810, front foot front dust]
type = explod
trigger1 = animelem = 7
anim = F120
pos = -440,8
scale = 2, 2
ontop = 1
ownpal = 1

[state 810, front foot back dust]
type = explod
trigger1 = animelem = 7
anim = F120
pos = -250,8
scale = 2, 2
ontop = 1
ownpal = 1

[state 810, front foot front dust]
type = explod
trigger1 = animelem = 10
anim = F120
pos = -320,22
scale = 2, 2
ontop = 1
ownpal = 1

[state 810, front foot back dust]
type = explod
trigger1 = animelem = 10
anim = F120
pos = -150,22
scale = 2, 2
ontop = 1
ownpal = 1

[state x, combo dampener]
type = varadd
trigger1 = animtime = 0
v = 18
value = -18
persistent = 0
ignorehitpause =1 

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 811



;---------------------------------------------------------------------------
;Follow through on throw
[Statedef 811]
type    = S
movetype= I
physics = N
anim = 811
poweradd = 0
sprpriority = -4

[State 811, 12 quake]
type = EnvShake
trigger1 = animelem = 4
persistent = 0
time = 15
ampl = 10
freq = 200
phase = 100

[state 811, front foot front dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = -60,15
scale = 2, 2
ontop = 1
ownpal = 1

[state 810, front foot back dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = -20,15
scale = 2, 2
ontop = 1
ownpal = 1

[state 811, 12 sfx]
type = playsnd
trigger1 = animelem = 4
persistent = 0
value = S0,1

[State 811, turn at end]
type = Turn
trigger1 = Animtime = 0

[state 811, animation]
type = changestate
trigger1 = animtime = 0
ctrl = 1
value = 0
;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 805


[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Non techable Grab
[Statedef 822]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050


;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
poweradd = 80
sprpriority = 0

[State 821, gravity] ;Gravity
type = gravity
Trigger1 = 1

[state 821, Speed]
type = velset
trigger1 = time = 0
x = 18 
y = 120

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 810, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 1


;[State 821, 2] ; Recover near ground (use ChangeState)
;type = ChangeState
;triggerall = Vel Y > 0
;triggerall = Pos Y >= -20
;triggerall = alive
;triggerall = CanRecover
;trigger1 = Command = "recovery"
;value = 5200 ;HITFALL_RECOVER

;[State 821, 3] ; Recover in mid air (use SelfState)
;type = SelfState
;triggerall = Vel Y > 0
;triggerall = alive
;triggerall = CanRecover
;trigger1 = Command = "recovery"
;value = 5210 ;HITFALL_AIRRECOVER

[State 821, 4] ;Hit ground
type = changestate
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 825 ;Hit ground

[state 820, thud sfx]
type = playsnd
trigger1 = pos y >= -1
persistent = 0
value = S0,1
;--------------------------------------------------------------------------
;Hard Bounce
[statedef 825]
type    = A
movetype= H
physics = N
poweradd = 40
anim = 5100
sprpriority = 1

[state 825, impact]
type = velset
trigger1 = time = 0
y = 0

[state 240, shake]
type = envshake
trigger1 = time = 0
ampl = 14
time = 16

[State 240, 8]
type = Explod
trigger1 = Time = 1
anim = F62 ;f3 is pretty good
;anim = F(60 + (sysvar(1) > Const720p(20)) + (sysvar(1) > Const720p(56)))
pos = 0, 0
scale = 2,1
ontop = 1
ignorehitpause = 1
ownpal = 1


[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7,2
;value = F7, (sysvar(1) > Const720p(20)) + (sysvar(1) > Const720p(56))

[state 246, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 246, bounce]
type = velset
trigger1 = time = 6
y = -36
x = 1.6

[state 246, anim]
type = changeanim
trigger1 = time = 6
value = 5061

[state 246, gravity]
type = gravity
trigger1 = time > 7

[state 246, down]
type = selfstate
trigger1 = time >= 7 && pos y >= 0
value = 5110




;===========================================================================
;                             Jumbo Butt Bounce
;===========================================================================
;---------------------------------------------------------------------------
;Vicious Butt Drops -Light HA!
[Statedef 1000]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 100
velset = 0, 0
anim = 41
ctrl = 0
sprpriority = 2

[state 1000, invun]
type = nothitby
trigger1 = 1
value = ,AP

[state 1000, elephant sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S1000,random%3
channel = 1

;1 extra bounce
[state 1300, var]
type = varset
trigger1 = time = 0
v = 23
value = 1

[State 1000, 7]
type = ChangeState
trigger1 = time = 1
value = 1001


[state 1000, combo damage score]
type = varadd
trigger1 = time = 0
v = 18
value = ifelse(enemy,movetype = H,-18,0)

;---------------------------------------------------------------------------
;Going Up
[statedef 1001]
Type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 42

[state 1001, invun]
type = nothitby
trigger1 = 1
value = , AP

[state 1001, movement]
type = velset
trigger1 = time = 0
x = ifelse(p2bodydist x > 500, 27.777, floor(p2dist x * 0.0555))
y = -50

[state 1011, varset]
type = varset
trigger1 = time = 0
v = 15
value = 1
persistent = 0

[state 1001, control]
type = veladd
trigger1 = command = "holdfwd"
trigger1 = ailevel = 0
x = 0.2

[state 1001, control]
type = veladd
trigger1 = command = "holdback"
trigger1 = ailevel = 0
x = -0.2


[state 1002, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 1001, end]
type = changestate
trigger1 = time = 18
value = 1002
;---------------------------------------------------------------------------
;coming down L
[Statedef 1002]
type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
poweradd = 0
anim = 1002
sprpriority = -2

[state 1002, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(10020)
anim = 10020
id = 10020
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
removetime = -1
ignorehitpause = 1
sprpriority = 2

[state 1002, freeze]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1000, invun]
type = nothitby
trigger1 = time < 8
value = , AP

[state 1002, fall]
type = veladd
trigger1 = time > 8
y = 7.2

[state 1002, gravity]
type = gravity
trigger1 = time > 8


[state 1002, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[State 1002, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 0,30
guardflag = HA
hitflag = MAFD
priority = 4
hitsound = S0,8
pausetime = 0,0
id = 1000
nochainid = 430
guard.pausetime = 7,12
sparkno = -1
guardsound = 6,0
p1sprpriority = -2
animtype = heavy
down.hittime = 40
ground.type = High
guard.velocity = -60       
guard.hittime = 34
guard.slidetime = 34
airguard.velocity = -32,-1
airguard.hittime = 60
guard.dist = 640

[state 1002, flatten]
type = targetstate
triggerall = numtarget(1000)
triggerall = target(1000),ishelper = 0
trigger1 = movehit
trigger1 = enemy,statetype != A
value = 661

;Ride down mechanic
[state 1002, Ride down]
type = targetbind
triggerall = numtarget(1000)
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = 44, -112

[state 1002, state of ride down]
type = targetstate
triggerall = numtarget(1000)
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1006

[state 1002, end]
type = targetstate
triggerall = numtarget(1000)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1006
value = 661
;-------------------


[state 1002, wedge]
type = targetstate
triggerall = numtarget(1000)
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1002, wedge var]
type = varset
triggerall = numtarget(1000)
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 1002, end miss]
type = changestate
triggerall = movehit = 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1007

[state 1002, end hit]
type = changestate
triggerall = movehit != 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1003
;---------------------------------------------------------------------------
; vicious bounces Land
[statedef 1003]
type    = C
movetype= A
physics = C
anim = 641
sprpriority = 2

[state 1003, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 642, crater]
type = explod
;triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
;trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
;trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1003, invun]
type = nothitby
trigger1 = 1
value = , AP, AT

[state 1003, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1003, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 1003, on ground2]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 1003, 3]
type = HitDef
trigger1 = 1
attr = C, SA
damage = 100
persistent = 0
Hitflag = FD
guardflag = 
priority = 7
sparkno = -1
hitsound = S1,2
fall.recover = 0
pausetime = 0,0
guard.pausetime = 8, 10
guardsound = 6,0
animtype = Heavy

[state 1003, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 1003, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1003, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1


[State 1003, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 35
ampl = 20
freq = 100
phase = 100


[State 1003, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0



[state 1003, var counter]
type = varadd
trigger1 = time = 0
var(23) = -1

[state 1003, repeater]
type = changestate
trigger1 = time = 8
value = 1004
;---------------------------------------------------------------------------
;Bounce repeater
[Statedef 1004]
type    = A
movetype= A
physics = N
anim = 1002
sprpriority = 2

[state 1004, invun]
type = nothitby
trigger1 = 1
value = , AP, AT


[state 1004, nudge]
type = veladd
trigger1 = command = "holdfwd"
x = 0.2

[state 1004, nudge]
type = veladd
trigger1 = command = "holdback"
x = -0.2

[state 1004, movement]
type = velset
triggerall = Var(23) = 0
trigger1 = time = 0
y = -36

[state 1004, no push]
type = playerpush
trigger1 = time >= 0
value = 0
time = 600

[state 1004, veladd]
type = veladd
trigger1 = vel y > 3
y = 6
persistent = 1

[state 1304, movement]
type = velset
Triggerall = Var(23) = 1
trigger1 = time = 0
y = -24

[state 1004, movement]
type = velset
triggerall = Var(23) = 2
trigger1 = time = 0
y = -24

[state 1004, movement]
type = velset
triggerall = Var(23) >= 3
trigger1 = time = 0
y = -24

[State 1004, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 100,30
persistent = 0
Hitflag = MA
guardflag = H
priority = 7
sparkno = -1
fall.recover = 0
pausetime = 0,0
hitsound = S1,2
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 95

[state 1004, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 1004, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1004, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 1004, gravity]
type = gravity
trigger1 = time > 0

[state 1304, spiking]
type = veladd
trigger1 = time > 14
y = 0.1


[state 1004, go to bounce]
type = changestate
triggerall = var(23) > 0
triggerall = time > 8
trigger1 = pos y >= 0
value = 1003

[state 1004, end]
type = changestate
triggerall = var(23) <= 0
triggerall = time > 8
trigger1 = pos y >= 2
value = 1005
;---------------------------------------------------------------------------
;Vicious butt drops End
[Statedef 1005]
type  = C
movetype = A
physics = C
anim = 643
velset = 0,0
sprpriority = 2

[state x, dust Front]
type = explod
trigger1 = time = 0
anim = 1500
pos = 40,0
scale = const(size.xscale),const(size.yscale)
sprpriority  = 3
ownpal = 1

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state x, dust back]
type = explod
trigger1 = time = 0
anim = 1501
pos = 40,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1005, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1005, height indicator]
type = varset
trigger1 = 1
V = 15
value = 0

[state 1005, invun]
type = nothitby
trigger1 = 1
value = , AP, AT


[state 1005, 1]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = p2life > 0
value = 646
ctrl = 0

[state 1005, 2]
type = changestate
trigger1 = animtime = 0
trigger1 = p2life <= 0
value = 648
ctrl = 0

[state 1005, width]
type = width
trigger1 = 1
value = 0,0

[State 1005, 3]
type = HitDef
trigger1 = !movecontact
attr = C, SA
damage = 100
persistent = 0
Hitflag = FD
guardflag = 
priority = 7
sparkno = -1
fall.recover = 0
hitsound = S1,2
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 95

[state 1005, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661
persistent = 0

[state 1005, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650
persistent = 0

[state 1005, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 1005 thud]
type = PlaySnd
trigger1 = time = 1
value = 0, 0

[state 1005, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[State 1005, shake]
type = EnvShake
trigger1 = Time = 1
time = 25
ampl = 10
freq = 100
phase = 100

;---------------------------------------------------------------------------
;Rode down
[statedef 1006]
type = A
movetype = H
physics = N

[state 1006, anim]
type = changeanim2
trigger1 = time = 0
value = 1006

[State 820, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 661

;--------------------------------------------------------------------------
;Empty Landing, with bounce
[statedef 1007]
type    = A
movetype= I
physics = N
anim = 1007
sprpriority = 2
ctrl = 0

[state 1007, removexplod]
type = removeexplod
trigger1 = time = 0
id = 6400

[state 1007, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 1007, anim]
type = changeanim
trigger1 = time =0
value = 641

[state 1007, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state 1007, width]
type = width
trigger1 = 1
value = 0,0

[state 1007, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1007, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 1007, slow down x]
type = velmul
trigger1 = time = 0
x = 0.5

[State 1007, gravity]
type = gravity
trigger1 = time > 10

[State 1007, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 25
ampl = 10
freq = 100
phase = 100

[State 1007, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0


[state 1007, 2]
type = velset
trigger1 = time = 10
y = -18
x = 0

[state 1007, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 0

[state 1007, no push]
type = playerpush
trigger1 = 1
value = 1




;---------------------------------------------------------------------------
;Vicious Butt Drops - Hard
[Statedef 1010]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 100
velset = 0,0
anim = 41
ctrl = 0
sprpriority = 2

[state 1010, invun]
type = nothitby
trigger1 = 1
value = , AP

[state 1010, elephant sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S1000,random%3
channel = 1


;1 bounce
[state 1300, var]
type = varset
trigger1 = time = 0
v = 23
value = 2

[State 1000, 7]
type = ChangeState
trigger1 = time = 1
value = 1011


[state 1010, combo damage score]
type = varadd
trigger1 = time = 0
v = 18
value = ifelse(enemy,movetype = H,-18,0)



;---------------------------------------------------------------------------
;Going Up H
[statedef 1011]
Type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 42

[state 1011, invun]
type = nothitby
trigger1 = 1
value = , AP

[state 1011, varset]
type = varset
trigger1 = time = 0
v = 15
value = 1
persistent = 0

[state 1011, control]
type = veladd
trigger1 = command = "holdfwd"
trigger1 = ailevel = 0
x = 0.1

[state 1011, control]
type = veladd
trigger1 = command = "holdback"
trigger1 = ailevel = 0
x = -0.1

[state 1011, movement]
type = velset
trigger1 = time = 0
x = ifelse(p2bodydist x > 800, 33.333, floor(p2dist x * 0.0416))
y = -37.5

[state 1011, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 1011, end]
type = changestate
trigger1 = time = 24
value = 1012
;----------------------------------------------------------------------------
;coming down H
[Statedef 1012]
type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
poweradd = 0
anim = 1002
sprpriority = -2



[state 1012, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(10020)
anim = 10020
id = 10020
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
removetime = -1
ignorehitpause = 1
sprpriority = 2



[state 1012, freeze]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1012, invun]
type = nothitby
trigger1 = time < 8
value = , AP

[state 1012, fall]
type = veladd
trigger1 = time > 8
y = 7.2

;[state 1002, gravity]
;type = gravity
;trigger1 = time > 8


[state 1012, no push]
type = playerpush
trigger1 = time >= 0
value = 0



[State 1012, 3]
type = HitDef
trigger1 = time = 0
attr = A, NA
damage = 0,25
guardflag = HA
hitflag = MAFD
priority = 4
id = 1010
nochainid = 430
hitsound = S0,8
pausetime = 0,0
guard.pausetime = 9,12
sparkno = -1
p1sprpriority = -2
guardsound = 6,0
animtype = heavy
down.hittime = 40
ground.type = High
guard.velocity = -60       
guard.hittime = 30
guard.slidetime = 30
airguard.velocity = -32,-1
airguard.hittime = 40
guard.dist = 640

;Ride down mechanic
[state 1002, Ride down]
type = targetbind
triggerall = numtarget(1010)
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = 44, -112

[state 1002, state of ride down]
type = targetstate
triggerall = numtarget(1010)
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1006

[state 1002, end]
type = targetstate
triggerall = numtarget(1010)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1006
value = 661
;-------------------


[state 1012, flatten]
type = targetstate
triggerall = numtarget(1010)
triggerall = target(1010),ishelper = 0
trigger1 = movehit
trigger1 = enemy,statetype != A
value = 661

[state 1012, wedge]
type = targetstate
triggerall = numtarget(1010)
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1012, wedge var]
type = varset
triggerall = numtarget(1010)
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 1012, end miss]
type = changestate
triggerall = movehit = 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1017

[state 1012, end hit]
type = changestate
triggerall = movehit != 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1013
;---------------------------------------------------------------------------
; vicious bounces Land H
[statedef 1013]
type    = C
movetype= A
physics = C
anim = 641
sprpriority = 2

[state 1013, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1
[state 1013, invun]
type = nothitby
trigger1 = 1
value = , AP,AT


[state 1003, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,-5
scale = 4,1
sprpriority = -4
ignorehitpause = 1
ownpal = 1

[state 1003, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1013, no push]
type = playerpush
trigger1 = 1
value = 0


[state 1013, on ground2]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 1013, 3]
type = HitDef
trigger1 = 1
attr = C, SA
damage = ifelse(var(23) = 1, 84,83)
persistent = 0
Hitflag = FD
guardflag = 
priority = 7
sparkno = -1
hitsound = S1,2
fall.recover = 0
pausetime = 0,0
guard.pausetime = 8, 10
guardsound = 6,0
animtype = Heavy

[state 1013, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 1013, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1013, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1


[State 1013, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 35
ampl = 20
freq = 100
phase = 100

[State 1013, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0

[state 1013, var counter]
type = varadd
trigger1 = time = 0
var(23) = -1

[state 1013, repeater]
type = changestate
trigger1 = time = 8
value = 1014
;---------------------------------------------------------------------------
;Bounce repeater H
[Statedef 1014]
type    = A
movetype= A
physics = N
anim = 1002
sprpriority = 2

[state 1014, invun]
type = nothitby
trigger1 = 1
value = , AP,AT


[state 1014, nudge]
type = veladd
trigger1 = command = "holdfwd"
x = 0.2

[state 1004, nudge]
type = veladd
trigger1 = command = "holdback"
x = -0.2

[state 1014, movement]
type = velset
triggerall = Var(23) = 0
trigger1 = time = 0
y = -36

[state 1014, no push]
type = playerpush
trigger1 = time >= 0
value = 0
time = 600

[state 1014, movement]
type = velset
Triggerall = Var(23) = 1
trigger1 = time = 0
y = -24

[state 1014, movement]
type = velset
triggerall = Var(23) = 2
trigger1 = time = 0
y = -24

[state 1014, movement]
type = velset
triggerall = Var(23) >= 3
trigger1 = time = 0
y = -24

[state 1014, veladd]
type = veladd
trigger1 = vel y > 3
y = 6
persistent = 1

[State 1014, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 83,25
persistent = 0
Hitflag = MA
guardflag = HA
priority = 7
sparkno = -1
fall.recover = 0
hitsound = S1,2
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 180

[state 1014, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 1014, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1014, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 1014, gravity]
type = gravity
trigger1 = time > 0

[state 1014, spiking]
type = veladd
trigger1 = time > 14
y = 0.3


[state 1014, go to bounce]
type = changestate
triggerall = var(23) > 0
triggerall = time > 8
trigger1 = pos y >= 0
value = 1013

[state 1004, end]
type = changestate
triggerall = var(23) <= 0
triggerall = time > 8
trigger1 = pos y >= 2
value = 1015
;---------------------------------------------------------------------------
;Vicious butt drops End H
[Statedef 1015]
type  = C
movetype = A
physics = C
anim = 643
velset = 0,0
sprpriority = 2

[state x, dust Front]
type = explod
trigger1 = time = 0
anim = 1500
pos = 40,0
scale = const(size.xscale),const(size.yscale)
sprpriority  = 3
ownpal = 1

[state x, dust back]
type = explod
trigger1 = time = 0
anim = 1501
pos = 40,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1015, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1015, invun]
type = nothitby
trigger1 = 1
value = , AP,AT

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = animtime = 1
value = S641,0


[state 1015, height indicator]
type = varset
trigger1 = 1
V = 15
value = 0

[state 1015, 1]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = p2life > 0
persistent = 1
value = 646
ctrl = 0

[state 1015, 2]
type = changestate
trigger1 = animtime = 0
trigger1 = p2life <= 0
value = 648
ctrl = 0

[state 1015, width]
type = width
trigger1 = 1
value = 0,0

[State 1015, 3]
type = HitDef
trigger1 = !movecontact
attr = C, SA
damage = 83
persistent = 0
Hitflag = FD
guardflag = HA
priority = 7
sparkno = -1
fall.recover = 0
hitsound = S1,2
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 180

[state 1015, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661
persistent = 0

[state 1015, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650
persistent = 0

[state 1015, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 1015 thud]
type = PlaySnd
trigger1 = time = 1
value = 0, 0

[state 1015, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[State 1015, shake]
type = EnvShake
trigger1 = Time = 1
time = 20
ampl = 12

;--------------------------------------------------------------------------
;Empty Landing, with bounce
[statedef 1017]
type    = A
movetype= I
physics = N
anim = 1007
sprpriority = 2
ctrl = 0

[state 1017, removexplod]
type = removeexplod
trigger1 = time = 0
id = 6400

[state 1017, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 1017, anim]
type = changeanim
trigger1 = time =0
value = 641

[state 1017, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state 1017, width]
type = width
trigger1 = 1
value = 0,0

[state 1007, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1017, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 1017, slow down x]
type = velmul
trigger1 = time = 0
x = 0.5

[State 1017, gravity]
type = gravity
trigger1 = time > 10

[State 1017, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 25
ampl = 10
freq = 100
phase = 100

[State 1017, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0


[state 1017, 2]
type = velset
trigger1 = time = 10
y = -21
x = 0

[state 1017, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 0

[state 1017, no push]
type = playerpush
trigger1 = 1
value = 1




;---------------------------------------------------------------------------
;EX vicious butt drops
[Statedef 1020]
type    = A
movetype= A
physics = S
juggle  = 4
poweradd= -500
velset = 0,0
anim = 41
ctrl = 0
sprpriority = 2

[state 1020, invun]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
time = 1

[state 1010, elephant sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S1000,random%3
channel = 1

[state 1020, var]
type = varset
trigger1 = time = 0
v = 23
value = 1

[state 200, combo damage score]
type = varadd
trigger1 = time = 0
v = 18
value = -9

[State 1020, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3


[State 1000, 7]
type = ChangeState
trigger1 = time = 1
value = 1021

;---------------------------------------------------------------------------
;Going Up
[statedef 1021]
Type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 42

[state 1021, invun]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
time = 1

[state 1021, movement]
type = velset
trigger1 = time = 0
x = ifelse(p2bodydist x > 900, 50, Floor(p2dist x * 0.0555))
y = -50

[state 1021, varset]
type = varset
trigger1 = time = 0
v = 15
value = 1
persistent = 0

[state 1002, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 1021, end]
type = changestate
trigger1 = time = 18
value = 1022

[State 1090, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

;--------------------------------------------------------------------------
;coming down EX version
[Statedef 1022]
type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 1002
sprpriority = -2

[state 1022, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(10020)
anim = 10020
id = 10020
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
removetime = -1
ignorehitpause = 1
sprpriority = 2

[state 1020, invun]
type = nothitby
trigger1 = 1
value = ,AP
ignorehitpause = 1
time = 1

[State 1022, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

[state 1022, freeze]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1022, fall]
type = veladd
trigger1 = time > 8
y = 7.2

[state 1022, no push]
type = playerpush
trigger1 = 1
value = 0

[State 1022, 3]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, HA
damage = 0,30
guardflag = HA
hitflag = MAFD
id = 1020
nochainid = 430
hitsound = S1,2
priority = 4
getpower = 0
pausetime = 0,0
p1sprpriority = -2
guard.pausetime = 2,8
guard.hittime = 38
sparkno = -1
guardsound = 6,0
guard.velocity = -60
airguard.velocity = -32,-1
guard.slidetime = 38
animtype = heavy
down.hittime = 40
ground.type = High
guard.dist = 640

;Ride down mechanic
[state 1002, Ride down]
type = targetbind
triggerall = numtarget(1020)
trigger1 = movehit
trigger1 = enemy,statetype = A
trigger1 = p2life > 0
pos = 44, -112

[state 1002, state of ride down]
type = targetstate
triggerall = numtarget(1020)
trigger1 = movehit
trigger1 = enemy,statetype = A
trigger1 = p2life > 0
value = 1006

[state 1002, end]
type = targetstate
triggerall = numtarget(1020)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1006
value = 661
;-------------------

[state 1022, flatten]
type = targetstate
triggerall = numtarget(1020)
trigger1 = movehit
trigger1 = enemy,statetype != A
trigger1 = p2life > 0
value = 661

[state 1022, wedge]
type = targetstate
trigger1 = movehit
triggerall = numtarget(1020)
trigger1 = p2life <= 0
value = 650

[state 1022, wedge var]
type = varset
triggerall = numtarget(1020)
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 1022, end miss]
type = changestate
triggerall = movehit = 0
trigger1 = pos y >= 2
value = 1027


[state 1022, end hit]
type = changestate
triggerall = movehit != 0
trigger1 = pos y >= 2
value = 1023
;---------------------------------------------------------------------------
; vicious bounces Land
[statedef 1023]
type    = C
movetype= A
physics = N
anim = 641
sprpriority = 2

[state 1023, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[State 1023, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

[state 1023, Can't be thrown]
type = NotHitBy
trigger1 = 1
value = ,AP
ignorehitpause = 1


[state 1023, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1023, no push]
type = playerpush
trigger1 = 1
value = 0


[state 1023, on ground2]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 1023, 3]
type = HitDef
trigger1 = 1
attr = C, HA
damage = 100
persistent = 0
getpower = 0
Hitflag = FD
guardflag = 
hitsound = S0,8
priority = 7, hit
sparkno = -1
getpower = 0
fall.recover = 0
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 95

[state 1023, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 1023, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1023, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1


[State 1023, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 12

[State 1023, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0



[state 1023, var counter]
type = varadd
trigger1 = time = 0
var(23) = -1

[state 1023, repeater]
type = changestate
trigger1 = time = 8
value = 1024
;---------------------------------------------------------------------------
;Bounce repeater
[Statedef 1024]
type    = A
movetype= A
physics = N
anim = 1002
sprpriority = 2

[state 1024, invun]
type = nothitby
trigger1 = 1
value = ,AP


[state 1024, nudge]
type = veladd
trigger1 = command = "holdfwd"
x = 0.4

[state 1024, nudge]
type = veladd
trigger1 = command = "holdback"
x = -0.4

[state 1024, movement]
type = velset
triggerall = Var(23) = 0
trigger1 = time = 0
y = -36

[State 1024, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

[state 1024, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[state 1024, movement]
type = velset
Triggerall = Var(23) = 1
trigger1 = time = 0
y = -27

[state 1024, movement]
type = velset
triggerall = Var(23) = 2
trigger1 = time = 0
y = -27

[state 1024, movement]
type = velset
triggerall = Var(23) >= 3
trigger1 = time = 0
y = -27

[state 1014, veladd]
type = veladd
trigger1 = vel y > 3
y = 6
persistent = 1

[State 1024, 3]
type = HitDef
trigger1 = 1
attr = A, HA
damage = 100,30
persistent = 0
hitsound = S0,8
Hitflag = MA
guardflag = H
priority = 7
getpower = 0
sparkno = -1
fall.recover = 0
pausetime = 0,0
guardsound = 6,0
animtype = Heavy

[state 1024, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 1024, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 1024, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 1024, gravity]
type = gravity
trigger1 = time > 0

[state 1024, spiking]
type = veladd
trigger1 = time > 14
y = 0.3


[state 1024, go to bounce]
type = changestate
triggerall = var(23) > 0
triggerall = time > 8
trigger1 = pos y >= 0
value = 1023

[state 1024, end]
type = changestate
triggerall = var(23) <= 0
triggerall = time > 8
trigger1 = pos y >= 0
value = 1025

;--------------------------------------------------------------------------
;EX vicious butt drops End
[Statedef 1025]
type  = C
movetype = A
physics = C
anim = 643
velset = 0,0
sprpriority = 2

[State 1024, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state x, dust Front]
type = explod
trigger1 = time = 0
anim = 1500
pos = 40,0
scale = const(size.xscale),const(size.yscale)
sprpriority  = 3
ownpal = 1

[state x, dust back]
type = explod
trigger1 = time = 0
anim = 1501
pos = 40,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1005, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1005, height indicator]
type = varset
trigger1 = 1
V = 15
value = 0

[state 1005, invun]
type = nothitby
trigger1 = 1
value = , AP, AT


[state 1005, 1]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = p2life > 0
value = 646
ctrl = 0

[state 1005, 2]
type = changestate
trigger1 = animtime = 0
trigger1 = p2life <= 0
value = 648
ctrl = 0

[state 1005, width]
type = width
trigger1 = 1
value = 0,0

[State 1005, 3]
type = HitDef
trigger1 = 1
attr = C, SA
damage = 100
persistent = 0
Hitflag = FD
guardflag = 
priority = 7
sparkno = -1
fall.recover = 0
hitsound = S1,2
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 95

[state 1005, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661
persistent = 0

[state 1005, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650
persistent = 0

[state 1005, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 1005 thud]
type = PlaySnd
trigger1 = time = 1
value = 0, 0

[state 1005, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[State 1005, shake]
type = EnvShake
trigger1 = Time = 1
time = 25
ampl = 10
freq = 100
phase = 100


;---------------------------------------------------------------------------
;Going Up
[statedef 1026]
Type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 42

[state 1026, invun]
type = nothitby
trigger1 = 1
value = ,AP
ignorehitpause = 1


[state 1026, control]
type = veladd
trigger1 = command = "holdfwd"
x = 12

[state 1026, control]
type = veladd
trigger1 = command = "holdback"
x = -12

[state 1026, movement]
type = velset
trigger1 = time = 0
x = 0
y = -54



[state 1026, no push]
type = playerpush
trigger1 = time >= 0
value = 0
time = 600


[state 1026, end]
type = changestate
trigger1 = time = 6
value = 1022

[State 1026, Afterimage]
type = AfterImage
trigger1 = Time = 0
length = 13
PalBright   =  30, 30,  0
PalContrast =  70, 70, 20
PalAdd      = -10,-10,-10
PalMul      = .85,.85,.50
TimeGap  = 1
FrameGap = 2
Trans = Add
time = 2

[State 1026, Afterimage]
type = AfterImageTime
trigger1 = AnimElemTime(8) < 0
time = 2

[State 1026, Blink Yellow]
type = PalFX
trigger1 = Time = 0
time = 20
add = 32,16,0
sinadd = 64,32,5,3

;--------------------------------------------------------------------------
;Empty Landing, with bounce
[statedef 1027]
type    = A
movetype= I
physics = N
anim = 1007
sprpriority = 2
ctrl = 0

[state 1027, removexplod]
type = removeexplod
trigger1 = time = 0
id = 6400

[state 1027, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 10020
ignorehitpause = 1

[state 1027, anim]
type = changeanim
trigger1 = time =0
value = 641

[state 1027, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state 1027, width]
type = width
trigger1 = 1
value = 0,0

[state 1027, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1027, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 1027, slow down x]
type = velmul
trigger1 = time = 0
x = 0.5

[State 1027, gravity]
type = gravity
trigger1 = time > 10

[State 1027, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 25
ampl = 10
freq = 100
phase = 100

[State 1027, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0


[state 1027, 2]
type = velset
trigger1 = time = 10
y = -18
x = 0

[state 1017, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 0

[state 1017, no push]
type = playerpush
trigger1 = 1
value = 1


;===========================================================================
;                          Jumbo Butt Thrust
;===========================================================================
;Light version

[statedef 1050]
type    = A
movetype= A
physics = N
sprpriority = 2
ctrl = 0



[state 1050, not autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

[state 1050, Voice]
type = playsnd
trigger1 = time = 0
value = 1050,random%4
channel = 1

;==============
; Armor
;==============

[state 1050, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1050
time = 1
persistent = 1

[state 1050, animation]
type = changeanim
trigger1 = anim != 1050
value = 1050

[state 1050, armor counter]
type = varset
triggerall = prevstateno != 1050
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 80
V = 20
value = 80
persistent = 0

[State 1050, inhibitor]
type = varset
trigger1 = time = 1
V = 21
Value = 0

[state 1050, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1050, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1



[State 1050, flash red]
type = PalFX
trigger1 = gethitvar(damage) != 0
time = 6
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1050, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1050, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 1050, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = 1
;--------------------------

[state 1050, gravity]
type = gravity
trigger1 = pos y < -1

[state 1050, spiking]
type = velset
trigger1 = animelemtime(1) = 2
trigger1 = pos y <= 0
persistent = 1
X = 14
y = -12

[state 1050, go to bounce]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1051

;------------------------------------------------------------------------------------
[statedef 1051]
type = S
movetype = A
physics = S
sprpriority = 3

[state 1070-1090, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1051, nothitby]
type = nothitby
trigger1 = animelemtime(7) < 0
value = S,AT
ignorehitpause = 1

[state 1051, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA,AA,AP
stateno = 1051
time = 1
persistent = 1



[State 1051, 4]
type = EnvShake
trigger1 = time = 0
time = 10
ampl = 8

[State 1051, 1]
type = EnvShake
trigger1 = movehit = 1
persistent = 0
time = 10
ampl = 8  

;==============
; Armor
;==============

[state 1051, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1051, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value =-gethitvar(damage)
persistent = 1

[State 1051, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1051, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1051, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = anim
elem = var(22)

[state 1051, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = 1
;--------------------------

;[state 1071, width]
;type = width
;trigger1 = animelem = 4
;player = 90, 45

[state 1051, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 1051, stop y]
type = velset
trigger1 = time = 0
y = 0

[state 1051, animation]
type = changeanim
trigger1 = anim != 1051
value = 1051

[state 1051, Armor off]
type = varset
trigger1 = anim = 1051
trigger1 = animelemtime(5) = 0
v = 20
value = 0

[State 1051, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 150,30
persistent = 0
Hitflag = MAF
id = 1050
nochainid = 1050
guardflag = MA
priority = 4, hit
pausetime = 14,14
guard.pausetime = 10,12
sparkno = 3
sparkxy = -15,-396
hitsound   = S0,8
guardsound = 6,0
ground.slidetime = 32
ground.hittime  = 32
ground.velocity = -96,24
air.velocity = -96, 24
animtype = Heavy
guard.velocity = -54       
guard.hittime = ifelse((Prevstateno = [200,440]),18,30)  ;-2
guard.slidetime = ifelse((Prevstateno = [200,440]),18,30)
airguard.velocity = -27,-4
airguard.hittime = ifelse((Prevstateno = [200,440]),14,24)
guard.dist = 720
p2facing = 1
fall = 1
air.fall = 1
down.bounce = 1
fall.xvelocity = -4
fall.yvelocity = -32
fall.recover = 0

[state 1051, velset]
type = velset
trigger1 = animelem = 3 || animelem = 4
x = 18

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[state 1051,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I



[state 1051, end]
type = changestate
trigger1 = Animtime = 0
value = 0
ctrl = 1
ignorehitpause = 1
;--------------------------------------------------------------------------
;Heavy version
[statedef 1060]
type    = A
movetype= A
physics = N
velset = 0,0
sprpriority = 2
ctrl = 0

[state 1060, Voice]
type = playsnd
trigger1 = time = 0
value = 1050,random%4
channel = 1

[state 1060, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1060
time = 1
persistent = 1

[state 1060, animation]
type = changeanim
trigger1 = anim != 1060
value = 1060

[state 1060, not autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

;==============
; Armor
;==============

[state 1060, armor counter]
type = varset
triggerall = prevstateno != 1060
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 160
V = 20
value = 160
persistent = 0

[State 1060, inhibitor]
type = varset
trigger1 = time = 1
V = 21
Value = 0

[state 1060, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1060, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1



[State 1060, flash red]
type = PalFX
trigger1 = gethitvar(damage) != 0
time = 6
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1060, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1060, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 1060, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = 1
;--------------------------

[state 1060, gravity]
type = gravity
trigger1 = pos y < -1

[state 1060, spiking]
type = velset
trigger1 = animelemtime(1) = 2
trigger1 = pos y <= 0
persistent = 1
X = 16
y = -12

[state 1060, go to bounce]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1061

;------------------------------------------------------------------------------------
[statedef 1061]
type = S
movetype = A
physics = S
sprpriority = 3

[state 1050-1070, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1061, nothitby]
type = nothitby
trigger1 = animelemtime(7) < 0
value = S,AT
ignorehitpause = 1

[state 1061, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA,AA,AP
stateno = 1061
time = 1
persistent = 1

[State 1061, 4]
type = EnvShake
trigger1 = time = 0
time = 10
ampl = 8

[State 1061, 1]
type = EnvShake
trigger1 = movehit = 1
persistent = 0
time = 10
ampl = 8  



;==============
; Armor
;==============

[state 1061, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1061, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1

[State 1061, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1061, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1061, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = anim
elem = var(22)

[state 1061, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = 1
;--------------------------

;[state 1071, width]
;type = width
;trigger1 = animelem = 4
;player = 90, 45

[state 1061, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 1061, stop y]
type = velset
trigger1 = time = 0
y = 0

[state 1061, animation]
type = changeanim
trigger1 = anim != 1061
value = 1061

[state 1061, Armor off]
type = varset
trigger1 = anim = 1061
trigger1 = animelemtime(5) = 0
v = 20
value = 0

[State 1061, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 180,38
persistent = 0
Hitflag = MAF
guardflag = MA
id = 1060
nochainid = 1060
priority = 4, hit
pausetime = 14,14
guard.pausetime = 7,12
sparkno = 3
sparkxy = -15,-396
hitsound   = S0,8
guardsound = 6,0
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -96,24
air.velocity = -96, 24
animtype = Heavy
guard.velocity = -64      
guard.hittime = ifelse((Prevstateno = [200,440]),18,30) ;-4
guard.slidetime = ifelse((Prevstateno = [200,440]),18,30)
airguard.velocity = -27,-4
airguard.hittime = ifelse((Prevstateno = [200,440]),12,22)
guard.dist = 720
p2facing = 1
fall = 1
air.fall = 1
down.bounce = 1
fall.xvelocity = -6
fall.yvelocity = -36
fall.recover = 0

[state 1061, velset]
type = velset
trigger1 = animelem = 3 || animelem = 4
x = 20

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 

[state 1061,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 1061, end]
type = changestate
trigger1 = Animtime = 0
value = 0
ctrl = 1
ignorehitpause = 1

;--------------------------------------------------------------------------
;EX version
[statedef 1070]
type    = A
movetype= A
physics = N
velset = 0,0
sprpriority = 2
ctrl = 0

[state 1050, Voice]
type = playsnd
trigger1 = time = 0
value = 1050,random%4
channel = 1

[state 1070, Helper]
type = helper
trigger1 = animelemtime(1) = 2
trigger1 = !numhelper(1070)
stateno = 1072
id = 1070
postype = p1
pos = 0,0

[State 1090, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause


[state 1070, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1070
time = 1
persistent = 1

[state 1070, animation]
type = changeanim
trigger1 = anim != 1070
value = 1070

[state 1070, not autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

;==============
; Armor
;==============

[state 1070, armor counter]
type = varset
triggerall = prevstateno != 1070
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 180
V = 20
value = 180
persistent = 0

[State 1070, inhibitor]
type = varset
trigger1 = time = 1
V = 21
Value = 0

[state 1070, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1070, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1



[State 1070, flash red]
type = PalFX
trigger1 = gethitvar(damage) != 0
time = 6
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1070, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1070, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 1070, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.25)
value = 1
;--------------------------

[state 1070, gravity]
type = gravity
trigger1 = pos y < -1

[state 1070, spiking]
type = velset
trigger1 = animelemtime(1) = 2
trigger1 = pos y <= 0
persistent = 1
X = 18
y = -12

[state 1070, go to bounce]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1071

;------------------------------------------------------------------------------------
[statedef 1071]
type = S
movetype = A
physics = S
sprpriority = 3

[state 1071, wall bounce limiter]
type = varadd
trigger1 = movehit
v = 11
value = -1
ignorehitpause = 1
persistent = 0

[state 1051, nothitby]
type = nothitby
trigger1 = animelemtime(7) < 0
value = S,AT
ignorehitpause = 1

[State 1090, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1050-1070, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1071, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA,AA,AP
stateno = 1071
time = 1
persistent = 1

[State 1071, 4]
type = EnvShake
trigger1 = time = 0
time = 10
ampl = 8

[State 1071, 1]
type = EnvShake
trigger1 = movehit = 1
persistent = 0
time = 10
ampl = 8  



;==============
; Armor
;==============

[state 1071, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1071, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1

[State 1071, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1071, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1071, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = anim
elem = var(22)

[state 1071, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = 1
;--------------------------

;[state 1071, width]
;type = width
;trigger1 = animelem = 4
;player = 90, 45

[state 1071, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 1071, stop y]
type = velset
trigger1 = time = 0
y = 0

[state 1071, animation]
type = changeanim
trigger1 = anim != 1071
value = 1071

[state 1071, Armor off]
type = varset
trigger1 = anim = 1071
trigger1 = animelemtime(5) = 0
v = 20
value = 0

[State 1071, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 150,30
id = 1070
nochainid = 1070
persistent = 0
Hitflag = MAF
guardflag = MA
priority = 4, hit
pausetime = 14,14
sparkno = 3
sparkxy = -15,-396
hitsound   = S0,8
guardsound = 6,0
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -100,ifelse(var(11) > 1,-27, 6)
air.velocity = -100, ifelse(var(11) > 1, -27,6)
animtype = Heavy
guard.velocity = -54       
guard.hittime = ifelse((Prevstateno = [200,240]),25,40) ;+2
guard.slidetime = ifelse((Prevstateno = [200,240]),25,40)
airguard.velocity = -36,-4
airguard.hittime = ifelse((Prevstateno = [200,240]),20,30)
guard.dist = 720
p2facing = 1
fall = 1
air.fall = 1
down.bounce = 1
fall.xvelocity = -1
fall.yvelocity = -26
fall.recover = 0

[state 1071, wall bounce]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 13
trigger1 = var(11) > 0 
trigger1 = numtarget(1070)
ignorehitpause = 1
value = 670



[state 1071, velset]
type = velset
trigger1 = animelem = 3 || animelem = 4
x = 24

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 1071,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 1071, end]
type = changestate
trigger1 = Animtime = 0
value = 0
ctrl = 1
ignorehitpause = 1

;---------------------------------------------------------------------------
;Helper to remove Power
[statedef 1072]
type = U
movetype = I
physics = N
anim = 9999
ctrl = 0


[state 1072, remove power]
type = poweradd
trigger1 = time = 0
value = -500

[state 1072, End]
type = destroyself
trigger1 = time = 24

;---------------------------------------------------------------------------
;hard version

[statedef 1080]
type    = A
movetype= A
physics = N
sprpriority = 2
velset = 0,0
ctrl = 0

[state 1080, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA,AA,AP
stateno = 1080
time = 1
persistent = 1

[state 1080, animation]
type = changeanim
trigger1 = anim != 1070
value = 1070

[state 1080, gravity]
type = gravity
trigger1 = pos y < -1

[state 1080, spiking]
type = velset
trigger1 = animelem = 1
persistent = 1
X = 3
y = -4

;==============
; Armor
;==============

[state 1080, armor counter]
type = varset
triggerall = prevstateno != 1080
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 2
V = 20
value = 2
persistent = 0

[State 1080, inhibitor]
type = varset
trigger1 = time = 1
V = 21
Value = 0

[state 1080, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1080, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1



[State 1080, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1080, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1080, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 1080, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 1080, go to bounce]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
trigger2 = time > 24
value = 1081

;------------------------------------------------------------------------------------
[statedef 1081]
type = S
movetype = A
physics = S

[state 1070-1090, posset]
type = posset
trigger1 = time = 0
y = 0


;=========
; Armor
;=========
[state 1081, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1081, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

[state 1081, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1081
time = 1
persistent = 1

[State 1081, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1081, 4]
type = EnvShake
trigger1 = time = 0
time = 10
ampl = 8

[state 1081, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 1081, stop y]
type = velset
trigger1 = time = 0
y = 0

[state 1081, slide]
type = velmul
trigger1 = time = 0
x = 0.5

;[state 1081, width]
;type = width
;trigger1 = animelem = 4
;player = 45, 45

[state 1081, animation]
type = changeanim
trigger1 = anim != 1081
value = 1081

[State 1081, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 240, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

[state 1071, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = 1

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.75)
value = anim
elem = var(22)
;--------------------------

[State 1081, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage = 100,10
persistent = 0
Hitflag = MA
guardflag = MA
priority = 4, hit
pausetime = 14,14
sparkno = 3
sparkxy = -15,-90
hitsound   = S0,8
guardsound = 6,0
ground.slidetime = 30
ground.hittime  = 30
ground.velocity = -12
air.velocity = -12, -4
animtype = Heavy
guard.velocity = -14       
guard.hittime = 24; -4
guard.slidetime = 24
airguard.velocity = -14,-2
airguard.hittime = 22
envshake.time = 10
envshake.ampl = -8
envshake.freq = 80
guard.dist = 180

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause =1 


[state 1071, velset]
type = velset
trigger1 = animelem = 3 || animelem = 4
x = 4

[state 1071, end]
type = changestate
trigger1 = Animtime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------------------------------------
;EX version Butt Bump
[statedef 1090]
type    = A
movetype= A
physics = N
sprpriority = 2
ctrl = 0

[state 1090, animation]
type = changeanim
trigger1 = anim != 1070
value = 1070

;==============
; Armor
;==============

[state 1080, armor counter]
type = varset
triggerall = prevstateno != 1090
trigger1 = time = 0
trigger1 = var(21) = 1
trigger2 = var(20) > 2
V = 20
value = 2
persistent = 0

[State 1080, inhibitor]
type = varset
trigger1 = time = 1
V = 21
Value = 0

[state 1090, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 0
ignorehitpause =1


[state 1090, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1
ignorehitpause = 1

[state 1090, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = var(20) > 0
attr = SCA, AA, AP
stateno = 1090
persistent = 1
time = 1
ignorehitpause

[State 1090, flash red]
type = PalFX
trigger1 = gethitvar(damage) != 0
time = 8
add = 175,0,0
IgnoreHitPause = 1

;determine what frame
[state 1090, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

[state 1090, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = 1

;delay effect
[state 1090, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)
;--------------------------

[State 1090, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause


[state 1090, var]
type = varset
trigger1 = time = 0
v = 3
value = 2

[state 1090, meter]
type = poweradd
trigger1 = time = 0
trigger1 = var(21) = 1
value = -500
persistent = 0


 
[state 1090, gravity]
type = gravity
trigger1 = pos y < -1

[state 1090, spiking]
type = velset
trigger1 = animelem = 1
y = -4
x = 3

[state 1090, go to bounce]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
trigger2 = time > 12
value = 1093
ignorehitpause =1

;------------------------------------------------------------------------------------

;----------------------------------------------------------------------------------------------

;final hit
[statedef 1093]
type = S
movetype = A
physics = S

[state 1070-1090, posset]
type = posset
trigger1 = time = 0
y = 0


[State 1093, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[State 1093, 4]
type = EnvShake
trigger1 = time = 0
time = 10
ampl = 8


[state 1093, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 1093, stop y]
type = velset
trigger1 = time = 0
y = 0

[state 1093, slide]
type = velmul
trigger1 = time = 0
x = 0.5

;[state 1093, width]
;type = width
;trigger1 = animelem = 4
;player = 90, 45

[state 1093, animation]
type = changeanim
trigger1 = anim != 1092
value = 1092


[state 1093, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1
ignorehitpause

[state 1080, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 0
ignorehitpause = 1

;determine what frame
[state 1093, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

[state 1093, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.2)
value = 1

;delay effect
[state 1093, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.2)
value = anim
elem = var(22)

[state 1080, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

[state 1081, Unstoppable]
type = hitoverride
triggerall = alive
trigger1 = var(20) > 0
trigger1 = animelemtime(6) < 0
attr = SCA, AA, AP
stateno = 1093
time = 1
persistent = 1

[State 1081, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1081, 3]
type = HitDef
trigger1 = time = 0
attr = A, HA
damage = 80,8
persistent = 0
Hitflag = MA
guardflag = MA
priority = 7
getpower = 0
pausetime = 14,14
sparkno = 3
sparkxy = -15,-90
hitsound   = S0,8
guardsound = 6,0
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = -12,-6
air.velocity = -12, -6
animtype = Back
fall = ifelse(var(11)>0,0,1)
fall.recover = 0
guard.velocity = -14       
guard.hittime = 10 ;0 Neutral
guard.slidetime = 10
airguard.velocity = -16,-3
airguard.hittime = 24
guard.dist = 180

[state 1093, wall bounce]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 13
trigger1 = var(11) > 0 
ignorehitpause = 1
value = 670

[state 1093, wall bounce limiter]
type = varadd
trigger1 = movehit
v = 11
value = -1
ignorehitpause = 1
persistent = 0

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 


[state 1071, velset]
type = velset
trigger1 = animelem = 3 || animelem = 4
x = 3

[state 1071, end]
type = changestate
trigger1 = Animtime = 0
value = 0
ctrl = 1


;===========================================================================
;                          Jumbo Spinning Seated Senton 
;===========================================================================
[Statedef 1100]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
poweradd = 70
anim = 1100
sprpriority = 4

[State 1100, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, ST          ;Attributes: Standing, Normal Throw
hitflag = M-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 1101       ;On success, KFM changes to state 810
p2stateno = 1130       ;If hit, p2 changes to state 820 in KFM's cns
guard.dist = 0        ;This prevents p2 from going into a guard state if close
;fall = 1              ;Force p2 into falling down

[State 1100, 1]
type = HitDef
Triggerall = enemynear,anim = 5300
trigger1 = Time = 0
attr = S, ST          
hitflag = M          
priority = 1, Miss   
sparkno = -1         
p1facing = 1
p2facing = 1          
p1stateno = 1101      
p2stateno = 1130       
guard.dist = 0       
;fall = 1 

[state 1100, statetypeset]
type = statetypeset
trigger1 = time > 7
movetype = I



[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 1101]
type    = S
movetype= A
physics = N
anim = 1101
poweradd = 0
sprpriority = -1

[state 1101, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1100)
anim = 1106
id = 1100
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = 2
removetime = -1


[State 1101, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = S1100, random%3
Channel = 1

[state 1101, UP]
type = velset
trigger1 = animelemtime(4) = 0
y = -30

[state 1101, side]
type = velset
trigger1 = animelemtime(4) = 0
trigger1 = backedgebodydist > 160
trigger1 = frontedgedist > 520
x = 0.75

[state 1101, move away from wall]
type = veladd
trigger1 = backedgebodydist <= 160
trigger1 = animelemtime(4) = 0
x = 12

[state 1101, move away from wall]
type = veladd
trigger1 = frontedgebodydist <= 520
trigger1 = time = 12
x = -12

[state 1101, gravity]
type = gravity
trigger1 = animelemtime(4) > 0

[state 1102, elephant sfx]
type = playsnd
trigger1 = vel y > 1
trigger1 = time > 5
persistent = 0
value = S1,0

[State 1101, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 490, 0

[State 1101, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 410, 0

[State 1101, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 390, 0

[State 1101, Bind 4] ; Head hold
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = 388,-324

[State 1101, Bind 5] ;Head hold
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = 154, -178

[State 1101, Bind 6] ;Rotation Starts
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = 122, -116

[State 1101, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = 122, -116

[State 1101, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = 122, -116


[State 1101, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = 122, -116


[State 1101, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0 
pos = 122, -116

[State 1101, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 122, -116

[State 1101, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116

[State 1101, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116






[State 1101, Hurt end]
type = TargetLifeAdd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = time > 12
persistent = 0
value = -200

[state 1101, powergive]
type = targetpoweradd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = time > 12
persistent = 0
value = 200

[state 1101, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 1101, State End]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = time > 12
value = 1102



;---------------------------------------------------------------------------
;Landing!
[Statedef 1102]
type    = S
movetype= I
physics = N
anim = 1102
poweradd = 334
sprpriority = 2

[state 1101, removeexplod]
type = removeexplod
trigger1 = 1
id = 1100

[state 1102, op state]
type = targetstate
trigger1 = time = 7
value = 1139


[State 1102, 12 quake]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 45
ampl = -18

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1102, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,0
scale = 5,3
ignorehitpause = 1
ownpal = 1

[state 1102, 12 sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S0,0

[State 1102, pause]
type = Pause
trigger1 = Time = 7
time = 30
endcmdbuftime = 20 ;Buffer commands input during the pause
pausebg = 0  



[state 1102, STOP]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1102, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1102, animation]
type = changestate
trigger1 = animtime = 0
ctrl = 0
value = 1103
;---------------------------------------------------------------------------
;jump back state
[Statedef 1103]
type    = S
movetype= I
physics = A
anim = 1103
poweradd = 0
sprpriority = 3

[state 1103, jump]
type = velset
trigger1 = time = 0
x = -22
y = -30


[state 1103, nothitby]
type = nothitby
trigger1 = 1
value = SCA

;-------------------------------------------------------------------------------------------

;Seated Senton Hard
[Statedef 1110]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 1110
sprpriority = 4

[State 1110, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, ST          
hitflag = M-          
priority = 1, Miss   
sparkno = -1                     
p1facing = 1
p2facing = 1         
p1stateno = 1111       
p2stateno = 1132      
guard.dist = 0        
;fall = 1              ;Force p2 into falling down

[State 1110, 1]
type = HitDef
triggerall = enemynear,anim = 5300
Trigger1 = Time = 0
attr = S, ST          
hitflag = M         
priority = 1, Miss   
sparkno = -1                     
p1facing = 1
p2facing = 1         
p1stateno = 1111       
p2stateno = 1132      
guard.dist = 0 

[state 1110, statetypeset]
type = statetypeset
trigger1 = time > 7
movetype = I

[State 1110, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Hard SPD
[Statedef 1111]
type    = S
movetype= A
physics = N
anim = 1111
poweradd = 0
sprpriority = -4

[State 1101, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = S1100, random%3
Channel = 1

[state 1111, UP]
type = velset
trigger1 = animelemtime(4) = 0
y = -46


[state 1111, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1110)
anim = 1116
id = 1110
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = 2
removetime = -1

[state 1101, side]
type = velset
trigger1 = animelemtime(4) = 0
trigger1 = backedgebodydist > 160
trigger1 = frontedgedist > 520
x = 0.75

[state 1101, move away from wall]
type = veladd
trigger1 = backedgebodydist <= 160
trigger1 = animelemtime(4) = 0
x = 12

[state 1101, move away from wall]
type = veladd
trigger1 = frontedgebodydist <= 520
trigger1 = time = 12
x = -12

[State 1111, Grab Sound]
type = PlaySnd
trigger1 = time = 20 || time = 40 
value = s0, 4
volumescale = 50

[state 1111, elephant sfx]
type = playsnd
trigger1 = vel y > 1
persistent = 0
value = S1,0



[state 1111, gravity]
type = gravity
trigger1 = animelemtime(4) > 0


[State 1111, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 490, 0

[State 1111, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 410, 0

[State 1111, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 390, 0

[State 1111, Bind 4] ; Head hold
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = 388,-324

[State 1111, Bind 5] ;Head hold
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = 154, -178

[State 1111, Bind 6] ;Rotation Starts
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = 122, -116

[State 1111, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = 122, -116

[State 1111, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = 122, -116


[State 1111, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = 122, -116


[State 1111, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0 
pos = 122, -116

[State 1111, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 122, -116

[State 1111, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116

[State 1111, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116

[State 1111, Hurt end]
type = TargetLifeAdd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = animelemtime(4) > 0
persistent = 0
value = -300

[state 1111, powergive]
type = targetpoweradd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = animelemtime(4) > 0
persistent = 0
value = 375

[state 1111, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 1111, State End]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = animelemtime(4) > 0
value = 1112


;---------------------------------------------------------------------------
;Landing!
[Statedef 1112]
type    = S
movetype= I
physics = N
anim = 1102
poweradd = 500
sprpriority = 2

[state 1112, removeexplod]
type = removeexplod
trigger1 = 1
id = 1110

[state 1112, op state]
type = targetstate
trigger1 = time = 7
value = 1139

[State 1112, 12 quake]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 45
ampl = -18

ignorehitpause = 1
[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1112, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,0
scale = 6,3.5
ignorehitpause
ownpal = 1

[state 1112, 12 sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S0,0

[State 1112, pause]
type = Pause
trigger1 = Time = 7
time = 45
endcmdbuftime = 20 
pausebg = 0  

[state 1112, STOP]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1112, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1112, animation]
type = changestate
trigger1 = animtime = 0
ctrl = 0
value = 1113

;------------------------------------------------------------------------
;jump back
[Statedef 1113]
type    = S
movetype= I
physics = A
anim = 1103
poweradd = 0
sprpriority = 3

[state 1113, jump]
type = velset
trigger1 = time = 0
x = -10
y = -30

[state 1113, nothitby]
type = nothitby
trigger1 = 1
value = SCA

;---------------------------------------------------------------------------
;EX Spinning Seated Senton
[Statedef 1120]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
poweradd = -500
anim = 1120
sprpriority = 4

[State 1120, 1]
type = HitDef
Trigger1 = animelem = 2
trigger1 = p2stateno != [150,155]
attr = S, HT          
hitflag = M         
priority = 1, Miss    
sparkno = -1                            
p1facing = 1
p2facing = 1          
p1stateno = 1121       
p2stateno = 1134      
guard.dist = 0        


[State 1090, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

[state 1100, Can't be thrown]
type = NotHitBy
trigger1 = animelemtime(3) < 0
value = SCA
ignorehitpause = 1

[state 1120, statetypeset]
type = statetypeset
trigger1 = time > 7
movetype = I

[State 1110, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;EX SSS
[Statedef 1121]
type    = S
movetype= A
physics = N
anim = 1121
velset = 0,0
sprpriority = -4

[state 1121, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1120)
anim = 1126
id = 1120
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = 2
removetime = -1

[State 1121, Blink Yellow]
type = PalFX
trigger1 = time > 0
time = 1
add = 32,16,0
sinadd = 64,32,5,3

[State 1101, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = S1100, random%3
Channel = 1

[State 1121, Grab Sound]
type = PlaySnd
trigger1 = time = 10 || time = 20 ||time = 30 || time = 40
value = s0, 4
volumescale = 50

[state 1121, elephant sfx]
type = playsnd
trigger1 = vel y > 1
persistent = 0
value = S1,0

[state 1111, UP]
type = velset
trigger1 = animelemtime(4) = 0
y = -62

[state 1101, side]
type = velset
trigger1 = animelemtime(4) = 0
trigger1 = backedgebodydist > 160
trigger1 = frontedgedist > 520
x = 0.75

[state 1101, move away from wall]
type = veladd
trigger1 = backedgebodydist <= 160
trigger1 = animelemtime(4) = 0
x = 12

[state 1101, move away from wall]
type = veladd
trigger1 = frontedgebodydist <= 520
trigger1 = time = 12
x = -12

[state 1121, gravity]
type = gravity
trigger1 = animelemtime(4) > 0



[State 1101, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 490, 0

[State 1101, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 410, 0

[State 1101, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 390, 0

[State 1101, Bind 4] ; Head hold
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = 388,-324

[State 1101, Bind 5] ;Head hold
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = 154, -178

[State 1101, Bind 6] ;Rotation Starts
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = 122, -116

[State 1101, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = 122, -116

[State 1101, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = 122, -116


[State 1101, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = 122, -116


[State 1101, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0 
pos = 122, -116

[State 1101, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 122, -116

[State 1101, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116

[State 1101, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116

[State 1121, Hurt end]
type = TargetLifeAdd
trigger1 = pos y >= 0
trigger1 = animelemtime(4) > 0
persistent = 0
value = -floor(fvar(10)*250)

[state 1121, Power give]
type = Targetpoweradd
trigger1 = pos y >= 0
trigger1 = animelemtime(4) > 0
value = 200
persistent = 0

[state 1121, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 1121, State End]
type = ChangeState
trigger1 = pos y >= 0
trigger1 = animelemtime(4) > 0
value = 1122


;---------------------------------------------------------------------------
;Landing!
[Statedef 1122]
type    = S
movetype= I
physics = N
anim = 1102
poweradd = 0
sprpriority = 2

[state 1122, removeexplod]
type = Removeexplod
trigger1 = 1
id = 1120

[state 1122, op state]
type = targetstate
trigger1 = time = 7
value = 1139

[State 1122, 12 quake]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 75
ampl = -24
ignorehitpause = 1

[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 1122, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,0
scale = 6,4
ignorehitpause
ownpal = 1

[state 1122, 12 sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S0,0

[state 1122, 12 sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S0,0

[State 1122, pause]
type = Pause
trigger1 = Time = 7
time = 30
endcmdbuftime = 30 
pausebg = 0  

[state 1122, STOP]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1122, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1122, animation]
type = changestate
trigger1 = animtime = 0
ctrl = 0
value = 1123

;------------------------------------------------------------------------
;Jumpback
[Statedef 1123]
type    = S
movetype= I
physics = A
anim = 1103
sprpriority = 4

[state 1123, jump]
type = velset
trigger1 = time = 0
x = -17
y = -36

[state 1123, nothitby]
type = nothitby
trigger1 = 1
value = SCA


;---------------------------------------------------------------------------
;SPD Victim Light
[Statedef 1130]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 1105, anim]
type = changeanim2
trigger1 = time = 0
value = 1130

[state 1105, angle draw]
type = angledraw
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0 
trigger2 = animelemtime(9) >= 0 && animelemtime(10) < 0 
trigger3 = animelemtime(11) >= 0 && animelemtime(12) < 0 
trigger4 = animelemtime(13) >= 0 
scale = 0.5, 1


[state 1105, angle draw]
type = angledraw
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0 
trigger2 = animelemtime(10) >= 0 && animelemtime(11) < 0 
scale = 0.1, 1



;[State 1105, 1]
;type = changestate
;trigger1 = p2stateno = 1102 
;value = 1106


[State 1105, 2]
type = SelfState
trigger1 = time > 240
value = 5050

;---------------------------------------------------------------------------
;SPD Victim Hard
[Statedef 1132]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 1132, anim]
type = changeanim2
trigger1 = time = 0
value = 1132

[state 1132, angle draw]
type = angledraw
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0 
trigger2 = animelemtime(9) >= 0 && animelemtime(10) < 0 
trigger3 = animelemtime(11) >= 0 && animelemtime(12) < 0 
trigger4 = animelemtime(13) >= 0 
scale = 0.5, 1


[state 1105, angle draw]
type = angledraw
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0 
trigger2 = animelemtime(10) >= 0 && animelemtime(11) < 0 
scale = 0.1, 1



;[State 1105, 1]
;type = changestate
;trigger1 = p2stateno = 1102 
;value = 1106


[State 1105, 2]
type = SelfState
trigger1 = time > 240
value = 5050

;---------------------------------------------------------------------------
;SPD Victim EX
[Statedef 1134]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 1134, anim]
type = changeanim2
trigger1 = time = 0
value = 1134

[state 1134, angle draw]
type = angledraw
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0 
trigger2 = animelemtime(9) >= 0 && animelemtime(10) < 0 
trigger3 = animelemtime(11) >= 0 && animelemtime(12) < 0 
trigger4 = animelemtime(13) >= 0 
scale = 0.5, 1


[state 1134, angle draw]
type = angledraw
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0 
trigger2 = animelemtime(10) >= 0 && animelemtime(11) < 0 
scale = 0.1, 1



;[State 1105, 1]
;type = changestate
;trigger1 = p2stateno = 1102 
;value = 1106


[State 1134, 2]
type = SelfState
trigger1 = time > 240
value = 5050

;---------------------------------------------------------------------------


;Splat
[statedef 1139]
type    = C
movetype= H
physics = C
velset = 0,0
sprpriority = 0

[state 1106, anim]
type = changeanim
trigger1 = time = 0
value = 5100

[state 1106, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1106, end]
type = changestate
trigger1 = time = 6
trigger1 = life > 0
value = 661

[state 1106, end ded]
type = changestate
trigger1 = time = 6
trigger1 = life <= 0
value = 650

;--------------------------------------------------------------------------

;==========================================================================
;-----------------------------Trunk Throwdown------------------------------
;==========================================================================
;Anti Air Trunk Light
[statedef 1200]
type = S
movetype = A
physics = S
poweradd = 60
anim = 1200
sprpriority = 2
ctrl = 0

[State 1200, 1]
type = HitDef
trigger1 = !movecontact
trigger1 = var(9) > 0
attr = S, ST          
hitflag = AF
guardflag = A       
priority = 1, Miss    
sparkno = -1             
p1facing = 1
p2facing = 1  
guard.velocity = -12
guard.hittime = 8
airguard.hittime = 12
airguard.velocity = -8,-4     
p1stateno = 1201      
p2stateno = 1205 
guard.dist = 640      
    

[State 1200, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 1200, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1


[state 1200, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 270,-4
scale = 2, 2
ontop = 1
ownpal = 1

[state 1200, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 462,-4
scale = 2, 2
ontop = 1
ownpal = 1

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 1200, playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
value = S1200,0

[state 1100, statetypeset]
type = statetypeset
trigger1 = animelemtime(7) > 0
movetype = I
             
[state 1200, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Throw portion
[statedef 1201]
type    = S
movetype= A
physics = N
anim = 1201
sprpriority = 3

[state 1201, width]
type = width
trigger1 = 1
edge = 110,110

[state 1201, grab sound]
type = playsnd
trigger1 = time = 0
value = S1200,random%3+1

[state 1201-1221, varad]
type = varadd
trigger1= time = 0
var(9) = -1
ignorehitpause
persistent = 0

[State 1201, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

;Explod layered animation====================
[state 1201, buttcheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1200) 
id = 1200
anim = 1202
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
sprpriority = 4

[state 1201, sprpriority]
type = sprpriority
trigger1 = animelem = 4
value = 1


; Bindings  =================================
[State 1201, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 642,-638

[State 1201, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 540,-654

[State 1201, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 112,-686

[State 1201, Bind 4] 
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = -210,-584

[State 1201, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = -74,-408

[State 1201, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = -56,-408

[State 1201, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = -51,-408


[State 1201, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -56,-408

[State 1201, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = -62,-408

[State 1201, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0
pos = -16,-400

[State 1201, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 46,-342


[State 1201, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = -200,-626


[State 1201, Bind 13]
type = TargetBind
trigger1 = AnimElemtime(13) >= 0 && Animelemtime(14) < 0
pos = -122,-780


[State 1201, Bind 14]
type = TargetBind
trigger1 = AnimElemtime(14) >= 0 && Animelemtime(15) < 0 
pos = 196,-922

[State 1201, Bind 15]
type = TargetBind
trigger1 = AnimElemtime(15) >= 0 && Animelemtime(16) < 0 
pos = 568,-782

[State 1201, Bind 16]
type = TargetBind
trigger1 = AnimElemtime(16) >= 0 && Animelemtime(17) < 0 
pos = 832,-326

[State 1201, Bind 17]
type = TargetBind
trigger1 = AnimElemtime(17) >= 0 && Animelemtime(17) < 23 
pos = 776,-56


;FX  =================================================
[State 1201, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 1220, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 1220, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 170,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1220, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 358,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 5
persistent = 0
value = S1200,0


[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 12
persistent = 0
value = S0,3

[State 1201, 12 quake]
type = EnvShake
trigger1 = animelem = 17
persistent = 0
time = 24
ampl = -24
ignorehitpause = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1500
pos = 150,5
scale = 0.75,0.75
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1501
pos = 150,5
scale = 0.75,0.75
sprpriority = -3
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = F61
pos = 714,0
scale = 2,1
ignorehitpause
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 17
persistent = 0
value = S0,0

;Physics ========================================
[state 1201, Leap back]
type = velset
trigger1 = animelemtime(12) = 0
x = -6
y = -12

[state 1201, gravity]
type = veladd;gravity
trigger1 = pos y < -1
trigger1 = animelemtime(12) > 0
y = 1.25
persistent = 1

[state 1201, landing]
type = velset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
x = 0
y = 0

[state 1201, Landing]
type = posset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
y = 0



;Attack Data ============================================
[State 1201, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 17
persistent = 0
value = floor(-160*fvar(10))

[state 1201, hit add]
type = hitadd
trigger1 = pos y >= 0
trigger1 = animelem = 17
value = 1

[state 1201, hit add]
type = hitadd
trigger1 = animelem = 5
value = 1

[State 1201, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 5
persistent = 0
value = floor(-20*fvar(10))
kill = 0

[state 1201, movehit energy]
type = poweradd
trigger1 = animelem = 17
value = 200
persistent = 0

[state 1201, movehit power give]
type = targetpoweradd
trigger1 = animelem = 17
value = floor(enemynear,powermax %12)
persistent = 0

[State 1201, State End]
type = ChangeState
trigger1 = animtime = 0
value = 1202


;--------------------------------------------------------------------------
;Jumpback
[Statedef 1202]
type    = S
movetype= I
physics = N
anim = 1103
sprpriority = 4
ctrl = 0

[state 1202, jump]
type = velset
trigger1 = time = 0
x = -6
y = -15

[state 1202, gravity]
type = gravity
trigger1 = 1

[state 1202, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[state 1202, nothitby]
type = nothitby
trigger1 = 1
value = SCA

;---------------------------------------------------------------------------
;Trunk Thrown
[Statedef 1205]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 3

[state 1205, hitby]
type = hitby
trigger1 = 1
value = SCA

[state 1205, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1,0

[state 1205, anim]
type = changeanim2
trigger1 = time = 0
value = 1205

[State 1205, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 1206

;---------------------------------------------------------------------------
;Trunk Thrown Bounce
[Statedef 1206]
type    = A
movetype= H
physics = A
velset = -4,-18



[state 1206, hitby]
type = nothitby
trigger1 = 1
value = SCA



[state 1205, anim]
type = changeanim 
trigger1 = time = 0
value = 5061


[state 1205, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 5100

;[State 1205, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050

;---------------------------------------------------------------------------
;Anti Air Trunk Heavy
[statedef 1210]
type = S
movetype = A
physics = S
poweradd = 60
anim = 1210
sprpriority = 2
ctrl = 0

[state 1210, nothitby]
type = nothitby
trigger1 = animelemtime(7) < 0
value = A

[State 1210, 1]
type = HitDef
trigger1 = !movecontact
trigger1 = var(9) > 0
trigger1 = p2stateno != [150,155]
persistent = 0
attr = S, ST          
hitflag = A-          
priority = 1, Miss    
sparkno = -1             
p1facing = 1
p2facing = 1
guard.velocity = -5
airguard.velocity = -5, -5             
p1stateno = 1211      
p2stateno = 1215       
guard.dist = 0        

[State 1210, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 1210, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 1210, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 270,-4
scale = 2, 2
ontop = 1
ownpal = 1

[state 1200, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 462,-4
scale = 2, 2
ontop = 1
ownpal = 1

[state x, combo dampener]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 1210, playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
value = S1200,0

[state 1210, statetypeset]
type = statetypeset
trigger1 = animelemtime(7) > 0
movetype = I
             
[state 1210, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Throw portion
[statedef 1211]
type    = S
movetype= A
physics = S
anim = 1211
sprpriority = 3

[state 1211, width]
type = width
trigger1 = 1
edge = 110,110

[state 1201, grab sound]
type = playsnd
trigger1 = time = 0
value = S1200,random%3+1

[state 1201-1221, varad]
type = varadd
trigger1= time = 0
var(9) = -1
ignorehitpause
persistent = 0

[State 1211, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

;Explod layered animation====================
[state 1201, buttcheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1210) 
id = 1210
anim = 1212
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
sprpriority = 4

[state 1201, sprpriority]
type = sprpriority
trigger1 = animelem = 4
value = 1


; Bindings  =================================
[State 1201, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 642,-638

[State 1201, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 540,-654

[State 1201, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 112,-686

[State 1201, Bind 4] 
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = -210,-584

[State 1201, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = -74,-408

[State 1201, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = -56,-408

[State 1201, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = -51,-408


[State 1201, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -56,-408

[State 1201, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = -62,-408

[State 1201, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0
pos = -16,-400

[State 1201, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 46,-342


[State 1201, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = -200,-626


[State 1201, Bind 13]
type = TargetBind
trigger1 = AnimElemtime(13) >= 0 && Animelemtime(14) < 0
pos = -122,-780


[State 1201, Bind 14]
type = TargetBind
trigger1 = AnimElemtime(14) >= 0 && Animelemtime(15) < 0 
pos = 196,-922

[State 1201, Bind 15]
type = TargetBind
trigger1 = AnimElemtime(15) >= 0 && Animelemtime(16) < 0 
pos = 568,-782

[State 1201, Bind 16]
type = TargetBind
trigger1 = AnimElemtime(16) >= 0 && Animelemtime(17) < 0 
pos = 832,-326

[State 1201, Bind 17]
type = TargetBind
trigger1 = AnimElemtime(17) >= 0 && Animelemtime(17) < 23
pos = 776,-56




;FX  =================================================
[State 1201, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 1220, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 1220, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 170,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1220, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 358,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 5
persistent = 0
value = S1200,0


[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 12
persistent = 0
value = S0,3

[State 1201, 12 quake]
type = EnvShake
trigger1 = animelem = 17
persistent = 0
time = 24
ampl = -24
ignorehitpause = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1500
pos = 150,5
scale = 0.75,0.75
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1501
pos = 150,5
scale = 0.75,0.75
sprpriority = -3
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = F61
pos = 714,0
scale = 2,1
ignorehitpause
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 17
persistent = 0
value = S0,0

;Physics ========================================
[state 1201, Leap back]
type = velset
trigger1 = animelemtime(12) = 0
x = -24
y = -15

[state 1201, gravity]
type = veladd;gravity
trigger1 = pos y < -1
trigger1 = animelemtime(12) > 0
y = 1.25
persistent = 1

[state 1201, landing]
type = velset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
x = 0
y = 0

[state 1201, Landing]
type = posset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
y = 0

;Attack Data ============================================
[State 1211, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 17
persistent = 0
value = floor(-200*fvar(10))

[state 1211, hit add]
type = hitadd
trigger1 = pos y >= 0
trigger1 = animelem = 17
value = 1

[state 1201, hit add]
type = hitadd
trigger1 = animelem = 5
value = 1

[State 1201, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 5
persistent = 0
value = floor(-20*fvar(10))
kill = 0

[state 1211, movehit energy]
type = poweradd
trigger1 = animelem = 17
value = 250
persistent = 0

[state 1211, targetpoweradd]
type = targetpoweradd
trigger1 = animelem = 17
value = floor(enemynear,powermax % 10)
persistent = 0 

[State 1211, State End]
type = ChangeState
trigger1 = animtime = 0
value = 1212




;--------------------------------------------------------------------------
; Jump back
[Statedef 1212]
type    = S
movetype= I
physics = N
anim = 1103
sprpriority = 4
ctrl = 0

[state 1212, jump]
type = velset
trigger1 = time = 0
x = -2
y = -18

[state 1212, gravity]
type = gravity
trigger1 = 1

[state 1212, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[state 1212, nothitby]
type = nothitby
trigger1 = 1
value = SCA
;---------------------------------------------------------------------------
;Trunk Thrown
[Statedef 1215]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 3

[state 1215, hitby]
type = hitby
trigger1 = 1
value = SCA

[state 1215, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1,0

[state 1215, anim]
type = changeanim2
trigger1 = time = 0
value = 1205

[State 1205, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 1216

;---------------------------------------------------------------------------
;Trunk Thrown Bounce
[Statedef 1216]
type    = A
movetype= H
physics = A
velset = -0.5,-18



[state 1206, hitby]
type = nothitby
trigger1 = 1
value = SCA



[state 1205, anim]
type = changeanim 
trigger1 = time = 0
value = 5061


[state 1205, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 5100

;[State 1205, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050

;---------------------------------------------------------------------------

;--------------------------------------------------------------------------
;Anti Air Trunk EX
[statedef 1220]
type = S
movetype = A
physics = S
poweradd = -500
anim = 1220
sprpriority = 2
ctrl = 0

[State 1220, 1]
type = HitDef
Trigger1 = animelem = 6
trigger1 = !movecontact
trigger1 = var(9) > 0
attr = S, ST          
hitflag = AF        
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 2     
p1facing = 1
p2facing = 1          
p1stateno = 1221      
p2stateno = ifelse(var(12)>1,1225,1227)  
guard.velocity = -5
airguard.velocity = -5, -5        
guard.dist = 0        

[state 1220, anti air]
type = nothitby
trigger1 = animelemtime(7) < 0
value = SCA
time = 1

[State 1220, 4]
type = EnvShake
trigger1 = animelem = 4
time = 10
ampl = 8

[state 1220, 4]
type = playsnd
trigger1 = animelem = 4
value = S0,1

[state 1200, playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
value = S1200,0




[state 1220, front foot front dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = 140,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1220, front foot back dust]
type = explod
trigger1 = animelem = 4
anim = F120
pos = 100,0
scale = 2, 2
ontop = 1
ownpal = 1

[State 1220, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1100, statetypeset]
type = statetypeset
trigger1 = time > 31
movetype = I

            
[state 1220, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Throw portion
[statedef 1221]
type    = S
movetype= A
physics = S
anim = 1201
sprpriority = 3

[state 1201, grab sound]
type = playsnd
trigger1 = time = 0
value = S1200,random%3+1

[state 1221, ground bounce limiter]
type = varadd
trigger1 = time = 1
var(12) = -1

[state 1201-1221, varad]
type = varadd
trigger1= time = 0
var(9) = -1
ignorehitpause
persistent = 0

[State 1221, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1221, width]
type = width
trigger1 = 1
edge = 110,110


[State 1221, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

;Explod layered animation====================
[state 1221, buttcheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1200) 
id = 1200
anim = 1202
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
sprpriority = 4

[state 1201, sprpriority]
type = sprpriority
trigger1 = animelem = 4
value = 1


; Bindings  =================================
[State 1221, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 642,-638

[State 1221, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 540,-654

[State 1221, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 112,-686

[State 1221, Bind 4] 
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = -210,584

[State 1221, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = -74,-408

[State 1221, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = -56,-408

[State 1221, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = -51,-408


[State 1221, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -56,-408

[State 1221, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = -62,-408

[State 1221, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0
pos = -16,-400

[State 1221, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 46,-342


[State 1221, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = -200,-626


[State 1221, Bind 13]
type = TargetBind
trigger1 = AnimElemtime(13) >= 0 && Animelemtime(14) < 0
pos = -122,-780


[State 1221, Bind 14]
type = TargetBind
trigger1 = AnimElemtime(14) >= 0 && Animelemtime(15) < 0 
pos = 196,-922

[State 1221, Bind 15]
type = TargetBind
trigger1 = AnimElemtime(15) >= 0 && Animelemtime(16) < 0 
pos = 568,-782

[State 1221, Bind 16]
type = TargetBind
trigger1 = AnimElemtime(16) >= 0 && Animelemtime(17) < 0 
pos = 832,-326

[State 1221, Bind 17]
type = TargetBind
trigger1 = AnimElemtime(17) >= 0 && Animelemtime(17) < 23 
pos = 776,-56


;FX  =================================================
[State 1221, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 1220, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 1220, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 170,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1220, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 358,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 5
persistent = 0
value = S1200,0


[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 12
persistent = 0
value = S0,3

[State 1201, 12 quake]
type = EnvShake
trigger1 = animelem = 17
persistent = 0
time = 24
ampl = -30
ignorehitpause = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1500
pos = 150,5
scale = 0.75,0.75
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1501
pos = 150,5
scale = 0.75,0.75
sprpriority = -3
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = F61
pos = 714,0
scale = 2,1
ignorehitpause
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 17
persistent = 0
value = S0,0

;Physics ========================================
[state 1201, Leap back]
type = velset
trigger1 = animelemtime(12) = 0
x = -18
y = -12

[state 1201, gravity]
type = veladd;gravity
trigger1 = pos y < -1
trigger1 = animelemtime(12) > 0
y = 0.8
persistent = 1

[state 1201, landing]
type = velset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
x = 0
y = 0

[state 1201, Landing]
type = posset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
y = 0



;Attack Data ============================================
[State 1201, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 17
persistent = 0
value = floor(-120*fvar(10))

[state 1201, hit add]
type = hitadd
trigger1 = pos y >= 0
trigger1 = animelem = 17
value = 1

[state 1201, hit add]
type = hitadd
trigger1 = animelem = 5
value = 1

[State 1201, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 5
persistent = 0
value = floor(-20*fvar(10))
kill = 0

[state 1201, movehit energy]
type = poweradd
trigger1 = animelem = 17
value = 0
persistent = 0

[state 1221, movehit power give]
type = targetpoweradd
trigger1 = animelem = 17
value = floor(enemynear,powermax %12)
persistent = 0



[State 1221, State End]
type = ChangeState
trigger1 = animtime = 0
value = 1222



;--------------------------------------------------------------------------
; Jump Back
[Statedef 1222]
type    = S
movetype= I
physics = N
anim = 1103
sprpriority = 4

[State 1222, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1222, gravity]
type = gravity
trigger1 = time > 0

[state x, combo dampener]
type = varadd
trigger1 = time = 0
v = 18
value = -9
persistent = 0
ignorehitpause =1 

[state 1222, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[state 1222, jump]
type = velset
trigger1 = time = 0
x = -4
y = -6


;---------------------------------------------------------------------------
;opponent landing
[Statedef 1225]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 2

[state 1225, hitby]
type = hitby
trigger1 = 1
value = SCA

[state 1225, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1,0

[state 1225, anim]
type = changeanim2
trigger1 = time = 0
value = 1205


[state 1225, end]
type = CHANGEstate
trigger1 = !gethitvar(isbound)
value = 1226

;[State 1225, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050
;---------------------------------------------------------------------------
;bounce portion
[statedef 1226]
type = A
movetype = H
physics = N
anim = 5100

[state 1226, impact]
type = velset
trigger1 = time = 0
y = 0

[State 1226, 8]
type = Explod
trigger1 = Time = 1
anim = F62 
pos = 0, 0
ontop = 1
scale = 1.7, 0.5

[State 1226, 10]
type = PlaySnd
trigger1 = Time = 1
value = F7,2

[state 1226, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10

[state 1226, anim]
type = changeanim
trigger1 = time = 6
value = 5160

[state 1226, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 247, bounce]
type = velset
trigger1 = time = 6
y = -40
x = 16

[state 247, gravity]
type = gravity
trigger1 = time > 7
;y = .44

[state 247, down]
type = selfstate
trigger1 = time >= 7 && pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;harmless bounce
[Statedef 1227]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 1227, hitby]
type = hitby
trigger1 = 1
value = SCA

[state 1215, anim]
type = changeanim2
trigger1 = time = 0
value = 1205


[state 1227, end]
type = changestate
trigger1 = !gethitvar(isbound)
value = 1206

;[State 1215, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050


;===========================================================================
; Lunge Grab
;=========================================================================
;Light Lunge
[statedef 1250]
type = C
movetype = A
physics = N
ctrl = 0
velset = 0,0

[state 1250, anim]
trigger1 = anim != 1250
type = changeanim
value = 1250

[state 1250, width]
type = width
trigger1 = 1
player = -200,-200

[state 1250, not autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

[state 1250, fistdown shake]
type = envshake
trigger1 = animelem = 2
ampl = -8
time = 12

[state 1250, playerpush off]
type = playerpush
trigger1 = animelem = 4
value = 0
ignorehitpause = 1

[state 1250, playerpush off]
type = playerpush
trigger1 = animelem = 7
value = 1
ignorehitpause = 1

[state 1250, statetypeset]
type = statetypeset
trigger1 = animelem = 5
statetype = S
ignorehitpause = 1

[state 1250, voice]
type = playsnd
trigger1 = animelemtime(3) = 2
value = 1250,random%2
channel = 1
ignorehitpause = 1

;------------------------------
;Armor Start
;------------------------------

[state 1250, armor counter]
type = helper
trigger1 = animelemtime(1) = 1
trigger1 = !numhelper(1250)
id = 1250
stateno = 1259
postype = p1
pos = 0,0


[state 1250, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1250, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1
ignorehitpause = 1

[state 1250, Cancel]
type = changestate
triggerall = time > 12 && animelemtime(3) < 0
trigger1 = command = "x" || command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(26) = 2
value = 1258

[state 1120, power]
type = poweradd
trigger1 = time%10
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
value = 2

[state 1250, HOLD]
TYPE = changeanim
triggerall = time < 300
triggerall = animelemtime(2) >= 0  && animelemtime(3) < 0
trigger1 = command = "holda"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(26) = 0
value = 1250
elem = 2
persistent = 1

[state 1250, duck projectiles]
type = nothitby
trigger1 = animelemtime(4) < 0
value = ,AP
ignorehitpause = 1

[state 1260, nothitby]
type = nothitby
trigger1 = animelemtime(4) >= 0 && animelemtime(7) < 0
value = ,AT
ignorehitpause = 1

[state 1250, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = var(20) > 0
trigger1 = animelemtime(7) < 0
attr = SC, AA, AP
stateno = 1250
time = 1
persistent = 1

[State 1250, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1250, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1250, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 1250, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------


[state 1250, vel x]
type = velset
trigger1 = animelemtime(4) >= 0 && animelemtime(6) < 0
x = 26;ifelse(var(20) <= 2,28,14)
persistent = 1

[state 1250, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S0,9

[state 1250, vel x]
type = statetypeset
trigger1 = animelem = 7
physics = S
persistent = 0

[State 1250, 4]
type = EnvShake
trigger1 = animElem = 7
time = 10
ampl = 8
freq = 100


[State 1250, 1]
type = HitDef
Trigger1 = !movecontact
persistent = 0
attr = S, ST          
hitflag = M-          
priority = 1, Miss    
sparkno = -1               
p1facing = 1
p2facing = 1          
p1stateno = 1255     
p2stateno = 1280      
guard.dist = 0 

[State 1250, 1]
type = HitDef
triggerall = enemynear,anim = 5300
Trigger1 = !movecontact
persistent = 0
attr = S, ST          
hitflag = M          
priority = 1, Miss    
sparkno = -1               
p1facing = 1
p2facing = 1          
p1stateno = 1255     
p2stateno = 1280      
guard.dist = 0 

[state 1250, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1 

;--------------------------------------------------------------------------
; Successful Grab Landing recovery time
[statedef 1254]
type = S
movetype = I
physics = S
ctrl = 0
anim = 47

[state 1254, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1254, stop vel]
type = velset
trigger1 = time = 0
y = 0

[state 1254, stop place on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1254, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[State 1254, 4]
type = EnvShake
trigger1 = time = 0
time = 18
ampl = -12

[state 52, front foot front dust]
type = explod
trigger1 = time = 0
anim = F120
pos = -256,0
scale = 2, 2
sprpriority = 4

[state 52, front foot back dust]
type = explod
trigger1 = time = 0
anim = F120
pos = -96,0
scale = 2, 2
sprpriority = 4

[state 52, backfoot front dust]
type = explod
trigger1 = time = 0
anim = F120
pos = 72,0
scale = 2, 2
sprpriority = 4

[state 52,back foot back dust]
type = explod
trigger1 = time = 0
anim = F120
pos = 226,0
scale = 2, 2
sprpriority = 4


[state 1254, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 1254, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1



;--------------------------------------------------------------------------
;Belly Bump Grab animation
[statedef 1255]
type = S
movetype = A
physics = N
ctrl = 0

[state 1255, voice]
type = playsnd
trigger1 = time = 0
value = S1100,0

[state 1255, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1255, anim]
type = changeanim
trigger1 = time = 0
value = 1255

[State 1255, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && animelemtime(4) < 0
pos = 386, -338

[State 1255, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(4) >= 0  && animelemtime(5) < 0 
pos = 272, -338

[state 1255, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(5) = 0
value = -180

[state 1255, powergive]
type = targetpoweradd
trigger1 = animelemtime(5) = 0
value = 100

[state 1255, hitstop]
type = pause
trigger1 = animelemtime(5) = 0
ignorehitpause = 1
time = 4

[state 1255, screenshake]
type = envshake
trigger1 = animelemtime(5) = 0
ampl = 8
time = 12
ignorehitpause = 1



[state 1255, vel]
type = velset
trigger1 = animelemtime(4) = 0
x = 32
y = -15

[state 1255, bump]
type = targetstate
trigger1 = animelemtime(5) = 0
value = 1282

[state 1255, snd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = S0,8
ignorehitpause = 1

[state 1255, gravity]
type = gravity
trigger1 = pos y < -1

[state 1255, vel]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1254

[state 1255, wall crash]
type = changestate
trigger1 = frontedgebodydist < 300
trigger1 = animelemtime(5) > 0 && animelemtime(5) < 4
value = 1256

;---------------------------------------------------------------------------
;On wall
[statedef 1256]
Type = A
movetype = A
physics = N
velset  =0,0
anim = 1256

[state 1256, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1,1

[state 1255, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 1256, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[State 1256, Bind 1] 
type = TargetBind
trigger1 = anim = 1236
trigger1 = animelemtime(5) < 4
pos = 196, -356

[state 1256, posset]
type = posset
trigger1 = time = 0
x = ifelse(facing=1,540,-540) ;110

[state 1256, envshake]
type = envshake
trigger1 = time = 0
time = 36
ampl = 18
freq = 50

[state 1256, snd]
type = playsnd 
trigger1 = time = 0
value = S0,0

[state 1256, snd]
type = playsnd 
trigger1 = time = 2
value = S1,2

[state 1256, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -220

[state 1256, changeanim]
type = changeanim
trigger1 = animtime = 0
value = 43

[state 1256, targetstate]
type = targetstate
trigger1 = time = 0
value = 1281

[state 1256, bounce off wall]
type = velset
trigger1 = anim = 43
x = -20
y = -24
persistent = 0

[state 1256, Voice]
type = playsnd
trigger1 = anim = 43
trigger1 = time = 42
trigger1 = !enemynear,alive
value = 1255, random%3
channel = 1
persistent = 0

[state 1256, gravity]
type = gravity
trigger1 = anim = 43


[state 1256, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1254

;---------------------------------------------------------------------------
;Light Cancel
[statedef 1258]
type = C
movetype = I
anim = 1259
ctrl = 0

[State X, Blink white]
type = PalFX
trigger1 = time = 0
time = 2
add = 150,150,150 ;32,16,0
ignorehitpause

[state 1258, nothitby]
type = nothitby
trigger1 = 1
value = ,AT,AP

[state 1258, changeanim]
type = changeanim
trigger1 = time < 40
trigger1 = command = "holdback"
value = 1259
elem = 1
persistent = 1

[state 1258, exit]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Addition armor helper
[statedef 1259]
type = S
movetype = I
anim = 9999
ctrl = 0

[state 1259]
type = parentvaradd
trigger1 = time = 0
v = 20
value = 60

[state 1259]
type = poweradd
trigger1 = time = 0
value = 70

[state 1259]
type = destroyself
trigger1 = time = 30

;---------------------------------------------------------------------------
;Heavy Cancel
[statedef 1268]
type = C
movetype = I
anim = 1269
ctrl = 0

[State X, Blink white]
type = PalFX
trigger1 = time = 0
time = 2
add = 150,150,150 ;32,16,0
ignorehitpause

[state 1268, nothitby]
type = nothitby
trigger1 = 1
value = ,AT,AP

[state 1268, changeanim]
type = changeanim
trigger1 = time < 40
trigger1 = command = "holdback"
value = 1269
elem = 1
persistent = 1

[state 1268, exit]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Addition armor Headbutt helper
[statedef 1269]
type = S
movetype = I
anim = 9999
ctrl = 0

[state 1269]
type = parentvaradd
trigger1 = time = 0
v = 20
value = 100

[state 1269]
type = poweradd
trigger1 = time = 0
value = 70

[state 1269]
type = destroyself
trigger1 = time = 30

;---------------------------------------------------------------
[statedef 1260]
type = S
movetype = A
physics = N
ctrl = 0
velset = 0,0

[state 1260, anim]
trigger1 = anim != 1260
type = changeanim
value = 1260

[state 1250, width]
type = width
trigger1 = 1
player = -200,-200

[state 1260, not autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

[state 1250, fistdown shake]
type = envshake
trigger1 = animelem = 2
ampl = -8
time = 12

[state 1260, playerpush off]
type = playerpush
trigger1 = animelem = 4
value = 0
ignorehitpause = 1

[state 1260, playerpush off]
type = playerpush
trigger1 = animelem = 7
value = 1
ignorehitpause = 1

[state 1260, statetypeset]
type = statetypeset
trigger1 = animelem = 5
statetype = S
ignorehitpause = 1

[state 1260, voice]
type = playsnd
trigger1 = animelemtime(3) = 2
value = 1250,random%2
channel = 1
ignorehitpause = 1

;------------------------------
;Armor Start
;------------------------------

[state 1260, armor counter]
type = helper
trigger1 = animelemtime(1) = 1
trigger1 = !numhelper(1260)
id = 1260
stateno = 1269
postype = p1
pos = 0,0


[state 1260, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.75)
persistent = 1

[state 1260, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1
ignorehitpause = 1

[state 1260, Cancel]
type = changestate
triggerall = time > 12 && animelemtime(3) < 0
trigger1 = command = "x"  || command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(26) = 2
value = 1268

[state 1260, HOLD]
TYPE = changeanim
triggerall = time < 300
triggerall = animelemtime(2) >= 0  && animelemtime(3) < 0
trigger1 = command = "holdb"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(26) = 0
value = 1260
elem = 2
persistent = 1

[state 1260, duck projectiles]
type = nothitby
trigger1 = animelemtime(4) < 0
value = ,AP
ignorehitpause = 1

[state 1260, nothitby]
type = nothitby
trigger1 = animelemtime(4) >= 0 && animelemtime(7) < 0
value = ,AT
ignorehitpause = 1

[state 1260, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = var(20) > 0
trigger1 = animelemtime(7) < 0
attr = SC, AA, AP
stateno = 1260
time = 1
persistent = 1

[State 1260, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1260, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1260, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.5)
value = anim
elem = var(22)

[state 1260, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.5)
value = 1
;--------------------------


[state 1260, vel x]
type = velset
trigger1 = animelemtime(4) >= 0 && animelemtime(6) < 0
x = 26;ifelse(var(20) <= 3,28,14)
persistent = 1

[state 1250, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S0,9

[state 1260, vel x]
type = statetypeset
trigger1 = animelem = 7
physics = S
persistent = 0

[State 1260, 4]
type = EnvShake
trigger1 = animElem = 7
time = 10
ampl = 8
freq = 100


[State 1260, 1]
type = HitDef
Trigger1 = !movecontact
persistent = 0
attr = S, ST          
hitflag = M-          
priority = 1, Miss    
sparkno = -1               
p1facing = 1
p2facing = 1          
p1stateno = 1255     
p2stateno = 1280      
guard.dist = 0 

[State 1260, 1]
type = HitDef
triggerall = enemynear,anim = 5300
Trigger1 = !movecontact
persistent = 0
attr = S, ST          
hitflag = M         
priority = 1, Miss    
sparkno = -1               
p1facing = 1
p2facing = 1          
p1stateno = 1255     
p2stateno = 1280      
guard.dist = 0 

[state 1260, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1 



;---------------------------------------------------------------------------
;EX Lunge
[statedef 1270]
type = S
movetype = A
physics = N
ctrl = 0
velset = 0,0

[state 1270, anim]
trigger1 = anim != 1270
type = changeanim
value = 1270

[state 1250, width]
type = width
trigger1 = 1
player = -200,-200

[state 1250, not autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

[State 1270, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 100,50,0 ;32,16,0
sinadd = 64,32,5,3

[state 1270, fistdown shake]
type = envshake
trigger1 = animelem = 2
ampl = -8
time = 12

[state 1270, playerpush off]
type = playerpush
trigger1 = animelem = 4
value = 0
ignorehitpause = 1

[state 1270, playerpush off]
type = playerpush
trigger1 = animelem = 7
value = 1
ignorehitpause = 1

[state 1270, statetypeset]
type = statetypeset
trigger1 = animelem = 5
statetype = S
ignorehitpause = 1

[state 1250, voice]
type = playsnd
trigger1 = animelemtime(3) = 2
value = 1250,random%2
channel = 1
ignorehitpause = 1

;------------------------------
;Armor Start
;------------------------------

[state 1270, armor counter]
type = helper
trigger1 = animelemtime(1) = 1
trigger1 = !numhelper(1270)
id = 1270
stateno = 1279
postype = p1
pos = 0,0

[state 1270, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.25)
persistent = 1

[state 1270, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -gethitvar(damage)
persistent = 1
ignorehitpause = 1

[state 1250, Cancel]
type = changestate
triggerall = time > 12 && animelemtime(3) < 0
trigger1 = command = "x" || command = "y" || command = "z"
trigger1 = !ailevel 
trigger2 = ailevel
trigger2 = var(26) = 2
value = 1278

[state 1260, HOLD]
TYPE = changeanim
triggerall = time < 300
triggerall = animelemtime(2) >= 0  && animelemtime(3) < 0
trigger1 = command = "holdc"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(26) = 0
value = 1270
elem = 2
persistent = 1

[state 1270, duck projectiles]
type = nothitby
trigger1 = animelemtime(4) < 0
value = ,AP
ignorehitpause = 1

[state 1270, nothitby]
type = nothitby
trigger1 = animelemtime(4) >= 0 && animelemtime(7) < 0
value = ,AT
ignorehitpause = 1

[state 1270, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = var(20) > 0
trigger1 = animelemtime(7) < 0
attr = SCA, AA, AP
stateno = 1270
time = 1
persistent = 1

[State 1270, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;determine what frame
[state 1270, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1270, delay]
type = changeanim 
trigger1 = var(32) < floor(gethitvar(hittime)*0.5)
value = anim
elem = var(22)

[state 1270, posfreeze]
type = posfreeze
trigger1 = var(32) < floor(gethitvar(hittime)*0.5)
value = 1
;--------------------------


[state 1270, vel x]
type = velset
trigger1 = animelemtime(4) >= 0 && animelemtime(6) < 0
x = 32
persistent = 1

[state 1270, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S0,9

[state 1270, vel x]
type = statetypeset
trigger1 = animelem = 7
physics = S
persistent = 0

[State 1270, 4]
type = EnvShake
trigger1 = animElem = 7
time = 10
ampl = 8
freq = 100


[State 1270, 1]
type = HitDef
Trigger1 = !movecontact
persistent = 0
attr = S, ST          
hitflag = M-          
priority = 1, Miss    
sparkno = -1               
p1facing = 1
p2facing = 1          
p1stateno = 1255     
p2stateno = 1280      
guard.dist = 0 

[State 1270, 1]
type = HitDef
triggerall = enemynear,anim = 5300
Trigger1 = !movecontact
persistent = 0
attr = S, ST          
hitflag = M         
priority = 1, Miss    
sparkno = -1               
p1facing = 1
p2facing = 1          
p1stateno = 1255     
p2stateno = 1280      
guard.dist = 0 

[state 1270, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1 
;---------------------------------------------------------------------------
;EX Cancel
[statedef 1278]
type = C
movetype = I
anim = 1279
ctrl = 0

[state 1278, poweradd]
type = poweradd
trigger1 = time = 0
value = 500
persistent = 0

[State X, Blink white]
type = PalFX
trigger1 = time = 0
time = 2
add = 150,150,150 ;32,16,0
ignorehitpause

[state 1278, nothitby]
type = nothitby
trigger1 = 1
value = ,AT,AP

[state 1278, changeanim]
type = changeanim
trigger1 = time < 40
trigger1 = command = "holdback"
value = 1279
elem = 1
persistent = 1

[state 1278, exit]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Addition armor Headbutt helper
[statedef 1279]
type = S
movetype = I
anim = 9999
ctrl = 0

[state 1279]
type = parentvaradd
trigger1 = time = 0
v = 20
value = 120

[state 1279, poweradd]
type = poweradd
trigger1 = time = 0
value = -500
ignorehitpause
persistent = 0

[state 1279]
type = destroyself
trigger1 = time = 30



;---------------------------------------------------------------------------
;Enemy Grabbed
[Statedef 1280]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 1280, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[state 1280, escape]
type = selfstate
trigger1 = time > 40
trigger1 = !gethitvar(isbound)
value = 5050

[state 1280, anim]
type = changeanim2
trigger1 = time = 0
value = 1280

;---------------------------------------------------------------------------------------------
;Flattened
[statedef 1281]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[State 1281, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 0.3,1.3


[state 1281, anim]
type = changeanim
trigger1 = time = 0
value = 5000

[state 1281, velset]
type = velset
trigger1 = time = 24
x = 0
y = -6

[state 1281, gravity]
type = veladd
trigger1 = time > 24
y = 0.55

[state 1281, nothitby]
type = nothitby
trigger1 = 1
value = SCA
time = 90

[state 1281, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;--------------------------------------------------------------
[statedef 1282]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 1238, anim]
type = changeanim
trigger1 = time = 0
value = 5012

[state 1282, anim]
type = changeanim
trigger1 = anim = 5012
trigger1 = animtime = 0
value = 5035

[state 1238, velset]
type = velset
trigger1 = time = 0
x = -60
y = -9

[state 1238, gravity]
type = gravity
trigger1 = 1

[state 1238, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;===========================================================================
; Push Block
;===========================================================================

[Statedef 1400]
type = S
movetype = A
physics = S
velset = 0,0
anim = 1400

[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -1000

[state 1400, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[State 330, Spark]
type = Explod
trigger1 = AnimElem = 3
id = 1410
anim = 1410
postype = p1
pos = 574,-582
sprpriority = 4
bindtime = 1
ownpal = 1
scale = const(size.xscale)*4,const(size.yscale)*4

[State 211, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, NA
animtype  = Heavy
damage    = 60
Hitflag = MA
guardflag = MA
pausetime = 0,0
sparkno = -1
guard.velocity = -20
guard.slidetime = 10
guard.hittime = 10
ground.Velocity = -12,9
guard.dist = 120
air.Velocity = -12,9
fall = 1
fall.recover = 0
kill = 0
guard.kill = 0


[state 330, snd]
type = playsnd
trigger1 = time = 1
value = 1400,0

[State 1400, Push]
type = Helper
trigger1 = Time = 13
trigger1 = time = 15
ignorehitpause = 1
ID = 1440
name = "attack"
pos = 0,0
postype = p1
stateno = 1440
keyctrl = 0
ownpal = 1
helpertype = normal

[state 340, HB]
Type = hitby
trigger1 = 1
value = SCA,AT


[state 1400, previous state]
type = varset
trigger1 = time = 0
v = 5
value = prevstateno


[State 330, 3]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Pushing part
[Statedef 1440]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 1440

[State 1440, Push]
type = posset
trigger1 = time = 0
y = 0

[State 1440, Push]
type = PlayerPush
trigger1 = 1
value = 1

[State 1440, NHB]
type = NotHitBy
Trigger1 = 1
value = SCA
Time = 1

[State 1440, Vel]
type = VelSet
trigger1 = Time >= 0
x = 60

[State 345, End]
type = DestroySelf
trigger1 = Time = 15



;---------------------------------------------------------------------------
;===========================================================================
;------------------------------Meteor Drop----------------------------------
; Grab Start	:	3000
; 1st Trunk	:	3001 	Victim	:	1105
; 2nd Trunk	:	3002	Victim 	:	1115
; 3rd Sit On	:	3003	Victim	:	1205
; 4th Super Jump:	3004	Victim	: 	642

;Total Damage: 650
[statedef 3000]
type    = S
movetype= A
physics = S
anim = 3000
ctrl = 0
velset = 0,0

[state 3000, random variable]
type = varset
trigger1 = time = 0
var(27) = random%2
ignorehitpause = 1

[state x, combo damage score]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 90
v = 18
value = 90
persistent = 0
ignorehitpause = 1

[state 3000, Voice]
type = playsnd
trigger1 = animelemtime(1) = 0
value = 3000,var(27) + 1
channel = 1

[state 3000, Voice]
type = playsnd
trigger1 = animelemtime(6) = 10
value = 3001,var(27) + 1
channel = 1

[state 3000, invun]
type = nothitby
trigger1 = animelemtime(6) < 0
value = SCA
ignorehitpause = 1

[state 3000, no bg]
type = assertspecial
trigger1 = animelemtime(1) >= 0 && animelemtime(5) < 0
flag = nobg
ignorehitpause = 1

[State 3000, Super A]
type = SuperPause
trigger1 =  animelemtime(1) = 0
sound = S3000, 0
poweradd = -3000
pos = 10,-100
time = 60
movetime = 60


[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(1) >=0  && animelemtime(2) <  11
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(const(size.xscale)),(3-(time*0.15))*(const(size.yscale))
pos = 0,60-time*5
ownpal = 1


[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(2) = 12
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ownpal = 1

[State 3000, 1]
type = HitDef
Trigger1 = animelem = 5
persistent = 0
attr = S, HT          
hitflag = M-          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1    
p1facing = 1
p2facing = 1 
id = 3000         
p1stateno = 3001      
p2stateno = 1205       
guard.dist = 0   

[State 3000, 1]
type = HitDef
triggerall = enemynear,anim = 5300
Trigger1 = animelem = 5
persistent = 0
attr = S, HT          
hitflag = M          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1    
p1facing = 1
p2facing = 1 
id = 3000         
p1stateno = 3001      
p2stateno = 1205       
guard.dist = 0   

[state 3000, end]
type = changestate
trigger1 = animtime = 0
ctrl = 1
value = 0

[state 1100, statetypeset]
type = statetypeset
trigger1 = time > 66
movetype = I

[state 3000, damage multiplier]
type = varset
trigger1 = 1
fvar(10) = 1
;==========================================================================
; Super Portrait
;==========================================================================
[Statedef 3100]
type = A
ctrl = 0
anim = 3100
sprpriority = -3

[State 9999,Destory self]
type = DestroySelf
trigger1 = root,stateno != 3000
trigger2 = time >= 50


;--------------------------------------------------------------------------
;Throw portion
[statedef 3001]
type    = S
movetype= A
physics = S
anim = 1201
sprpriority = 3

[state 3001, voice]
type = playsnd
trigger1 = animelem = 1
value = S1100,0
channel = 0

[state 3001, damage multiplier]
type = varset
trigger1 = 1
fvar(10) = 1

[state 3001, width]
type = width
trigger1 = 1
edge = 110,110

;Explod layered animation====================
[state 3001, buttcheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1200) 
id = 1200
anim = 1202
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
sprpriority = 4

[state 1201, sprpriority]
type = sprpriority
trigger1 = animelem = 4
value = 1


; Bindings  =================================
[State 3001, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 642,-638

[State 3001, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 540,-654

[State 3001, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 112,-686

[State 3001, Bind 4] 
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = -210,-584

[State 3001, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = -74,-408

[State 3001, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = -56,-408

[State 3001, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = -51,-408


[State 3001, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -56,-408

[State 3001, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = -62,-408

[State 3001, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0
pos = -16,-400

[State 3001, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 46,-342


[State 3001, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = -200,-626


[State 3001, Bind 13]
type = TargetBind
trigger1 = AnimElemtime(13) >= 0 && Animelemtime(14) < 0
pos = -122,-780


[State 3001, Bind 14]
type = TargetBind
trigger1 = AnimElemtime(14) >= 0 && Animelemtime(15) < 0 
pos = 196,-922

[State 3001, Bind 15]
type = TargetBind
trigger1 = AnimElemtime(15) >= 0 && Animelemtime(16) < 0 
pos = 568,-782

[State 3001, Bind 16]
type = TargetBind
trigger1 = AnimElemtime(16) >= 0 && Animelemtime(17) < 0 
pos = 832,-326

[State 3001, Bind 17]
type = TargetBind
trigger1 = AnimElemtime(17) >= 0 
pos = 776,-56


;FX  =================================================
[State 3001, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 3001, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 3001, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 170,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 3001, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 358,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 3001, 12 sfx]
type = playsnd
trigger1 = animelem = 5
persistent = 0
value = S1200,0


[state 3001, 12 sfx]
type = playsnd
trigger1 = animelem = 12
persistent = 0
value = S0,3

[State 3001, 12 quake]
type = EnvShake
trigger1 = animelem = 17
persistent = 0
time = 24
ampl = -30
ignorehitpause = 1

[state 3001, fx]
type = explod
trigger1 = animelem = 17
anim = 1500
pos = 150,5
scale = 0.75,0.75
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 3001, fx]
type = explod
trigger1 = animelem = 17
anim = 1501
pos = 150,5
scale = 0.75,0.75
sprpriority = -3
ignorehitpause = 1
ownpal = 1

[state 3001, fx]
type = explod
trigger1 = animelem = 17
anim = F61
pos = 714,0
scale = 2,1
ignorehitpause
ownpal = 1

[state 3001, 12 sfx]
type = playsnd
trigger1 = animelem = 17
persistent = 0
value = S0,0

;Physics ========================================
[state 3001, Leap back]
type = velset
trigger1 = animelemtime(12) = 0
x = -18
y = -12

[state 3001, gravity]
type = veladd;gravity
trigger1 = pos y < -1
trigger1 = animelemtime(12) > 0
y = 0.8
persistent = 1

[state 3001, landing]
type = velset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
x = 0
y = 0

[state 3001, Landing]
type = posset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
y = 0



;Attack Data ============================================
[State 3001, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 17
persistent = 0
value = -80
KILL = 0

[state 3001, hit add]
type = hitadd
trigger1 = pos y >= 0
trigger1 = animelem = 17
value = 1

[state 3001, hit add]
type = hitadd
trigger1 = animelem = 5
value = 1

[State 3001, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 5
persistent = 0
value = -20
KILL = 0

[state 3001, movehit energy]
type = poweradd
trigger1 = animelem = 17
value = 0
persistent = 0

[state 3001, movehit power give]
type = targetpoweradd
trigger1 = animelem = 17
value = floor(enemynear,powermax/20)
persistent = 0

[state 3001, power give]
type = targetpoweradd
trigger1 = animelem = 11
value = 150
persistent = 0

;[state 3001, hit counter]
;type = hitadd
;trigger1 = animelem = 11
;value = 0

[state 3001, end]
type = Changestate
trigger1 = animtime = 0
value = 3002

;--------------------------------------------------------------------------
; Second Slam
[Statedef 3002]
type    = S
movetype= A
physics = S
anim = 1211
sprpriority = 3

[State 3002, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1
[state 1211, width]
type = width
trigger1 = 1
edge = 110,110


[State 1211, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

;Explod layered animation====================
[state 1201, buttcheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1210) 
id = 1210
anim = 1212
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
sprpriority = 4

[state 1201, sprpriority]
type = sprpriority
trigger1 = animelem = 4
value = 1


; Bindings  =================================
[State 1201, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 642,-638

[State 1201, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 540,-654

[State 1201, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 112,-686

[State 1201, Bind 4] 
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = -210,-584

[State 1201, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = -74,-408

[State 1201, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = -56,-408

[State 1201, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = -51,-408


[State 1201, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -56,-408

[State 1201, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = -62,-408

[State 1201, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0
pos = -16,-400

[State 1201, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 46,-342


[State 1201, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = -200,-626


[State 1201, Bind 13]
type = TargetBind
trigger1 = AnimElemtime(13) >= 0 && Animelemtime(14) < 0
pos = -122,-780


[State 1201, Bind 14]
type = TargetBind
trigger1 = AnimElemtime(14) >= 0 && Animelemtime(15) < 0 
pos = 196,-922

[State 1201, Bind 15]
type = TargetBind
trigger1 = AnimElemtime(15) >= 0 && Animelemtime(16) < 0 
pos = 568,-782

[State 1201, Bind 16]
type = TargetBind
trigger1 = AnimElemtime(16) >= 0 && Animelemtime(17) < 0 
pos = 832,-326

[State 1201, Bind 17]
type = TargetBind
trigger1 = AnimElemtime(17) >= 0 
pos = 776,-56




;FX  =================================================
[State 1201, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 1220, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 1220, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 170,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1220, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 358,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 5
persistent = 0
value = S1200,0


[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 12
persistent = 0
value = S0,3

[State 1201, 12 quake]
type = EnvShake
trigger1 = animelem = 17
persistent = 0
time = 24
ampl = -24
ignorehitpause = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1500
pos = 150,5
scale = 0.75,0.75
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = 1501
pos = 150,5
scale = 0.75,0.75
sprpriority = -3
ignorehitpause = 1
ownpal = 1

[state 1201, fx]
type = explod
trigger1 = animelem = 17
anim = F61
pos = 714,0
scale = 2,1
ignorehitpause
ownpal = 1

[state 1201, 12 sfx]
type = playsnd
trigger1 = animelem = 17
persistent = 0
value = S0,0

;Physics ========================================
[state 1201, Leap back]
type = velset
trigger1 = animelemtime(12) = 0
x = -24
y = -15

[state 1201, gravity]
type = veladd;gravity
trigger1 = pos y < -1
trigger1 = animelemtime(12) > 0
y = 1.25
persistent = 1

[state 1201, landing]
type = velset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
x = 0
y = 0

[state 1201, Landing]
type = posset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
y = 0

;Attack Data ============================================
[State 3002, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 17
persistent = 0
value = -90
KILL = 0

[state 1211, hit add]
type = hitadd
trigger1 = pos y >= 0
trigger1 = animelem = 17
value = 1

[state 1201, hit add]
type = hitadd
trigger1 = animelem = 5
value = 1

[State 1201, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 5
persistent = 0
value = -10
KILL = 0


[state 1211, targetpoweradd]
type = targetpoweradd
trigger1 = animelem = 17
value = floor(enemynear,powermax/20)
persistent = 0 

[State 3002, State End]
type = ChangeState
trigger1 = animtime = 0
value = 3003
;---------------------------------------------------------------------------
; third pard SSS
[Statedef 3003]
type    = S
movetype= A
physics = N
anim = 1101
poweradd = 0
sprpriority = -1

[state 3003, damage multiplier]
type = varset
trigger1 = 1
fvar(10) = 1


[state 3003, targetstate]
type = targetstate
trigger1 = time = 0
value = 1130

[state 3003, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1100)
anim = 1106
id = 1100
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = 3
removetime = -1

[State 3003, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = F1, 1

[state 3003, UP]
type = velset
trigger1 = animelemtime(4) = 0
y = -36

[state 3003, side]
type = velset
trigger1 = animelemtime(4) = 0
trigger1 = backedgebodydist > 160
trigger1 = frontedgedist > 520
x = 0.75

[state 3003, move away from wall]
type = veladd
trigger1 = backedgebodydist <= 160
trigger1 = animelemtime(4) = 0
x = 12

[state 1101, move away from wall]
type = veladd
trigger1 = frontedgebodydist <= 520
trigger1 = time = 12
x = -12

[state 1101, gravity]
type = gravity
trigger1 = animelemtime(4) > 0

[state 1102, elephant sfx]
type = playsnd
trigger1 = vel y > 1
trigger1 = time > 5
persistent = 0
value = S1,0

[State 1101, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 490, 0

[State 1101, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 410, 0

[State 1101, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 390, 0

[State 1101, Bind 4] ; Head hold
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = 388,-324

[State 1101, Bind 5] ;Head hold
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = 154, -178

[State 1101, Bind 6] ;Rotation Starts
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = 122, -116

[State 1101, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = 122, -116

[State 1101, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = 122, -116


[State 1101, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = 122, -116


[State 1101, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0 
pos = 122, -116

[State 1101, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 122, -116

[State 1101, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116

[State 1101, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = 122, -116






[State 1101, Hurt end]
type = TargetLifeAdd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = time > 12
persistent = 0
value = -115
kill = 0

[state 3004, op state]
type = targetstate
trigger1 = vel y  > 0
trigger1 = pos y  > -vel y
value = 662
persistent = 0

[state 3003, power give]
type = targetpoweradd
trigger1 = vel y  > 0
trigger1 = pos y  > -vel y
value = floor(enemynear,powermax/10)
persistent = 0

[state 3003, hit counter]
type = hitadd
trigger1 = vel y  > 0
trigger1 = pos y  > -vel y
persistent = 0
value = 1

[State 3003, State End]
type = ChangeState
trigger1 = vel y  > 0
trigger1 = pos y  > -vel y
value = 3004

;-----------------------------------------------------------------------------------
;Landing!
[Statedef 3004]
type    = S
movetype= I
physics = N
anim = 1102
poweradd = 0
sprpriority = 2

[state 1101, removeexplod]
type = removeexplod
trigger1 = 1
id = 1100

[state 642, dust]
type = explod
trigger1 = time = 1
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = time = 1
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = time = 1
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1


[state 3004, op state]
type = targetstate
trigger1 = time = 0
value = 662

[State 3004, 12 quake]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 30
ampl = 12
ignorehitpause = 1

[state 3004, dust]
type = explod
trigger1 = time = 0
anim = 1500
pos = 40,10
ontop = 1
ownpal = 1

[state 3004, dust 2]
type = explod
trigger1 = time = 0
anim = 1501
pos = 40,10
sprpriority = -3
ownpal = 1

[state 3004, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,0
scale = 6,3.5
ignorehitpause
ownpal = 1

[state 3004, 12 sfx]
type = playsnd
trigger1 = time = 0
persistent = 0
value = S0,0

[State 3004, pause]
type = Pause
trigger1 = Time = 7
time = 45
endcmdbuftime = 20 

[state 3004, STOP]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3004, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3004, animation]
type = changestate
trigger1 = animtime = 0
ctrl = 0
value = 3005
;---------------------------------------------------------------------------------
;Super Jump
[Statedef 3005]
type = A
movetype = I
anim = 3005
sprpriority = -3

[state 3005, Leg]
type = explod
trigger1 = !numexplod(3005)
trigger1 = time = 0
id = 3005
anim = 3035
postype = p1
pos = 0,0
sprpriority = 2
scale = const(size.xscale), Const(size.yscale)
bindtime = -1
removeongethit = 1

[state 3005, crane]
type = helper
trigger1 = time = 0
trigger1 = !numhelper(3010)
postype = p1
pos = frontedgebodydist + 720 ,-400
scale = const(size.xscale),const(size.yscale)
id = 3010
stateno = 3010
name = "Heavy Lifting Crane"

[state 3004, jump]
type = velset
trigger1 = animelemtime(3) = 0
x = 25
y = -25
persistent = 0

[state 3004, takeoff sfx]
type = playsnd
trigger1 = time = 14
value = 0,9

[state 3004, gravity]
type = gravity
trigger1 = time > 14

[state 641, no push]
type = playerpush
trigger1 = 1
value = 0

[state 3004, nothitby]
type = nothitby
trigger1 = 1
value = SCA



[state 240, fx]
type = explod
trigger1 = time = 14
anim = F61
pos = 40,-5
scale = 3,3
ownpal = 1

[state 240, fx]
type = explod
trigger1 = time = 14
anim = F61
pos = 40,-200
scale = 1.5,1.5
ownpal = 1

[state 1121, elephant sfx]
type = playsnd
trigger1 = vel y > 1
persistent = 0
value = S1,0

[state 3004, damage multiplier]
type = varset
trigger1 = 1
fvar(10) = 1

[state 3004, change]
type = changestate
trigger1 = vel y > 1
value = 3006

;----------------------------------------------------------------------------------
;Grabs Crane
[statedef 3006]
type = A
movetype = I
physics = N
anim = 3006

[state 3006, removeexplod]
type = removeexplod
trigger1 = numexplod(3005)
id = 3005

;[state 3006, screen bound]
;type = screenbound
;trigger1 = time >= 0
;value = 0
;movecamera = 0,1
;persistent = 1

[state 3006, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3006, nothitby]
type = playerpush
trigger1 = 1
value = 0

[state 3006, helper camera]
type = helper
trigger1 = animelemtime(2) = 0
ignorehitpause
id = 3012
stateno = 3012
postype = p1
pos = 0,0
name = "Banzai Drop Camera"

;=============================
; Posadd's
;=============================
[state 3006, posadd 5]
type = posadd
trigger1 = animelemtime(5) = 0
y = -88
ignorehitpause = 1

[state 3006, posadd 7]
type = posadd
trigger1 = animelemtime(7) = 0
y = -52
ignorehitpause = 1

[state 3006, posadd 10]
type = posadd
trigger1 = animelemtime(10) = 0
y = -130
ignorehitpause = 1
;----------------------------------------

;----------------------------------------
; Stutter
;----------------------------------------


[state 3006, stutter]
type = posadd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(5) = 0
trigger3 = animelemtime(8) = 0
trigger4 = animelemtime(13) = 0
y = 20

[state 3006, stutter]
type = posadd
trigger1 = animelemtime(2) = 6
trigger2 = animelemtime(5) = 6
trigger3 = animelemtime(8) = 6
trigger4 = animelemtime(13) = 6
y = -18


;-------------------------
;Drops
;-------------------------

[state 3006, veladd]
type = velset
trigger1 = animelemtime(2) = 0
x = 0
y = 0

[state 3006, veladd]
type = velset
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(8) = 0
trigger3 = animelemtime(13)= 0
y = 0


;--------------------------------------------
;Lift
;--------------------------------------------

[state 3006, velmul]
type = veladd
triggerall = vel y > -4;-15
trigger1 = animelemtime(3) > 0 && animelemtime(13) < 0
y = -0.2
persistent = 1

[state 3004, Voice]
type = playsnd
trigger1 = time = 4
value = 3002,0
channel = 1
ignorehitpause = 1

[state 3004, Voice]
type = playsnd
trigger1 = time = 72
value = 3002,1
channel = 1
ignorehitpause = 1

[state 3006, end]
type = changestate
trigger1 = animtime = 0
value = 3007



;----------------------------------------------------------------------------------
;Butt Drop
[statedef 3007]
type = A
movetype = A
physics = N
velset = 0,0
sprpriority = -2

;[state 3006, screen bound]
;type = screenbound
;trigger1 = time >= 0
;value = 1
;movecamera = 0,1
;persistent = 1

[state 3007, Voice]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 3002,2
channel = 1
ignorehitpause = 1

[state 3007, Butt]
type = explod
trigger1 = time =0
trigger1 = !numexplod(3007)
anim = 3017
postype = p1
pos = 0,0
bindtime = -1
id = 3007
sprpriority = 2
removetime = -1
scale = const(size.xscale),const(size.yscale)

[state 3007, Wind]
type = explod
trigger1 = animelemtime(6) = 0
trigger1 = !numexplod(2300)
anim = 2300
postype = p1
pos = 0,0
bindtime = -1
id = 2300
sprpriority = 4
removetime = -1
removeongethit = 1
scale = const(size.xscale), const(size.yscale)
trans = addalpha
alpha = 256,192

[state 3007, jump]
type = velset
trigger1 = animelemtime(3) = 0
y = -36;-22
x = p2bodydist x * 0.012 ;0.025



;[state 3007, pos x]
;type = posset
;trigger1 = animelemtime
;x = enemy,pos x


[state 3007, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3007, damage multiplier]
type = varset
trigger1 = 1
fvar(10) = 1

[state 3007, takeoff sfx]
type = playsnd
trigger1 = animelemtime(3) = 0
value = S3000,4


[state 3007, takeoff sfx]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 0,9

[State 3005, gravity]
type = gravity
trigger1 = animelemtime(3) > 2

[state 641, no push]
type = playerpush
trigger1 = 1
value = 0

[state 3005, buttdrop]
type = changeanim
trigger1 = time = 0
value = 3007

[state 3005, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 3008
;-----------------------------------------------------------------------------------
;Sit on
[Statedef 3008]
type    = C
movetype= A
physics = N
anim = 3008
sprpriority = -2

[state 3007, removexplod]
type = removeexplod
trigger1 = time = 0
id = 3007

[state 3007, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 2300

[state 3007, explod]
type = explod
trigger1 = time =0
trigger1 = !numexplod(3008)
anim = 3018
postype = p1
pos = 0,0
bindtime = -1
id = 3008
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

[state 3007, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[state 3007, width]
type = width
trigger1 = 1
value = 0,0

[state 3007, damage multiplier]
type = varset
trigger1 = 1
fvar(10) = 1

[state 3007, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 3007, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,-5
scale = 6,3
sprpriority = -3

[state 642, crater]
type = explod
trigger1 = time = 0
anim = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = time = 0
anim = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = time = 0
anim = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = time = 0
anim = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[State 3007, 3]
type = HitDef
triggerall = enemy,stateno = 662
trigger1 = Time = 0
attr = C, HA
HitFlag = D
getpower = 0
damage    = 0
guardflag = 
id = 3000
hitonce = 1
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = 6,0
animtype = Heavy
p1sprpriority = -2
p2sprpriority = 1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -7
air.velocity = -3,-4

[state 3007, playsnd]
type = playsnd
trigger1 = time = 0
value = S1,2


[state 3007, targetlife]
type = targetlifeadd
trigger1 = time = 0
trigger1 = numtarget(3000)
value = -345
id = 3000
persistent = 0
absolute = 1

[state 3007, targetpowergive]
type = targetpoweradd
trigger1 = time = 0
trigger1 = numtarget(3000)
value = floor(enemynear,powermax/7.5)
persistent = 0

[state 3007, flatten]
type = targetstate
trigger1 = time = 1
trigger1 = numtarget(3000)
trigger1 = target(3000),alive
value = 3020
persistent = 0

[state 3007, hit counter]
type = hitadd
trigger1 = numtarget(3000)
trigger1 = time = 0
value = 1


[state 3007, wedge]
type = targetstate
triggerall = numtarget(3000)
trigger1 = time = 1
trigger1 = !target(3000),alive
value = 650

[state 642, wedge var]
type = varset
triggerall = numtarget(3000)
trigger1 = target(3000),life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1


[state 3007, slow-mo]
type = pause
trigger1 = time > 1  
time = 2
persistent = 2


[state 3007, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 3007, slow down x]
type = velset
trigger1 = time = 0
x = 0

[State 3007, gravity]
type = gravity
trigger1 = time > 12

[state 3007, bounce]
type = velset
trigger1 = animelemtime(4) = 0
y = -24
persistent = 0

[State 3007, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 45
ampl = -45
freq = 75
phase = 75

[State 3007, thud]
type = PlaySnd
trigger1 = time = 0
value = S3000, 3
persistent = 0

[State 3007, thud]
type = PlaySnd
trigger1 = time = 0
value = S3000, 3
persistent = 0



;[state 3007, 2]
;type = velset
;trigger1 = time = 10
;y = -6

[state 3007, no push]
type = playerpush
trigger1 = 1
value = 0


[state 3007, 3]
type = ChangeState
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3009

;------------------------------------------------------------------------------------
;bounce
[statedef 3009]
type    = C
movetype= I
physics = C
anim = 3009
ctrl = 0
sprpriority = -2

[state 3007, removexplod]
type = removeexplod
trigger1 = time = 0
id = 3008

[state 3007, explod]
type = explod
trigger1 = time =0
trigger1 = !numexplod(3009)
anim = 3019
postype = p1
pos = 0,0
bindtime = -1
id = 3009
sprpriority = 2
scale = const(size.xscale),const(size.yscale)

[State 3008, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 24
ampl = -18

[State 3007, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0
persistent = 0

[state 3008]
type = nothitby
trigger1 = 1
value = SCA

[state 3009, posset]
type = posset
trigger1 = time = 0
y = 0

[state 3009, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1042, no push]
type = playerpush
trigger1 = 1
value = 0

[state 3009, sprpriority]
type = sprpriority
trigger1 = animtime = 0
value = 3

[state 1042, end]
type = changestate
trigger1 = animtime = 0
value = 646

;--------------------------------------------------------------------------
;Crane helper
[statedef 3010]
type = A
movetype = I
physics = N
velset = 0,0
anim = 3010
sprpriority = -4

[state 3010, nothitby]
type = nothitby
trigger1 = 1
value = SCA

;-----------------------------
;Rotate in
;-----------------------------
[state 3010, rotate]
type = angledraw
trigger1 = time = 0
value = -90

[state 3010, stop]
type = angledraw
trigger1 = time > 0  && time < 18
value = -90+(time*5)
persistent = 1

[state 3010, stop]
type = angledraw
trigger1 = time = 18
value = 0

;--------------------------------
;Stutter
;--------------------------------

[state 3010, stutter]
type = posadd
triggerall = root,anim = 3006
trigger1 = root,animelemtime(2) = 0
trigger2 = root,animelemtime(5) = 0
trigger3 = root,animelemtime(8) = 0
trigger4 = root,animelemtime(13) = 0
y = 20

[state 3010, stutter]
type = posadd
triggerall = root,anim = 3006
trigger1 = root,animelemtime(2) = 6
trigger2 = root,animelemtime(5) = 6
trigger3 = root,animelemtime(8) = 6
trigger4 = root,animelemtime(13) = 6
y = -18





;-------------------------------------
;Drops
;-------------------------------------
[state 3010, impact 1]
type = velset
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(2)=0
y = 0

[state 3010, impact 2]
type = velset
triggerall = root,anim = 3006
trigger1 = root,animelemtime(5)=0
trigger2 = root,animelemtime(8)=0
trigger3 = root,animelemtime(13) = 0
y = 0


[state 3010, Jump off]
type = veladd
triggerall = root,anim = 3007
trigger1 = root,animelemtime(3) = 0
y = 24

[state 3010, popbackup]
type = veladd
triggerall = root,anim = 3007
trigger1 = root,animelemtime(3) > 0 && root,animelemtime(4) < 10
y = -2.4

[state 3010, stop]
type = velset
trigger1 = root,anim = 3007
trigger1 = root,animelemtime(5) = 0
y = 0

;-----------------------------------------------
; Lift
;-----------------------------------------------



[state 3006, velmul]
type = veladd
triggerall = vel y > -4 ;-15
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(3) > 0 && root,animelemtime(13) < 0
y = -0.2
persistent = 1

[state 3006, velmul]
type = velset
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(13) = 8
y = 0




;------------------------------------------------
;Play Snd
;------------------------------------------------

[state 3010, impact 1]
type = Playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(2)=0
value = S3010,0

[state 3010, impact 1]
type = Playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(2)=4
value = S3010,1

[state 3010, impact 2]
type = playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(5)=0
value = S3010,0

[state 3010, impact 2]
type = playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(5)=4
value = S3010,2

[state 3010, impact 2]
type = playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(8)=0
value = S3010,0

[state 3010, impact 2]
type = Playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(8)=4
value = S3010,1

[state 3010, impact 2]
type = playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(13)=0
value = S3010,0

[state 3010, impact 2]
type = playsnd
trigger1 = root,anim = 3006
trigger1 = root,animelemtime(13)=4
value = S3010,2

[state 3010, impact 1]
type = Playsnd
trigger1 = root,anim = 3007
trigger1 = root,animelemtime(2)=0
value = S3010,1



[state 3010, destroyself]
type = changestate
trigger1 = time = 230
value = 3011

;--------------------------------------------------------------------------
;Crane helper Leave
[statedef 3011]
type = U
movetype = I
physics = N
velset = 0,0
anim = 3010
sprpriority = -4

[state 3010, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3010, rotate]
type = angledraw
trigger1 = time = 0
value = 0

[state 3010, stop]
type = angledraw
trigger1 = time > 0  && time < 9
value = 0-(time*10)
persistent = 1

[state 3010, stop]
type = angledraw
trigger1 = time >= 9
value = -90

[state 3010, destroyself]
type = destroyself
trigger1 = time = 10

;--------------------------------------------------------------------------
;camera bind
[statedef 3012]
type = A
movetype = I
physics = N
anim = 9999

[state 3012, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,1
persistent = 1

[state 3012, posset]
type = posset
trigger1 = 1
y = root,pos y - 400
persistent = 1

[state 3012, destroystuff]
type = destroyself
trigger1 = time = 240
trigger2 = root,anim = 3007
trigger2 = root,animelemtime(3) = 0



;--------------------------------------------------------------------------
;opponent landing
[Statedef 3015]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 3015, hitby]
type = hitby
trigger1 = 1
value = SCA

[state 3015, anim]
type = changeanim2
trigger1 = time = 0
value = 1205


;[state 3015, end]
;type = selfstate
;trigger1 = animtime = 0
;value = 5100

;[State 1215, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050


;--------------------------------------------------------------------------
;Super Crushed state
; Moderate Crushed State
[statedef 3020]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 1

[state 3020, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[state 3020, anim]
type = changeanim
trigger1 = anim = 5080
trigger1 = time = 24
value = 5110

[State 660, flatten]
type = AngleDraw
trigger1 =  1
value = 0
scale = 1.3,0.1
ignorehitpause = 1
persistent = 1

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 660, invunerability]
type = nothitby
trigger1 = 1
value = SCA

[State 660, 5]
type = PosSet
trigger1 = 1
y = 0



[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0
x = 0


[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 150 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 30
value = 5150

;--------------------------------------------------------------------------
; Trunk Throwdown with Butt Crush  Damage: 320
;--------------------------------------------------------------------------

;Light version - infinite armored move

;Anti Air Trunk Light
[statedef 3040]
type = S
movetype = A
physics = S
poweradd = 0
anim = 3040
sprpriority = 2
ctrl = 0

[state 3040, invun]
type = nothitby
trigger1 = animelemtime(8) < 0
value = SCA


[state 3040, no bg]
type = assertspecial
trigger1 = animelemtime(1) > 0  && animelemtime(6) < 0
flag = nobg
ignorehitpause = 1

[State 3040, Super A]
type = SuperPause
trigger1 = animelemtime(1) = 0
sound = S3000, 0
poweradd = -1000
pos = 10,-100
time = 60
movetime = 60


[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(1) >= 0 && animelemtime(3) < 11
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(const(size.xscale)),(3-(time*0.15))*(const(size.yscale))
pos = 0,60-time*5
ownpal = 1


[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(3) = 12
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
pausemovetime = 60
removetime = 45
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ownpal = 1

[State 3040, 1]
type = HitDef
trigger1 = !movecontact
attr = S, HT          
hitflag = AF
guardflag =       
priority = 1, Miss    
sparkno = -1             
p1facing = 1
p2facing = 1 
id = 3040 
guard.velocity = -3
airguard.velocity = -3, -5        
p1stateno = 3041      
p2stateno = 3050 
guard.dist = 0     
    

[State 3040, 4]
type = EnvShake
trigger1 = animelem = 5
time = 12
ampl = 8

[state 3040, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1


[state 3040, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 460,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 3040, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 290,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 3040, playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
value = S1200,0


[state x, combo dampener]
type = varset
trigger1 = var(18) < 70
v = 18
value = 70
persistent = 0
ignorehitpause =1 
             
[state 1200, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Throw portion
[statedef 3041]
type    = S
movetype= A
physics = S
anim = 3041
sprpriority = 4


[state 3041, width]
type = width
trigger1 = 1
edge = 110,110

[state 3041, varad]
type = varadd
trigger1= time = 0
var(9) = -1
ignorehitpause
persistent = 0

[State 3041, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

;Explod layered animation====================
[state 3041, buttcheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1210) 
id = 1210
anim = 1212
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
sprpriority = 4

[state 3041, sprpriority]
type = sprpriority
trigger1 = animelem = 4
value = 1


; Bindings  =================================
[State 3041, Bind 1] 
type = TargetBind
trigger1 = AnimElemtime(1) >= 0 && Animelemtime(2) < 0
pos = 642,-638

[State 3041, Bind 2]
type = TargetBind
trigger1 = AnimElemtime(2) >= 0 && Animelemtime(3) < 0
pos = 540,-654

[State 3041, Bind 3]
type = TargetBind
trigger1 = AnimElemtime(3) >= 0 && Animelemtime(4) < 0
pos = 112,-686

[State 3041, Bind 4] 
type = TargetBind
trigger1 = AnimElemtime(4) >= 0 && Animelemtime(5) < 0
pos = -210,-584

[State 3041, Bind 5]
type = TargetBind
trigger1 = AnimElemtime(5) >= 0 && Animelemtime(6) < 0
pos = -74,-408

[State 3041, Bind 6]
type = TargetBind
trigger1 = AnimElemtime(6) >= 0 && Animelemtime(7) < 0
pos = -56,-408

[State 3041, Bind 7]
type = TargetBind
trigger1 = AnimElemtime(7) >= 0 && Animelemtime(8) < 0
pos = -51,-408


[State 3041, Bind 8]
type = TargetBind
trigger1 = AnimElemtime(8) >= 0 && Animelemtime(9) < 0
pos = -56,-408

[State 3041, Bind 9]
type = TargetBind
trigger1 = AnimElemtime(9) >= 0 && Animelemtime(10) < 0
pos = -62,-408

[State 3041, Bind 10]
type = TargetBind
trigger1 = AnimElemtime(10) >= 0 && Animelemtime(11) < 0
pos = -16,-400

[State 3041, Bind 11]
type = TargetBind
trigger1 = AnimElemtime(11) >= 0 && Animelemtime(12) < 0
pos = 46,-342


[State 3041, Bind 12]
type = TargetBind
trigger1 = AnimElemtime(12) >= 0 && Animelemtime(13) < 0
pos = -200,-626


[State 3041, Bind 13]
type = TargetBind
trigger1 = AnimElemtime(13) >= 0 && Animelemtime(14) < 0
pos = -122,-780


[State 3041, Bind 14]
type = TargetBind
trigger1 = AnimElemtime(14) >= 0 && Animelemtime(15) < 0 
pos = 196,-922

[State 3041, Bind 15]
type = TargetBind
trigger1 = AnimElemtime(15) >= 0 && Animelemtime(16) < 0 
pos = 568,-782

[State 3041, Bind 16]
type = TargetBind
trigger1 = AnimElemtime(16) >= 0 && Animelemtime(17) < 0 
pos = 832,-326

[State 3041, Bind 17]
type = TargetBind
trigger1 = AnimElemtime(17) >= 0 && Animelemtime(17) < 23
pos = 776,-56




;FX  =================================================
[State 3041, 4]
type = EnvShake
trigger1 = animelem = 5
time = 10
ampl = 8

[state 3041, 4]
type = playsnd
trigger1 = animelem = 5
value = S0,1

[state 3041, front foot front dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 170,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 3041, front foot back dust]
type = explod
trigger1 = animelem = 5
anim = F120
pos = 358,0
scale = 2, 2
ontop = 1
ownpal = 1

[state 3041, 12 sfx]
type = playsnd
trigger1 = animelem = 5
persistent = 0
value = S1200,0


[state 3041, 12 sfx]
type = playsnd
trigger1 = animelem = 12
persistent = 0
value = S0,3

[State 3041, 12 quake]
type = EnvShake
trigger1 = animelem = 17
persistent = 0
time = 24
ampl = -24
ignorehitpause = 1

[state 3041, fx]
type = explod
trigger1 = animelem = 17
anim = 1500
pos = 150,5
scale = 0.75,0.75
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 3041, fx]
type = explod
trigger1 = animelem = 17
anim = 1501
pos = 150,5
scale = 0.75,0.75
sprpriority = -3
ignorehitpause = 1
ownpal = 1

[state 3041, fx]
type = explod
trigger1 = animelem = 17
anim = F61
pos = 714,0
scale = 2,1
ignorehitpause
ownpal = 1

[state 3041, 12 sfx]
type = playsnd
trigger1 = animelem = 17
persistent = 0
value = S0,0

;Physics ========================================
[state 3041, Leap back]
type = velset
trigger1 = animelemtime(12) = 0
x = -24
y = -15

[state 3041, gravity]
type = veladd;gravity
trigger1 = pos y < -1
trigger1 = animelemtime(12) > 0
y = 1.25
persistent = 1

[state 3041, landing]
type = velset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
x = 0
y = 0

[state 3041, Landing]
type = posset
trigger1 = animelemtime(12) > 0
trigger1 = pos y > 0
trigger2 = animelemtime(17) = 0
y = 0

;Attack Data ============================================
[State 3041, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 17
persistent = 0
value = floor(-80*fvar(10))
kill = 0

[state 3041, hit add]
type = hitadd
trigger1 = pos y >= 0
trigger1 = animelem = 17
value = 1

[state 3041, hit add]
type = hitadd
trigger1 = animelem = 5
value = 1

[State 3041, Hurt end]
type = TargetLifeAdd
trigger1 = animelem = 5
persistent = 0
value = floor(-20*fvar(10))
kill = 0

[state 3041, movehit energy]
type = poweradd
trigger1 = animelem = 17
value = 0
persistent = 0

[state 3041, targetpoweradd]
type = targetpoweradd
trigger1 = animelem = 17
value = floor(enemynear,powermax % 10)
persistent = 0 

[State 3041, State End]
type = ChangeState
trigger1 = animtime = 0
value = 3042


;--------------------------------------------------------------------------
; Jump Back
;Jumpback
[Statedef 3042]
type    = S
movetype= I
physics = N
anim = 41
sprpriority = 3

[state 304X, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3042, jump]
type = velset
trigger1 = time = 0
x = -4
y = -12

[state 3042, gravity]
type = gravity
trigger1 = pos y < -1

[state 3042, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3043

[state 3042, nothitby]
type = nothitby
trigger1 = 1
value = SCA

;---------------------------------------------------------------------------------
;Butt Drop
[Statedef 3043]
type    = A
movetype= A
physics = N
sprpriority = 3
ctrl = 0

[state 304X, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3043, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3043, posset]
type = posset
trigger1 = time = 0
y = 0

[State 52, 4]
type = EnvShake
trigger1 = time = 0
time = 12
ampl = -8
freq = 100
phase = 100

[state 52, 4]
type = playsnd
trigger1 = time = 0
value = S0,1

[state 3043, animation]
type = changeanim
trigger1 = anim != 3043
value = 3043

[State 3043, 1]
type = EnvShake
trigger1 = movehit = 1
persistent = 0
time = 10
ampl = 8

[state 3043, width]
type = width
trigger1 = animelem = 8
value = 45,-60
  

[state 3043, gravity]
type = gravity
trigger1 = animelemtime(7) > 0
ignorehitpause = 0
persistent = 1

[state 3042, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3043, Launching]
type = velset
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
persistent = 1
y = -18 ;40

[state 41, takeoff sfx]
type = playsnd
trigger1 = animelem = 3
value = 0,9

[state 41, fx]
type = explod
trigger1 = animtime = 3
anim = F61
pos = 40,5
scale = 4,4

[state 3043, forward momentum]
type = velset
trigger1 =animelemtime(3) >= 0 && animelemtime(4) < 0
x = 32 ;28

[state 3043, stop]
type = velset
trigger1 = animelemtime(4) = 0
x = 0
y = 0

[state 52, 4]
type = playsnd
trigger1 = animelemtime(7) = 0
value = S1,0

[state 3043, fall]
type = veladd
trigger1 =animelemtime(8) > 0
x = 0
y = 7.2

[state 3043, go to bounce]
type = changestate
triggerall = animelemtime(3) > 1
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3044

;--------------------------------------------------------------------------
;impact
[statedef 3044]
type    = C
movetype= A
physics = C
anim = 641
ctrl = 0

[state 304X, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3044, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1007, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0

[state 41, fx]
type = explod
trigger1 = time = 1
anim = F61
pos = 40,5
scale = 4,4

[state 3044, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 3044, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 3044, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 3044, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -2
ownpal = 1

[state 3044, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[State 3044, 3]
type = HitDef
trigger1 = animelem = 1
attr = C, HA
damage = 250
getpower = 0
persistent = 0
Hitflag = FD
guardflag = 
priority = 7
sparkno = -1
hitsound   = S1,2
fall.recover = 0
pausetime = 0,0
guard.pausetime = 8, 10
sparkxy = -10,-40
ground.velocity = 0,0
air.velocity = 0, 0
animtype = Heavy

[state 3044, playsnd]
type = playsnd
trigger1 = time = 0
value = S1,2


[state 3044, flatten]
type = targetstate
trigger1 = time = 0
trigger1 = p2life > 0
value = 660

[state 3044, wedge]
type = targetstate
trigger1 = time = 0
trigger1 = p2life <= 0
value = 650

[state 3044, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -250)
id = 3040

[state 3044, wedge var]
type = varset
trigger1 = p2life <= 0
trigger1 = time = 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 3044, sprite priority]
type = sprpriority
trigger1 = movecontact
value = 2

[state 3044, slowdown]
type = velmul
trigger1 = time = 0
x = 0.5

[state 3044, on ground]
type = posset
trigger1 = time = 0
y = 0

[State 3044, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 60
ampl = 40
freq = 75
phase = 75

[State 3044, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0

[state 3044, end]
type = changestate
trigger1 = time = 12
ctrl = 0
value = 3045
;-------------------------------------------------------------------------
; bounce
[statedef 3045]
type    = A
movetype= I
physics = N
ctrl = 0

[state 304X, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3045, velocity]
type = velset
trigger1 = time = 0
y = -25

[state 3045, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 3045, gravity]
type = gravity
trigger1 = time > 0

[state 3045, end]
type = changestate
trigger1 = pos y >= 0
trigger1 = time > 1
value = 3046

;----------------------------------------------------
;landing
[statedef 3046]
type    = C
movetype= I
physics = N
anim = 643
ctrl = 0

[state 304X, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3046, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3046, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[state 3046, on ground]
type = posset
trigger1 = time = 0
y = 0

[State 3046, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 12


[State 3046, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0

[state 3046, end]
type = changestate
trigger1 = animtime = 0
value = 5120


;---------------------------------------------------------------------------
;opponent landing
;Pancaked
[Statedef 3050]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 2

[state 3050, hitby]
type = hitby
trigger1 = 1
value = SCA

[state 3050, screenbound]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 3050, anim]
type = changeanim2
trigger1 = time = 0
value = 1205


[state 3050, end]
type = changestate
trigger1 = animtime = 0
value = 3052
;[State 1205, 2]
;type = SelfState
;trigger1 = !gethitvar(isbound)
;value = 5050


;---------------------------------------------------------------------------
;Super Crushed State
[statedef 3052]
type    = L
movetype= H
physics = N
ctrl = 0


[state 3052, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[state 3052, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3052, passthrough]
type = playerpush
trigger1 = 1
value = 0

[state 3052, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[State 3052, Width]
type = Width
trigger1 = time > 0
value = 10,10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0
x = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

;[state 662, hitby]
;type = hitby
;trigger1 = 1
;value = SCA,AA

[State 662, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 662, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 662, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 300
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 150
value = 5150
;--------------------------------------------------------------------------
;Vicious Butt Crush Damage: 300 & projectile immune
;--------------------------------------------------------------------------

[statedef 3080]
type    = A
movetype= A
physics = S
sprpriority = 2
ctrl = 0
velset = 0,0
anim = 3080

[state 3080, posset]
type = posset
trigger1 = time = 0
y = 0

[state 3080, invun]
type = nothitby
trigger1 = 1
value = SCA
time = 1

[state 3080, no bg]
type = assertspecial
trigger1 = animelemtime(2) >= 0 && animelemtime(2) < 60
flag = nobg
ignorehitpause = 1

[State 3080, Super A]
type = SuperPause
trigger1 = animelemtime(2) = 0
sound = S3000, 0
poweradd = -1000
pos = 10,-100
time = 60
movetime = 60


[state 3080, Super Portrait]
type = explod
trigger1 = animelemtime(2) =[0, 14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 1
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(const(size.xscale)),(3-(time*0.15))*(const(size.yscale))
pos = 0,60-time*5
ownpal = 1


[state 3080, Super Portrait]
type = explod
trigger1 = animelemtime(2) = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 40
removetime = 45
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ownpal = 1

[state 3080, invun]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
time = 1

[state 3080, var]
type = varset
trigger1 = time = 0
v = 23
value = 4

[state 3080, combo damage score]
type = varset
trigger1 = var(18) < 70
v = 18
value = 70

[State 3080, 7]
type = ChangeState
trigger1 = animtime = 0
value = 3081


;---------------------------------------------------------------------------
;Going Up
[statedef 3081]
Type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 42

[state 41, takeoff sfx]
type = playsnd
trigger1 = time = 0
value = 0,9

[state 41, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 40,-5
scale = 3,3

[state 3081, invun]
type = nothitby
trigger1 = time <= 8
value = SCA
ignorehitpause = 1
time = 1

[state 3081, invun]
type = nothitby
trigger1 = time > 8
value = ,AP
ignorehitpause = 1
time = 1

[state 3081, movement]
type = velset
trigger1 = time = 0
x = ifelse(p2bodydist x < 900, floor(p2dist x * 0.0666), 60)
y = -60

[state 3081, gravity]
type = gravity
trigger1 = pos y < -1

;[state 3081, stop]
;type = velset
;trigger1 = p2dist x <= 0
;x = 0

[state 3081, varset]
type = varset
trigger1 = time = 0
v = 15
value = 1
persistent = 0

[state 3081, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 3081, elephant sfx]
type = playsnd
trigger1 = time = 14
persistent = 0
value = S1000,random%3
channel = 1

[state 3081, end]
type = changestate
trigger1 = time = 15
value = 3082

;--------------------------------------------------------------------------
;coming down EX version
[Statedef 3082]
type = A
movetype = A
physics = N
juggle = 0
ctrl = 0
anim = 640

[state 3082, invun]
type = nothitby
trigger1 = 1
value = ,AP
ignorehitpause = 1
time = 1

[state 3082, control]
type = veladd
trigger1 = command = "holdfwd"
x = 0.4

[state 3082, control]
type = veladd
trigger1 = command = "holdback"
x = -0.4

[state 3082, freeze]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3082, fall]
type = veladd
trigger1 = time > 8
y = 7.2

[state 3082, no push]
type = playerpush
trigger1 = 1
value = 0

[State 3082, 3]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = A, HA
damage = 0,96
guardflag = HA
hitflag = MAFD
hitsound = S1,2
priority = 4
getpower = 0
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 56
sparkno = -1
guardsound = 6,0
guard.velocity = -14
airguard.velocity = -12,4
guard.slidetime = 60
animtype = heavy
down.hittime = 40
ground.type = High
guard.dist = 180

;Ride down mechanic
[state 3082, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = enemy,statetype = A
trigger1 = p2life > 0
pos = 0, -20

[state 3082, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype = A
trigger1 = p2life > 0
value = 1006

[state 3082, end]
type = targetstate
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1006
value = 661
;-------------------

[state 3082, flatten]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype != A
trigger1 = p2life > 0
value = 661

[state 3082, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 3082, wedge var]
type = varset
trigger1 = p2life <= 0
trigger1 = numenemy <= 1
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 3082, end miss]
type = changestate
triggerall = movehit = 0
trigger1 = pos y >= 2
value = 645


[state 3082, end hit]
type = changestate
triggerall = movehit != 0
trigger1 = pos y >= 2
value = 3083
;---------------------------------------------------------------------------
; vicious bounces Land
[statedef 3083]
type    = C
movetype= A
physics = N
anim = 641
sprpriority = 2


[state 642, crater]
type = explod
triggerall = !numexplod(2010)
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = !numexplod(2011)
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 3083, Can't be thrown]
type = NotHitBy
trigger1 = 1
value = ,AP
ignorehitpause = 1


[state 3083, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3083, no push]
type = playerpush
trigger1 = 1
value = 0


[state 3083, on ground2]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 3083, 3]
type = HitDef
trigger1 = 1
attr = C, HA
damage = 64
persistent = 0
getpower = 0
Hitflag = FD
guardflag = 
hitsound = S0,8
priority = 7, hit
sparkno = -1
getpower = 0
fall.recover = 0
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 95

[state 3083, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661
persistent = 0

[state 3083, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650
persistent = 0

[state 3083, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1


[State 3083, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 12

[State 3083, thud]
type = PlaySnd
trigger1 = time = 0
value = S0, 0



[state 3083, var counter]
type = varadd
trigger1 = time = 0
var(23) = -1

[state 3083, repeater]
type = changestate
trigger1 = time = 8
value = 3084
;---------------------------------------------------------------------------
;Bounce repeater
[Statedef 3084]
type    = A
movetype= A
physics = N
anim = 640
sprpriority = 2

[state 3084, invun]
type = nothitby
trigger1 = 1
value = ,AP


[state 3084, nudge]
type = veladd
trigger1 = command = "holdfwd"
x = 0.4

[state 3084, nudge]
type = veladd
trigger1 = command = "holdback"
x = -0.4

[state 3084, movement]
type = velset
triggerall = Var(23) = 0
trigger1 = time = 0
y = -42

[state 3084, no push]
type = playerpush
trigger1 = time >= 0
value = 0

[state 3084, veladd]
type = veladd
trigger1 = vel y > 3
y = 6
persistent = 1

[state 3084, movement]
type = velset
Triggerall = Var(23) = 1
trigger1 = time = 0
y = -27

[state 3084, movement]
type = velset
triggerall = Var(23) = 2
trigger1 = time = 0
y = -27

[state 3084, movement]
type = velset
triggerall = Var(23) >= 3
trigger1 = time = 0
y = -27

[State 3084, 3]
type = HitDef
trigger1 = 1
attr = A, HA
damage = 64
persistent = 0
hitsound = S0,8
Hitflag = MA
guardflag = H
priority = 7
getpower = 0
sparkno = -1
fall.recover = 0
pausetime = 0,0
guardsound = 6,0
animtype = Heavy

[state 3084, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661
persistent = 0

[state 3084, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650
persistent = 0

[state 3084, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[state 3084, gravity]
type = gravity
trigger1 = time > 0

[state 3084, spiking]
type = veladd
trigger1 = time > 14
y = 0.3


[state 3084, go to bounce]
type = changestate
triggerall = var(23) > 0
triggerall = time > 8
trigger1 = pos y >= 0
value = 3083

[state 3084, end]
type = changestate
triggerall = var(23) <= 0
triggerall = time > 8
trigger1 = pos y >= 0
value = 3085

;--------------------------------------------------------------------------
;EX vicious butt drops End
[Statedef 3085]
type  = C
movetype = A
physics = C
anim = 643
velset = 0,0
sprpriority = 2

[state 641, Thwomp Grunt]
type = playsnd
trigger1 = time = 1
value = S641,0


[state 642, crater]
type = explod
trigger1 = time = 0
anim = 2010
id = 2010
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, crater]
type = explod
trigger1 = time = 0
anim = 2011
id = 2011
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
ownpal = 1

[state 642, dust]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = time = 0
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

[state 3085, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 3085, height indicator]
type = varset
trigger1 = 1
V = 15
value = 0

[state 3085, invun]
type = nothitby
trigger1 = 1
value = ,AP


[state 3085, 1]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = p2life > 0
value = 646
ctrl = 0

[state 3085, 2]
type = changestate
trigger1 = animtime = 0
trigger1 = p2life <= 0
value = 648
ctrl = 0

[state 3085, width]
type = width
trigger1 = 1
value = 0,0

[State 3085, 3]
type = HitDef
trigger1 = 1
attr = C, SA
damage = 64
persistent = 0
Hitflag = FD
guardflag = 
priority = 7
sparkno = -1
fall.recover = 0
hitsound = S1,2
pausetime = 0,0
guard.pausetime = 12,10
guard.hittime = 20
guardsound = 6,0
animtype = Heavy
guard.dist = 95

[state 3085, flatten]
type = targetstate
trigger1 = movehit
trigger1 = p2life > 0
value = 661

[state 3085, wedge]
type = targetstate
trigger1 = movehit
trigger1 = p2life <= 0
value = 650

[state 3085, wedge var]
type = varset
trigger1 = p2life <= 0
V = 25
value = 1
persistent = 1
ignorehitpause = 1

[State 3085 thud]
type = PlaySnd
trigger1 = time = 1
value = 0, 0

[state 3085, no push]
type = playerpush
trigger1 = time >= 0
value = 0


[State 3085, shake]
type = EnvShake
trigger1 = Time = 1
time = 25
ampl = 10
freq = 100
phase = 100


;---------------------------------------------------------------------------




;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------
; Stand - custom only to set the variable
;---------------------------------------------------------------------------
;Win Poses
; Win - Winners Seat
[Statedef 18300]
type = S
movetype = A
ctrl = 0
physics = N
velset = 0,0

[state 18300, no push]
type = playerpush
trigger1 = 1
value = 0

[State 183, front walk back dust 1]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 2 
trigger1 = command = "holdfwd"
pos = 60, 0
spacing = 1

[State 20, front walk front dust 1]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 2
trigger1 = command = "holdfwd"
pos = 100, 0
spacing = 1

[State 20, front walk balk dust 2]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 10
trigger1 = command = "holdfwd"
pos = 70, 0
spacing = 1

[State 20, front walk front dust 2]
type = MakeDust
triggerall = anim = 20
trigger1 = animelem = 10
trigger1 = command = "holdfwd"
pos = 120, 0
spacing = 1

[state 20, quake]
type = envshake
triggerall = anim = 20
trigger1 = animelem = 2
time = 10
ampl = 8


[state 20, sound1]
type = playsnd
triggerall = anim = 20
trigger1 = animelem = 2
value = S0,1

[state 20, quake]
type = envshake
triggerall = anim = 20
trigger1 = animelem = 10
time = 10
ampl = 8


[state 20, sound1]
type = playsnd
triggerall = anim = 20
trigger1 = animelem = 10
value = S0,1

[state 18300, start walk]
type = changeanim
trigger1 = time = 3
value = 20

[state 18300, walk]
type = velset
trigger1 = anim = 20
x = const(velocity.walk.fwd.x)

[state 18300, endwalk]
type = velset
triggerall = anim = 20
trigger1 = Abs(pos x - helper(185),pos x) = [-1,1]
x = 0

[state 18300, end]
type = changeanim
trigger1 = anim = 20
trigger1 = Abs(pos x - helper(185),pos x) = [-1,1]
value = 41 

[state 18300, jump move]
type = velset
triggerall = anim = 41
trigger1 = Abs(pos x - helper(185),pos x) = [-1,1]
y = -12
x = 2
persistent = 0


[state 18300, grav]
type = gravity
trigger1 = anim = 41 || anim = 640


[state 183, change anim]
type = changeanim
trigger1 = anim = 41
trigger1 = vel y > 0
value = 640

[state 183, landing]
type = velset
triggerall = anim = 640
trigger1 = pos y > -vel y
trigger1 = vel y >= 0
y = 0 
x =0

[state 18300, sit pose]
type = changestate
triggerall = anim = 640
trigger1 = vel y = 0
value = 18400

[state 642, dust]
type = explod
trigger1 = anim = 184
anim = 1500
pos = 40,0
ontop = 1
persistent = 0

[state 642, dust 2]
type = explod
trigger1 = anim = 184
anim = 1501
pos = 40,0
sprpriority = -3
persistent = 0



;---------------------------------------------------------------------------
;Win - Victory landing
[statedef 18400]
type = S
anim = 184
ctrl = 0


[state 18400, 1]
type = velset
trigger1 = 1
y = 0

[state 18400, dust 2]
type = explod
trigger1 = time = 1
anim = 1501
pos = 40,0
sprpriority = -4
persistent = 0

[state 18400, quake]
type = envshake
trigger1 = time = 1
time = 30
ampl = 12
persistent = 0

[state 184, sound1]
type = playsnd
trigger1 = anim = 184
value = S0,0
persistent = 0
;---------------------------------------------------------------------------
;Win - Wedge
[Statedef 18500]
Type = S
sprpriority = -3
ctrl = 0

[state 18500, target]
trigger1 = time = 0
type = targetstate
ID = 30
value = 651

[state 18500, width]
type = width
trigger1 = 1
edge = 60,480

[state 18500, nopush]
trigger1 = 1
type = playerpush
value = 0


[state 18500, width]
type = width
trigger1 = 1
edge = 60,100

[state 18500, 1]
type = changeAnim
trigger1 = anim != 185
value = 185

[state 18500, posadd]
type = posadd
trigger1 = animelem = 2
x = 50

[state 18500, posadd]
type = posadd
trigger1 = animelem = 3
x = 30

[state 18500, posadd]
type = posadd
trigger1 = animelem = 5
x = -20

[state 18500, posadd]
type = posadd
trigger1 = animelem = 6
x = -40

[state 18500, posadd]
type = posadd
trigger1 = animelem = 7
x = -20

[state 18500, posadd]
type = posadd
trigger1 = animelem = 8
x = -40

[state 18500, posadd]
type = posadd
trigger1 = animelem = 9
x = -20

[state 18500, snd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(9) = 0
value = S0,1

[state 18500, envshake]
type = envshake
trigger1 = animelem = 5
trigger2 = animelem = 9
ampl = -8
time = 10

[state 181, announce]
type = playsnd
trigger1 = time = 10
trigger1 = life != lifemax
value = S180,1

[state 181, announce]
type = playsnd
trigger1 = time = 10
trigger1 = life = lifemax
value = S180,1




[state 18500, 2 back portions]
type = explod
trigger1 = animelemtime(2) = 0
trigger1 = anim = 185
trigger1 = !numexplod(186)
scale = Const(size.xscale),Const(size.yscale)
anim = 186
ID = 186
sprpriority = 4
postype = p1
pos = 0,0
bindtime = -1

[state 18500, winpose duration]
type = assertspecial
trigger1 = time < 148
flag = roundnotover
persistent = 1


;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy's projectile (helper). For use with AI.
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy's projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy's projectile helper's distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy's projectile helper's velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
 
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
;==========================================================================
;                Detect Enemy's Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = cond(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = cond(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = cond(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = cond(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = cond(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = cond(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = cond(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = cond(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = cond(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = cond(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 



;===========================================================================
;-----------------------------------Push Block------------------------------
;===========================================================================


;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------
[statedef -2]

;Jumbo Elephant is © Kazecat 2016
[state -2, author and copyright]
type = displaytoclipboard
trigger1 = 1
;text = "Jumbo Elephant is (c) Kazecat 2016"
text = "Distance Opp. X: %d, Y: %d, Position Y: %f Armor HP:  %d"
params = p2bodydist x, p2bodydist y, pos y, var(20)
;===========================================================================
; ---------------------------------Victory Quotes---------------------------
;===========================================================================

[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%5)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ana 'Jiggly' Bunny"
value = 6+(random%4)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ryu"
value = 10+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ken"
value = 12+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Hulk"
trigger2 = enemy, name = "Savage Hulk"
trigger3 = enemy, name = "MVC2 Hulk By Kamekaze"
value = 14+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Juggernaut"
trigger2 = enemy, name = "Da Juggernaut "
trigger3 = enemy, name = "Juggernaut by Splode"
value = 16+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Kung Fu Man"
value = 18+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Zangief"
trigger2 = enemy, name = "ZangiefHD"
value = 20+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumbo Elephant"
value = 23+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Katrina Crocodile"
value = 25+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Bertha Hippo"
value = 28+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Enorma Pig"
value = 31+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Aroma Skunk"
value = 34+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Lardo Rat"
value = 37+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Zafta Giraffe"
value = 40+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Makuyama"
value = 43+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Pastilla Skunk"
value = 46+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumba Elephant"
value = 49+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Twiggi Bunny"
value = 52+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Ra Lord"
value = 55+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Violet 'Tyla' Bunny"
value = 58+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Julian Hippo"
value = 61+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Rapid Bunny"
value = 64+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Noah Sharker"
value = 67+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Akai R. Panda"
trigger1 = palno != 2
value = 70+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Akai R. Panda"
trigger1 = palno = 2
value = 73
ignorehitpause =1
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Andy Armadillo"
value = 74+(random%3)
ignorehitpause = 1
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Montana Moth"
value = 77+(random%3)
ignorehitpause = 1
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Texas Stanton"
value = 80+(random%3)
ignorehitpause = 1
persistent = 1





;-----------------------------------------
; Win Quotes End
;-----------------------------------------


;==========================================
;Super Armor Delay
;==========================================

[state -2, counter]
type = varset
trigger1 = gethitvar(damage) != 0
v = 32
value = 0
ignorehitpause = 1

[state -2, count]
type = varadd
trigger1 = var(32) < var(33)
v = 32
value = 1
ignorehitpause = 0

[state -2, delay conter set]
type = varset
trigger1 = 1
v = 33
value = 90

;============================================================================
;----------------------------------------------------------------------------
;============================================================================

[state -2, wedge intitiate]
type = varset
trigger1 = roundstate = 0
trigger1 = p2life != 0
V = 30
value = 0
persistent = 0

;Win - Wedge pose indicator
[state -2, Wedge]
type = removeexplod
trigger1 = anim != 185
ID = 186

;Weight Detection
;If needed add or remove from this list those that have great strength to move him.
;All Grapplers/Power Archetypes should be allowed to Throw him and nothing else IMO.   
[state -2, Those strong enough to throw him]
type = varset
triggerall = numenemy
trigger1 = enemy,name = "Savage Hulk"
Trigger2 = enemy,name = "Superman"
Trigger3 = enemy,name = "Juggernaut"
trigger4 = enemy,name = "ZangiefHD"
trigger5 = enemy,name = "Kimala"
trigger6 = enemy,name = "Bertha Hippo"  || enemy, name = "Jumba Elephant" || enemy,name = "Luna Bunny"
trigger7 = enemy,name = "Goku Z2" || enemy,name = "Freeza Z2" || enemy,name = "Golden Freeza Z2"
trigger8 = enemy,name = "Vegeta Z2"
trigger9 = enemy,name = "Gohan Z2"
trigger10 = enemy,name = "SSJ Goku Z2"
Trigger11 = enemy,name = "Hulk"
Trigger12 = enemy,name = "Colossus"
trigger13 = enemy,name = "Jumbo Elephant" || enemy,name = "Jumba Elephant"
trigger14 = enemy,name = "John Cena"
trigger15 = enemy,name = "Yokozuna"
trigger16 = enemy,name = "Zangief"
trigger17 = enemy,name = "Bowser"
trigger18 = enemy,name = "Wonder Woman" || enemy,name = "Wonder Woman Reloaded"
trigger19 = enemy,name = "She Hulk"
trigger20 = enemy,name = "Blubberman"
trigger21 = enemy,name = "The-Mountain"
Trigger22 = enemy,name = "Shaq"
Trigger23 = enemy,name = "2DFM95 Kinnikuman"
trigger24 = enemy,name = "Haggar"
trigger25 = enemy,name = "Katrina Crocodile"
trigger26 = enemy,name = "Kazecat" || enemy,name = "Kaze Cat"
trigger27 = enemy,name = "Power Girl"
trigger28 = enemy,name = "Makuyama" || enemy,name = "Pastilla Skunk"
trigger29 = enemy,name = "Thanos"
V = 10
value = 1


;========================================================
;-| Custom Hit stun Limiter|-----------------------------
;========================================================

[state -2, Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Air trap check]
type = varset
triggerall = numenemy
trigger1 = (enemynear,movetype != H)
trigger1 = (enemynear,statetype != A)
var(9) = 2
ignorehitpause = 1

[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemy, movetype != H)
var(11) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemy, movetype != H)
var(12) = 2
ignorehitpause = 1

[state -2, Stun Limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(13) = 2
ignorehitpause = 1

;========================================================
;Combo Scaling
;========================================================
[state -2, default damage]
type = varset
triggerall = numenemy
trigger1 = enemy, movetype != H
fvar(10) = 1
ignorehitpause = 1

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger2 = !numenemy
ignorehitpause = 1
v = 18
value = 100

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar(10)
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05
;---------------------------------------------------------------------------
;Transformed changes
;---------------------------------------------------------------------------

;Earthquakes
[State -2, quakes]
type = envshake
triggerall = time = 1
trigger1 = stateno = 1521
trigger1 = prevstateno != 1523  
trigger2 = stateno = 1527 && time = 1
time = 15
ampl = -10

;Thuds
[State -2, sfx]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 1521
trigger1 = prevstateno != 1523   
trigger2 = stateno = 1527 && time = 1 
value = S0,1 

;Huge target, Defense buff
[state -2, Defense Up]
type = defencemulset
trigger1 = stateno = [1521,1549]
trigger1 = anim = [19030, 19040]
value = 1.5


;=======================AI Detect Projectile System==========================
[state -2, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1


;Kneel Dizzy
[State -2, quakes]
type = envshake
triggerall = time = 1
trigger1 = anim = 5300
time = 25
ampl = -16

[State -2, sfx]
type = PlaySnd
triggerall = Time = 1
trigger1 = anim = 5300
value = S0,0 

;Anti Grab animation
;var 28
[state -2, Removeexplod]
type = removeexplod
triggerall = numenemy
trigger1 = enemy,stateno = 5120
trigger1 = numexplod(9997) > 2
id = 9997
ignorehitpause = 1

[state -2, Explod]
type = explod
triggerall = numenemy
trigger1 = enemy,stateno = 5120
trigger1 = enemy,animtime = -1
anim = 9997
id = 9997
pos = 0,0
postype = p1
bindtime = -1
removetime = 12
ownpal = 1
ignorehitpause = 1

[state -2, Explod]
type = explod
trigger1 = roundstate = 2
trigger1 = time = 0
anim = 9997
id = 9997
pos = 0,0
postype = p1
bindtime = -1
removetime = 12
ownpal = 1
ignorehitpause = 1
persistent = 0

;------------------------
; Voice Over
;------------------------

[State -2, Voices]
type = playsnd
trigger1 = time = 0 && (random<=250)
trigger1 = stateno = 5000 || stateno = 5010 || stateno = 5020 || stateno = 5030 || stateno = 5040
value = 5000, 0+random%3
channel = 1



;---------------------------------------------------------------
; Bear Hug check
;---------------------------------------------------------------
[state -2, bearhug check - Approval to Lunge]
type = varset
triggerall = numenemy
triggerall = stateno = 1250 || stateno = 1260 || stateno = 1270 
triggerall = enemynear,hitdefattr != SCA,NP,SP,HP
triggerall = p2bodydist x =[0, 650]
triggerall = p2stateno != 5120
;triggerall = random < ailevel*32
trigger1 = p2bodydist y = [-80,0]
trigger1 = enemynear, vel y > 0
trigger1 = enemynear,hitfall = 0
trigger2 = p2statetype != A
trigger2 = enemynear,ctrl = 0
trigger3 = p2statetype != A
trigger3 = enemynear,ctrl = 1
trigger4 = enemynear,ctrl = 0
trigger4 = enemynear,animtime > -12
trigger4 = p2statetype != A
trigger5 = enemynear,vel x = 0
trigger5 = p2statetype != A
trigger6 = p2bodydist x = [0,400]
trigger6 = p2statetype = S || p2statetype = C
v = 26
value = 1

[state -2, bearhug check - Reasons to Cancel]
type = varset
triggerall = numenemy
triggerall = stateno = 1250 || stateno = 1260 || stateno = 1270 
;triggerall = random < ailevel*32
trigger1 = p2statetype = A
trigger2 = enemynear,movetype = A
trigger2 = enemynear,hitdefattr = SCA,HA
trigger3 = p2bodydist x < 0
trigger4 = p2stateno = 0
trigger4 = enemynear,ctrl = 1
trigger4 = p2bodydist x > 650
v = 26
value = 2

[state -2, bearhug check - neutral]
type = varset
triggerall = numenemy
trigger1 = time = 0
trigger1 = stateno = 1250 || stateno = 1260 || stateno = 1270 
trigger2 = enemynear,hitdefattr = SCA,NP,SP,HP
trigger3 = p2stateno = [5100,5120]
trigger4 = numhelper(33333333)
trigger4 = PlayerIDExist(helper(33333333),var(3))
trigger4 = inguarddist
trigger5 = p2stateno = [660,669]
v = 26
value = 0

;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

;big body falls
[State -3, quakes]
type = envshake
triggerall = time = 1
trigger1 = stateno = 5100
trigger2 = stateno = 1521  && time = 0
time = 25
ampl = -16

;Weight Detection
[state -2, Can't be thrown]
type = null;NotHitBy
triggerall = numenemy
triggerall = time > 0
triggerall = enemynear,authorname != "Kazecat"
trigger1 = Var(10) = 0
value = ,NT
ignorehitpause = 1
time = 1

[State -3, sfx]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 5100
trigger2 = stateno = 1521  && time = 0
value = S0,0 

[state -3, gravity]
type = gravity
trigger1 = stateno = 5620
trigger1 = time > 0

[state -3, land]
type = changestate
triggerall = stateno = 5620
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[state 642, dust]
type = explod
trigger1 = !numexplod(2000)
trigger1 = time = 1
trigger1 = stateno = 5100
anim = 2000
id = 2000
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
ownpal = 1

[state 642, dust 2]
type = explod
trigger1 = !numexplod(2001)
trigger1 = time = 1
trigger1 = stateno = 5100
anim = 2001
id = 2001
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
ownpal = 1

