; KFM's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 1000
;attack power (more is stronger)
Power = 5000
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 15
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 0.9  ;Horizontal scaling factor.
yscale = 0.9        ;Vertical scaling factor.
; Set Jessie and Janes size in statedef 5900

ground.back = 60     ;Player width (back, ground)
ground.front = 64    ;Player width (front, ground)
air.back = 48        ;Player width (back, air)
air.front = 48       ;Player width (front, air)
height = 240         ;Height of player (for opponent to jump over)
attack.dist = 640    ;Default attack distance
proj.attack.dist = 360 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = -20, -360 ;Approximate position of head
mid.pos = -20, -240  ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 9.5      ;Walk forward
walk.back = -8.5     ;Walk backward
run.fwd  = 23.0, 0   ;Run forward (x, y)
run.back = -37.5,-8 ;Hop backward (x, y)
jump.neu = 0,-37   ;Neutral jumping velocity (x, y)
jump.back = -11,-33.6 ;Jump back Speed (x, y)
jump.fwd = 11,-33.6     ;Jump forward Speed (x, y)
runjump.back = -10.2,-24 ;Running jump speeds (opt)
runjump.fwd = 16,-24    ;.
airjump.neu = 0,-32.4     ;.
airjump.back = -10.2      ;Air jump speeds (opt)
airjump.fwd = 10          ;.
air.gethit.groundrecover = -.6,-14    ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-18     ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -4       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -8         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 6        ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 0      ;Number of air jumps allowed (opt)
airjump.height = 140 ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.76         ;Vertical acceleration
stand.friction = .85  ;Friction coefficient when standing
crouch.friction = .82 ;Friction coefficient when crouching
stand.friction.threshold = 8          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .2        ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 100          ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -80 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 40   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -4  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.4    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 60      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 80            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.6              ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 48          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .2          ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes **MUGEN 1.0**
;The default language victory quotes must be implemented in English.
[Quotes]
; Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory1 = "Yer under arrest."
victory2 = "Ain't never been t' Gold Springs before, huh partner?"
victory3 = "Y'all are far easier than mah regular outlaws."
victory4 = "That's one down, but now I gotta round up all these pesky outlaws..."
victory5 = "Ain't ah seen  your face on a wanted poster?"
victory6 = "Another outlaw rounded up."

;Jumbo

victory7 = "Ah don't care how right you think you are.  A criminal is a criminal an ah'm takin you in."
victory8 = "Lucky for me, there ain't honor among outlaws."
victory9 = "Ah think ah just about had a heart attack when that ass was fallin' toward me."

;Jiggly

victory10 = "Ain't nothin' personal, I've just  had some bad run-ins with fat-assed bunnies."
victory11 = "Haven't ah seen you around before?"
victory12 = "At least you ain't got an eleven tonne cow..."

;Katrina

victory13 = "Ah'm not sure a chest that big is legal."
victory14 = "Must be nice to have someone helpful around."
victory15 = "This is why ah steer clear o' the bayous."

;Bertha

victory16 = "Ah'm glad you ain't an outlaw.  You could bust open a bank vault with them hips!"
victory17 = "Not sure that ass'll fit in a cell..."
victory18 = "You sure you ain't part wreckin' ball?"

;Aroma

victory19 = "Sadly ah've had plenty o' practice dealin' with skunks..."
victory20 = "Can't gas out a Gold Springs gal!"
victory21 = "Y'could clear out a stable o' broncos with that stink!"

;Enorma

victory22 = "You sure you ain't got family down in Gold Springs?"
victory23 = "Ah've had mah fill of sweaty pig asses, thanks."
victory24 = "You're one hell of a shot, partner, but you were too slow on the draw."

;Lardo

victory25 = "Ah feel like ah need a couple o' hundred bath after fightin' you..."
victory26 = "You may be the grossest thing ah've ever seen, an' given where ah'm from that's sayin' somethin'."
victory27 = "Yer tail ain't a match fer mah lasso, outlaw."

;Zafta

victory28 = "Pretty sure your thigh's as big as my entire body..."
victory29 = "Lasso 'round the legs works no matter how big you are."
victory30 = "Yer a lean, mean, fightin' machine....Mind if ah get some tips?"

;Makuyama

victory31 = "Ah didn't wanna hurt ya, but I also didn't wanna end up under that ass..."
victory32 = "Usually when my foes eat mid-fight they're scarfin' down chili.  So this makes a nice change."
victory33 = "Ah don't think ah've seen a bear like you before... Size-wise, I mean."

;Pastilla

victory34 = "Half skunk, half hippo, an' all bad news."
victory35 = "Y'all didn't happen t' teach a rat name Molly, didja?"
victory36 = "Ugh, can't tell if that's dark magic or skunk farts ah'm smellin'..."

;Jumba

victory37 = "Sorry partner, but ah'm rather attached to mah third dimension."
victory38 = "Ah ain't plannin' on bein' a butt tattoo just yet!"
victory39 = "Ah don't even wanna THINK about being caught between yer ass an' Georgia's."

;Rapid

victory40 = "Ain't fast enough t' dodge an outlaw's backside, huh?"
victory41 = "Yer faster than the Gold Springs Express!"
victory42 = "From one crime fighter to another.  Ya ain't half bad, kid."

;Twiggi

victory43 = "PROMISE me that you won't teach anyone in Gold Springs how to summon elephants."
victory44 = "Can ah ask you fer some weight loss tips?  It all just goes t'mah thighs!"
victory45 = "Sorry partner, didn't see you there!  Ah think you were standin' sideways."

;Violet

victory46 = "Y'all can really put that lower half't good use."
victory47 = "There's a thigh-based martial art!?  My life just got a whole lot harder..."
victory48 = "You ain't rustlin' cattle, so yer O.K. in mah books!"

;Julian

victory49 = "Pretty sure yer breakin' a half-dozen public indecency laws there, partner."
victory50 = "I deal with a lotta ass, but even mah outlaws wear more clothes than that!"
victory51 = "So this is what big city folk call 'fashion', huh?"

;Akai

victory52 = "Now you can tell me everythin' you know about yer boss's operation."
victory53 = "Ah don't tolerate criminals in mah town."
victory54 = "You can use that super speed to do laps o' yer cell."

;Andy

victory55 = "Ah do mah crimefightin' the ol' fashioned way."
victory56 = "Don't suppose you'd consider becomin' a deputy?"
victory57 = "Next time ya roll through town, whiskey's on me."

;Sarjiri

victory58 = "A-ah...survived...?"
victory59 = "Ah'm gonna be havin' nightmares about that ass fer weeks..."
victory60 = "Ah'm gonna need a bigger jail..."

;Noah

victory61 = "Ah like yer girlfriend's boots!"
victory62 = "Small an' dangerous...Are y'all friends with Smilin' Jacks?"
victory63 = "No offense partner, but ah'd take a gun over a bow any time."

;Montana

victory64 = "Magic...Why'd it have to hav'ta be magic?"
victory65 = "Y'all got my sister's name, but that's where the similarities end."
victory66 = "That stink'd fit right in in Gold Springs..."

;Ra

victory67 = "There's mah boot on that snake."
victory68 = "We don't usually get rattlers that big where ah'm from."
victory69 = "Ain't you heard?  Weasels EAT snakes."

;Herself

victory70 = "This town ain't big enough fer the both of us."
victory71 = "Ah get enough trouble from mah siblings without needin' a twin."
victory72 = "Sorry Partner, but ah'm One-of-a-kind."

;Itoka

victory73 = "Mysterious drifter, huh?  Well y'all can keep on driftin'!"
victory74 = "Hot darn, yer sword weighs as much as Georgia."
victory75 = "Ya gain some respect for authority now?"
;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).


;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
;Hat Mechanic
[statedef 171]
type = A
movetype = I
physics = N
anim = 175


[state 171, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 171, velset]
type = velset
trigger1 = time = 0
x = -2 + parent,gethitvar(xvel) * 0.25
y = -5 + parent,gethitvar(yvel) * 0.25

[state 171, gravity]
type = veladd
trigger1 = time > 0
y = 0.44

[state 171, bounce]
type = velmul
trigger1 = backedgebodydist < 50
trigger2 = frontedgebodydist < 50
x = -0.8
persistent = 30

[state 171, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 172

;-------------------------------------------------------------------------------
[statedef 172]
type = C
movetype = I
physics = C
anim = 176

[state 172, velset]
type = velset
trigger1 = time = 0
y = 0

[state 172, on ground]
type = posset
trigger1 = time = 0
y = 0


;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
; Win pose 1 - Bow
; CNS difficulty: basic
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[state 181, width]
type = width
trigger1 = time = 0
edge = 200,150

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
value = S180,1

[state 181, playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = S180,0

[state 181, move 1]
type = posadd
trigger1 = animelemtime(8) = 0
x = 34
persistent = 0

[state 181, move 2]
type = posadd
trigger1 = animelemtime(9) = 0
x = 30
persistent = 0

[state 181, move 2]
type = posadd
trigger1 = animelemtime(10) = 0
x = 62
persistent = 0

[state 181, move 2]
type = posadd
trigger1 = animelemtime(11) = 0
x = 4
persistent = 0


[state 181, winpose]
type = assertspecial
trigger1 = time < 180
flag = roundnotover

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0
sprpriority = -1



[state 191, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 1,1
postype = Back
pos = ifelse(facing =1, 20, 157),360 ; Nice!
ontop = 1

[state 191, helper]
type = helper
trigger1 = time = 0
trigger1 = !numhelper(1950)
name = "Origin Point"
stateno = 1950
postype = p1
pos = 0,0
id = 1950


[state 191, Posset]
type = Helper
trigger1 = time = 0
trigger1 = !numhelper(1900)
stateno = 1900
postype = back
pos = -1000, -360
id = 1900
name = "Nutmeg"

[state 191, posset]
type = posset
trigger1 = numhelper(1900)
ignorehitpause = 1
x = helper(1900), pos x
y = helper(1900), pos y
persistent = 1


[state 191, changestate]
type = changestate
trigger1 = numhelper(1900)
trigger1 = helper(1900), stateno = 1910
value = 192
ignorehitpause = 1

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = time = 240
value = 0

;---------------------------------------------------------------------------
;Texas Lands
[statedef 192]
type = A
movetype = I
physics = N
anim = 191


[state 191, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 191, bind to horse]
type = posset
trigger1 = numhelper(1900)
trigger1 = animelemtime(3) < 0
x = helper(1900), pos X
y = helper(1900), pos y
ignorehitpause = 1

[state 191, posadd]
type = posadd
trigger1 = animelemtime(3) = 0
x = -100
y = -180

[state 191, sprpriority]
type = sprpriority
trigger1 = animelemtime(3) = 1
value = 1
 
[state 191, Jump]
type = velset
trigger1 = animelemtime(3) = 1
trigger1 = numhelper(1950)
y = -27
x = helper(1950),parentdist x * -0.02777

[state 191, gravity]
type = gravity
trigger1 = pos y < 0

[State 191, 2] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 191, changestate]
type = changestate
trigger1 = animelemtime(3) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 193

;------------------------------------------------------------------------------
;Texas Dismounts
[statedef 193]
type = C
movetype = I
physics = C
anim = 192
velset = 0,0

[state 191, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 192, posset]
type = posset
trigger1 = time = 0
trigger1 = numhelper(1950)
x = helper(1950),pos x
y = 0

[State 191, 2] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 192, changestate]
type = changestate
trigger1 = animtime = 0
value = 0 


;--------------------------------------------------------------------------
;Origin Point
[statedef 1950]
type = U
anim = 9999

[state 1950, destroyself]
type = destroyself
trigger1 = time > 300
trigger2 = roundstate = 2

[state 1950, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Pos X: %d || Pos y: %d"
params = pos x, pos y 

;---------------------------------------------------------------------------
;Nutmeg Intro
[statedef 1900]
type = A
movetype = I
physics = N
anim = 1900
velset = 0,0
sprpriority = -2

[state 1900, velset]
type = velset
trigger1 = time = 24
x = 36
y = -12

[state 1900, gravity]
type = gravity
trigger1 = pos y < 0
trigger1 = time > 24

[state 1900, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1910


;----------------------------------------------------------------------------
;Nutmeg Landing
[statedef 1910]
type = S
movetype = I
physics = N
anim = 1910

[state 1910, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1910)
anim = 1915
id = 1910
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1

[state 1910, dust]
type = explod
trigger1 = time < 18
anim = 2025
postype = p1
pos = 60,0
accel = 0, -0.11
persistent = 2
sprpriority = 3

[state 1910, dust]
type = explod
trigger1 = time > 6 && time < 18
anim = 2025
postype = p1
pos = 140,0
accel = 0, -0.11
persistent = 2
sprpriority = -3

[state 1910, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1910, velset]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1910, velset]
type = velmul
trigger1 = time = 12
x = 0.5

[state 1910, velset]
type = velset
trigger1 = time = 18
x = 0



[state 1910, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 190, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 2, 2

[state 1910, sound]
type = playsnd
trigger1 = time = 0
value = 190,0

[state 1910, sound]
type = playsnd
trigger1 = time = 0
value = 440,0


[state 1910, sound]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 190,0

[state 1910, sound]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 190,0

[state 1910, sound]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 190,0



[state 1910, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1910, velset]
type = VELSET
trigger1 = animelemtime(6) = 0
x = -30
y = -15

[state 1910, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 4032,0

[state 1910, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[state 1910, destroyself]
type = destroyself
trigger1 = backedgebodydist < -800
trigger2 = time > 300

;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 200                       ;Change animation (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA                    
damage = 20                  
animtype = Light                
guardflag = MA                  
hitflag = MAF                    
priority = 3, Hit                
pausetime = 6, 6    
guard.pausetime = 6,6             
sparkno = 0                     
sparkxy = -40, -304              
hitsound = S200, 1                  
guardsound = 6, 0               
ground.type = High              
ground.slidetime = 14             
ground.hittime  = 14             
ground.velocity = -12          
airguard.velocity = -7.6,-3.2    
air.type = High                  
air.velocity = -4,-6         
air.hittime = 15       
guard.slidetime = 14
guard.hittime = 14   
guard.velocity = -16     
fall.recovertime = 30

[State 200, 2]
type = PlaySnd
trigger1 = Time = 1
value = 200, 0

[state 200, Texas Combo check]
type = varset
trigger1 = movehit = 1
v = 27
value = 1
ignorehitpause = 1

[state 200,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I


[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Standing Strong
[Statedef 205]
type    = S
movetype= A
physics = S
poweradd= 20
ctrl = 0
velset = 0,0
anim = 205
sprpriority = -1

[state x, combo damage score]
type = varadd
trigger1 = prevstateno = 200
v = 18
value = 9
ignorehitpause = 1
persistent = 0

[state 205, velset]
type = velset
trigger1 = animelemtime(2) = 0
x = 10
persistent = 0
ignorehitpause = 1

[State 205, 1]
type = PlaySnd
trigger1 = Time = 2
value = 200, 0

[State 205, 2]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = S, NA
animtype  = Medium
damage    = ifelse(var(27) = 1, 30, 25)
guardflag = MA
hitflag = MAF
pausetime = 10,10
sparkno = 1
sparkxy = -40,-280
hitsound   = S205,1
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -16
air.velocity = -6,-8
forcenofall = 1
guard.hittime = 12
guard.velocity = -18
guard.slidetime = 12

[state 205, easymode]
type = changestate
trigger1 = movecontact
trigger1 = command = "x"
value = 240



[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = ifelse(prevstateno = 200, 0, -6)
persistent = 0
ignorehitpause = 1

[state 205,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[State 205, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
; Standing strong punch
; CNS difficulty: easy
; Note the width controller. It makes KFM's push box larger, so he doesn't
; stand so close to the opponent. Hit Ctrl-C and look at the red bar at his
; feet.
; The sprpriority for this state is at -1, instead of the usual 2 for
; attacks. This makes KFM appear behind the opponent initially.
; The SprPriority controller in [State 210, 4] brings KFM to the front when
; his arm has swung over.
; To stop KFM from pausing in his swing frame, there is a ChangeAnim in
; [State 210, 3] that detects if the hit has come in contact with the
; opponent during that frame, and switches to the next animation element
; (notice the elem=6 parameter). If you don't see what I mean, try commenting
; out that controller, then hit someone with this attack.
[Statedef 210]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -1


[State 210, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 200, 0

[State 210, 2]
type = HitDef
trigger1 = animelemtime(5) >= 0 && animelemtime(7) < 0 
attr = S, NA
animtype  = Medium
persistent = 0
damage    = 65
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,8
sparkno = 2
id = 210
sparkxy = -40,-280
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 27
ground.hittime  = 27
ground.velocity = -27
air.velocity = -18,4
guard.hittime = 15
guard.velocity = -24
guard.slidetime = 15
airguard.velocity = -9,9

[state 210, velset]
type = velset
trigger1 = animelemtime(4) = 0
x = 15
persistent = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 210, not texas combo]
type = varset
trigger1 = movehit
v = 27
value = 0
ignorehitpause =1 

[state 210,  Not active]
trigger1 = animelemtime(7) = 0
type = statetypeset
movetype = I

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
poweradd= 11
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 2
value = 200, 0

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 25
guardflag = MA
pausetime = 8,8
sparkno = 0
sparkxy = -40,-148
hitsound   = S200,1
guardsound = 6,0
ground.type = Low
ground.slidetime = 13
ground.hittime  = 13
ground.velocity = -8
air.velocity = -1,-12
guard.velocity = -16
guard.hittime = 11
guard.slidetime = 11

[state X, not Texas in trouble combo]
type = varset
trigger1 = movehit
v = 27
value = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = ifelse(prevstateno = 200, -15, -9)
persistent = 0
ignorehitpause = 1

[state 230,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 240
sprpriority = 2

[state x, combo damage score]
type = varadd
trigger1 = prevstateno = 205
v = 18
value = 6
persistent = 0
ignorehitpause = 1

[State 240, 1]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 200, 0

[State 240, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Back
damage    = ifelse(var(27) = 1, 90, 70)
guardflag = MA
hitflag = MAF
pausetime = 12,12
sparkno = 2
sparkxy = -40,-240
hitsound   = S240,1
guardsound = 6,0
ground.type = Low
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -24, 4
air.velocity = -24, 4
fall = 1
fall.recover = 0
fall.recovertime = 26
guard.slidetime = 15
guard.hittime = 15
guard.velocity = -30
airguard.velocity = -15, 2



[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = ifelse(prevstateno = 205, 0, -3)
persistent = 0
ignorehitpause = 

[state 240,  Not active]
trigger1 = animelemtime(7) = 0
type = statetypeset
movetype = I


[State 240, 3]
type = velset
trigger1 = AnimElem = 4
x = 25

[State 240, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Light Kick
;Dashing Kick out of Run
[Statedef 245]
type    = A
movetype= A
physics = N
poweradd= 30
ctrl = 0
anim = 245
sprpriority = 2

[state 245, noautoturn]
type = assertspecial
trigger1 = 1
flag = Noautoturn


[State 240, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 200, 0

[state 240, Jump]
type = veladd
trigger1 = time = 0
x = 6
y = -9

[State 240, 2]
type = HitDef
trigger1 = Time = 0
attr = S, SA
animtype  = Back
damage    = 80,8
guardflag = MA
hitflag = MAF
pausetime = 14,14
sparkno = 3
sparkxy = -40,-240
hitsound   = F5,4
guardsound = 6,0
ground.type = Low
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -30, -4
air.velocity = -27, 0
fall = 1
fall.recover = 1
fall.recovertime = 45
guard.slidetime = 18
guard.hittime = 18
guard.velocity = -50
airguard.velocity = -12,-6

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 245,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I


[state 240, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[State 240, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 247
ctrl = 0

;---------------------------------------------------------------------------
;Heavy
;Dashing Kick out of Run
[Statedef 246]
type    = A
movetype= A
physics = N
poweradd= 30
ctrl = 0
anim = 245
sprpriority = 2

[state 246, noautoturn]
type = assertspecial
trigger1 = 1
flag = Noautoturn


[State 246, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 200, 0

[state 246, Jump]
type = veladd
trigger1 = time = 0
x = 9
y = -11

[State 246, 2]
type = HitDef
trigger1 = Time = 0
attr = S, SA
animtype  = Back
damage    = 100,10
guardflag = MA
hitflag = MAF
pausetime = 14,14
sparkno = 3
sparkxy = -40,-240
hitsound   = F5,4
guardsound = 6,0
ground.type = Low
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -30, -4
air.velocity = -27, 0
fall = 1
fall.recover = 1
fall.recovertime = 45
guard.slidetime = 16
guard.hittime = 16
guard.velocity = -40
airguard.velocity = -12,-6

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 246,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[state 246, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[State 246, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 247
ctrl = 0

;---------------------------------------------------------------------------
; Dash Kick recovery
[statedef 247]
type = C
movetype = I
physics = C
anim = 47

[state 1101, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1101, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1101, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 1,1

[state 1101, recovery]
type = changestate
trigger1 = time = 12
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;EX
;Dashing Kick out of Run
[Statedef 248]
type    = A
movetype= A
physics = N
poweradd= -500
ctrl = 0
anim = 247
sprpriority = 2

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = time < 18
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 248, noautoturn]
type = assertspecial
trigger1 = 1
flag = Noautoturn

[STATE 248, nothitby]
type = nothitby
trigger1 = time < 8
value = SCA


[State 248, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 200, 0

[state 248, Jump]
type = veladd
trigger1 = time = 0
x = 12
y = -12


[State 248, 2]
type = HitDef
trigger1 = animelem = 3
attr = S, SA
animtype  = Hard
damage    = 20,2
guardflag = MA
hitflag = MAF
pausetime = 2,2
getpower = 0
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-290
hitsound   = F5,0
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -4, 0
air.velocity = -4, -2
guard.slidetime = 8
guard.hittime = 8
guard.velocity = -6
airguard.velocity = -3,-2
forcestand = 1

[State 248, 2]
type = HitDef
trigger1 = animelem = 4
attr = S, SA
animtype  = Hard
damage    = 20,2
guardflag = MA
hitflag = MAF
pausetime = 2,2
getpower = 0
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-290
hitsound   = F5,0
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -4, 0
air.velocity = -4, -2
guard.slidetime = 8
guard.hittime = 8
guard.velocity = -6
airguard.velocity = -3,-2

[State 248, 2]
type = HitDef
trigger1 = animelem = 5
attr = S, SA
animtype  = Hard
damage    = 20,2
guardflag = MA
hitflag = MAF
pausetime = 2,2
getpower = 0
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-290
hitsound   = F5,0
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -4, 0
air.velocity = -4, -2
guard.slidetime = 8
guard.hittime = 8
guard.velocity = -6
airguard.velocity = -3,-2

[State 248, 2]
type = HitDef
trigger1 = animelem = 6
attr = S, SA
animtype  = Back
damage    = 20,2
guardflag = MA
hitflag = MAF
getpower = 0
id = 248
pausetime = 14,14
envshake.ampl = 8
envshake.time = 14
sparkno = 2
sparkxy = -40,-290
hitsound   = S4020,0
guardsound = 6,0
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -60, -10
air.velocity = -60, -10
fall = 1
fall.recover = 1
fall.recovertime = 45
guard.slidetime = 15
guard.hittime = 15
guard.velocity = -40
airguard.velocity = -28,-2

[state 248, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = animelemtime(6) > 0
trigger1 = hitpausetime = 1
id = 248
value = 675
ignorehitpause = 1

[state 248, lightweight]
type = velmul
trigger1 = animelemtime(6) = 1
trigger1 = movecontact
trigger1 = numtarget(248)
x = -0.25
ignorehitpause = 1
persistent = 0


[state 248, Bounce]
type = veladd
trigger1 = animelemtime(6) = 1
trigger1 = movecontact
trigger1 = numtarget(248)
y = -4
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit 
trigger1 = animelem = 6
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 248, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[State 248, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 247
ctrl = 0

;---------------------------------------------------------------------------
;Crouching light punch
; CNS difficulty: easy
; Description: Simple crouching attack. The HitDef's guardflag parameter
;     is set to "L", meaning that the move can only be guarded low
;     (crouching), and not by standing or jumping opponents.
;     Like for all light attacks, it's a good idea to keep the slidetime
;     and hittime parameters at a smaller number, so the opponent isn't
;     stunned for too long. For all crouching attacks you have to
;     remember to set the attr parameter to indicate that it is crouching
;     attack. In this case, "C, NA" stands for "crouching, normal attack".
;     The HitDef's priority is set at 3, instead of the default of 4,
;     so this attack has a lower priority than most others, meaning
;     KFM will get hit instead of trading hits with his opponent if
;     their attack collision boxes (Clsn1) intersect each other's Clsn2
;     boxes at the same time.
[Statedef 400]
type    = C
movetype= A
physics = C
poweradd= 8
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 2]
type = PlaySnd
trigger1 = Time = 1
value = 200, 0

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 20
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = MA
pausetime = 8,8
sparkno = 1
sparkxy = -40,-195
hitsound   = S200,1
guardsound = 6,0
ground.type = Low
ground.slidetime = 11
ground.hittime  = 11
ground.velocity = -14
air.velocity = -6,-12
guard.velocity = -18
guard.hittime = 10
guard.slidetime = 10

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 400,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I


[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching strong punch
; CNS difficulty: easy
; Description: This is a 2-hit move. It is done by having two HitDefs
;     triggered, one for each frame of animation that hits.
;     Notice how the first hit cannot be guarded by an opponent in the
;     air, because of the "M" in the guardflag, meaning it can only
;     be guarded "middle". The second hit has an "MA" guardflag, so
;     it can be guarded both on the ground and in the air.
[Statedef 410]
type    = C
movetype= A
physics = C
poweradd= 25
ctrl = 0
anim = 410
sprpriority = 2

[state 410, random number check]
type = varset
trigger1 = time = 0
v = 35
value = random%11

[State 410, 1]
type = PlaySnd
trigger1 = Time = 8
value = 200, 0

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = !movecontact
attr = C, NA
damage    = ifelse(var(35) > 8, 120,80),ifelse(enemynear,statetype = A, 24, 0)
animtype  = Up
hitflag = MAF
guardflag = MA
id = 410
pausetime = 18,18
envshake.time = 18
envshake.ampl = 14
sparkno = 3
sparkxy = -40,-400
hitsound   = ifelse(var(35) > 8, 410, 5),ifelse(var(35) > 8, 0, 4)
guardsound = 6,0
ground.type = Low
ground.slidetime = 45
ground.hittime  = 45
air.hittime = 45
ground.velocity = ifelse(var(36) > 8, -8, -2), ifelse(var(11) > 0,-42, -8)
air.velocity = ifelse(var(36) > 8, -8, -2),ifelse(var(11) > 0,-34, -6)
guard.hittime = 6
guard.velocity = -16
guard.slidetime = 6
airguard.velocity = -12,-15
airguard.ctrltime = 24
fall = ifelse(var(35) > 8, 1, 0)
fall.recover = 1
fall.recovertime = ifelse(var(11) > 0, 45, 16)
guard.kill = 0

[state 410, Launcher]
type = varadd
trigger1 = movehit
var(11) = -1
ignorehitpause = 1
persistent = 0

[state 410, Snd]
type = playsnd
Trigger1 = movehit
trigger1 = var(35) > 8
value = 410,0
persistent = 0
ignorehitpause = 1

[state 410, Snd]
type = playsnd
Trigger1 = movehit
trigger1 = numtarget(410)
trigger1 = !target(410),ishelper
trigger1 = var(35) > 8
value = 411,random%3
channel = 0
persistent = 0

[state 410, Super Jump followup]
type = changestate
triggerall = movehit
trigger1 = command = "holdup"
trigger1 = !ailevel
trigger2 = ailevel
value = 42



[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 410,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I


[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
poweradd= 11
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 2]
type = PlaySnd
trigger1 = Time = 4
value = 200, 0

[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 25
animtype  = Light
hitflag = MAF
guardflag = L
pausetime = 10,10
sparkno = 2
sparkxy = -40,-155
hitsound   = S200,1
guardsound = 6,0
ground.type = Low
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -12
air.velocity = -8,-12
guard.velocity = -15
guard.hittime = 10
guard.slidetime = 10

[state X, not Texas in trouble combo]
type = varset
trigger1 = movehit
v = 27
value = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 430,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I


[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = C

poweradd= 35
ctrl = 0
anim = 440
sprpriority = 2

[State 440, 2]
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 440, 0

[state 440, nothitby]
type = nothitby
trigger1 = animelemtime(3) > 0 && animelemtime(13) < 0
value = ,AP
ignorehitpause = 1

[state 440, statetypeset]
type =statetypeset
trigger1 = animelemtime(3) = 0
Physics = N

[state 440, statetypeset]
type = statetypeset
trigger1 = animelemtime(10) = 0
Physics = C

[state 440, posadd]
type = posadd
trigger1 = animelemtime(3) = 0
trigger1 = p2bodydist x > 60
x = 60
ignorehitpause = 1


[state 440, Velset]
type = velset
trigger1 = animelemtime(3) = 0
x = 30

[state 440, explod]
type = null;explod
trigger1 = animelemtime(5) > 0 && animelemtime(13) < 0
anim = 2025
postype = p1
pos =  360, -30
vel = 0, -2
accel = 0, -0.2
sprpriority = -1
persistent = 4
ignorehitpause = 1

[state 440, explod]
type = explod
trigger1 = animelemtime(5) > 0 && animelemtime(10) < 0
anim = 2025
postype = p1
pos =  -30, -2
vel = 0, -2
accel = 0, -0.2
sprpriority = -2
persistent = 4
ignorehitpause = 1

[State 440, 3]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = ifelse(p2statetype = L, 60, ifelse(p2statetype = A, 40,80))
hitflag = MAFD
guardflag = L
nochainid = 1400
pausetime = 10,10
sparkxy = -20,-60
hitsound   = 5,4
guardsound = 6,0
id = 440
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 2,ifelse(enemynear,movetype = H,-21, -27)
air.velocity = 2,-15
fall = 1
fall.recover = 0
fall.recovertime = 45
guard.hittime = 7
guard.slidetime = 7
guard.velocity = -54
down.velocity = -50,0
down.hittime = 24
guard.dist = 920

[state 440, playerpass]
type = playerpush
triggerall = animelemtime(5) >= 0 && animelemtime(13) < 0
triggerall = p2statetype != L
trigger1 = !moveguarded
value = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 440,  Not active]
trigger1 = animelemtime(13) = 0
type = statetypeset
movetype = I

[State 440, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
poweradd= 5
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 0

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 18
guardflag = HA
priority = 3
pausetime = 6,6
guard.velocity = -14
sparkno = 0
sparkxy = -40,-240
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -12
air.velocity = -6,-8
air.hittime = 16
airguard.ctrltime = 11
fall.recovertime = 30

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 600,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[State 600, 3]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Strong Punch
; CNS difficulty: easy
[Statedef 610]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 2]
type = PlaySnd
trigger1 = Time = 2
value = 200, 0

[state 610, veladd]
type = veladd
triggerall = movecontact
triggerall = enemynear,statetype = A
trigger1 = command = "holdup"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = numhelper(4100)
trigger2 = helper(4100),stateno = [4100, 4110]
y = ifelse(movehit, -40, -20)
persistent = 0
ignorehitpause = 1

[State 610, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 70
guardflag = HA
priority = 4
pausetime = 12,18
guard.pausetime = 8,12
envshake.ampl = -8
envshake.time = 18
sparkno = 3
sparkxy = -40,-220
hitsound   = 5,4
guardsound = 6,0
animtype = Hard
ground.type = High
p2facing = 1
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -20
guard.slidetime = 18
guard.hittime = 18
guard.velocity = -26
air.velocity = -12,48
airguard.velocity = -14, 20
airguard.ctrltime = 20
down.bounce = 1
fall.xvelocity = -6
fall.yvelocity = -24
air.fall = 1
fall.recover = 1
fall.recovertime = 45

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 200,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I


[state 610, end]
type =changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = A
poweradd= 10
ctrl = 0
anim = 630
sprpriority = 2

[State 630, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[state 630, playerpush]
type = playerpush
trigger1 = !moveguarded
value = 0
ignorehitpause = 1
persistent = 1

[State 630, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 25
guardflag = HA
priority = 3
id = 630
pausetime = 8,8
sparkno = 2
sparkxy = -20,-140
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -16
air.velocity = -8,-12
air.hittime = 20
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -18
airguard.velocity = -10, -4
fall.recovertime = 30


[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 630,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[state 630, changestate]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
anim = 640
sprpriority = 2

[State 640, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1


[state 640, veladd]
type = veladd
trigger1 = animelemtime(4) = 0
x = 15.0

[State 640, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 80
guardflag = HA
priority = 4
pausetime = 18,18
sparkno = 3
id = 640
envshake.ampl = 8
envshake.time = 18
sparkxy = -40,-290
hitsound   = S4020,0
guardsound = 6,0
animtype = Hard
ground.type = High
ground.slidetime = 14
ground.hittime  = 20
ground.velocity = -28
air.velocity = -36, -12
guard.velocity = -36
guard.hittime = 16
guard.slidetime = 16
air.hittime = 45
airguard.ctrltime = 15
airguard.velocity = -24, -6
air.fall = 1
fall.recover = 1
fall.recovertime = 45


[state 640, Wall Bounce]
type = targetstate
trigger1 = movehit
trigger1 = var(7) > 0
trigger1 = p2statetype = A
value = 675
persistent = 0

[state 640, Wall Bounce Inhibitor]
type = varadd
trigger1 = movehit
trigger1 = p2statetype = A
var(7) = -1
ignorehitpause = 1
persistent = 0

[state 640, movecontact]
type = velmul
trigger1 = movecontact
trigger1 = p2statetype = A
x = -0.25
ignorehitpause = 1
persistent = 0


[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[state 640,  Not active]
trigger1 = animelemtime(6) = 0
type = statetypeset
movetype = I


[state 640, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Rode down
[statedef 655]
type = A
movetype = H
physics = N
sprpriority = -1

[state 655, anim]
type = changeanim2
trigger1 = time = 0
value = 655

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 660


;===========================================================================
;---------------------------Crushed State-----------------------------------
;===========================================================================
; Moderate Crushed State
[statedef 660]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 660, sprpriority]
type = sprpriority
trigger1 = time = 0
value = -1

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[state 660, 2]
type = changeanim
trigger1 = time = 12
value = 5110

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.5,0.1

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause =1 
persistent = 1

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 660, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0 
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 1108, nothitby]
type = nothitby
trigger1 = time = 120
value = SCA
time = 4

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 120 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 30
value = 5150

;--------------------------------------------------------------------------------
; Brief Crushed State
[statedef 661]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -2

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[state 661, 2]
type = changeanim
trigger1 = time = 12
value = 5110

[State 661, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.5,0.1

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause =1 
persistent = 1

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 661, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 661, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 661, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 661, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 661, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0 
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 661, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 661, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 1108, nothitby]
type = nothitby
trigger1 = time = 120
value = SCA
time = 4

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 80 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 30
value = 5150
;-----------------------------------------------------------------------------------

; Gassed Moderate Crushed State
[statedef 662]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 662, sprpriority]
type = sprpriority
trigger1 = time = 0
value = -1

[state 4020, color]
type = palFX
trigger1 = time = 0
time = 300
mul = 100,180,40

[state 662, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[state 662, 2]
type = changeanim
trigger1 = time = 12
value = 5110

[State 662, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.5,0.1

[state 662, on ground]
type = posset
trigger1 = 1
y = 0

[state 662, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause =1 
persistent = 1

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 660, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0 
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 1108, nothitby]
type = nothitby
trigger1 = time = 120
value = SCA
time = 4

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 140 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 30
value = 5150

;===========================================================================
;------------------------------Wall Bounce State
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[state 671, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

[state 671, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[state 671, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 670, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 670, Gravity]
type = veladd
trigger1 = 1
y = ifelse(enemynear,stateno = 671, 1.32, 0.44)

;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 672, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 672, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 672, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 673, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -24

[State 673, Vel X]
type = VelSet
trigger1 = Time = 0
trigger1 = enemynear,stateno != [670,679]
x = ceil(p2dist x*0.0188)

[State 673, Vel X]
type = VelSet
trigger1 = Time = 0
trigger1 = enemynear,stateno = [670,679]
x = 12 + random%12

[State 673, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = ifelse(enemynear,stateno = 673, 3.15, 1.05)

;[state 673, gravity]
;type = gravity
;trigger1 = 1

[State 673, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 673, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 673, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 673, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100
;----------------------------------------------------------------------------

;Wall Bounce Splat
[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 4020, color]
type = palFX
trigger1 = time = 0
trigger1 = numhelper(4200)
time = 240
mul = 100,180,40

[state 675]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[state 676, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 676, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 676, Gravity]
type = veladd
trigger1 = 1
y = ifelse(enemynear,stateno = 676, 1.32, 0.44)

;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 677, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -14

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 6 + random%6

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 678, Gravity]
type = VelAdd
trigger1 = 1
y = ifelse(enemynear,stateno = 678, 3.15, 1.05)

;[state 673, gravity]
;type = gravity
;trigger1 = 1

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100



;===========================================================================
;Dodge Roll
;===========================================================================

[statedef 700]
type = S
movetype = I
physics = N
anim = 700
ctrl = 0

[State 700, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 23
length = 20
;palcolor = 256
;palinvertall = 0
;palbright = 30,30,30
;palcontrast = 120,120,220
;palpostbright = 0,0,0
paladd = 10,10,25
;palmul = .65,.65,.75
timegap = 1
framegap = 8
;trans = "add" ;"none","add1","sub"
;ignorehitpause = 
;persistent =


[state 700, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 700, DODGE!!]
type = hitby
trigger1 = time < 24
value = SCA ,AT

[state 700, veladd]
type = veladd
trigger1 = animelemtime(2) = 0
x = 10


[state 700, velmul]
type = velmul
trigger1 = animelemtime(6) = 0
x = 0.9

[state 700, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 40,0

[state 700, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = C

[state 700, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------

[statedef 710]
type = S
movetype = I
physics = N
anim = 710
ctrl = 0

[State 710, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 23
length = 20
;palcolor = 256
;palinvertall = 0
;palbright = 30,30,30
;palcontrast = 120,120,220
;palpostbright = 0,0,0
paladd = 10,10,25
;palmul = .65,.65,.75
timegap = 1
framegap = 8
;trans = "add" ;"none","add1","sub"
;ignorehitpause = 
;persistent =


[state 710, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 710, DODGE!!]
type = hitby
trigger1 = time < 27
value = SCA ,AT

[state 710, veladd]
type = veladd
trigger1 = animelemtime(2) = 0
x = 18


[state 710, velmul]
type = velmul
trigger1 = animelemtime(6) = 0
x = 0.9

[state 710, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 40,0

[state 710, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = C

[state 710, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

; Notes: The '-' symbol in the hitflag field means that it only affects
;   players who are not in a hit state. This prevents KFM from combo-ing
;   into the throw. The priority should be set to a low number, such as
;   1 or 2, so that the throw does not take precedence over normal attacks.
;   The type of priority must always be set to "Miss" or "Dodge" for throws,
;   otherwise strange behavior can result.
[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, NT          ;Attributes: Standing, Normal Throw
hitflag = M-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 1     ;Draw p1's sprite in front of p2
id = 800                      ;p2's sprite priority is set to 0 by default
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 810       ;On success, KFM changes to state 810
p2stateno = 820       ;If hit, p2 changes to state 820 in KFM's cns
guard.dist = 0        ;This prevents p2 from going into a guard state if close
fall = 1              ;Force p2 into falling down
fall.recover = 0
fall.recovertime = 45
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -20

[state 800,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p2
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
facep2 = 1
sprpriority = 4

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120

;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -40

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p1
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(130)
value = 130

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 130

[state 805, removeexplod]
type = removeexplod
trigger1 = numexplod(811)
id = 811
ignorehitpause = 1

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, turn]
type = turn
trigger1 = prevstateno = 820
trigger1 = time = 0
persistent = 0
ignorehitpause

[state 805, velset]
type = velset
trigger1 = time = 10
x= -40

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Kung Fu Throw - Throwing the opponent
; Description: In this state, KFM throws the opponent by binding him to
;     various offsets based on his current frame of animation. For
;     example, [State 810, Bind 1] binds the opponent to an offset of
;     28 pixels in front of KFM. That puts him around where KFM's hand
;     is at. Is is important to keep the opponent bound using a
;     TargetBind controller at all times, until you let him go. This
;     is especially important if your player has a Clsn2 box that
;     allows him to get hit while throwing someone. Each time a player
;     gets hit, all his bound targets will be set to a fall state. If
;     the opponent is not bound, then he may get stuck in his thrown
;     state when his attacker is knocked out of the throw halfway.
; Notes: There is a TargetLifeAdd controller to decrease the opponent's
;     life, and a TargetState controller to change his state to a
;     falling state when KFM lets go of him.
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 0
sprpriority = 2



[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 805
value = 806
persistent = 1

[State 810, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdfwd"

[State 810, Grab Sound]
type = PlaySnd
trigger1 = time = 2
value = 1, 1

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 6
value = 800, 0

[state 810, Whoosh]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 800,1

[state 810, sprpriority]
type = sprpriority
trigger1 = animelemtime(3) = 0
value = 0

[state 810, sprpriority]
type = sprpriority 
trigger1 = animelemtime(5) = 0
value = 2

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 160 * const(size.xscale), 0 * const(size.yscale)

[State 810, Width 2-11]
type = Width
trigger1 = 1
edge = 350,350

[State 810, Bind 2-4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 180 * const(size.xscale), 0 * const(size.yscale)

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 125 * const(size.xscale), -450 * const(size.yscale)

[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 2

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElem = 2
x = -148

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 2
value = -1

[State 810, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -45 * const(size.xscale), -500 * const(size.yscale)

[State 810, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -160 * const(size.xscale), -100 * const(size.yscale)

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = -120

[state 815, sound]
type = playsnd
trigger1 = time = 41
value = F7,2

[state 815, envshake]
type = envshake
trigger1 = time = 41
ampl = -10
time = 12

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 6
value = 821

[State 810, Turn 12]
type = Turn
trigger1 = Animtime = 0

[state 810, stepback]
type = posadd
trigger1 = animelemtime(10) = 0
x = 58

[state 810, posadd]
type = posadd
trigger1 = animtime = 0
x = -92
persistent = 0

[state 810, nothitby]
type = nothitby
trigger1 = animtime = 0
value = SCA
time = 12

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 805

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = 40,40
poweradd = 40

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = 1.6

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground


;---------------------------------------------------------------------------
;Gun Shot Slow Start / Fast Recovery
[statedef 1000]
type = S
movetype = A
physics = S
velset = 0,0
ctrl = 0
poweradd = 50
anim = 1000

[state 1000, width]
type = width
trigger1 = animelemtime(3) = 0
player = 170,0

[state 1000, Explod]
type = explod
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
anim = 1005
id = 1005
postype = p1
pos = 385 * const(size.xscale) , -445 * const(size.yscale)
scale = 1, 1
sprpriority  = 4

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
value = 1000,0
ignorehitpause = 1

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger1 = var(26) <= 0
value = 1000,1
ignorehitpause = 1

[State 0, Projectile]
type = Projectile
triggerall = enemynear,name = "Sarjiri Sara Dragon"
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
velocity = 60,0
remvelocity = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 80, 16
attr = S, SP
hitflag = MAF
guardflag = MAF
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 30
animtype = Back

[State 0, Projectile]
type = Projectile
triggerall = enemynear,name != "Sarjiri Sara Dragon"
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
velocity = 60,0
remvelocity = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 80, 16
attr = S, SP
hitflag = HAF
guardflag = MAF
offset = 280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 30
animtype = Back

[state 1000, varadd]
type = varadd
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
var(26) = -1
ignorehitpause = 1
persistent = 0



[state 1000, End]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Gun Shot Quick Start / Slow recovery
[statedef 1010]
type = S
movetype = A
physics = S
velset = 0,0
ctrl = 0
poweradd = 50
anim = 1010

[state 1010, width]
type = width
trigger1 = animelemtime(3) = 0
player = 170,0

[state 1010, Explod]
type = explod
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
anim = 1005
id = 1005
postype = p1
pos = 385 * const(size.xscale) , -445 * const(size.yscale)
scale = 1, 1

[state 1010, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
value = 1000,0
ignorehitpause = 1

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger1 = var(26) <= 0
value = 1000,1
ignorehitpause = 1


[State 1010, Projectile]
type = Projectile
triggerall = enemynear,name = "Sarjiri Sara Dragon"
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
velocity = 60,0
remvelocity = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 80, 16
attr = S, SP
hitflag = MAF
guardflag = MA
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 45
animtype = Back

[State 1010, Projectile]
type = Projectile
triggerall = enemynear,name != "Sarjiri Sara Dragon"
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
velocity = 60,0
remvelocity = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 80, 16
attr = S, SP
hitflag = HAF
guardflag = MA
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 45
animtype = Back

[state 1000, varadd]
type = varadd
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
var(26) = -1
ignorehitpause = 1
persistent = 0




[state 1010, End]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Gun Shot Quick Start / Slow recovery
[statedef 1020]
type = S
movetype = A
physics = S
velset = 0,0
poweradd = -250
ctrl = 0
anim = 1020

[state 1020, width]
type = width
trigger1 = animelemtime(3) = 0
player = 170,0

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = time < 18
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1010, Explod]
type = explod
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(11) = 0
triggerall = var(26) > 0
anim = 1005
id = 1005
postype = p1
pos = 385 * const(size.xscale) , -445 * const(size.yscale)
scale = 1, 1

[state 1010, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(11) = 0
triggerall = var(26) > 0
value = 1000,0
ignorehitpause = 1

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(11) = 0
triggerall = var(26) <= 0
value = 1000,1
ignorehitpause = 1


[State 1010, Projectile]
type = Projectile
trigger1 = enemynear,name != "Sarjiri Sara Dragon"
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
getpower = 0
velocity = 60,0
remvelocity = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 80, 16
attr = S, SP
hitflag = HAF
guardflag = MAF
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 45
animtype = Back

[State 1010, Projectile]
type = Projectile
trigger1 = enemynear,name != "Sarjiri Sara Dragon"
trigger1 = animelemtime(11) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
velocity = 60,0
remvelocity = 0,0
velmul = 1
getpower = 0
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 40, 8
attr = S, SP
hitflag = HAF
guardflag = MAF
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 45
animtype = Back

[State 1010, Projectile]
type = Projectile
trigger1 = enemynear,name = "Sarjiri Sara Dragon"
trigger1 = animelemtime(4) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
getpower = 0
velocity = 60,0
remvelocity = 0,0
velmul = 1
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 80, 16
attr = S, SP
hitflag = MAF
guardflag = MAF
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 45
animtype = Back

[State 1010, Projectile]
type = Projectile
trigger1 = enemynear,name = "Sarjiri Sara Dragon"
trigger1 = animelemtime(11) = 0
trigger1 = var(26) > 0
ProjID = 1000
projanim = 2000	
projscale = 1.5,1.5
projremove = 1
projremovetime = -1
velocity = 60,0
remvelocity = 0,0
velmul = 1
getpower = 0
projhits = 1
projmisstime = 0
projpriority = 1
projsprpriority = 3
projedgebound = 40
projstagebound = 40
projheightbound = -240
pausetime = 18,18
guard.pausetime = 8,8
envshake.time = 18
envshake.ampl = 8
damage = 40, 8
attr = S, SP
hitflag = MAF
guardflag = MAF
offset =  280 * const(size.xscale),-460 * const(size.yscale)
postype = P1         ;P2, Front, Back, Left, Right
ground.velocity = -27, -4
air.velocity = -27, -4
ground.hittime = 26
ground.slidetime = 26
hitsound = 5,4 
sparkno = 2
sparkxy = 100,0
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -24
airguard.velocity = -12, -4
fall = 1
fall.recover = 1
fall.recovertime = 45
animtype = Back

[state 1000, varadd]
type = varadd
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(11) = 0
triggerall = var(26) > 0
var(26) = -1
ignorehitpause = 1
persistent = 1




[state 1010, End]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Horizontal Lasso
[statedef 1050]
type = S
movetype = I
physics = S
ctrl = 0
poweradd = 200
anim = 1050

[state 1050, varset]
type = varset
trigger1 = time = 0
Fv = 14
value = 1

[state 1050, changestate]
type = changestate
triggerall = animtime = 0
trigger1 = command = "holdx"
trigger2 = ailevel
value =  1051

[state 1050, changestate]
type = changestate
triggerall = animtime = 0
trigger1 = command != "holdx"
trigger1 = !ailevel
value = 1053

;--------------------------------------------------------------------------
;Charge Distance
[statedef 1051]
type = S
movetype = A
physics = S
anim = 1051

[state 1051, poweradd]
type = poweradd
trigger1 = time < 15
value = 75
persistent = 16

[state 1051, changestate]
type = changestate
trigger1 = !ailevel
trigger1 = command != "holdx"
trigger2 = time >= 128
trigger3 = AIlevel
trigger3 = fvar(14) >= 9
trigger3 = p2statetype != A
trigger3 = p2bodydist x > 800
trigger3 = p2statetype != L
trigger4 = ailevel
trigger4 = fvar(14) >= 5.0
trigger4 = p2statetype != A
trigger4 = p2bodydist x <= 800
trigger4 = p2statetype != L
value = 1053

[state 1051, Snd]
type = playsnd
trigger1 = animelemtime(1) = 1
value = 1050,0
persistent = 1

[state 1051, varadd]
type = varadd
trigger1 = animelemtime(4) = 3
Fv = 14
value = 1.5
persistent = 1


[state 1051, changestate]
type = changestate
trigger1 = command = "BB"
trigger1 = !ailevel 
trigger2 = ailevel
trigger2 = p2statetype = A
trigger2 = p2movetype = A
trigger2 = p2bodydist x = [0,500]
trigger3 = numhelper(4001)
trigger3 = helper(4001),stateno = 4035
trigger3 = helper(4001),pos y = [-1000,-200]
trigger3 = random < ailevel * 36
value = 105

[state 1051, Changestate]
type = changestate
triggerall = time > 24
trigger1 = command = "FF"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x > 1000
trigger2 = p2statetype = A
trigger2 = random < ailevel * 6
value = 100

;---------------------------------------------------------------------------
;Throw Lasso
[statedef 1053]
type = S
movetype = A
physics = S
anim = 1052

[state 1051, throw Lasso]
type = helper
trigger1 = !numhelper(1080)
trigger1 = animelemtime(3) = 0
stateno = 1080
id = 1080
postype = p1
pos = 200 * const(size.xscale), -275 * const(size.yscale)
name = "Lasso"

[state 1080, Rope]
type = explod
trigger1 = animelemtime(3) >= 1
trigger1 = numhelper(1080)
trigger1 = !numexplod(1050)
id = 1050
anim = 2050
postype = p1
pos = 410 * const(size.xscale), -275 * const(size.yscale)  
facing = -1
scale = (helper(1080),rootdist x - helper(1080),vel x  +  410 * const(size.xscale)) * 0.5, 1
removeongethit = 1
removetime = 300 
ignorehitpause = 1

[state 1050, modifyexplod]
type = modifyexplod
trigger1 = numexplod(1050)
trigger1 = numhelper(1080)
id = 1050
postype = p1
facing = -1
pos = 410, -275 * const(size.yscale)
scale = (helper(1080),rootdist x - helper(1080),vel x + 410 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 1051, changestate]
type = changestate
trigger1 = numhelper(1080)
trigger1 = helper(1080),stateno = 1081
value = 1055
ignorehitpause = 1

[state 1051, changestate]
type = changestate
trigger1 = animelemtime(4) >= 0
trigger1 = !numhelper(1080)
value = 1054
ctrl = 0

;-------------------------------------------------------------------------------
;Throw Lasso Recovery
[statedef 1054]
type = S
movetype = I
physics = S
anim = 1054

[state 1054, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 1050

[state 1054, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------
;Pull in
[statedef 1055]
type = S
movetype = A
physics = S
anim = 1053

[state 1080, modifyexplod]
type = modifyexplod
triggerall = animelemtime(2) < 0
trigger1 = numexplod(1050)
trigger1 = numhelper(1080)
id = 1050
postype = p1
facing = -1
pos = 450 * const(size.xscale), -315 * const(size.yscale)
scale = (helper(1080),rootdist x - helper(1080),vel x + 450 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 1080, modifyexplod]
type = modifyexplod
triggerall = animelemtime(2) >= 0   && animelemtime(3) < 0
trigger1 = numexplod(1050)
trigger1 = numhelper(1080)
id = 1050
postype = p1
facing = -1
pos = 170 * const(size.xscale), -275  * const(size.yscale)
scale = (helper(1080),rootdist x - helper(1080),vel x + 170 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 1080, modifyexplod]
type = modifyexplod
triggerall = animelemtime(3) >= 0 
trigger1 = numexplod(1050)
trigger1 = numhelper(1080)
id = 1050
postype = p1
facing = -1
pos = 200 * const(size.xscale), -290  * const(size.yscale)
scale = (helper(1080),rootdist x - helper(1080),vel x + 200 * const(size.xscale)) * 0.5, 1
persistent = 1


[state 1055, End invunerability]
type = nothitby
trigger1 = animtime = 0
value = SCA
time = 12


[state 1055, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Diagonal Lasso
[statedef 1060]
type = S
movetype = A
physics = S
ctrl = 0
poweradd = 200
anim = 1050

[state 1060, varset]
type = varset
trigger1 = time = 0
Fv = 14
value = 1

[state 1060, changestate]
type = changestate
triggerall = animtime = 0
trigger1 = command = "holdy"
trigger2 = ailevel
value =  1061

[state 1060, changestate]
type = changestate
triggerall = animtime = 0
trigger1 = command != "holdy"
trigger1 = !ailevel
value = 1063

;--------------------------------------------------------------------------
;Charge Distance
[statedef 1061]
type = S
movetype = A
physics = S
anim = 1051

[state 1051, poweradd]
type = poweradd
trigger1 = time < 15
value = 75
persistent = 16

[state 1061, nothitby]
type = nothitby
trigger1 = time < 24
value = A

[state 1061, changestate]
type = changestate
trigger1 = !ailevel
trigger1 = command != "holdy"
trigger2 = time >= 120
trigger3 = ailevel
trigger3 = fvar(14) > 5.5
trigger3 = p2statetype = A
trigger3 = p2bodydist x > 800
trigger3 = p2statetype != L
trigger4 = ailevel
trigger4 = fvar(14) >= 3.25
trigger4 = p2statetype = A
trigger4 = p2bodydist x <= 800
trigger4 = p2statetype != L
value = 1063

[state 1061, Snd]
type = playsnd
trigger1 = animelemtime(1) = 1
value = 1050,0
persistent = 1

[state 1061, varadd]
type = varadd
trigger1 = animelemtime(4) = 3
Fv = 14
value = 2.5
persistent = 1


[state 1061, changestate]
type = changestate
trigger1 = command = "BB"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x = [0,500]
trigger2 = p2movetype = A
trigger2 = p2statetype != A
trigger3 = numhelper(4001)
trigger3 = helper(4001),stateno = 4035
trigger3 = helper(4001),pos y = [-1000,-200]
trigger3 = random < ailevel * 36
value = 105

[state 1051, Changestate]
type = changestate
triggerall = time > 24
trigger1 = command = "FF"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x > 1000
trigger2 = p2statetype != A
trigger2 = random < ailevel * 6
value = 100

;---------------------------------------------------------------------------
;Throw Lasso
[statedef 1063]
type = S
movetype = A
physics = S
anim = 1052

[state 1062, nothitby]
type = nothitby
trigger1 = time < 14
value = A
ignorehitpause = 1

[state 1063, throw Lasso]
type = helper
trigger1 = !numhelper(1084)
trigger1 = animelemtime(3) = 0
stateno = 1084
id = 1084
postype = p1
pos = 200 * const(size.xscale), -235 * const(size.yscale)
name = "Lasso"

[state 1080, Rope]
type = helper
trigger1 = animelemtime(3) = 1
trigger1 = numhelper(1084)
trigger1 = !numhelper(1060)
id = 1060
stateno = 1066
postype = p1
pos = 410 * const(size.xscale), -275 * const(size.yscale)
facing = 1
name = "Rope"
ignorehitpause = 1

[state 1063, changestate]
type = changestate
trigger1 = numhelper(1084)
trigger1 = helper(1084),stateno = 1085
value = 1065
ignorehitpause = 1

[state 1063, changestate]
type = changestate
trigger1 = animelemtime(4) >= 0
trigger1 = !numhelper(1084)
value = 1064
ctrl = 0

;-------------------------------------------------------------------------------
;Throw Lasso Recovery
[statedef 1064]
type = S
movetype = I
physics = S
anim = 1054

[state 1064, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 1050

[state 1064, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------
;Pull in
[statedef 1065]
type = S
movetype = A
physics = S
anim = 1053

[state 1065, End invunerability]
type = nothitby
trigger1 = animtime = 0
value = SCA
time = 12

[state 1065, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Diagonal Rope
[statedef 1066]
type = S
physics = N
anim = 2050

[state 1066, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = Root,pos x, Root,pos y, pos x, pos y
text = "Parent X: %d, Y: %d ---- Pos X: %d, Y: %d"

[state 1066, posset]
type = posset
trigger1 = root,stateno = 1065
trigger1 = animelemtime(1) = 1
x = root,pos X + 450 * const(size.xscale)
y = root,pos y - 315 * const(size.yscale)

[state 1066, posset]
type = posset
trigger1 = root,stateno = 1065
trigger1 = animelemtime(2) = 0
x = root,pos X + 170 * const(size.xscale)
y = root,pos y - 275 * const(size.yscale)

[state 1066, posset]
type = posset
trigger1 = root,stateno = 1065
trigger1 = animelemtime(3) = 0
x = root,pos X + 200 * const(size.xscale)
y = root,pos y - 290 * const(size.yscale)

[state 1066, modifyexplod]
type = angledraw
trigger1 = numhelper(1084)
scale = -(helper(1084),rootdist x - helper(1084),vel x + 326) * 0.5, 1
value = 15
persistent = 1

[state 1066, destoryself]
type = destroyself
trigger1 = parent,stateno != [1060,1065]
trigger2 = !numhelper(1084)
trigger3 = numtarget(1090)
trigger3 = target(1090),stateno = 1091

;---------------------------------------------------------------------------
;EX Horizontal Lasso
[statedef 1070]
type = S
movetype = A
physics = S
poweradd = -500
ctrl = 0
poweradd = 140
anim = 1070

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1070, Projectile Immune]
type = nothitby
trigger1 = 1
value = ,AP, AT
ignorehitpause =1

[state 1070, varset]
type = varset
trigger1 = time = 0
fvar(14) = 1


[state 1070, changestate]
type = changestate
triggerall = animtime = 0
trigger1 = command = "holdz"
trigger2 = ailevel
value =  1071

[state 1070, changestate]
type = changestate
triggerall = animtime = 0
trigger1 = command != "holdz"
trigger1 = !ailevel
value = 1073

;--------------------------------------------------------------------------
;Charge Distance
[statedef 1071]
type = S
movetype = A
physics = S
anim = 1071

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = time < 40
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1070, Projectile Immune]
type = nothitby
trigger1 = 1
value = ,AP, AT
ignorehitpause =1

[state 1071, changestate]
type = changestate
trigger1 = !ailevel
trigger1 = command != "holdz"
trigger2 = time >= 120
trigger3 = ailevel
trigger3 = fvar(14) >= 7.00
trigger3 = p2statetype != A
trigger3 = p2bodydist x > 800
trigger4 = ailevel
trigger4 = fvar(14) >= 4.0
trigger4 = p2statetype != A
trigger4 = p2bodydist x <= 800
value = 1073

[state 1071, Snd]
type = playsnd
trigger1 = animelemtime(1) = 1
value = 1050,0
persistent = 1

[state 1071, varadd]
type = varadd
trigger1 = animelemtime(4) = 2
fvar(14) = 2.0
persistent = 1


[state 1071, changestate]
type = changestate
trigger1 = command = "BB"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x = [0, 500]
trigger2 = p2movetype = A
trigger2 = p2statetype = A
trigger3 = numhelper(4001)
trigger3 = helper(4001),stateno = 4035
trigger3 = helper(4001),pos y = [-1000,-200]
trigger3 = random < ailevel * 36
value = 105

[state 1051, Changestate]
type = changestate
triggerall = time > 24
trigger1 = command = "FF"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x > 1000
trigger2 = p2statetype = A
trigger2 = random < ailevel * 6
value = 100

;---------------------------------------------------------------------------
;Throw Lasso
[statedef 1073]
type = S
movetype = A
physics = S
anim = 1072

[state 1073, nothitby]
type = nothitby
trigger1 = time < 40
value = ,AP, AT

[state 1051, throw Lasso]
type = helper
trigger1 = !numhelper(1087)
trigger1 = animelemtime(3) = 0
stateno = 1087
id = 1087
postype = p1
pos = 200 * const(size.xscale), -275 * const(size.yscale)
name = "Lasso"

[state 1080, Rope]
type = explod
trigger1 = animelemtime(3) >= 1
trigger1 = numhelper(1087)
trigger1 = !numexplod(1050)
id = 1050
anim = 2050
postype = p1
pos = 410 * const(size.xscale), -275 * const(size.yscale)  
facing = -1
scale = (helper(1087),rootdist x - helper(1087),vel x  +  410 * const(size.xscale)) * 0.5, 1
removeongethit = 1
removetime = 300 
ignorehitpause = 1

[state 1080, modifyexplod]
type = modifyexplod
trigger1 = numexplod(1050)
trigger1 = numhelper(1087)
id = 1050
postype = p1
facing = -1
pos = 410, -275 * const(size.yscale)
scale = (helper(1087),rootdist x - helper(1087),vel x + 410 * const(size.xscale)) * 0.5, 1
persistent = 1



[state 1073, changestate]
type = changestate
trigger1 = numhelper(1087)
trigger1 = helper(1087),stateno = 1088
value = 1075
ignorehitpause = 1

[state 1073, changestate]
type = changestate
trigger1 = animelemtime(4) >= 0
trigger1 = !numhelper(1087)
value = 1074
ctrl = 0

;-------------------------------------------------------------------------------
;Throw Lasso Recovery
[statedef 1074]
type = S
movetype = I
physics = S
anim = 1074

[state 1074, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 1050

[state 1074, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------
;Pull in
[statedef 1075]
type = S
movetype = A
physics = S
anim = 1073



[state 1080, modifyexplod]
type = modifyexplod
triggerall = animelemtime(2) < 0
trigger1 = numexplod(1050)
trigger1 = numhelper(1087)
id = 1050
postype = p1
facing = -1
pos = 450 * const(size.xscale), -315 * const(size.yscale)
scale = (helper(1087),rootdist x - helper(1087),vel x + 450 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 1080, modifyexplod]
type = modifyexplod
triggerall = animelemtime(2) >= 0   && animelemtime(3) < 0
trigger1 = numexplod(1050)
trigger1 = numhelper(1087)
id = 1050
postype = p1
facing = -1
pos = 170 * const(size.xscale), -275  * const(size.yscale)
scale = (helper(1087),rootdist x - helper(1087),vel x + 170 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 1080, modifyexplod]
type = modifyexplod
triggerall = animelemtime(3) >= 0 
trigger1 = numexplod(1050)
trigger1 = numhelper(1087)
id = 1050
postype = p1
facing = -1
pos = 200 * const(size.xscale), -290  * const(size.yscale)
scale = (helper(1087),rootdist x - helper(1087),vel x + 200 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 1055, End invunerability]
type = nothitby
trigger1 = animtime = 0
value = SCA
time = 12

[state 1075, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Horizontal Lasso Ring
[statedef 1080]
type = S
movetype = A
physics = N
anim = 2051

[state 1080, stun limiter]
type = parentvaradd
trigger1 = time = 0
var(13) = -1
ignorehitpause = 1
persistent = 0

[state 1080, nothitby]
type = nothitby
trigger1 = 1 
value = SCA
ignorehitpause = 1

[state 1080, velset]
type = velset
trigger1 = time = 0
x = 6 * parent,fvar(14)

[state 1080, velmul]
type = velmul
triggerall = vel x > 0
trigger1 = frontedgebodydist < 400
trigger2 = time = 21
x = 0.5
persistent = 30


[State 1080, 1]
type = HitDef
trigger1 = vel x > 0
trigger1 = p2stateno != [150,155]
attr = S, ST          
hitflag = M-  
damage = 10
guardflag = 
id = 1080        
priority = 1, Miss    
sparkno = -1        
p1sprpriority = 1                      
p1facing = 1
p2facing = 1              
guard.dist = 0        
fall = 0            
forcestand = 1
kill = 0


[state 1080, targetstate]
type = targetstate
trigger1 = movehit
value = ifelse(parent,var(13) > 0, 1090, 1092)
ignorehitpause = 1

[state 1080, chagnestate]
type = changestate
trigger1 = movehit
value = 1081
ignorehitpause = 1

[STATE 1080, statetypeset]
type = statetypeset
trigger1 = time > 0
trigger1 = vel x < 0
movetype = I
persistent = 0

[state 1080, velset]
type = velset
triggerall = vel x > 0
trigger1 = frontedgebodydist < 330
trigger2 = time = 24
x = -8 * parent,fvar(14)
persistent = 8


[state 1080, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = frontedgebodydist, parentdist x
text = "Front edge: %d Parentdist : %d"

[state 1080, end]
type = destroyself
trigger1 = time > 10
trigger1 = parentdist x > -180
trigger2 = parent,movetype = H

;--------------------------------------------------------------------------
;Lasso hit
[statedef 1081]
type = S
movetype = A
physics = N
anim = 2052
sprpriority = 3

[state 1081, fvarset]
type = varset
trigger1 = time = 0
trigger1 = numtarget(1080)
fv = 1
value = floor((target(1080),const(size.ground.back) + target(1080),const(size.ground.front)) / (const(size.ground.back) + const(size.ground.front))* 1.0625)

[state 1081, scale]
type = angledraw
trigger1 = 1
value = 0
scale = fvar(1) , 1

[state 1080, nothitby]
type = nothitby
trigger1 = 1 
value = SCA
ignorehitpause = 1

[state 1081, playsnd catch]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1080, parentvaradd]
type = parentvaradd
trigger1 = time = 0
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1080, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1081, bindtotarget]
type = bindtotarget
trigger1 = 1
pos = -16,-30, mid

[state 1080, velset]
type = velset
trigger1 = time = 17
x = -40

[state 1081, end]
type = null;targetstate
trigger1 = time > 17
triggerall = parent,var(13) >= 0
trigger1 = parentdist x > -300
value = 1091
persistent = 0

[state 1081, end]
type = null;selfstate
trigger1 = time > 17
triggerall = parent,var(13) < 0
trigger1 = parentdist x > -300
value = 5050
persistent = 0

[state 1080, releasetarget]
type = targetdrop
trigger1 = time > 17
trigger1 = parentdist x > -300

[state 1080, velset]
type = velset
trigger1 = parentdist x > -300
x = 0
[state 1080, end]
type = destroyself
trigger1 = time > 16
trigger1 = numtarget(1080)
trigger1 = target(1080),stateno = 1091
trigger2 = parent,movetype = H
trigger3 = !numtarget(1080)


;===========================================================================
;---------------------------------------------------------------------------
;HEAVY Diagonal Lasso Ring
[statedef 1084]
type = S
movetype = A
physics = N
anim = 2061

[state 1084, stun limiter]
type = parentvaradd
trigger1 = time = 0
var(13) = -1
ignorehitpause = 1
persistent = 0

[state 1084, angledraw]
type = angledraw
trigger1 = 1
value = 15
ignorehitpause = 1

[state 1084, nothitby]
type = nothitby
trigger1 = 1 
value = SCA
ignorehitpause = 1

[state 1084, velset]
type = velset
trigger1 = time = 0
x = 6 * parent,fvar(14)
y = -1.5 * parent,fvar(14)

[STATE 1080, statetypeset]
type = statetypeset
trigger1 = time > 0
trigger1 = vel x < 0
movetype = I
persistent = 0

[state 1084, velmul]
type = velmul
triggerall = vel x > 0
trigger1 = frontedgebodydist < 400
trigger2 = time = 24
x = 0.5
y = 0.5
persistent = 30

[State 1084, 1]
type = HitDef
trigger1 = vel x > 0
trigger1 = p2stateno != [150,155]
attr = S, ST          
hitflag = AF
guardflag = 
id = 1080       
damage = 10 
priority = 1, Miss    
sparkno = -1        
p1sprpriority = 1                      
p1facing = 1
p2facing = 1             
guard.dist = 0        
fall = 0            
forcestand = 1
kill = 0

[state 1084, targetstate]
type = targetstate
trigger1 = movehit
value = ifelse(root,var(13) > 0, 1090, 1092)
ignorehitpause = 1

[state 1084, chagnestate]
type = changestate
trigger1 = movehit
value = 1085
ignorehitpause = 1


[state 1084, velset]
type = velset
triggerall = vel x > 0
trigger1 = frontedgebodydist < 330
trigger2 = time = 27
x = -6 * parent,fvar(14)
y = 1.5 * parent,fvar(14)
persistent = 8

[state 1085, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = frontedgebodydist, parentdist x
text = "Front edge: %d Parentdist : %d"

[state 1085, end]
type = destroyself
trigger1 = time > 10
trigger1 = parentdist x > -120
trigger2 = parent,movetype = H

;--------------------------------------------------------------------------
;Lasso hit
[statedef 1085]
type = S
movetype = A
physics = N
anim = 2052
sprpriority = 3

[state 1085, fvarset]
type = varset
trigger1 = time = 0
trigger1 = numtarget(1080)
fv = 1
value = floor((target(1080),const(size.ground.back) + target(1080),const(size.ground.front)) / (const(size.ground.back) + const(size.ground.front))* 1.0625)

[state 1085, scale]
type = angledraw
trigger1 = 1
value = 15
scale = fvar(1) , 1

[state 1085, nothitby]
type = nothitby
trigger1 = 1 
value = SCA
ignorehitpause = 1

[state 1085, playsnd catch]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1085, parentvaradd]
type = parentvaradd
trigger1 = time = 0
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1085, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1085, bindtotarget]
type = bindtotarget
trigger1 = 1
pos = -16,-30, mid

[state 1085, velset]
type = velset
trigger1 = time = 17
x = -40
y = 10

[state 1085, releasetarget]
type = targetdrop
trigger1 = time > 17
trigger1 = parentdist x > -300

[state 1085, velset]
type = velset
trigger1 = parentdist x > -300
x = 0
[state 1085, end]
type = destroyself
trigger1 = time > 16
trigger1 = numtarget(1080)
trigger1 = target(1080),stateno = 1091
trigger2 = parent,movetype = H
trigger3 = !numtarget(1080)

;---------------------------------------------------------------------------
;===========================================================================
;EX Horizontal Lasso Ring
[statedef 1087]
type = S
movetype = A
physics = N
anim = 2051


[state 1084, stun limiter]
type = parentvaradd
trigger1 = time = 0
var(13) = -1
ignorehitpause = 1
persistent = 0

[state 1087, nothitby]
type = nothitby
trigger1 = 1 
value = SCA
ignorehitpause = 1

[state 1087, velset]
type = velset
trigger1 = time = 0
x = 12 * parent,fvar(14)

[state 1087, velmul]
type = velmul
triggerall = vel x > 0
trigger1 = frontedgebodydist < 400
trigger2 = time = 21
x = 0.5
persistent = 30

[STATE 1080, statetypeset]
type = statetypeset
trigger1 = time > 0
trigger1 = vel x < 0
movetype = I
persistent = 0

[State 1087, 1]
type = HitDef
trigger1 = time = 0
attr = S, ST          
hitflag = M 
damage = 10,1
guardflag = 
guard.pausetime = 12,12
getpower = 0
id = 1080        
priority = 1, Miss    
sparkno = -1        
p1sprpriority = 1                      
p1facing = 1
p2facing = 1            
guard.dist = 640       
fall = 0            
forcestand = 1
kill = 0

[state 1087, targetstate]
type = targetstate
trigger1 = movehit
value = ifelse(parent,var(13) > 0, 1090, 1092)
ignorehitpause = 1

[state 1087, chagnestate]
type = changestate
trigger1 = movehit
value = 1088
ignorehitpause = 1


[state 1087, velset]
type = velset
triggerall = vel x > 0
trigger1 = frontedgebodydist < 330
trigger2 = time = 24
trigger3 = moveguarded
x = -12 * parent,fvar(14)
persistent = 8

[state 1087,  Not active]
trigger1 = vel x < 0
trigger2 = time = 24
type = statetypeset
movetype = I

[state 1087, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = frontedgebodydist, parentdist x
text = "Front edge: %d Parentdist : %d"

[state 1087, end]
type = destroyself
trigger1 = time > 10
trigger1 = parentdist x > -180
trigger2 = parent,movetype = H

;--------------------------------------------------------------------------
;Lasso hit
[statedef 1088]
type = S
movetype = A
physics = N
anim = 2052
sprpriority = 3

[state 1088, fvarset]
type = varset
trigger1 = time = 0
trigger1 = numtarget(1080)
fv = 1
value = floor((target(1080),const(size.ground.back) + target(1080),const(size.ground.front)) / (const(size.ground.back) + const(size.ground.front))* 1.0625)

[state 1088, scale]
type = angledraw
trigger1 = 1
value = 0
scale = fvar(1) , 1

[state 1088, nothitby]
type = nothitby
trigger1 = 1 
value = SCA
ignorehitpause = 1

[state 1088, playsnd catch]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1088, parentvaradd]
type = parentvaradd
trigger1 = time = 0
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1088, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1088, bindtotarget]
type = bindtotarget
trigger1 = 1
pos = -16,-30, mid

[state 1088, velset]
type = velset
trigger1 = time = 17
x = -40 

[state 1088, releasetarget]
type = targetdrop
trigger1 = time > 17
trigger1 = parentdist x > -300

[state 1088, velset]
type = velset
trigger1 = parentdist x > -300
x = 0

[state 1088, end]
type = destroyself
trigger1 = time > 16
trigger1 = numtarget(1080)
trigger1 = target(1080),stateno = 1091
trigger2 = parent,movetype = H
trigger3 = !numtarget(1080)
;---------------------------------------------------------------------------
;Lassoed
[statedef 1090]
type = S
movetype = H
physics = N

[state 1090, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1090

[state 1090, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 0

[state 1090, on ground]
type = posset
trigger1 = pos y > 0
y = 0
persistent = 1

[state 1090, changestate]
type = changestate
trigger1 = !gethitvar(isbound)
value = 1091
ignorehitpause =1 


;---------------------------------------------------------------------------
;Dizzy
[statedef 1091]
type = S
movetype = H
physics = S
velset = 0, 0

[state 1090, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 0

[state 1091, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1091, chagneanim]
type = changeanim
trigger1 = time = 0
value = 5300

[state 1091, selfstate]
type = selfstate
trigger1 = time >= 45
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Lassoed
[statedef 1092]
type = S
movetype = H
physics = N

[state 1092, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1090

[state 1092, hitfallset]
type = hitfallset
trigger1 = time = 0
value = 0

[state 1092, on ground]
type = posset
trigger1 = pos y > 0
y = 0
persistent = 1

[state 1092, velset]
type = velset
trigger1 = !gethitvar(isbound)
x = 0
y = 0
ignorehitpause = 1

[state 1092, changestate]
type = selfstate
trigger1 = !gethitvar(isbound)
value = 5050
ignorehitpause =1 




;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
;Dashing Kick out of Run
[Statedef 1100]
type    = S
movetype= A
physics = S
poweradd= 60
ctrl = 0
anim = 1100
sprpriority = 2

[state 1100, noautoturn]
type = assertspecial
trigger1 = 1
flag = Noautoturn


[state 100, explod]
type = explod
trigger1 = animelemtime(2) = 0
bindtime = -1
anim = 8100
scale = 1,0.9
id = 8100
postype = p1
pos = 0,0
removeongethit = 1
removetime = 24

[state 1110, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 1,1

[State 1100, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 200, 0

[state 1100, Jump]
type = veladd
trigger1 = animelemtime(2) = 0
x = 21
y = -8

[state 1100, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
physics = N
ignorehitpause = 1

[State 1100, 2]
type = HitDef
trigger1 = Time = 0
attr = S, SA
animtype  = Back
damage    = 120,12
guardflag = MA
hitflag = MAF
pausetime = 14,14
sparkno = 3
sparkxy = -40,-240
hitsound   = F5,4
guardsound = 6,0
ground.type = Low
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -30, -4
air.velocity = -27, -2
fall = 1
fall.recover = 1
fall.recovertime = 45
guard.slidetime = 18
guard.hittime = 18
guard.velocity = -35
airguard.velocity = -12,-6

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1100, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1100,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[State 240, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1101
ctrl = 0

;---------------------------------------------------------------------------
; Dash Kick recovery
[statedef 1101]
type = C
movetype = I
physics = C
anim = 47
movehitpersist = 1

[state 1101, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1101, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1101, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 1,1

[state 1101, recovery]
type = changestate
trigger1 = time = 12
value = 0
ctrl = 1
;-----------------------------------------------------------------------------
;Dashing Kick 
[Statedef 1110]
type    = S
movetype= A
physics = S
poweradd= 60
ctrl = 0
anim = 1100
sprpriority = 2

[state 1100, noautoturn]
type = assertspecial
trigger1 = 1
flag = Noautoturn

[state 100, explod]
type = explod
trigger1 = animelemtime(2) = 0
bindtime = -1
anim = 8100
scale = 1,0.9
id = 8100
postype = p1
pos = 0,0
removeongethit = 1
removetime = 24

[state 1110, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 1.2,1.2


[State 1110, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 200, 0

[state 1110, Jump]
type = veladd
trigger1 = animelemtime(2) = 0
x = 27
y = -10

[state 1110, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
physics = N
ignorehitpause = 1

[State 1110, 2]
type = HitDef
trigger1 = Time = 0
attr = S, SA
animtype  = Back
damage    = 150,15
guardflag = MA
hitflag = MAF
pausetime = 14,14
sparkno = 3
sparkxy = -40,-240
hitsound   = F5,4
guardsound = 6,0
ground.type = Low
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -30, -4
air.velocity = -27, 0
fall = 1
fall.recover = 1
fall.recovertime = 45
guard.slidetime = 20
guard.hittime = 20
guard.velocity = -40
airguard.velocity = -12,-6


[state 1110, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1110,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[State 1110, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1111
ctrl = 0

;---------------------------------------------------------------------------
; Dash Kick recovery
[statedef 1111]
type = C
movetype = I
physics = C
anim = 47
movehitpersist = 1

[state 1101, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1101, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1101, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 1,1

[state 1101, recovery]
type = changestate
trigger1 = time = 18
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;EX Dash Attack
;---------------------------------------------------------------------------
;EX
[Statedef 1120]
type    = S
movetype= A
physics = S
poweradd= -500
ctrl = 0
anim = 1120
sprpriority = 2

[state 1120, I-frames]
type = nothitby
trigger1 = time < 16
value = ,AP
ignorehitpause = 1

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = time < 24
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1120, noautoturn]
type = assertspecial
trigger1 = 1
flag = Noautoturn

[state 1120, Jump]
type = veladd
trigger1 = animelemtime(2) = 0
x = 33
y = -12

[state 1120, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
physics = N
ignorehitpause = 1


[State 1120, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = 200, 0

[State 1120, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, SA
animtype  = Hard
damage    = 30,3
getpower = 0
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-290
hitsound   = S4020,0
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -4, 0
air.velocity = -4, -2
guard.slidetime = 8
guard.hittime = 8
guard.velocity = -6
airguard.velocity = -3,-2
forcestand = 1

[State 1120, 2]
type = HitDef
trigger1 = animelem = 5
attr = A, SA
animtype  = Hard
damage    = 30,3
getpower = 0
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-290
hitsound   = S4020,0
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -4, 0
air.velocity = -4, -2
guard.slidetime = 8
guard.hittime = 8
guard.velocity = -6
airguard.velocity = -3,-2

[State 1120, 2]
type = HitDef
trigger1 = animelem = 6
attr = A, SA
animtype  = Hard
damage    = 30,3
getpower = 0
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-290
hitsound   = S4020,0
guardsound = 6,0
ground.type = high
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -4, 0
air.velocity = -4, -2
guard.slidetime = 8
guard.hittime = 8
guard.velocity = -6
airguard.velocity = -3,-2

[State 1120, 2]
type = HitDef
trigger1 = animelem = 7
attr = A, SA
animtype  = Back
damage    = 30,3
getpower = 0
guardflag = MA
hitflag = MAF
pausetime = 8,8
sparkno = 3
id = 1123
sparkxy = -40,-290
hitsound   = S4020,0
guardsound = 6,0
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
ground.velocity = -40, ifelse(var(7) > 0, -15,-4)
air.velocity = -40, ifelse(var(7) > 0, -12, 0)
fall = 1
fall.recover = 1
fall.recovertime = 45
guard.slidetime = 25
p2stateno = 670
guard.hittime = 25
guard.velocity = -36
airguard.velocity = -24,-2

[state 1120, Wall Bounce]
type = targetstate
trigger1 = movehit
trigger1 = var(7) > 0
trigger1 = hitpausetime = 1
ignorehitpause = 1
persistent = 0
value = 670
id = 1123

[state 1120, varadd]
type = varadd
trigger1 = movehit
trigger1 = numtarget(1123)
var(7) = -1
ignorehitpause = 1
persistent = 0

[state 248, lightweight]
type = velmul
trigger1 = animelemtime(7) = 1
trigger1 = movecontact
trigger1 = numtarget(1123)
x = -0.25
ignorehitpause = 1
persistent = 0


[state 248, Bounce]
type = veladd
trigger1 = animelemtime(7) = 1
trigger1 = movecontact
trigger1 = numtarget(1123)
y = -8
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit 
trigger1 = animelem = 7
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1120,  Not active]
trigger1 = animelemtime(8) = 0
type = statetypeset
movetype = I

[state 1120, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.88

[State 1120, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1121
ctrl = 0

;---------------------------------------------------------------------------
; Dash Kick recovery
[statedef 1121]
type = C
movetype = I
physics = C
anim = 47
movehitpersist = 1

[state 1121, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1121, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1121, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 1,1

[state 1121, recovery]
type = changestate
trigger1 = time = 24
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Bad Assist
[statedef 1200]
type = U
movetype = A
physics = U
ctrl = 0
poweradd = 50

[state 1200, on ground]
type = posset
trigger1 = prevstateno = 40
trigger1 = time = 0
y = 0

[state 1200, on ground]
type = statetypeset
trigger1 = prevstateno = 40
trigger1 = time = 0
statetype = S

[state 1200, stop]
type = velset
trigger1 = time = 0
trigger1 = statetype = S || statetype = C
x = 0
y = 0

[state 1200, velset]
type = changeanim
trigger1 = time = 0
value = ifelse(statetype = A, 1210, 1200)

[state 1200, velmul]
type = velmul
trigger1 = time = 0
trigger1 = statetype = A
x = 0.1
y = 0.1

[state 1200, physics]
type = statetypeset
trigger1 = time = 0
trigger1 = statetype = A
physics = N

[state 1200, statetypeset]
type = statetypeset
trigger1 = time = 0
trigger1 = statetype != A
trigger1 = random < ailevel * 18
statetype = S

[state 1200, which way]
type = varset
triggerall = time = 0
trigger1 = p2statetype != A
trigger2 = random%10 >= 2
v = 16
value = 0

[state 1200, which way]
type = varset
triggerall = time = 0
trigger1 = p2bodydist x < 400 
v = 16
value = 1

[state 1200, which way]
type = varset
triggerall = time = 0
trigger1 = p2statetype = A
trigger1 = statetype != A
trigger2 = p2statetype != A
trigger2 = random < ailevel * 12
trigger3 = random%10 < 2
v = 16
value = 2

[state 1200, Armor set]
type = varset
trigger1 = time = 1
trigger1 = var(16) = 0
v = 20
value = 80

[state 1200, Armor set]
type = varset
trigger1 = time = 1
trigger1 = var(16) = 1
v = 20
value = 100

[state 1200, Armor set]
type = varset
trigger1 = time = 1
trigger1 = var(16) = 2
v = 20
value = 60


[state 1200, Jesse/Jane randomizer]
type = varset
trigger1 = time = 0
triggerall = !numhelper(4000)
triggerall = !numhelper(4001)
v = 15
value = random%2

[state 1200, helper]
type = helper
trigger1 = command != "holddown" && command != "holdup"
triggerall = time = 1
trigger1 = !ailevel 
trigger2 = ailevel
trigger2 = var(16) = 0
triggerall = !numhelper(4000)
triggerall = !numhelper(4001)
stateno = 4010
postype = back
pos = -800, 0
name = "Jesse & Jane - Hip Check"
id = 4000
ownpal = 1

[state 1200, helper]
type = helper
trigger1 = command = "holdup"
triggerall = time = 1
trigger1 = !ailevel 
trigger2 = ailevel
trigger2 = var(16) = 2
triggerall = !numhelper(4000)
triggerall = !numhelper(4001)
stateno = 4014
postype = back
pos = -800, 0
name = "Jesse & Jane - Anti Air"
id = 4000
ownpal = 1

[state 1200, helper]
type = helper
trigger1 = command = "holddown"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(16) = 1
triggerall = time = 1
triggerall = !numhelper(4000)
triggerall = !numhelper(4001)
stateno = 4012
postype = back
pos = -800, 0
name = "Jesse & Jane - Leaphog"
id = 4000
ownpal = 1

[state 1200, end]
type = changestate
trigger1 = time = 20
trigger1 = statetype != A
value = 0
ctrl = 1

[state 1200, gravity]
type = gravity
trigger1 = time > 16
trigger1 = statetype = A

[state 1200, end]
type = changestate
trigger1 = time = 20
trigger1 = statetype = A
value = 50
ctrl = 1

[state 1200, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;---------------------------------------------------------------------------
;Custom Knockback
[statedef 1230]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5030, 1]
type = ChangeAnim
trigger1 = Anim != [5000, 5199]
trigger1 = SelfAnimExist(5030)
value = 5030

[State 5030, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[state 5030, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1
persistent = 1

[State 5030, 3]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 4]
type = selfstate
triggerall = !HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= Const(movement.air.gethit.groundlevel)
value = 5040 ;HITA_RECOV

[State 5030, 5]
type = selfstate
triggerall = HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= Const(movement.air.gethit.groundlevel)
value = 5050 ;HITA_FALL

[State 5030, 6]
type = selfstate
trigger1 = AnimTime = 0
value = 5035 ;Air get-hit (transition)

;---------------------------------------------------------------------------

;===========================================================================
; Push Block
;===========================================================================

[Statedef 1400]
type = S
movetype = A
physics = S
velset = 0,0
anim = 1400

[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -500

[state 1400, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[State 330, Spark]
type = null;Explod
trigger1 = AnimElem = 3
id = 1410
anim = 1410
postype = p1
pos = 574,-582
sprpriority = 4
bindtime = 1
ownpal = 1
scale = const(size.xscale)*4,const(size.yscale)*4

[State 211, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
animtype  = Heavy
damage    = 80,8
id = 1400
getpower = 0
Hitflag = MA
guardflag = HA
pausetime = 18,18
envshake.ampl = -8
envshake.time = 18
hitsound = 5,4
sparkno = 3
sparkxy = 0, -300 
guard.velocity = -45
guard.slidetime = 30
guard.hittime = 30
ground.Velocity = -18,0
guard.dist = 640
air.Velocity = -18,3
fall = 1
fall.recover = 0
kill = 0
guard.kill = 0

[state 1400, lifeadd]
type = lifeadd
trigger1 = movecontact
value = ifelse(movehit, 20,-40)
persistent = 0
ignorehitpause = 1
kill = 0

[state 330, snd]
type = playsnd
trigger1 = time = 1
value = 1,3

[State 1400, Push]
type = null;Helper
trigger1 = Time = 13
trigger1 = time = 15
ignorehitpause = 1
ID = 1440
name = "attack"
pos = 0,0
postype = p1
stateno = 1440
keyctrl = 0
ownpal = 1
helpertype = normal

[state 340, HB]
Type = hitby
trigger1 = animelemtime(5) < 0
value = SCA,AT
ignorehitpause = 1

[state 1400,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I


[state 1400, previous state]
type = varset
trigger1 = time = 0
v = 5
value = prevstateno


[State 330, 3]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1


;====================================================================================
;                                 Pickups
;====================================================================================

;Small Heal
[statedef 2500]
type = C
movetype = A
physics = N
velset = 0,0
sprpriority = 5
anim = 2500

[state 2500, turn if nessisary]
type = turn
trigger1 = facing != root,facing
trigger1 = time = 0

[state 2500, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance to Texas: %d"
params = rootdist x

[state 2500, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 25XX, screenbound]
type = screenbound
trigger1 = time < 8
value = 1
movecamera = 0,0

[state 2500, posset]
type = posset
trigger1 = time = 0
y = 0

[state 2500, Off]
type = statetypeset
trigger1 = rootdist x != [-200, 200]  
trigger1 = p2bodydist x != [-200, 200]
movetype = I
persistent = 1  

[state 2500, On]
type = statetypeset
trigger1 = rootdist x = [-200, 200]
trigger2 = p2bodydist x = [-200, 200]
movetype = A 
persistent = 1
   

[State 2500, 1]
type = HitDef
trigger1 = root,movetype = I || p2movetype = I
attr = C, ST         
hitflag = M-   
affectteam = B       
priority = 1, Miss    
sparkno = -1                                   
p1stateno = 2510     
p2stateno = 2520      
guard.dist = 0        
persistent = 1     

[State 800, 2]
type = destroyself
Trigger1 = time  >= 720
trigger2 = frontedgebodydist < -300
trigger3 = backedgebodydist < -300

;--------------------------------------------------------------------------------
;1 Bullet
[statedef 2501]
type = C
movetype = A
physics = N
velset = 0,0
sprpriority = 5
anim = 2501

[state 2500, turn if nessisary]
type = turn
trigger1 = facing != root,facing
trigger1 = time = 0

[state 2500, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance to Texas: %d"
params = rootdist x

[state 25XX, screenbound]
type = screenbound
trigger1 = time < 8
value = 1
movecamera = 0,0

[state 2500, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2501, posset]
type = posset
trigger1 = time = 0
y = 0

[state 2500, Off]
type = statetypeset
trigger1 = rootdist x != [-200, 200]
trigger1 = p2bodydist x != [-200, 200]
movetype = I
persistent = 1  

[state 2500, On]
type = statetypeset
trigger1 = rootdist x = [-200, 200]
trigger2 = p2bodydist x = [-200, 200]
movetype = A 
persistent = 1     

[State 2501, 1]
type = HitDef
trigger1 = root,movetype = I || p2movetype = I
attr = C, ST         
hitflag = M-   
affectteam = B       
priority = 1, Miss    
sparkno = -1                                   
p1stateno = 2511     
p2stateno = 2521      
guard.dist = 0        
persistent = 1       

[State 2501, 2]
type = destroyself
Trigger1 = time  >= 720
trigger2 = frontedgebodydist < -300
trigger3 = backedgebodydist < -300

;--------------------------------------------------------------------------------
;3 Bullet
[statedef 2502]
type = C
movetype = A
physics = N
velset = 0,0
sprpriority = 5
anim = 2502

[state 2500, turn if nessisary]
type = turn
trigger1 = facing != root,facing
trigger1 = time = 0

[state 2500, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance to Texas: %d"
params = rootdist x

[state 25XX, screenbound]
type = screenbound
trigger1 = time < 8
value = 1
movecamera = 0,0

[state 2500, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2501, posset]
type = posset
trigger1 = time = 0
y = 0

[state 2500, Off]
type = statetypeset
trigger1 = rootdist x != [-200, 200]
trigger1 = p2bodydist x != [-200, 200]
movetype = I
persistent = 1  

[state 2500, On]
type = statetypeset
trigger1 = rootdist x = [-200, 200]
trigger2 = p2bodydist x = [-200, 200]
movetype = A 
persistent = 1       

[State 2502, 1]
type = HitDef
trigger1 = root,movetype = I || p2movetype = I
attr = C, ST         
hitflag = M-   
affectteam = B      
priority = 1, Miss    
sparkno = -1                                   
p1stateno = 2512     
p2stateno = 2522      
guard.dist = 0        
persistent = 1  

[State 2502, 2]
type = destroyself
Trigger1 = time  >= 720
trigger2 = frontedgebodydist < -300
trigger3 = backedgebodydist < -300

;--------------------------------------------------------------------------------
;Large Heal
[statedef 2503]
type = C
movetype = A
physics = N
velset = 0,0
sprpriority = 5
anim = 2503

[state 2500, turn if nessisary]
type = turn
trigger1 = facing != root,facing
trigger1 = time = 0

[state 2500, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance to Texas: %d"
params = rootdist x

[state 25XX, screenbound]
type = screenbound
trigger1 = time < 8
value = 1
movecamera = 0,0

[state 2500, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2503, posset]
type = posset
trigger1 = time = 0
y = 0

[state 2500, Off]
type = statetypeset
trigger1 = rootdist x != [-200, 200]
trigger1 = p2bodydist x != [-200, 200]
movetype = I
persistent = 1  

[state 2500, On]
type = statetypeset
trigger1 = rootdist x = [-200, 200]
trigger2 = p2bodydist x = [-200, 200]
movetype = A 
persistent = 1  


[State 2503, 1]
type = HitDef
trigger1 = root,movetype = I || p2movetype = I
attr = C, ST         
hitflag = M-   
affectteam = B      
priority = 1, Miss    
sparkno = -1                                   
p1stateno = 2513     
p2stateno = 2523      
guard.dist = 0  
persistent = 1 
          

[State 2503, 2]
type = destroyself
Trigger1 = time  >= 720
trigger2 = frontedgebodydist < -300
trigger3 = backedgebodydist < -300

;--------------------------------------------------------------------------------
;Dissappear Effect
;--------------------------------------------------------------------------------
;Drumstick
[statedef 2510]
type = A
movetype = I
physics = N
velset = 0,0
anim = 2510

[state 2501, playsnd]
type = playsnd
trigger1 = time = 0
value = S2500,0

[state 2501, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2501, if on ground]
type = posset
trigger1 = time = 0
trigger1 = pos y > 0
y = 0

[state 2501, destroyself]
type = destroyself
trigger1 = animtime = 0

;-------------------------------------------------------------
;Bullet
[statedef 2511]
type = A
movetype = I
physics = N
velset = 0,0
anim = 2511

[state 2501, playsnd]
type = playsnd
trigger1 = time = 0
value = S2500,1

[state 2501, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2501, if on ground]
type = posset
trigger1 = time = 0
trigger1 = pos y > 0
y = 0

[state 2501, destroyself]
type = destroyself
trigger1 = animtime = 0
;----------------------------------------------------------------
; 3 bullets

[statedef 2512]
type = A
movetype = I
physics = N
velset = 0,0
anim = 2512

[state 2501, playsnd]
type = playsnd
trigger1 = time = 0
value = S2500,2

[state 2512, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2512, if on ground]
type = posset
trigger1 = time = 0
trigger1 = pos y > 0
y = 0

[state 2512, destroyself]
type = destroyself
trigger1 = animtime = 0

;----------------------------------------------------------------
; Large Health
[statedef 2513]
type = A
movetype = I
physics = N
velset = 0,0
anim = 2513

[state 2501, playsnd]
type = playsnd
trigger1 = time = 0
value = S2500,3

[state 2513, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2513, if on ground]
type = posset
trigger1 = time = 0
trigger1 = pos y > 0
y = 0

[state 2513, destroyself]
type = destroyself
trigger1 = animtime = 0

;----------------------------------------------------------------------------------
;Effects
;----------------------------------------------------------------------------------
;Small Heal
[statedef 2520]
type = U
movetype = I
physics = U

[state 2520, lifeadd]
type = lifeadd
trigger1 = time = 0
value = 60
absolute = 1
persistent = 0
ignorehitpause = 1

[state 2520, poweradd]
type = poweradd
trigger1 = time = 0
value = 100
persistent = 0
ignorehitpause = 1

[state 2520, nothitby]
type = nothitby
trigger1 = time = 0
value = SCA
ignorehitpause =1 
persistent = 1
time = 2

[state 2520, Visual indicator]
type = palfx
trigger1 = time = 0
time = 24
add = 196,196,196;32,150,32 
;sinadd = ;32,64,5,3
ignorehitpause
persistent = 1

[state 2520, return]
type = selfstate
trigger1 = time = 1
value = ifelse(statetype = A, 50, ifelse(statetype = C, 11, 0))
ctrl = 1


;------------------------------------------------------------------------------------
;Small Ammo
[statedef 2521]
type = U
movetype = I
physics = U

[state 2521, Bullet Add]
type = varadd
trigger1 = name = "Texas Stanton" || name = "Enorma Pig"
trigger1 = time = 0
var(26) = 1
persistent = 0

[state 2521, Bullet Add]
type = poweradd
trigger1 = time = 0
value = 200
persistent = 0



[state 2521, nothitby]
type = nothitby
trigger1 = time = 0
value = SCA
ignorehitpause =1 
persistent = 1
time = 2

[state 2521, Visual indicator]
type = palfx
trigger1 = time = 0
time = 24
add = 196,196,196;32,150,32 
;sinadd = ;32,64,5,3
ignorehitpause
persistent = 1

[state 2521, return]
type = selfstate
trigger1 = time = 1
value = ifelse(statetype = A, 50, ifelse(statetype = C, 11, 0))
ctrl = 1

;------------------------------------------------------------------------------------
;Large Ammo
[statedef 2522]
type = U
movetype = I
physics = U

[state 2522, Bullet Add]
type = varadd
trigger1 = name = "Texas Stanton" || name = "Enorma Pig"
trigger1 = time = 0
var(26) = 3
persistent = 0

[state 2522, Bullet Add]
type = poweradd
trigger1 = time = 0
value = 600
persistent = 0



[state 2522, nothitby]
type = nothitby
trigger1 = time = 0
value = SCA
ignorehitpause =1 
persistent = 1
time = 2

[state 2522, Visual indicator]
type = palfx
trigger1 = time = 0
time = 24
add = 196,196,196;32,150,32 
;sinadd = ;32,64,5,3
ignorehitpause
persistent = 1

[state 2522, return]
type = selfstate
trigger1 = time = 1
value = ifelse(statetype = A, 50, ifelse(statetype = C, 11, 0))
ctrl = 1

;-----------------------------------------------------------------------------------

;Large Heal

[statedef 2523]
type = U
movetype = I
physics = U

[state 2523, lifeadd]
type = lifeadd
trigger1 = time = 0
value = 180
absolute = 1
persistent = 0
ignorehitpause = 1

[state 2523, poweradd]
type = poweradd
trigger1 = time = 0
value = 300
persistent = 0
ignorehitpause = 1

[state 2523, nothitby]
type = nothitby
trigger1 = time = 0
value = SCA
ignorehitpause =1 
persistent = 1
time = 2

[state 2523, Visual indicator]
type = palfx
trigger1 = time = 0
time = 24
add = 196,196,196;32,150,32 
;sinadd = ;32,64,5,3
ignorehitpause
persistent = 1

[state 2523, return]
type = selfstate
trigger1 = time = 1
value = ifelse(statetype = A, 50, ifelse(statetype = C, 11, 0))
ctrl = 1

;=====================================================================================

; SUPERS

;====================================================================================
;Roxxie Ambush
[statedef 3000]
type = S
movetype = A
physics = S
anim = 3000
velset = 0, 0 
ctrl = 0

[state 3000, COMBO SCALING]
type = varset
trigger1 = var(18) < 90
trigger1 = time = 0
var(18) = 90
ignorehitpause = 1

[state 3000, no bg]
type = assertspecial
trigger1 = time = [0,60]
flag = nobg
ignorehitpause = 1

[state 3000, nothitby]
type = nothitby
trigger1 = time < 72
value = SCA

[State 3040, Super Pause]
type = SuperPause
trigger1 = animelemtime(1) = 1
sound = S3000, 1
poweradd = -3000
pos = -10,-200
time = 60
movetime = 60

[state 3001, Super Portrait]
type = explod
trigger1 = time = [1,15]
anim = 3101
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3001, Super Portrait]
type = explod
trigger1 = time = 16
anim = 3101
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3000, Helper]
type = helper
trigger1 = time = 44
trigger1 = !numhelper(4300)
id = 4300
name = "Roxxie Rose"
stateno = 4310
postype = p1
pos = 0, -2160
supermovetime = 16
ignorehitpause = 1
ownpal = 1

[state 3000, Hitby Roxxie]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),parentdist x = [-100,100]
trigger1 = helper(4300), parentdist y = [0, 420]
value = 3010
ignorehitpause = 1

[state 3000, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------
;Stuck to Roxxie Down
[statedef 3010]
type = A
movetype = H
physics = N
anim = 4340



[state 3010, Posset]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), stateno = 4310
x = helper(4300),pos x - 45
y = helper(4300),pos y - 95
persistent = 1

[state 3010, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4311
value = 3011

[state 3010, Selfstate]
type = selfstate
trigger1 = time > 180
value = 5050

;-----------------------------------------------------------------------------------------------
;Stuck to Roxxie Up
[statedef 3011]
type = A
movetype = H
physics = N
anim = 4341

[state 3010, lifeadd]
type = lifeadd
trigger1 = time = 0
value = -60
kill = 0

[state 3011, Posset 1]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), stateno = 4311
trigger1 = helper(4300), animelemtime(2) < 0
x = helper(4300),pos x - 110
y = helper(4300),pos y - 60
persistent = 1

[state 3011, Posset 2]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), stateno = 4311
trigger1 = helper(4300), animelemtime(2)>= 0 && Helper(4300), animelemtime(3) < 0
x = helper(4300),pos x - 110
y = helper(4300),pos y - 60
persistent = 1

[state 3011, Posset 3]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), stateno = 4311
trigger1 = helper(4300), animelemtime(3)>= 0 
x = helper(4300),pos x - 30
y = helper(4300),pos y - 70
persistent = 1

[state 3011, selfstate]
type = selfstate
trigger1 = time > 180
value = 5050


[state 3010, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4312
value = 3012

;---------------------------------------------------------------------------------------------
;Stuck on Bounce
[statedef 3012]
type = L
movetype = H
physics = N
anim = 4341

[state 3010, lifeadd]
type = lifeadd
trigger1 = time = 0
value = -15
kill = 0

[state 3012, posset]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4312
x = helper(4300), pos x - 90
y = helper(4300), pos y - 20

[state 3012, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4300
value = 5050

[state 3012, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4313
value = 3013


;---------------------------------------------------------------------------------------------
;Face clapped
[statedef 3013]
type = L
movetype = H
physics = N
anim = 4343

[state 3013, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3013, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3013, lifeadd]
type = lifeadd
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(16) = 0
value = -5
kill = 0

[state 3013, posset 1]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(2) < 0
trigger2 = helper(4300), animelemtime(11) >= 0  && helper(4300), animelemtime(12) < 0 
x = helper(4300), pos x - 150 * const(size.xscale) * facing
y = helper(4300), pos y - 145 * const(size.yscale)

[state 3013, posset 2]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(2) >= 0  && helper(4300),animelemtime(3) < 0
trigger2 = helper(4300), animelemtime(12) >= 0  && helper(4300), animelemtime(13) < 0 
x = helper(4300), pos x - 150 * const(size.xscale) * facing
y = helper(4300), pos y - 160 * const(size.yscale)

[state 3013, posset 3]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(3) >= 0  && helper(4300), animelemtime(4) < 0 
trigger2 = helper(4300), animelemtime(13) >= 0  && helper(4300), animelemtime(14) < 0 
x = helper(4300), pos x - 150 * const(size.xscale) * facing
y = helper(4300), pos y - 215 * const(size.yscale)

[state 3013, posset 4]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(4) >= 0  && helper(4300), animelemtime(5) < 0 
trigger2 = helper(4300), animelemtime(14) >= 0  && helper(4300), animelemtime(15) < 0 
x = helper(4300), pos x - 150 * const(size.xscale) * facing
y = helper(4300), pos y - 250 * const(size.yscale)

[state 3013, posset 5]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(5) >= 0  && helper(4300), animelemtime(6) < 0 
trigger2 = helper(4300), animelemtime(15) >= 0  && helper(4300), animelemtime(16) < 0 
x = helper(4300), pos x - 190 * const(size.xscale) * facing
y = helper(4300), pos y - 220 * const(size.yscale)

[state 3013, posset 6]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(6) >= 0  && helper(4300), animelemtime(7) < 0 
trigger2 = helper(4300), animelemtime(16) >= 0  && helper(4300), animelemtime(17) < 0 
x = helper(4300), pos x - 180 * const(size.xscale) * facing
y = helper(4300), pos y - 255 * const(size.yscale)

[state 3013, posset 7]
type = posset
triggerall = numhelper(4300)
trigger1 = helper(4300), animelemtime(7) >= 0  && helper(4300), animelemtime(8) < 0 
trigger2 = helper(4300), animelemtime(17) >= 0  && helper(4300), animelemtime(18) < 0 
x = helper(4300), pos x - 160 * const(size.xscale) * facing
y = helper(4300), pos y - 250 * const(size.yscale)

[state 3013, posset 8]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), animelemtime(8) >= 0  && helper(4300), animelemtime(9) < 0 
trigger2 = helper(4300), animelemtime(18) >= 0  && helper(4300), animelemtime(19) < 0 
x = helper(4300), pos x - 160 * const(size.xscale) * facing
y = helper(4300), pos y - 250 * const(size.yscale)

[state 3013, posset 9]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), animelemtime(9) >= 0  && helper(4300), animelemtime(10) < 0 
trigger2 = helper(4300), animelemtime(19) >= 0  && helper(4300), animelemtime(20) < 0 
x = helper(4300), pos x - 200 * const(size.xscale) * facing
y = helper(4300), pos y - 230 * const(size.yscale)

[state 3013, posset 10]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300), animelemtime(10) >= 0  && helper(4300), animelemtime(11) < 0 
trigger2 = helper(4300), animelemtime(20) >= 0   
x = helper(4300), pos x - 230 * const(size.xscale) * facing
y = helper(4300), pos y - 225 * const(size.yscale)


[state 3013, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4314
value = 3014


;---------------------------------------------------------------------------------------------
;Ride to Wall
[statedef 3014]
type = L
movetype = H
physics = N
anim = 4344

[state 3013, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3012, posset]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4314
x = helper(4300), pos x - 150 * facing
y = helper(4300), pos y - 300

[state 3012, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
value = 3015

;------------------------------------------------------------------------------
;Stick to Wall 1
[statedef 3015]
type = A
movetype = H
physics = N
sprpriority = 0

[state 3015, damage]
type = lifeadd
trigger1 = time = 0
value = -30
kill = 0

[state 3015, changeanim2]
type = changeanim
trigger1 = time = 0
value = 4345

[state 3015, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))
y = -400
[state 3015, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3015, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.1, 0.8

[state 3015, nothitby]
type = nothitby
trigger1 = time = 119
value = SCA
time = 45

[state 3015, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 3
value = 3016

[state 3015, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 1
value = 3019

[state 3015, End]
type = selfstate
trigger1 = time > 120
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 2
[statedef 3016]
type = A
movetype = H
physics = N
sprpriority = 0

[state 3015, damage]
type = lifeadd
trigger1 = time = 0
value = -30
kill = 0

[state 3016, changeanim2]
type = changeanim
trigger1 = time = 0
value = 4345

[state 3016, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3016, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3016, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.2, 0.6

[state 3016, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 3
value = 3017


[state 3015, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 1
value = 3019

[state 3016, End]
type = selfstate
trigger1 = time > 120
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 3
[statedef 3017]
type = A
movetype = H
physics = N
sprpriority = 0

[state 3015, damage]
type = lifeadd
trigger1 = time = 0
value = -30
kill = 0

[state 3017, changeanim2]
type = changeanim
trigger1 = time = 0
value = 4345

[state 3017, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3017, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3017, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.3, 0.4

[state 3016, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 2
value = 3018


[state 3015, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 1
value = 3019

[state 3016, End]
type = selfstate
trigger1 = time > 120
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 4
[statedef 3018]
type = A
movetype = H
physics = N
sprpriority = 0

[state 3015, damage]
type = lifeadd
trigger1 = time = 0
value = -30
kill = 0

[state 3018, changeanim2]
type = changeanim
trigger1 = time = 0
value = 4345

[state 3018, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3018, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3018, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.4, 0.2

[state 3018, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4315
trigger1 = helper(4300),var(1) = 1
value = 3019

[state 3016, End]
type = selfstate
trigger1 = time > 120
value = 5050

;----------------------------------------------------------------------------------------------
;Fall off wall into stun
[statedef 3019]
type = A
movetype = H
physics = N
anim = 3018
velset = 8, -1

[state 3019, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3019, stun Gauge]
type = varset
trigger1 = time = 0
var(17) = floor(life / 10)
ignorehitpause = 1

[state 3020, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Mash number: %d"
params = var(17)

[state 3015, damage]
type = lifeadd
trigger1 = time = 0
value = -30
kill = 0

[state 3019, gravity]
type = gravity
trigger1 = pos y < 0

[state 3019, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3020

;----------------------------------------------------------------------------------------------
;Stun
[statedef 3020]
type = S
movetype = H
physics = S
anim = 5300
velset = 0,0

[state 3020, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 3020, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3020, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4910)
anim = 4910
postype = p1
pos = 0,-100
ontop = 1
ownpal = 1
removetime = 240
id = 4910
removeongethit = 1
bindtime = -1

[State X, Blink Yellow]
type = PalFX
trigger1 = var(17) >= 110
time = 12
add = 228,228,228 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause = 1
persistent = 0

[state 3020, posadd]
type = posadd
trigger1 = command = "holdback"
trigger2 = ailevel
x = -3
persistent = 3

[state 3020, posadd]
type = posadd
trigger1 = command = "holdfwd"
trigger2 = ailevel
x = 3
persistent = 3



[state 3020, removeexplod]
type = removeexplod
trigger1 = var(17) >= 110
trigger1 = time > 0
id = 4910
persistent = 1
ignorehitpause = 1

[state 3020, selfstate]
type = selfstate
trigger1 = time > 120
value = 0
ctrl = 1

[state 3020, varadd]
type = varadd
trigger1 = command = "Texas"
trigger1 = !ailevel
var(17) = ifelse(power < 1000, 1, 3)
persistent = 1

[state 3020, poweradd]
type = poweradd
trigger1 = command = "Texas"
trigger1 = !ailevel
trigger1 = power < 1000
value = 25
persistent = 1

[state 3020, varadd]
type = varadd
trigger1 = Ailevel
trigger1 = power > 1000
var(17) = 3
persistent = 4

[state 3020, varadd]
type = varadd
trigger1 = Ailevel
trigger1 = power <= 1000
var(17) = 1
persistent = 4

[state 3020, varadd]
type = poweradd
trigger1 = Ailevel
trigger1 = power <= 1000
value = 50
persistent = 4



[state 3020, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Mash number: %d"
params = var(17)

[state 3020, Escape]
type = changestate
triggerall = power > 999
trigger1 = var(17) >= 110
triggerall = numhelper(4300)
triggerall = helper(4300),stateno = 4316
triggerall = helper(4300),parentdist x = [-800,-500]
value = 3120

[state 3020, HIT]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4316
trigger1 = helper(4300),parentdist x = [-600,-300]
value = 3021

;---------------------------------------------------------------------------------------------
;Stuck on Bounce
[statedef 3021]
type = L
movetype = H
physics = N
anim = 4344

[state 3013, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4910

[state 3013, playerpush]
type = playerpush
trigger1 = 1
value = 0


[state 3012, posset]
type = posset
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4316
x = helper(4300), pos x + 500 * -facing
y = helper(4300), pos y - 300

[state 3012, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4317
value = 3022

;------------------------------------------------------------------------------
;Stick to Wall 5
[statedef 3022]
type = A
movetype = H
physics = N
sprpriority = 0

[state 3015, damage]
type = lifeadd
trigger1 = time = 0
value = -60
kill = 0

[state 3018, changeanim2]
type = changeanim
trigger1 = time = 0
value = 4345

[state 3018, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3018, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3018, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.5, 0.1

[state 3022, velset]
type = velset
trigger1 = time > 160
x = 15
y = -4

[state 4123, StinkLines]
type = null;Helper
trigger1 = time = 138
stateno = 4046
postype = p2
pos = 0,0
ownpal = 1
name = "p1 Stinklines"
id = 4046
ignorehitpause = 1

[state 3016, End]
type = selfstate
trigger1 = time > 160
value = 5050


;---------------------------------------------------------------------------------------------
;Defiance / Iron Weasel
[statedef 3120]
type = S
movetype = A
physics = N
anim = 3120

[state 3120, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4910


[State 3120, Super Pause]
type = SuperPause
trigger1 = animelemtime(1) = 1
sound = S3000, 1
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60


[state 3120, Super Portrait]
type = explod
trigger1 = time = [1,15]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3120, Super Portrait]
type = explod
trigger1 = time = 16
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3000, no bg]
type = assertspecial
trigger1 = time = [0,60]
flag = nobg
ignorehitpause = 1

[state 3120, nothitby]
type = nothitby
trigger1 = time < 80
value = SCA

[state 3120, velset]
type = velset
trigger1 = animelemtime(2) >= 0 && animelemtime(6) < 0
x = 80
persistent = 1

[state 3120, statetypeset]
type = statetypeset
trigger1 = animelemtime(6) = 0
physics = C
statetype = C

[state 3120, turn]
type = turn
trigger1 = animtime = 0


[state 3120, end]
type = changestate
trigger1 = animtime = 0
value = 3121

;---------------------------------------------------------------------------------------------;
;Lasso Portion
[statedef 3121]
type = S
movetype = A
physics = S
anim = 3121
velset = 0,0

[state 3121, playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 1050,0


[state 1051, throw Lasso]
type = helper
trigger1 = !numhelper(3130)
trigger1 = animelemtime(16) = 0
stateno = 3130
id = 3130
postype = p1
pos = 200 * const(size.xscale), -275 * const(size.yscale)
name = "Lasso"

[state 1080, Rope]
type = explod
trigger1 = animelemtime(16) >= 1
trigger1 = numhelper(3130)
trigger1 = !numexplod(1050)
id = 1050
anim = 2050
postype = p1
pos = 410 * const(size.xscale), -275 * const(size.yscale)  
facing = -1
scale = (helper(3130),rootdist x - helper(3130),vel x  +  410 * const(size.xscale)) * 0.5, 1
removeongethit = 1
removetime = 300 
ignorehitpause = 1

[state 1050, modifyexplod]
type = modifyexplod
trigger1 = numexplod(1050)
trigger1 = numhelper(3130)
id = 1050
postype = p1
facing = -1
pos = 410, -275 * const(size.yscale)
scale = (helper(3130),rootdist x - helper(3130),vel x + 410 * const(size.xscale)) * 0.5, 1
persistent = 1

[state 3121, changestate]
type = changestate
trigger1 = numhelper(3130)
trigger1 = helper(3130),stateno = 3131
value = 3122

;----------------------------------------------------------------------------------------------

;Super Pull and throw
[statedef 3122]
type = S
movetype = A
physics = N
anim = 3122
velset = 0,0

[state 3122, veladd]
type = velset
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0
x = -4

[state 3122, dust]
type = explod
trigger1 = animelemtime(7) > 4 && animelemtime(8) < 0
anim = 2025
postype = p1
pos = -150 * const(size.xscale), 20 * const(size.yscale)
sprpriority = 3
scale = 1,1
persistent = 2
accel = 0,-0.22

[state 3122, veladd]
type = velset
trigger1 = animelemtime(8) = 0
x = 10

[state 3122, Jump]
type = velset
trigger1 = animelemtime(10) = 0
x = 9
y = -18

[state 3122, gravity]
type = gravity
trigger1 = animelemtime(10) > 0

[state 3122, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3123

;----------------------------------
;Landing Lag
[statedef 3123] 
type = C
movetype = I
physics = C
anim = 3123
velset = 0,0

[state 3123, on ground]
type = posset
trigger1 = time = 0
y = 0


[state 3123, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------
;Lasso
[statedef 3130]
type = A
movetype = A
physics = N
anim = 2061

[state 3130, velset]
type = velset
trigger1 = time = 0
x = 72

[state 3130, changestate]
type = changestate
trigger1 = numhelper(4300)
trigger1 = helper(4300), pos x = [pos x - 150, pos x + 150]
value = 3131

;----------------------------------------------------------------------------------------------
;Caught
[statedef 3131]
type = A
movetype = I
physics = N
anim = 2052
sprpriority = 3
velset = 0,0

[state 3131, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3131, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = 2.5,1.5

[state 3131, sprpriority]
type = sprpriority
trigger1 = time = 48
value = -1

[state 3131, postype]
type = posset
trigger1 = 1
trigger1 = numhelper(4300)
x = helper(4300),pos X

[state 3131, destroyself]
type = destroyself
trigger1 = numhelper(4300)
trigger1 = helper(4300),stateno = 4321


;----------------------------------------------------------------------------------------------
;Georgia Summon
[STATEDEF 3040]
TYPE = S
movetype = A
physics = S
anim = 3040
velset = 0,0
ctrl = 0


[State 3040, Super Pause]
type = SuperPause
trigger1 = animelemtime(1) = 1
sound = S3000, 1
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60


[state 3040, Helper]
type = Helper
trigger1 = animelemtime(1) = 1
trigger1 = !numhelper(4100)
postype = p1
pos = -460,-1440
stateno = 4100
id = 4100
ownpal = 1
name = "Georgia"
ignorehitpause = 1


[state 3001, Super Portrait]
type = explod
trigger1 = time = [1,15]
anim = 3103
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3001, Super Portrait]
type = explod
trigger1 = time = 16
anim = 3103
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3040, Armor Georgia]
type = varset
trigger1 = animelemtime(1) = 1
var(20) = 100
ignorehitpause = 1
 

[state 3000, no bg]
type = assertspecial
trigger1 = time = [0,60]
flag = nobg
ignorehitpause = 1

[state 3040, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------
;Smiling Jacks and Caramel Summon
[STATEDEF 3080]
TYPE = S
movetype = A
physics = S
anim = 3080
velset = 0,0
ctrl = 0


[State 3080, Super Pause]
type = SuperPause
trigger1 = animelemtime(1) = 1
sound = S3000, 1
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60

[state 3080, Hooves coming]
type = playsnd
trigger1 = time > 0
value = 4200,0
volumescale = ifelse(time > 70, 100, time+ 30)
persistent = 24
ignorehitpause =1 

[state 3080, Hooves coming]
type = playsnd
trigger1 = time > 12
value = 4200,0
volumescale = ifelse(time > 70, 100, time+ 30)
persistent = 24
ignorehitpause =1 


[state 3080, Hooves coming]
type = playsnd
trigger1 = time > 36
value = 4200,0
volumescale = ifelse(time > 70, 100, time+ 30)
persistent = 24
ignorehitpause =1 

[state 3080, Hooves coming]
type = playsnd
trigger1 = time > 42
value = 4200,0
volumescale = ifelse(time > 70, 100, time+ 30)
persistent = 24
ignorehitpause =1 

[state 3001, Super Portrait]
type = explod
trigger1 = time = [1,15]
anim = 3102
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3001, Super Portrait]
type = explod
trigger1 = time = 16
anim = 3102
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3000, no bg]
type = assertspecial
trigger1 = time = [0,60]
flag = nobg
ignorehitpause = 1

[state 3080, Caramel Summon]
type = helper
trigger1 = !numhelper(4200)
trigger1 = time = 50
postype = p1
pos = -1280, 0
stateno = 4200
id = 4200
ownpal = 1
name = "Caramel"
supermovetime = 10

[state 4200, Rider]
type = helper
trigger1 = time = 48
trigger1 = !numhelper(4250)
id = 4250
stateno = 4250
postype = p1
pos = -1300 * const(size.xscale) * fvar(22),  -340 * const(size.yscale) * fvar(22)
ownpal = 1
name = "Smilin Jacks"
supermovetime = 12

[state 3080, Armor Life set]
type = varset
trigger1 = time = 48
var(20) = 120
ignorehitpause = 1

[state 3080, Knockeddown]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),parentdist x =[0, 440]
trigger1 = helper(4200),parentdist y = [0, 400]
value = 3081


[state 3080, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------------
;Ran over
[statedef 3081]
type = A
movetype = H
physics = N
anim = 3081
velset = 20, -10

[state 3081, pause]
type = pause
trigger1 = time = 0
time = 6

[state 3081, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 6
ignorehitpause =1 

[state 3081, lifeadd]
type = lifeadd
trigger1 = time = 0
kill = 0
value = -80
ignorehitpause =1
persistent = 0


[state 3081, explod]
type = explod
trigger1 = time = 0
anim = F3
postype = p1
pos = -60,-300
ontop = 1

[state 3081, playsnd]
type = playsnd
trigger1 = time = 0
value = F5,4

[state 3081, gravity]
type = gravity
trigger1 = pos y < 0

[state 3081, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > - vel y
value = 3082

;----------------------------------------------------------------------------------------
;Rolling
[statedef 3082]
type = C
movetype = H
physics = N
anim = 3082
velset = 20,0

[state 3081, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3081, velmul]
type = veladd
trigger1 = 1
x = -1.5
persistent = 2

[state 3081, stop]
type = changestate
trigger1 = vel x < -40
trigger2 = numhelper(4200)
trigger2 = helper(4200),parentdist x < -650
value = 3083

;---------------------------------------------------------------------
;Laydown
[statedef 3083]
type = L
movetype = H
physics = C
anim = 3083
velset = 0,0

[state 3083, dizzytimesetup]
type = varset
trigger1 = time = 0
var(17) = floor(life / 10)

[state 3083, changestate]
type = changestate
trigger1 = time > 80
value = 3084

;----------------------------------------------------------------------
;Free Hit
[statedef 3084]
type = S
movetype = H
physics = S
anim = 5120
sprpriority = 3

[state 3020, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4910)
anim = 4910
postype = p1
pos = 0,-100
ontop = 1
ownpal = 1
removetime = 120
id = 4910
removeongethit = 1
bindtime = -1

[state 3020, posadd]
type = posadd
trigger1 = command = "holdback"
x = -3
persistent = 5

[state 3020, posadd]
type = posadd
trigger1 = command = "holdfwd"
x = 3
persistent = 5

[state 3084, wakeup]
type = varadd
trigger1 = command = "Texas"
trigger1 = !ailevel
var(17) = 5
persistent = 1

[state 3084, wakeup]
type = varadd
trigger1 = ailevel
var(17) = 5
persistent = 6

[state 3020, removexplod]
type = removeexplod
trigger1 = time > 0
trigger1 = var(17) >= 110
id = 4910
ignorehitpause =1 


[state 3084, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Mash score: %d"
params = var(17) 
persistent = 1

[State X, Blink Yellow]
type = PalFX
trigger1 = var(17) > 110
time = 12
add = 228,228,228 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause = 1
persistent = 0



[state 3084, changeanim]
type = changeanim
trigger1 = anim = 5120
trigger1 = animtime = 0
value = 5300

[state 3084, EnD]
type = changestate
trigger1 = var(17) > 110
value = 105
ctrl = 0

[state 3084, EnD]
type = changestate
trigger1 = time > 120
value = 0
ctrl = 1



;------------------------------------------------------------------------------------
;Jane Intro
[statedef 4000]
type = S
physics = S
movetype = I
ctrl = 0
sprpriority = -3

[state 4001, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4000, Pig set animation]
type = changeanim
trigger1 = time = 0
value = 4000

[state 4000, destroyself]
type = changestate
trigger1 = roundstate = 2
trigger2 = time > 150
value = 4005

;------------------------------------------------------------------------------------
;Jesse Intro
[statedef 4001]
type = S
physics = S
movetype = I
ctrl = 0
sprpriority = -3

[state 4001, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4001, Pig set animation]
type = changeanim
trigger1 = time = 0
value = 4001

[state 4001, destroyself]
type = changestate
trigger1 = roundstate = 2
trigger2 = time > 120
value = 4006

;-----------------------------------------------------------------------------------
;Jane Exit
[statedef 4005]
type = S
movetype = I
physics = S
ctrl = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4005, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4005, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4010, 0 
persistent = 1
ignorehitpause = 1

[state 4005, playsnd]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12
ignorehitpause = 1
persistent = 1

[state 4001, turn]
type = turn
triggerall = time = 0
trigger1 = backedgebodydist < frontedgebodydist
ignorehitpause = 1
persistent = 0

[state 4005, anim]
type = changeanim
trigger1 = anim != 4010
value = 4010 

[state 4005, velocity]
type = velset
trigger1 = 1
x = 18.5

[state 4005, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Back edge:  %d , Front Edge: %d"
params = backedgebodydist, frontedgebodydist 

[state 4005, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -600
trigger2 = time > 300

;-----------------------------------------------------------------------------------
;Jesse Exit
[statedef 4006]
type = S
movetype = I
Physics = S
ctrl = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4006, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4006, turn]
type = turn
triggerall = time = 0
trigger1 = backedgebodydist < frontedgebodydist
ignorehitpause = 1
persistent = 0

[state 4005, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4010, 0 
persistent = 1
ignorehitpause = 1

[state 4005, playsnd]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12
ignorehitpause = 1
persistent = 1

[state 4006, anim]
type = changeanim
trigger1 = anim != 4011
value = 4011

[state 4006, velocity]
type = velset
trigger1 = 1
x = 18.0

[state 4006, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -600
trigger2 = time > 300


;------------------------------------------------------------------------------------
;Jane Idle
[statedef 4007]
type = S
physics = S
movetype = I
ctrl = 0
sprpriority = -3
velset = 0,0

[state 4007, posadd]
type = posadd
trigger1 = time = 0
trigger1 = prevstateno = 4025
x = -488
persistent = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4007, nothitby]
type = nothitby
trigger1 = prevstateno = [4020, 4039]
value = ,AT
ignorehitpause =1 
persistent = 1

[state 4007, nothitby]
type = nothitby
trigger1 = prevstateno = [4080, 4099]
value = SCA
ignorehitpause =1 
persistent = 1

[State 4007, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4090
time = 1
ignorehitpause = 1
persistent = 1


[state 4001, Pig set animation]
type = changeanim
trigger1 = time = 0
value = 4000 

[state 4001, destroyself]
type = changestate
trigger1 = time > 12
value = 4005 

;------------------------------------------------------------------------------------
;Jesse Idle
[statedef 4008]
type = S
physics = S
movetype = I
ctrl = 0
sprpriority = -3
velset = 0,0

[state 4007, posadd]
type = posadd
trigger1 = time = 0
trigger1 = prevstateno = 4025
x = -488
persistent = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4007, nothitby]
type = nothitby
trigger1 = prevstateno = [4020, 4039]
value = ,AT
ignorehitpause =1 
persistent = 1

[state 4007, nothitby]
type = nothitby
trigger1 = prevstateno = [4080, 4099]
value = SCA
ignorehitpause =1 
persistent = 1

[State 4007, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4095
time = 1
ignorehitpause = 1
persistent = 1

[state 4001, Pig set animation]
type = changeanim
trigger1 = time = 0
value = 4001

[state 4001, destroyself]
type = changestate
trigger1= time > 12
value = 4006

;------------------------------------------------------------------------------------
;Run in
;-----------------------------------------------------------------------------------
;Pigs  Rush in -> Horizontal Assist
[statedef 4010]
type = S
movetype = A
physics = S
ctrl = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4010, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

;===========
;Armor start
;===========

;determine what frame
[state 4010, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4010, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4010, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4010, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1


[state 4010, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4010, 4090)
time = 1
persistent = 1

[State 4010, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1


[state 4010, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4010, 0 
persistent = 1
ignorehitpause = 1

[state 4010, playsnd]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12
ignorehitpause = 1
persistent = 1

[state 4010, anim]
type = changeanim
trigger1 = anim != 4010 + parent,var(15)
value = 4010 + parent,var(15)

[state 4010, velocity]
type = velset
trigger1 = 1
x = 22

[state 4010, Attack]
type = changestate
trigger1 = p2bodydist x = [50,200]
trigger1 = p2bodydist y = [-550,0]
;trigger2 = parentDist x < 300
value = 4020

[state 40XX, Imediately go to hurt state]
type = changestate
trigger1 = parent,var(20) < 1
value = 4090



[state 4010, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "ParentDist X:  %d , Front Edge: %d"
params = ParentDist x, frontedgebodydist 

[state 4010, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -400

;-----------------------------------------------------------------------------------
;Pigs rush in - Falling Vertical Assist
;Pigs  Rush in
[statedef 4012]
type = S
movetype = A
physics = S
ctrl = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1


[state 4012, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

;===========
;Armor start
;===========

;determine what frame
[state 4012, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4012, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4012, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4012, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1


[state 4012, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4012, 4090)
time = 1
persistent = 1

[State 4012, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1


[state 4012, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4010, 0 
persistent = 1
ignorehitpause = 1

[state 4012, playsnd]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12
ignorehitpause = 1
persistent = 1

[state 4012, anim]
type = changeanim
trigger1 = anim != 4010 + parent,var(15)
value = 4010 + parent,var(15)

[state 4012, velocity]
type = velset
trigger1 = 1
x = 22

[state 4012, Attack]
type = changestate
trigger1 = backedgebodydist > 200
;trigger1 = parentDist x = [-1000, -300]
value = 4030

[state 40XX, Imediately go to hurt state]
type = changestate
trigger1 = parent,var(20) < 1
value = 4090


[state 4012, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "ParentDist X:  %d , Front Edge: %d , Back Edge: %d"
params = ParentDist x, frontedgebodydist, backedgebodydist  

[state 4012, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -400

;-----------------------------------------------------------------------------------
;Pigs  Rush in -> Horizontal Assist
[statedef 4014]
type = S
movetype = A
physics = S
ctrl = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4014, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

;===========
;Armor start
;===========

;determine what frame
[state 4014, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4014, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4010, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4014, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1


[state 4014, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4014, 4090)
time = 1
persistent = 1

[State 4014, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1


[state 4014, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4010, 0 
persistent = 1
ignorehitpause = 1

[state 4014, playsnd]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12
ignorehitpause = 1
persistent = 1

[state 4014, anim]
type = changeanim
trigger1 = anim != 4010 + parent,var(15)
value = 4010 + parent,var(15)

[state 4014, velocity]
type = velset
trigger1 = 1
x = 22

[state 4014, Attack]
type = changestate
trigger1 = p2bodydist x = [0,400]
trigger2 = parentdist x = [0, 400]
trigger2 = parent,statetype = A
value = 4060

[state 40XX, Imediately go to hurt state]
type = changestate
trigger1 = parent,var(20) < 1
value = 4090



[state 4014, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "ParentDist X:  %d , Front Edge: %d, Enemy dist: %d"
params = ParentDist x, frontedgebodydist, p2bodydist x 

[state 4014, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -400

;------------------------------------------------------------------------------------
;Hip Check - Horizontal Assist
[statedef 4020]
type = S
movetype = A
physics = N

[state 4020, attackmulset]
type = AttackMulSet
trigger1 = 1
value = parent,fvar(10)
persistent = 1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4020, Dust]
type = explod
trigger1 = animelemtime(5) > 0 && animelemtime(9) < 0
anim = 2025
postype = p1
pos = 70,20
persistent = 4
sprpriority = 3

;===========
;Armor start
;===========

;determine what frame
[state 4020, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4020, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4020, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4020, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1


[state 4020, Unstoppable]
type = hitoverride
trigger1 = animelemtime(6) < 0
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4020, 4090)
time = 1
persistent = 1

[state 4020, Unstoppable]
type = hitoverride
trigger1 = animelemtime(6) >= 0
attr = SCA, AP, AA
stateno = 4090
time = 1
persistent = 1

[State 4010, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 4020, changeanim]
type = changeanim
trigger1 = anim != 4020 + parent,var(15)
value = 4020 + parent,var(15)

[state 4020, velmul]
type = velmul
trigger1 = animelemtime(2) = 0
x = 0.5

[state 4020, sprpriority]
type = sprpriority
trigger1 = animelemtime(2) = 0
value = 3

[state 4020, statetypeset]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = S
ignorehitpause = 1

[state 4020, veladd]
type = veladd
trigger1 = animelemtime(4) = 0
x = 20
ignorehitpause = 1


[state 4020, notthrowable]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1
persistent = 1


[State 4020, 1]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA                    
damage = 120,24
affectteam = B
animtype = Back               
guardflag = MA   
id = 4020    
getpower = 90
givepower = 120
p2facing = 1 
envshake.time = 12
envshake.ampl = -12          
hitflag = MAF                   
priority = 6, Hit                
pausetime = 6, 6    
guard.pausetime = 8,8             
sparkno = 0                     
sparkxy = -40, -304              
hitsound = S4020, 0                  
guardsound = 6, 0               
ground.type = High              
ground.slidetime = 24             
ground.hittime  = 24             
ground.velocity = -60,-18          
airguard.velocity = -24,-4   
air.type = High                  
air.velocity = -60,-18        
air.hittime = 30       
guard.slidetime = 18
guard.hittime = 18   
guard.velocity = -80 
fall = 1
guard.kill = 1
kill = 1

[state 4020, Wall Bounce]
type = targetstate
triggerall = !moveguarded
trigger1 = movehit
trigger1 = frontedgebodydist > 200 
value = 670
id = 4020
persistent = 0

[state 4020, Wall Crush]
type = targetstate
triggerall = !moveguarded
trigger1 = movehit
trigger1 = frontedgebodydist <= 300 
trigger1 = hitpausetime
value = 4040
id = 4020
persistent = 0
ignorehitpause = 1

[state 4020, Wall Crush]
type = changestate
triggerall = !moveguarded
trigger1 = hitpausetime
trigger1 = movehit
trigger1 = frontedgebodydist <= 300
trigger1 = numtarget(4020)
trigger1 = target(4020),stateno = 4040
value = 4025
persistent = 0
ignorehitpause = 1

[state 4004, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = animtime = 0
trigger1 = var(1) = [8,9]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = animtime = 0
trigger1 = var(1) = [0,4]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = animtime = 0
trigger1 = var(1) = [5,7]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = animtime = 0
trigger1 = var(1) = 10
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[state 4120, End2]
type = changestate
trigger1 = animtime = 0
value = 4007 + parent,var(15)
ignorehitpause = 1

[state 4020, combo scaling]
type = parentvaradd
trigger1 = movehit
trigger1 = frontedgebodydist > 300
v = 18
value = -18
ignorehitpause = 1
persistent = 0



;====================================================================================
;Wall Crush
[statedef 4025]
type = S
movetype = A
physics = N
velset = 0,0
sprpriority = 3

[state 4025, targetbind]
type = targetbind
trigger1 = anim = [4025, 4026]
pos = 2 * const(size.xscale) * parent,fvar(20),-410  * const(size.yscale) * parent,fvar(20)
id = 4020

[state 4025, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(parent,fvar(10) * -70)
id = 4020
persistent = 0

[state 4025, targetlifeadd]
type = targetpoweradd
trigger1 = time = 0
value = 80
id = 4020
persistent = 0

[state 4025, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(7) >= 0  && animelemtime(27) < 0
value = -1
id = 4020
persistent = 3

[state 4025, targetlifeadd]
type = targetpoweradd
trigger1 = animelemtime(7) >= 0  && animelemtime(27) < 0
value = -25
id = 4020
persistent = 3

[state 4025, envshake]
type = envshake
trigger1 = animelemtime(7) = 0
ampl = -4
time = 60

[state 4025, Rumble]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 4026,0
channel = 2


[state 4025, stopsnd]
type = stopsnd
trigger1 = animelemtime(27) = 4
channel = 2


[state 4025, playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 4025,random%4

[state 4025, explod]
type = explod
trigger1 = animelemtime(7) = 0
anim = 2110
postype = p1
pos = 0, -510
sprpriority = 2
scale = 1.5, 1.5

[state 4025, explod]
type = explod
trigger1 = animelemtime(7) = 0
anim = 2110
postype = p1
pos = 0, -180
sprpriority = 2
scale = 1.5, -1.5

[state 4025, explod]
type = explod
trigger1 = animelemtime(7) > 0 && animelemtime(26) < 0
anim = 2120
postype = p1
pos = 0, -480
sprpriority = 2
scale = 1.5,1.5
vel = -2 - random%9, -2 - random%12
accel = 0, -0.22
persistent = 6

[state 4025, explod]
type = explod
trigger1 = animelemtime(7) > 0 && animelemtime(26) < 0
anim = 2120
postype = p1
pos = 0, -150
sprpriority = 2
scale = 1.5,1.5
vel = -2 - random%9, 8+random%12
accel = 0, -0.22
persistent = 6



[state 4025, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 15

[state 4025, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4025, Screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4025, comboscaling]
type = parentvaradd
trigger1 = animtime = 0
var(18) = -18
ignorehitpause = 1
persistent = 0

[state 3042, posset]
type = posset
trigger1 = 1
x = (facing*(gamewidth/2))

[state 3042, Animationset]
type = changeanim
trigger1 = anim != 4025 + parent,var(15)
 value = 4025 + parent,var(15)

[state 4004, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = [8,9]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = [0,4]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = [5,7]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = 10
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = parentdist x * 0.8,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[state 4025, releasetarget]
type = targetdrop
trigger1 = animtime = 0


[state 4041, spawner]
type = helper
trigger1 = animtime = 0
postype = p2
pos = 0,0
stateno = 4045
id = 4045
name = "Stink lines"



[state 3042, changestate]
type = changestate
trigger1 = animtime = 0
value = 4007 + parent,var(15)

;------------------------------------------------------------------------------------
;Leap Hog
[statedef 4030]
type = S
movetype = A
physics = S

[state 4030, skid]
type = explod
trigger1 = time < 24
trigger1 = vel x > 10
anim = 2025
postype = p1
pos = 90,0
persistent = 4

[state 4030, skid]
type = explod
trigger1 = time < 24
trigger1 = vel x > 10
anim = 2025
postype = p1
pos = -180,0
persistent = 4

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4030, turn]
type = turn
trigger1 = time = 0
trigger1 = facing = Root,facing

;===========
;Armor start
;===========

;determine what frame
[state 4030, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4030, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*0.8)
value = anim
elem = parent,var(22)

[state 4030, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 4030, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1
 

[state 4030, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4030, 4090)
time = 1
persistent = 1

[State 4030, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 8
add = 100,0,0
IgnoreHitPause = 1

[state 4030, changeanim]
type = changeanim
trigger1 = anim != 4030 + parent,var(15)
value = 4030 + parent,var(15)

[state 4030, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
physics = S
ignorehitpause = 1

[state 4030, noautoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1


[state 4030, notthrowable]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1
persistent = 1

[state 4030, Lift]
type = changestate
trigger1 = numhelper(4001)
trigger1 = helper(4001),pos x  = [pos x -100, pos x + 100]
value = 4032

[state 4030, Time out]
type = changestate
trigger1 = time > 180
value = 4007

;------------------------------------------------------------------------------------
;Run in
[statedef 4031]
type = S
movetype = A
physics = S

[state 4031, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1


;===========
;Armor start
;===========

;determine what frame
[state 4031, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4031, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*0.8)
value = anim
elem = parent,var(22)

[state 4031, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 4031, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 21
value = -gethitvar(damage)
persistent = 1


[state 4031, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(21) > 0, 4031, 4095)
time = 1
persistent = 1

[State 4031, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1


[state 4031, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4010, 0 
persistent = 1
ignorehitpause = 1

[state 4031, playsnd]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12
ignorehitpause = 1
persistent = 1

[state 4031, anim]
type = changeanim
trigger1 = anim != 4011 - parent,var(15)
value = 4011 - parent,var(15)

[state 4031, velocity]
type = velset
trigger1 = 1
x = 26

[state 4031, Attack]
type = changestate
trigger1 = numhelper(4000)
trigger1 = helper(4000),stateno = 4032
value = 4033
ignorehitpause = 1


[state 4031, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "ParentDist X:  %d , Front Edge: %d"
params = ParentDist x, frontedgebodydist 

[state 4031, destroyself]
type = destroyself
trigger1 = time > 240 ;frontedgebodydist < -800

;====================================================================================
;Lift
[statedef 4032]
type = S
movetype = A
physics = S
velset = 0,0
sprpriority = -2

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4032, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 4032, turn]
type = turn
triggerall = numhelper(4001)
trigger1 = helper(4001),facing = facing

[state 4032, playsnd]
type = playsnd
triggerall = anim = [4032, 4033]
trigger1 = animelemtime(11) = 0
value = 4032,0

[state 4030, changeanim]
type = changeanim
trigger1 = anim != 4032 + parent,var(15)
value = 4032 + parent,var(15)

[state 4030, end]
type = changestate
trigger1 = animtime = 0
value = 4007 + parent,var(15)

;====================================================================================
;Leap
[statedef 4033]
type = S
movetype = A
physics = S
velset = 0,0
sprpriority = -1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4032, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 4033, posadd]
type = posset
trigger1 = time = 0
x = helper(4000),pos x + (-310 * facing)
y = 0

[state 4033, posadd]
type = posadd
trigger1 = anim = [4035, 4036]
trigger1 = animelemtime(10) = 0
y = -150

[state 4030, changeanim]
type = changeanim
trigger1 = anim != 4035 - parent,var(15)
value = 4035 - parent,var(15)

[state 4033, LAUNCH]
type = velset
trigger1 = animelemtime(11) = 0
y = -80

[state 4033, camera]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0
ignorehitpause = 1

[state 4030, end]
type = changestate
trigger1 = pos y < -1080
value = 4034

;------------------------------------------------------------------------------------
;Homing Pig
[statedef 4034]
type = A
movetype = I
physics = N
velset = 0,0
anim = 9999

[state 4035, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Parent dist x: %d  "
params = parentdist x


[state 4035, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4035, playsnd]
type = playsnd
trigger1 = time = 30
value = 4035,0
channel = 2

[state 4034, random set]
type = varset
trigger1 = time = 0
v = 2
value = random%3 + 1

[state 4034, helper]
type = helper
trigger1 = time = 0
trigger1 = !numhelper(4039)
postype = p1
pos = 0,0
stateno = 4039
id = 4039

[state 4034, veladd]
type = veladd
trigger1 = parentdist x > 50
trigger1 = vel x < 10
x = 2.0
persistent = 1

[state 4034, veladd]
type = veladd
trigger1 = parentdist x < -50
trigger1 = vel x > -10
x = -2.0
persistent = 1

[state 4034, veladd]
type = velmul
trigger1 = parentdist x = [-50, 50]
x = 0.5
persistent = 16

[state 4034, fall]
type = changestate
trigger1 = time > var(2) * 60
value = 4035

[state 4034, end]
type = destroyself
trigger1 = time > 360

;-------------------------------------------------------------------------------------
;Falling Pig
[statedef 4035]
type = A
movetype = A
physics = N
sprpriority = -2

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4035, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[state 4035, velset]
type = velset
trigger1 = time = 0
x = 0

[state 4035, change anim]
type = changeanim
trigger1 = time = 0
value = 4037 - parent,var(15)

[state 4035, Butt cheek]
type = explod
trigger1 = time = 0
id = 4035
anim = 24037 - parent,var(15)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
scale = const(size.xscale) *  Parent,fvar(20),const(size.yscale) * parent,fvar(20)
sprpriority = 3
removetime = -1


[state 4035, posset]
type = posset
trigger1 = time = 0
y = -2880

[state 4035, gravity]
type = gravity
trigger1 = pos y < 0

[state 4035, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
persistent = 1

[State 4035, 0]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact && !movereversed
persistent = 0
attr = A, SA
damage    = 80 * var(2)
guardflag = 
hitflag = MAF
affectteam = B
getpower = 80 * var(2)
givepower = 100 * var(2)
id = 4035
nochainid = 4035,1400
priority = 4
pausetime = 0,0
sparkno = -1
sparkxy = 0,0
hitsound   = S240,0
guardsound = S120,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -45            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -28,10
airguard.hittime = 35
guard.dist = 0
kill = 1

[state 4035, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = target,statetype != A
value = 660
;------------------------------------------------
;Ride down mechanic
[state 4035, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = target,statetype = A 
pos = 50, 0

[state 4035, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype = A 
value = 655
;----------------------------------------------

[state 4035, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4035, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [13,14]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4035, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [11,12]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4035, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [0,5]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [6,10]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0



[state 4035, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4036

;-------------------------------------------------------------------------
; 1st Landing
[statedef 4036]
type = C
movetype = A
physics = N
sprpriority = -2

[state 4036, Front Dust]
type = explod
trigger1 = time = 0
postype = p1
pos = 0, 0
sprpriority = 4
ownpal = 1
anim = 2160
scale = 0.85,0.85

[state 4036, Back Dust]
type = explod
trigger1 = time = 0
postype = p1
pos = 0, 0
sprpriority = -2
ownpal = 1
anim = 2161
scale = 0.85,0.85



[state 4036, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4035
ignorehitpause = 1

[state 4035, Butt cheek]
type = explod
trigger1 = time = 0
id = 4036
anim = 24039 - parent,var(15)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
scale = const(size.xscale) *  Parent,fvar(20),const(size.yscale) * parent,fvar(20)
sprpriority = 3
removetime = -1

[state 4036, anim]
type = changeanim
trigger1 = time = 0
value = 4039 - parent,var(15)


[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4036, stopsnd]
type = stopsnd
trigger1 = time = 0
channel = 2

[state 4036, envshake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 30

[state 4036, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4036, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4036, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4036, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 6,3
ownpal = 1
sprpriority = -3


[state 4036, not grabble]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1
persistent = 1

[State 4036, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4095
time = 1
ignorehitpause = 1
persistent = 1

[State 4036, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 80 * var(2)
guardflag = 
Affectteam = B
hitflag = FD
priority = 4
getpower = 80 * var(2)
givepower = 100 * var(2)
nochainid = 4090
id = 4090
pausetime = 0,0
sparkno = -1
sparkxy = -10,-40
hitsound   = S240,0
guardsound = S120,0
animtype = Med
p2stateno = 660
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state 4004, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [11,12]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [13,14]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [0,5]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = movehit
trigger1 = var(1) = [6,10]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = 0,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0



[state 4036, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4036, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4036, Bounce]
type = velset
trigger1 = time = 12
y = -18

[state 4036, Gravity]
type = gravity
triggerall = time > 12
trigger1 = pos y < 0

[state 4036, changestate]
type = changestate
triggerall = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4037

;------------------------------------------------------------------------------------
;2nd landing

[statedef 4037]
type = C
movetype = A
physics = N

[state 4037, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4036

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4037, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 16

[state 4037, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4037, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 4,2
ownpal = 1
sprpriority = -3


[state 4037, not grabble]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1
persistent = 1

[State 4037, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4095
time = 1
ignorehitpause = 1
persistent = 1

[state 4035, Butt cheek]
type = explod
trigger1 = time = 0
id = 4037
anim = 24041 - parent,var(15)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
scale = const(size.xscale) *  Parent,fvar(20),const(size.yscale) * parent,fvar(20)
sprpriority = 3


[state 4037, anim]
type = changeanim
trigger1 = time = 0
value = 4041 - parent,var(15)

[state 4037, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4037, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4092, changestate]
type = changestate
trigger1 = animtime = 0
value = 4081 


;-----------------------------------------------------------------------------------
;Doom's Shadow
[statedef 4039]
type = A
movetype = I
physics = N
anim = 2010


[state 4034, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4034, posset]
type = posset
trigger1 = 1
x = parent,pos x
ignorehitpause = 1
persistent = 1

[state 4034, varset]
type = varset
trigger1 = time = 0
fv = 25
value = 0.022

[state 4034, varadd]
type = varadd
trigger1 = parent,stateno != 4035
trigger1 = time > 3
trigger1 = fvar(25) < 1.00

fv = 25
value = 0.022
persistent = 4
ignorehitpause = 1

[state 4034, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = fvar(25),fvar(25)
ignorehitpause =1 
persistent = 1

[state 4034, destoryself]
type = destroyself
trigger1 = !numhelper(4001)
trigger2 = time > 300
trigger3 = parent,stateno = 4036


;====================================================================================
;   Wall Crushed
;====================================================================================
;--------------------------------------------------------------------------
;Flattened on wall FLAT  1
[statedef 4040]
type =A
movetype = H
physics = N
velset = 0,0

[state 4040, posset]
type = null;posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 4040, posset]
type = null;lposset
trigger1 = time = 0
y = -200

[state 4020, color]
type = palFX
trigger1 = time > 51
time = 1
mul = 100,180,40

[state 4040, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4040, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.3,0.2

[state 4040, anim]
type = changeanim2
trigger1 = time =  0
value = 4050

[state 3051, end]
type = changestate
trigger1 = time >= 150
value = 4041

;====================================================================================
;Fall off wall
[statedef 4041]
type = A
movetype = H
physics = N
velset = 2, -8

[state 4020, color]
type = palFX
trigger1 = time = 0
time = 300
mul = 100,180,40

[state 4041, selfstate]
type = selfstate
trigger1 = time = 1
value = 5050

;------------------------------------------------------------------------------------
;Gas FX Spawner
[statedef 4045]
type = U
movetype = U
physics = U
anim = 9999



[state 4045, smoke]
type = explod
trigger1 = Random%15 = 0
postype = p2
anim = 2120
scale = 1, 1
sprpriority = 3
removetime = -2
pos = -50 + (random%100),enemynear,const(size.mid.pos.y) - 40 + (random%80)
ownpal = 1

[state 4045, smoke]
type = explod
trigger1 = Random%15 = 0
postype = p2
anim = 2120
scale = 1, 1
sprpriority = 3
removetime = -2
pos = -50+(random%100),enemynear,const(size.head.pos.y) - 40 + (random%80)
ownpal = 1

[state 4045, end]
type = destroyself
trigger1 = time = 420
trigger2 = !numenemy 
trigger3 = roundstate = [3,4]

;-----------------------------------------------------------------------------------
;Stinklines Self
;------------------------------------------------------------------------------------
;Gas FX Spawner
[statedef 4046]
type = U
movetype = U
physics = U
anim = 9999



[state 4045, smoke]
type = explod
trigger1 = Random%15 = 0
postype = p1
anim = 2120
scale = 1, 1
sprpriority = 3
removetime = -2
pos = 0,0
ownpal = 1

[state 4045, smoke]
type = explod
trigger1 = Random%15 = 0
postype = p1
anim = 2120
scale = 1, 1
sprpriority = 3
removetime = -2
pos = 0,0
ownpal = 1

[state 4045, end]
type = destroyself
trigger1 = time = 420
trigger2 = !numenemy 
trigger3 = roundstate = [3,4]

;-----------------------------------------------------------------------------------
;Anti Air States
;-----------------------------------------------------------------------------------
[statedef 4060]
type = S
movetype = A
physics = S

[state 4012, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = 4090
time = 1
persistent = 1

[state 4060, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1


[state 4060, Changeanim]
type = changeanim
trigger1 = time = 0
value = 4060 + parent,var(15)

[state 4060, Jump]
type = velset
trigger1 = animelemtime(2) = 0
x = 18
y = -42

[state 4060, physics]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
Physics = N

[State 4060, 1]
type = HitDef
Trigger1 = Time = 0
attr = A, ST          
hitflag = AF  
affectteam = B        
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1     
id = 4060                    
p1facing = 1
p2facing = 1          
p1stateno = 4061       
p2stateno = 4070       
guard.dist = 0        
fall = 1              
fall.recover = 0
fall.recovertime = 45
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -20

[state 4060, movetype]
type = statetypeset
trigger1 = vel y > 0
movetype = I

[state 4060, Sound]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 4032,0

[state 4060, Shockwave]
type = explod
trigger1 = animelemtime(1) = 7
anim = F61
postype = p1
pos = 0,0
sprpriority = -2
scale = 2,2

[state 4060, gravity]
type = gravity
trigger1 = pos y < 0

[state 4060, End - Miss]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4069

;------------------------------------------------------------------------------------
;Grab Hit
[statedef 4061]
type = A
movetype = A
physics = N

[state 4060, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4061, Slow]
type = velmul
trigger1 = time = 0
x = 0.1
y = 0.1

[state 4061, changeanim]
type = changeanim
trigger1 = time = 0
value = 4062 + parent,var(15)

;Targetbinds
[state 4061, bind 1]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = 200, -790

[state 4061, bind 2]
type = targetbind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
pos = 45, -76

;--------------------

[state 4061, targetstate]
type = targetstate
trigger1 = animelemtime(3) = 0
value = 4071
persistent = 0

[state 4061, pop up]
type = veladd
trigger1 = animelemtime(3) = 0
y = -24

[state 4061, gravity]
type = gravity
trigger1 = animelemtime(3) > 0

[state 4061, xvel]
type = velset
trigger1 = animelemtime(3) = 0
x = 4

[state 4061, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4062

;--------------------------------------------------------------------------------------
;Facesit 1
[statedef 4062]
type = C
movetype = A
physics = C
velset = 0,0
sprpriority = -1

[state 4062, velset]
type = velset
trigger1 = time = 0
y = 0
x =0

[state 4062, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4062, width]
type = width
trigger1 = 1
edge = 340,400
ignorehitpause =1 

[state 4062, Dust]
type = explod
trigger1 = time = 0
anim = 2160
postype = p1
pos = 0,0
scale = 1,0.8
sprpriority = 4

[state 4062, Dust]
type = explod
trigger1 = time = 0
anim = 2161
postype = p1
pos = 0,0
scale = 1,0.8
sprpriority = -3


[state 4062, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4062, Thigh]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4062)
anim = 4054 + parent,var(15)
postype = p1
pos = 0,0
bindtime = -1
removetime = 60
id = 4062
scale = const(size.xscale) * parent,fvar(20), const(size.yscale) * parent,fvar(20)
sprpriority = 2

[state 4062, anim]
type = changeanim
trigger1 = time = 0
value = 4064 + parent,var(15)

[state 4062, targetstate]
type = targetstate
trigger1 = time = 0
value = 4073

[state 4062, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = Ceil(parent,fvar(10) * -150)
id = 4060

[state 4062, targetbind]
type = targetbind
trigger1 = time = 0
pos = -70, 0

[state 4062, targetbind]
type = targetvelset
trigger1 = animelemtime(3) = 0
y = 0

[state 4062, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 4,3
sprpriority = -3

[state 4062, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4062, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4062, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4062, quakes]
type = envshake
trigger1 = time = 0
ampl = -15
time = 18

[state 4062, bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -18

[state 4062, gravity]
type = gravity
trigger1 = pos y < 0

[state 4062, end]
type = changestate
trigger1 = animelemtime(3) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4063

;---------------------------------------------------------------------------------------
;Facesit 2
[statedef 4063]
type = C
movetype = A
physics = C
velset = 0,0
sprpriority = -1

[state 4062, velset]
type = velset
trigger1 = time = 0
y = 0
x =0

[state 4062, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4063, Thigh]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4063)
anim = 4056 + parent,var(15)
postype = p1
pos = 0,0
bindtime = -1
id = 4063
scale = const(size.xscale) * parent,fvar(20), const(size.yscale) * parent,fvar(20)
sprpriority = 2

[state 4063, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4062

[state 4063, anim]
type = changeanim
trigger1 = time = 0
value = 4066 + parent,var(15)

[state 4063, targetstate]
type = targetstate
trigger1 = time = 0
value = 4073

[state 4063, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = Ceil(parent,fvar(10) * -30)
id = 4060

[state 4063, velset]
type = velset
trigger1 = animelemtime(5) > 0 && animelemtime(8) < 0
x = 15

[state 4062, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1.25
sprpriority = -3

[state 4062, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0


[state 4062, quakes]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12


[state 4062, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4062, helper]
type = helper
trigger1 = animelemtime(3) = 0
trigger1 = var(1) = [8,9]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.8, parentdist x * 0.8),0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animelemtime(3) = 0
trigger1 = var(1) = [0,4]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.8, parentdist x * 0.8),0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animelemtime(3) = 0
trigger1 = var(1) = [5,7]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos =ifelse(parent,movetype = H, p2bodydist x * 0.8, parentdist x * 0.8),0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = animelemtime(3) = 0
trigger1 = var(1) = 10
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.8, parentdist x * 0.8),0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[state 4062, end]
type = changestate
trigger1 = animtime = 0
value = 4082










;------------------------------------------------------------------------------------
;Miss Landing
[statedef 4069]
type = C
movetype = I
physics = C
velset = 0,0

[state 4012, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = 4090
time = 1
persistent = 1

[state 4069, not throwable]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4069, playsnd]
type = playsnd
trigger1 = time = 0
value = 4010,0

[state 4069, playsnd]
type = playsnd
trigger1 = time = 0
value = 4010,0

[state 4069, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype =p1
pos = 0,0
scale = 2, 2
sprpriority = -3

[state 4069, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4069, anim]
type = changeanim
trigger1 = time = 0
value = 4068 + parent,var(15)

[state 4069, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4069, end]
type = changestate
trigger1 = animtime = 0
value = 4007 + parent,var(15)


;-----------------------------------------------------------------------------------
;Opponent: Caught
[statedef 4070]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 4070

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = time > 180
value = 5050

;-----------------------------------------------------------------------------------
;Opponent: Thrown
[statedef 4071]
type    = A
movetype= H
physics = N
velset = -12,30
sprpriority = 1

[state 4073, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[state 4071, lay and wait]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4072

;-----------------------------------------------------------------------------------
;Opponent: Land
[statedef 4072]
type    = L
movetype= H
physics = C
velset = 0,0
sprpriority = 0




[state 4072, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4073, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 4072, Effect]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 3,3

[state 4072, land]
type = changeanim
trigger1 = time = 0
value = 5100

[state 4072, change anim again]
type = changeanim
trigger1 = anim = 5100
trigger1 = animtime = 0
value = 5110

[state 4072, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[state 4072, lay and wait]
type = Selfstate
trigger1 = time > 240
value = 5120

;-----------------------------------------------------------------------------------
;Opponent: Chest Crush
[statedef 4073]
type    = L
movetype= H
physics = N
velset = 0,0
sprpriority = 0

[state 4073, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 4072, land]
type = changeanim2
trigger1 = time = 0
value = 4072

[state 4072, land]
type = changeanim
trigger1 = time = 24
value = 5110

[state 4072, posset]
type = posset
trigger1 = time = 24
y = 0

[state 4072, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = 1.2, 0.6 


[state 4072, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[state 4072, lay and wait]
type = Selfstate
trigger1 = time > 90
value = 5110

[state 4072, dead]
type = changestate
trigger1  = time > 80
trigger1  = !alive
value = 5150



;====================================================================================
;Get up animation
;====================================================================================
;Butt Front version
[statedef 4080]
type = C
movetype = I
physics = C
velset = 0,0



[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4080, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4080, changeanim]
type = changeanim
trigger1 = time = 0
value = 4096 + parent,var(15)

[state 4080, velset]
type = velset
trigger1 = time > 12
trigger1 = animelemtime(8) >= 0
x = -35
persistent = 1


[state 4080, end]
type = changestate
trigger1 = animtime = 0
value = 4007 + parent,var(15)

;------------------------------------------------------------------------------------
;Opposite Pig version
;Butt Front version
[statedef 4081]
type = C
movetype = I
physics = C
velset = 0,0



[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4081, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4081, changeanim]
type = changeanim
trigger1 = time = 0
value = 4097 - parent,var(15)

[state 4081, velset]
type = velset
trigger1 = time > 12
trigger1 = animelemtime(8) >= 0
x = -35
persistent = 1


[state 4081, end]
type = changestate
trigger1 = animtime = 0
value = 4008 - parent,var(15)
;-------------------------------------------------------------
; Front version
[statedef 4082]
type = C
movetype = I
physics = C
velset = 0,0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4080, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4080, changeanim]
type = changeanim
trigger1 = time = 0
value = 4098 + parent,var(15)

[state 4080, velset]
type = velset
trigger1 = time > 12
trigger1 = animelemtime(7) >= 0
x = -35
persistent = 1


[state 4080, end]
type = changestate
trigger1 = animtime = 0
value = 4007 + parent,var(15)

;------------------------------------------------------------------------------------
;Pigs Get hit
[statedef 4090]
type = A
movetype = A
physics = N
sprpriority = -1

[state 4090, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4530


[state 4004, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = [8,9]
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = [0,4]
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = [5,7]
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = 10
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4090, nothitby]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1
persistent = 1

[state 4090, anim]
type = changeanim
trigger1 = time = 0
value = 4090 + parent,var(15)

[state 4090, Veladd]
type = velset
trigger1 = time = 0
x = gethitvar(xvel) * 0.5 ;floor(parentdist x * 0.05)
y = ifelse(gethitvar(yvel) < 0, gethitvar(yvel), -5)

[state 4090, gravity]
type = gravity
trigger1 = pos y < 0

[state 4090, anim]
type = changeanim
trigger1 = time = 0
value = 4090 + parent,var(15)

[State 4090, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4090
time = 1
ignorehitpause = 1
persistent = 1

[State 4090, 0]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, SA
damage    = 120
guardflag = 
hitflag = M
affectteam = F
getpower = 125
givepower = 125
id = 4090
nochainid = 4090
priority = 4
pausetime = 0,0
sparkno = -1
sparkxy = 0,0
hitsound   = S240,0
guardsound = S120,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
p1sprpriority = -1
p2sprpriority = -2
down.hittime = 60
guard.velocity = -45            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -28,10
airguard.hittime = 35
guard.dist = 320
kill = 1

[state 650, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = target,statetype != A
value = 661
;------------------------------------------------
;Ride down mechanic
[state 4090, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = target,statetype = A
pos = 0, -20

[state 4090, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype = A
value = 655
;----------------------------------------------

[state 4090, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4091

;-------------------------------------------------------------------------
[statedef 4091]
type = C
movetype = A
physics = N
sprpriority = -1

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4091, envshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 24

[state 4091, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4091, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 651, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 6,3
ownpal = 1
sprpriority = -3


[state 4091, not grabble]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1
persistent = 1



[State 4091, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4090
time = 1
ignorehitpause = 1
persistent = 1

[State 651, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 150
guardflag = 
Affectteam = F
hitflag = FD
priority = 4
nochainid = 4090
id = 4090
pausetime = 12,12
sparkno = -1
p1sprpriority = -1
p2sprpriority = -2
sparkxy = -10,-40
hitsound   = S240,0
guardsound = S120,0
animtype = Med
p2stateno = 661
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0



[state 4091, anim]
type = changeanim
trigger1 = time = 0
value = 4092 + parent,var(15)

[state 4091, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4091, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4091, Bounce]
type = velset
trigger1 = time = 12
y = -15

[state 4091, Gravity]
type = gravity
triggerall = time > 12
trigger1 = pos y < 0

[state 4091, changestate]
type = changestate
triggerall = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4092

;------------------------------------------------------------------------------------

[statedef 4092]
type = C
movetype = H
physics = N

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4092, Dizzy Stars]
type = explod
trigger1 = animelemtime(5) = 0
trigger1 = !numexplod(4530)
anim = 2530
id = 4530
postype = p1
pos = -25 * const(size.xscale) * parent,fvar(20), -580 * const(size.yscale) * parent,fvar(20)
ownpal = 1
ontop = 1
removetime = 180
removeongethit = 1
ignorehitpause = 1

[state 4092, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 16

[state 4092, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 651, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 4,2
ownpal = 1


[state 4092, not grabble]
type = nothitby
trigger1 = time < 30
value = ,AT
ignorehitpause = 1
persistent = 1

[state 4092, not grabble]
type = nothitby
trigger1 = time >=  30
value = SCA
ignorehitpause = 1
persistent = 1

[State 4090, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4090
time = 1
ignorehitpause = 1
persistent = 1

[state 4092, anim]
type = changeanim
trigger1 = time = 0
value = 4094 + parent,var(15)

[state 4092, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4092, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4092, changestate]
type = changestate
trigger1 = animtime = 0
value = 4080 + parent,var(15)



;-----------------------------------------------------------------------------------
;Other Pig Get hit
[statedef 4095]
type = A
movetype = H
physics = N
sprpriority = -1

[state 4095, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4531

[state 4004, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = [8,9]
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = [0,4]
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = [5,7]
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = var(1) = 10
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4095, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
persistent = 1

[state 4095, anim]
type = changeanim
trigger1 = time = 0
value = 4091 - parent,var(15)

[state 4095, Veladd]
type = velset
trigger1 = time = 0
x = gethitvar(xvel) * 0.5 ;floor(parentdist x * 0.05)
y = ifelse(gethitvar(yvel) < 0, gethitvar(yvel), -5)

[state 4095, gravity]
type = gravity
trigger1 = pos y < 0

[State 4095, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4095
time = 1
ignorehitpause = 1
persistent = 1

[State 4095, 0]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, SA
damage    = 120
guardflag = 
hitflag = M
affectteam = F
getpower = 125
givepower = 125
id = 4090
nochainid = 4090
priority = 4
pausetime = 0,0
sparkno = -1
sparkxy = 0,0
hitsound   = S240,0
guardsound = S120,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
p1sprpriority = 3
p2sprpriority = -2
guard.velocity = -45            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -28,10
airguard.hittime = 35
guard.dist = 320
kill = 1

[state 4095, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = target,statetype != A
value = 660
;------------------------------------------------
;Ride down mechanic
[state 4095, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = target,statetype = A
pos = 0, -20

[state 4095, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype = A
value = 655
;----------------------------------------------

[state 4095, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4096

;-------------------------------------------------------------------------
[statedef 4096]
type = C
movetype = A
physics = N

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4096, envshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 24

[state 4096, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4096, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4096, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 6,3
ownpal = 1
sprpriority = -3


[state 4096, not grabble]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
persistent = 1

[State 4096, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4095
time = 1
ignorehitpause = 1
persistent = 1

[State 4096, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 150
guardflag = 
Affectteam = F
hitflag = FD
priority = 4
nochainid = 4090
id = 4090
pausetime = 12,12
sparkno = -1
p1sprpriority = 3
p2sprpriority = -2
sparkxy = -10,-40
hitsound   = S240,0
guardsound = S120,0
animtype = Med
p2stateno = 661
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0



[state 4096, anim]
type = changeanim
trigger1 = time = 0
value = 4093 - parent,var(15)

[state 4096, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4096, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4096, Bounce]
type = velset
trigger1 = time = 12
y = -15

[state 4096, Gravity]
type = gravity
triggerall = time > 12
trigger1 = pos y < 0

[state 4096, changestate]
type = changestate
triggerall = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4097

;------------------------------------------------------------------------------------

[statedef 4097]
type = C
movetype = H
physics = N

[state 40XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(20), parent,fvar(20)
ignorehitpause = 1
persistent = 1

[state 4092, explod]
type = explod
trigger1 = animelemtime(5) = 0
trigger1 = !numexplod(4531)
anim = 2530
id = 4531
postype = p1
pos = -25* const(size.xscale) * parent,fvar(20), -580 * const(size.yscale) * parent,fvar(20)
sprpriority = 4
removetime = 180
removeongethit = 1
ignorehitpause = 1

[state 4097, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 16

[state 4097, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4097, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 4,2
ownpal = 1


[state 4097, not grabble]
type = nothitby
trigger1 = time < 12
value = ,AT
ignorehitpause = 1
persistent = 1

[state 4097, nothitby]
type = nothitby
trigger1 = time >= 12
value = SCA
ignorehitpause = 1
persistent = 1

[State 4097, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA, AA, AP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
slot = 0
stateno = 4095
time = 1
ignorehitpause = 1
persistent = 1

[state 4097, anim]
type = changeanim
trigger1 = time = 0
value = 4095 - parent,var(15)

[state 4097, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4097, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4097, changestate]
type = changestate
trigger1 = animtime = 0
value = 4081 - parent,var(15)


;====================================================================================

; Georgia 

;===================================================================================
;jUMP IN
[statedef 4100]
type = A
movetype = I
physics = N
anim = 4100
velset = 10, 50

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4100, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4100, gravity]
type = gravity
trigger1 = pos y < 0


[state 4100, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4105

;-----------------------------------------------------------------------
;Exit
[statedef 4101]
type = S
movetype = I
physics = N
anim = 4101
velset = 0,0

[state 4101, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4123

[state 4101, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4122

[state 4101, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = frontedgebodydist, backedgebodydist
text = "Front edge:  %d , Back edge: %d"

[state 4101, turn]
type = turn
trigger1 = time = 2
trigger1 = frontedgebodydist < backedgebodydist

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4105, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4101, gravity]
type = gravity
trigger1 = pos y < 0

[state 4101, JUMP]
type = velset
trigger1 = animelemtime(3) = 0
x = -30
y = -24

[state 4101, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4102

[state 4101, destoyself]
type = destroyself
trigger1 = backedgebodydist < -100
trigger2 = frontedgebodydist < -100
trigger3 = time = 180


;------------------------------------------------------------------------------------
;Exit Continue to Exit
[statedef 4102]
type = S
movetype = I
physics = N
anim = 4101
velset = 0,0

[state 4101, playsnd]
type = playsnd
trigger1 = time =0
value = 4090, 0

[state 4101, quakes]
type = envshake
trigger1 = time = 0
ampl = -12
time = 15

[state 4101, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
sprpriority = -3
scale = 2,2

[state 4101, on ground]
type = posset
trigger1 = time = 0
y = 0


[state 4101, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = frontedgebodydist, backedgebodydist
text = "Front edge:  %d , Back edge: %d"

[state 4101, turn]
type = turn
trigger1 = time = 2
trigger1 = frontedgebodydist < backedgebodydist

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4105, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4101, gravity]
type = gravity
trigger1 = pos y < 0

[state 4101, JUMP]
type = velset
trigger1 = animelemtime(3) = 0
x = -30
y = -24

[state 4101, destoyself]
type = destroyself
trigger1 = backedgebodydist < -100
trigger2 = frontedgebodydist < -100
trigger3 = time = 180


;------------------------------------------------------------------------------------
;Landing
[statedef 4105]
type = C
movetype = I
physics = C
anim = 4105

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4105, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4105, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4105, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4105, envshake]
type = envshake
trigger1 = time = 0
ampl = -24
time = 24

[state 4105, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4105, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos  = 0,0
sprpriority = -3
scale = 4, 2

[state 4105, end]
type = changestate
trigger1 = animtime = 0
value = 4110

;--------------------------------------------------------------------------------------
;Lunge Grab
[statedef 4110]
type = S
movetype = A
physics = S


[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4110, no autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1
persistent = 1

;===========
;Armor start
;===========

[state 4110, anim]
type = changeanim
trigger1 = anim != 4110
value = 4110


;determine what frame
[state 4110, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4110, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4110, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4110, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 0
ignorehitpause =1 

[state 4110, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4110, varset]
type = parentvarset
trigger1 = animelemtime(13) = 0
trigger1 = parent,var(20) > 0
var(20) = 1
ignorehitpause = 1

[state 4110, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4110, 4117)
time = 1
persistent = 1

[state 4110, HURT state]
type = changestate
trigger1 = parent,var(20) < 0
value = 4117
ignorehitpause = 1
persistent = 1

[State 4110, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1


[State 4110, 1]
type = HitDef
Trigger1 = animelemtime(13) < 0
attr = S, HT          
hitflag = M-  
affectteam = B       
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1    
id = 4120                     
p1facing = 1
p2facing = 1          
p1stateno = 4120      
p2stateno = 4130       
guard.dist = 0       
fall = 1              
fall.recover = 0
fall.recovertime = 45
down.bounce = 1
fall.xvelocity = 2
fall.yvelocity = -40

[state 4110, movetype]
type = statetypeset
trigger1 = animelemtime(13) = 0
movetype = I




[state 4110, velset]
type = velset
trigger1 = animelemtime(1) >= 1  && animelemtime(13) < 0
x = 22.5
persistent = 1

[state 4110, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = parentdist x, parent,var(20)
text = "Parentdist x: %d |  Armor HP: %d"

[state 4110, Trip]
type = statetypeset
trigger1 = animelemtime(13) = 0
physics = N
statetype = A

[state 4110, Launch]
type = veladd
trigger1 = animelemtime(13) = 0
x = 12
y = -9
persistent = 0

[state 4110, gravity]
type = gravity
trigger1 = pos y < 0

[state 4110, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > - vel y
value = 4111

;------------------------------------------------------------------------------------
;Landing 1
[statedef 4111]
type = C
movetype = A
physics = N
anim = 4111
velset = 0,0

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4111, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = 4117
time = 1
persistent = 1

[state 4111, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1
persistent = 1

[state 4111, envshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 18

[state 4111, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4105, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos  = 0,0
sprpriority = -3
scale = 2, 1

[state 4111, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4111, Bounce]
type = velset
trigger1 = time = 12
y = -12

[state 4111, gravity]
type = gravity
trigger1 = pos y < 0

[state 4111, chagnestate]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4112

;------------------------------------------------------------------------------------
;Landing 2
[statedef 4112]
type = C
movetype = A
physics = N
anim = 4112
velset = 0,0

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4112, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = 4117
time = 1
persistent = 1

[state 4112, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1
persistent = 1


[state 4112, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 15

[state 4111, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4105, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos  = 0,0
sprpriority = -3
scale = 1.5, 1

[state 4111, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4111, chagnestate]
type = changestate
trigger1 = animtime = 0
value = 4101

;-----------------------------------------------------------------------------------
;Hit back state
[statedef 4117]
type = A
movetype = A
physics = N
anim = 4117

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4117, nothitby]
type = nothitby
trigger1 = 1
value = , AT

[state 4117, velset]
type = velset
trigger1 = time = 0
x = gethitvar(xvel) * 0.25
y = ifelse(gethitvar(yvel) >= 0, -12, gethitvar(yvel))

[state 4117, gravity]
type = gravity
trigger1 = pos y < 0

[state 4117, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA,AA,AP
slot = 1
stateno = 4117
ignorehitpause = 1


[State 4117, 0]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, HA
damage    = 120
guardflag = 
hitflag = M
affectteam = F
getpower = 250
givepower = 250
id = 4117
nochainid = 4117
priority = 4
pausetime = 0,0
sparkno = -1
sparkxy = 0,0
hitsound   = S240,0
guardsound = S120,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
p1sprpriority = 3
p2sprpriority = -2
down.hittime = 60
guard.velocity = -45            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -28,10
airguard.hittime = 35
guard.dist = 320
kill = 1

[state 4117, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = target,statetype != A
value = 661
;------------------------------------------------
;Ride down mechanic
[state 4117, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = target,statetype = A
pos = 0, -20

[state 4117, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype = A
value = 655

[state 4117, land]
type = changestate
trigger1 = time > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger2 = time > 120
value = 4118

;------------------------------------------------------------------------------------
;Landing 1
[statedef 4118]
type = C
movetype = A
physics = C

[state 4118, animation]
type = changeanim
trigger1 = time = 0
value = 4118

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[State 4118, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 120
guardflag = 
Affectteam = F
hitflag = FD
priority = 4
nochainid = 4090
getpower = 250
givepower = 250
id = 4090
pausetime = 12,12
sparkno = -1
p1sprpriority = 3
p2sprpriority = -2
sparkxy = -10,-40
hitsound   = S240,0
guardsound = S120,0
animtype = Med
p2stateno = 661
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0


[state 4111, envshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 18

[state 4111, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4111, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4105, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos  = 0,0
sprpriority = -3
scale = 6, 3


[state 4118, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4118, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4118, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
stateno = 4117
ignorehitpause = 1
slot = 1


[state 4118, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

[state 4118, Bounce]
type = velset
trigger1 = time = 12
y = -18


[state 4118, gravity]
type = gravity
trigger1 = pos y < 0
trigger1 = time > 12

[state 4118, End]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4119

;------------------------------------------------------------------------------------
;Landing 2
[statedef 4119]
type = C
movetype = I
physics = C

[state 4119, animation]
type = changeanim
trigger1 = time = 0
value = 4119

[state 4092, explod]
type = explod
trigger1 = animelemtime(4) = 0
trigger1 = !numexplod(4531)
anim = 2530
id = 4531
postype = p1
pos = -20* const(size.xscale) * parent,fvar(21), -510 * const(size.yscale) * parent,fvar(21)
sprpriority = 4
removetime = 120
removeongethit = 1
ignorehitpause = 1

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4111, envshake]
type = envshake
trigger1 = time = 0
ampl = -6
time = 12

[state 4111, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4105, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos  = 0,0
sprpriority = -3
scale = 2, 1


[state 4119, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4119, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4119, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
stateno = 4117
ignorehitpause = 1
slot = 1


[state 4119, nothitby]
type = nothitby
trigger1 = time < 24
value = ,AT

[state 4119, nothitby]
type = nothitby
trigger1 = time >= 24
value = SCA

[state 4119, End]
type = changestate
trigger1 = animtime = 0
value = 4101




;====================================================================================
;Chokeslam
[statedef 4120]
type = S
movetype = A
physics = N
anim = 4120
velset = 0,0
sprpriority = 1

[state 4120, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 4120, width]
type = width
trigger1 = time = 0
edge = 460, 360

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

;=====================================
; Targetbinds;
;=====================================

[state 4120, targetbind]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = 470 * const(size.xscale) * parent,fvar(21), -470 * const(size.yscale) * parent,fvar(21)

[state 4120, targetbind]
type = targetbind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
pos = 400 * const(size.xscale) * parent,fvar(21), -490 * const(size.yscale) * parent,fvar(21)

[state 4120, targetbind]
type = targetbind
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = 340 * const(size.xscale) * parent,fvar(21), -430 * const(size.yscale) * parent,fvar(21)

[state 4120, targetbind]
type = targetbind
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
pos = 310 * const(size.xscale) * parent,fvar(21), -950 * const(size.yscale) * parent,fvar(21)

[state 4120, targetbind]
type = targetbind
trigger1 = animelemtime(5) >= 0 
pos = 140 * const(size.xscale) * parent,fvar(21), -950 * const(size.yscale) * parent,fvar(21)
;-----------------------------------------------------

[state 4120, sprpriority]
type = sprpriority
trigger1 = animelemtime(5) = 0
value = 3 


[state 4120, Jump]
type = velset
trigger1 = animelemtime(4) = 0
x = -2
y = -24

[state 4120, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 4032, 0

[state 4120, gravity]
type = gravity
trigger1 = pos y < 0

[state 4120, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4121

;------------------------------------------------------------------------------------
[statedef 4121]
type = S
movetype = A
physics = S
anim = 4121
velset = 0,0

[state 4120, sprpriority]
type = sprpriority
trigger1 = animelemtime(5) = 0
value = -3

[state 4120, Butt]
type = explod
trigger1 = animelemtime(5) = 0
trigger1 = !numexplod(4121)
anim = 4141
postype = p1
pos = 0,0
sprpriority = 2
bindtime = -1
id = 4121
removeongethit = 1
removetime = -1
scale = const(size.xscale) * parent,fvar(21), const(size.yscale) * parent,fvar(21)


[state 4120, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 4120, width]
type = width
trigger1 = time = 0
edge = 460, 360

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4121, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4121, shockwave]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
postype = p1
scale = 2,1.5
sprpriority = -3

[state 4121, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 18

[state 4121, targetstate]
type = targetstate
trigger1 = time = 0
value = 4131

[state 4121, targetbind]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = -280  * const(size.xscale) * parent,fvar(21) , -350 * const(size.yscale) * parent,fvar(21)

[state 4121, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(2) = 0
value = ifelse(target,teamside = teamside, -40, ceil(parent,fvar(10)*-80))
kill = 0

[state 4121, targetlifeadd]
type = targetpoweradd
trigger1 = animelemtime(2) = 0
value = 100


[state 4121, targetstate]
type = targetstate
trigger1 = animelemtime(2) = 0
value = 4131

[state 4121, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4121, statetypeset]
type = statetypeset
trigger1 = animelemtime(5) = 0
statetype = A
physics = N

[state 4121, velset]
type = velset
trigger1 = animelemtime(5) = 0
y = -30
x = -4
persistent = 0

[state 4121, gravity]
type = gravity
trigger1 = time > 6
trigger1 = pos y < 0

[state 4121, veladd]
type = veladd
trigger1 = vel y > 5
y = 1.66
persistent = 1

[state 4121, changestate]
type = changestate
trigger1 = time > 6
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4122

;---------------------------------------------------------------------------
;Landing
[statedef 4122]
type = C
movetype = A
physics = C
velset = 0,0

[state 4122, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4121

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4120, Butt]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4122)
anim = 4142
postype = p1
pos = 0,0
sprpriority = 2
bindtime = -1
id = 4122
removeongethit =1
removetime = -1 
scale = const(size.xscale) * parent,fvar(21), const(size.yscale) * parent,fvar(21)


[state 4122, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4122, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4122, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ifelse(target,teamside = teamside, -115, ceil(parent,fvar(10) * -230))
persistent = 0
kill = 1

[state 4122, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 200

[state 4122, pause]
type = pause
trigger1 = time = 1
time = 8
ignorehitpause = 0

[state 4122, shockwave]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
postype = p1
scale = 5,2.25
sprpriority = -3

[state 4122, Dust]
type = explod
trigger1 = time = 0
anim = 2160
postype = p1
pos = 0,0
scale = 1,1
ownpal
sprpriority = 4

[state 4122, Dust]
type = explod
trigger1 = time = 0
anim = 2161
postype = p1
pos = 0,0
scale = 1,1
ownpal
sprpriority = -3


[state 4122, envshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 24

[state 4122, changeanim]
type = changeanim
trigger1 = time = 0
value = 4122

[state 4122, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4122, targetstate]
type = targetstate
trigger1 = time = 0
value = 660

[state 4122, Bounce]
type = velset
trigger1 = time = 12
y = -15
persistent = 0

[state 4122, gravity]
type = gravity
trigger1 = time > 12
trigger1 = pos y < 0

[state 4122, End]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4123

;-----------------------------------------------------------------------------------
;Landing and Gassing
[statedef 4123]
type = C
movetype = A
physics = C
velset = 0,0

[state 4123, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4122

[state 4120, Butt]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4123)
anim = 4143
postype = p1
pos = 0,0
sprpriority = 2
bindtime = -1
id = 4123
removeongethit = 1
removetime = -2
scale = const(size.xscale) * parent,fvar(21), const(size.yscale) * parent,fvar(21)


[state 4123, changeanim]
type = changeanim
trigger1 = time = 0
value = 4123

[state 41XX, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale =  parent,fvar(21), parent,fvar(21)
ignorehitpause = 1
persistent = 1

[state 4123, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4123, playsnd]
type =  playsnd
trigger1 = anim = 4123
trigger1 = animelemtime(5) = 0
value = 4125, random%2

[state 4123, Gas FX]
type = explod
trigger1 = animelemtime(5) = 1
anim = 2110
postype = p1
pos = -100 * const(size.xscale) * parent,fvar(21), -125 * const(size.yscale) * parent,fvar(21)
sprpriority = 4
scale = 3,3

[state 4123, Gas FX]
type = explod
trigger1 = animelemtime(6) >0  && animelemtime(34) < 0
anim = 2120
postype = p1
pos = -100 * const(size.xscale) * parent,fvar(21), -125 * const(size.yscale) * parent,fvar(21) 
sprpriority = 4
scale = random%3 + 1,random%3 + 1
vel = -18+ random%16, 12 - random%2
accel = 0, -0.22
persistent = 4


[state 4123, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(5) >= 0 && animelemtime(35) < 0
value = ifelse(target,teamside = teamside, -2, ceil(parent,fvar(10) * -4))
persistent = 6

[state 4123, targetpoweradd]
type = targetpoweradd
trigger1 = animelemtime(5) >= 0 && animelemtime(35) < 0
value = ifelse(target,teamside = teamside, 13, -25)
persistent = 6

[state 4123, shockwave]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
postype = p1
scale = 2,1.5
sprpriority = -3

[state 4123, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12



[state 4123, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4123, targetstate]
type = targetstate
trigger1 = time = 0
value = 660

[state 4123, targetstate]
type = targetstate
trigger1 = animelemtime(5) = 0
value = 662


[state 4123, random number]
type = varset
trigger1 = time = 0
var(1) = random%11
persistent = 0

[state 4123, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = [8,9]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.75, parentdist x * 0.75), 0 
stateno = 2500
id = 2500
name = "Small Heal"
persistent = 0

[state 4123, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = [0,4]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.75, parentdist x * 0.75), 0 
stateno = 2501
id = 2500
name = "One Bullet"
persistent = 0

[state 4123, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = [5,7]
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.75, parentdist x * 0.75), 0 
stateno = 2502
id = 2500
name = "Three Bullets"
persistent = 0

[state 4123, helper]
type = helper
trigger1 = animtime = 0
trigger1 = var(1) = 10
trigger1 = !numhelper(2500)
trigger1 = roundstate = 2
postype = p1
pos = ifelse(parent,movetype = H, p2bodydist x * 0.75, parentdist x * 0.75), 0 
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[state 4123, StinkLines]
type = Helper
trigger1 = animtime = 0
trigger1 = root,movetype != H
stateno = 4045
postype = p1
pos = 0,0
ownpal = 1

[state 4123, end]
type = changestate
trigger1 = animtime = 0
trigger2 = !numtarget(4120)
trigger2 = animelemtime(4) = 23
value = 4101
ignorehitpause = 1



;---------------------------------------------------------------------------
;Chokeslamed
[Statedef 4130]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 4130, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 4130

[state 4130, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0


[State 4130, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Slammed
[Statedef 4131]
type    = A
movetype= H
physics = N
poweradd = 40

[State 4130, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 4131

[state 4130, Velocity]
type = velset
trigger1 = !gethitvar(isbound)
x = 2
y = 120

[State 4131, 1] ;Gravity
type = VelAdd
Trigger1 = !gethitvar(isbound)
y = 1.6
persistent = 0

[State 4131, 4] ;Hit ground
type = Changestate
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 4132 ;Hit ground


;-----------------------------------------------------------------------------------
;Land and Bounce
[statedef 4132]
type = L
movetype = H
Physics = N

[state 4132, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 4132, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4132, animation]
type = changeanim
trigger1 = time = 0
value = 5100

[state 4132, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4130, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4130, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 18


[state 4132, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
ownpal = 1
scale = 3, 3

[state 4132, Bounce anim]
type = changeanim
trigger1 = anim = 5100
trigger1 = animtime = 0
value = 5160

[state 4132, velset]
type = velset
trigger1 = animelemtime(1) = 1
trigger1 = anim = 5160
y = -12
persistent = 0

[state 4132, gravity]
type = gravity
trigger1 = pos y < 0

[state 4132, End]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 4133

;-----------------------------------------------------------------------------------
;Land and rest
[statedef 4133]
type = L
movetype = H
Physics = N

[state 4132, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 4132, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4132, animation]
type = changeanim
trigger1 = time = 0
value = 5100

[state 4133, Laydown]
type = changeanim
trigger1 = anim = 5100
trigger1 = animtime = 0
value = 5110

[state 4132, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4130, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4130, envshake]
type = envshake
trigger1 = time = 0
ampl = -6
time = 12


[state 4132, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
ownpal = 1
scale = 1, 1

[state 4132, End]
type = Selfstate
trigger1 = alive
trigger1 = time = 180
value = 5120

;==================================================================================

; Support #3  Smiling Jacks & Caramel
;Caramel 4200 - 4249
;Smiling Jacks 4250 - 4299

;=================================================================================
;Run in
[statedef 4200]
type = S
movetype = A
physics = S
sprpriority = -1

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4200, width]
type = width
trigger1 = 1
value = floor(230 * const(size.xscale) * fvar(22)), floor(430 * const(size.xscale) * fvar(22))
ignorehitpause = 1 

[state 4200, Quakes]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12

[state 4200, Quakes]
type = envshake
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(7) = 0
ampl = -4
time = 12

[state 4200, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4200,0
volumescale = 100
channel = 1

[state 4200, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(7) = 0
value = 4200,0
volumescale = 75
channel = 2




[state 4200, anim]
type = changeanim
trigger1 = anim != 4200
value = 4200

;===========
;Armor start
;===========

;determine what frame
[state 4012, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4012, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4012, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4012, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1


[state 4012, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4200, 4240)
time = 1
persistent = 1

[State 4012, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 4200, velset]
type = velset
trigger1 = 1
x = 40
y = 0

[state 4200, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

[state 4200, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "parent bodydist X: %d  :Y %d "
params = parentdist x, parentdist y

[state 4200, changestate]
type = changestate
trigger1 = parent,var(20) <= 0
value = 4240
ignorehitpause = 1

[state 4200, changestate]
type = changestate
trigger1 = p2bodydist x = [0, 600]
trigger1 = p2bodydist y = [-400, 0]
value = 4205

[state 4200, deleteself]
type = destroyself
trigger1 = frontedgebodydist < -800
trigger2 = time > 600

;-----------------------------------------------------------------------------------
;Exit
;=================================================================================
;Run out
[statedef 4201]
type = S
movetype = A
physics = S
sprpriority = -1

[state 4201, turn]
type = turn
trigger1 = p2bodydist x > 0
trigger1 = time = 0


[state 4201, width]
type = width
trigger1 = 1
value = floor(230 * const(size.xscale) * fvar(22)), floor(430 * const(size.xscale) * fvar(22))
ignorehitpause = 1 

[state 4200, Quakes]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12

[state 4200, Quakes]
type = envshake
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(7) = 0
ampl = -4
time = 12

[state 4200, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
value = 4200,0
volumescale = 100
channel = 1

[state 4200, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(7) = 0
value = 4200,0
volumescale = 75
channel = 2

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4200, anim]
type = changeanim
trigger1 = anim != 4200
value = 4200

[state 4200, velset]
type = velset
trigger1 = 1
x = 18
y = 0

[state 4200, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4201, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4206

[state 4200, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "parent bodydist: %d"
params = parentdist x

[state 4200, deleteself]
type = destroyself
trigger1 = frontedgebodydist < -800
trigger2 = time > 600

;-----------------------------------------------------------------------------------
[statedef 4205]
type = S
movetype = A
physics = S
ctrl = 0

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4200, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

;===========
;Armor start
;===========

;determine what frame
[state 4012, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4012, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4012, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4012, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1



[state 4012, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4205, 4240)
time = 1
persistent = 1
ignorehitpause = 1

[State 4012, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;------------------------------------------------------------------

[state 4200, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4205)
anim = 2420
postype = p1
pos = 0,0
scale = const(size.xscale) * parent,fvar(22), const(size.yscale) * parent,fvar(22)
sprpriority =  4
bindtime = -1
ownpal = 1
removetime = 90
id = 4205

;Flaming Ass FX
[state 1200, Var14]
type = varset
trigger1 = time%4= 0
var(2) = Random%10
ignorehitpause = 1
persistent = 1

[state 1200, palFX]
type =  palFX
trigger1 = animelemtime(7) < 0
trigger1 = var(2) = 5
time = 2
mul = 0,0,0
persistent = 2
ignorehitpause = 1

[state 1200, palFX]
type = palFX
trigger1 = animelemtime(7) < 0
trigger1 = var(2) = [7,9]
time = 2
add = 128,0,0
persistent = 2
ignorehitpause = 1


[state 4200, removeid]
type = removeexplod
trigger1 = animelemtime(7) = 0
id = 4205

[state 4200, width]
type = width
trigger1 = 1
value = floor(230 * const(size.xscale) * parent,fvar(22)), floor(430 * const(size.xscale) * parent,fvar(22))
ignorehitpause = 1 



[state 4205, anim]
type = changeanim
trigger1 = anim != 4205
value = 4205

[State 4205, 2]
type = HitDef
trigger1 = animelemtime(7) <= 0 
persistent = 6
attr = S, HA
animtype  = Heavy
persistent = 0
damage    = 34,9
guardflag = MA
pausetime = 8,8
getpower = 0
givepower = 60
guard.pausetime = 8,8
sparkno = 2
p2sprpriority = -2
p2facing = 1
sparkxy = -40,-280
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -12
air.velocity = -8,-4
air.hittime = 28
guard.hittime = 20
guard.velocity = -6
guard.slidetime = 15
airguard.velocity = -9,9
guard.dist = 720
kill = 0

[State 4205, 2]
type = HitDef
trigger1 = animelemtime(8) >= 0 && animelemtime(9) < 0
persistent = 0
attr = S, HA
animtype  = Up
persistent = 0
damage    = 94,27
guardflag = MA
pausetime = 18,18
envshake.ampl = 12
envshake.time = 18
getpower = 0
givepower = 60
guard.pausetime = 8,8
sparkno = 3
id = 4200
sparkxy = -40,-280
hitsound   = 5,4
guardsound = 6,0
p2sprpriority = -2
p2facing = 1
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 15, -60
air.velocity = 15,-60
guard.hittime = 24
guard.velocity = -30
guard.slidetime = 24
airguard.velocity = -24,-12
yaccel = 1.22
fall = 1
fall.recover = 0
fall.recovertime = 45
guard.dist = 720
kill = 0

[state 4205, Targetstate]
type = targetstate
trigger1 = animelemtime(8) > 0
trigger1 = movehit
trigger1 = hitpausetime = 1
id = 4200
value = 4265
ignorehitpause = 1
persistent = 0

[state 4205, playerpush]
type = playerpush
trigger1 = 1
value = 1
ignorehitpause =1 

[state 4205, velocity]
type = velset
trigger1 = animelemtime(9) < 0
x = 40
persistent =1 
ignorehitpause = 1

[state 4205, velocity]
type = velset
trigger1 = animelemtime(9) = 0
x = 18
y = -15

[state 4205, gravity]
type = gravity
trigger1 = pos y < 0

[state 4200, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "parent bodydist: %d"
params = parentdist x

[state 4200, changestate]
type = changestate
trigger1 = parent,var(20) <= 0
value = 4240
ignorehitpause = 1


[state 4205, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4206

;-----------------------------------------------------------------------------------
;Landing
[statedef 4206]
type = C
movetype = I
physics = C
movehitpersist = 1



;===========
;Armor start
;===========

;determine what frame
[state 4206, remember frame]
type = parentvarset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 4206, delay]
type = changeanim 
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = parent,var(22)

[state 4206, freeze location]
type = posfreeze
trigger1 = parent,var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 4206, armor count down]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 20
value = -gethitvar(damage)
persistent = 1


[state 4206, Unstoppable]
type = hitoverride
trigger1 = 1
attr = SCA, AP, AA
stateno = ifelse(parent,var(20) > 0, 4206, 4240)
time = 1
persistent = 1
ignorehitpause = 1

[State 4206, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 4206, hitby]
type = hitby
trigger1 = 1
value = SCA, AA, AP

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4206, width]
type = width
trigger1 = time = 0
edge = 0, floor(600 * const(size.xscale) * parent,fvar(22))
ignorehitpause = 1

[state 4206, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0


[state 4206, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 12

[state 4206, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0


[state 4206, shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype =p1
pos = 0,0
scale = 3, 1.5
sprpriority = -3

[state 4206, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4206, stop]
type = velset
trigger1 = time = 0 
y = 0

[state 4206, anim]
type = changeanim
trigger1 = anim != 4206
value = 4206

[state 4200, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "parent bodydist: %d"
params = parentdist x


[state 4206, sprpriority]
type = sprpriority
trigger1 = animelemtime(9) = 0
value = -2

[state 4206, Buttcheek]
type = explod
trigger1 = animelemtime(9) = 0
trigger1 = !numexplod(4206)
id = 4206
anim = 4217
postype = p1
pos = 0,0
scale = const(size.xscale) * parent,fvar(22), const(size.yscale) * parent,fvar(22)
bindtime = -1
sprpriority = 3
removetime = 300

[state 4206, changestate]
type = changestate
trigger1 = !movehit
trigger1 = time = 60
trigger2 = time = 120
value = 4201

[state 4206, changestate]
type = changestate
trigger1 = numhelper(4250)
trigger1 = helper(4250),stateno = 4253
value = 4207

;===================================================================================
;Butt Catch
[statedef 4207]
type = S
movetype = A
physics = S

[state 4207, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[State 4207, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = enemynear,gethitvar(chainid) = 4250
attr = S, HT          
hitflag = AF         
priority = 1, Miss    
sparkno = -1          
p1sprpriority = -1     
id = 4200                            
p1stateno = 4208       
p2stateno = 4261      
guard.dist = 0       
fall = 1              
fall.recover = 0
fall.recovertime = 45
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -20

[state 4207, time end]
type = changestate
trigger1 = time > 90
value = 4201




;---------------------------------------------------------------------------------------
;Butt hold
[statedef 4208]
type = S
movetype = A
anim = 4208

[state 4208, clap]
type = playsnd
trigger1 = time = 0
value = 4205,0
persistent = 0

[state 4206, Buttcheek]
type = explod
trigger1 = anim = 4208
trigger1 = !numexplod(4208)
id = 4208
anim = 4218
postype = p1
pos = 0,0
scale = const(size.xscale) * parent,fvar(22), const(size.yscale) * parent,fvar(22)
bindtime = -1
sprpriority = 3

[state 4206, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4206

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4207, targetlifeadd]
type = targetlifeadd
trigger1= anim = 4209
trigger1 = animelemtime(4) = 0
value = floor(parent,fvar(10) * -90)
persistent = 0

[state 4207, envshake]
type = envshake
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 0
ampl = -4
time = 25

[state 4207, playsnd]
type = playsnd
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 0
value = 4208,0

[state 4207, playsnd]
type = playsnd
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 0
value = 4208,0

[state 4207, helper]
type = helper
trigger1 = anim = 4209
trigger1 = animelemtime(5) = 0
trigger1 = !numhelper(4210)
stateno = 4210
postype = p1
pos = 0,0
id = 4210


[state 4207, Explosive Gas]
type = Explod
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 1
anim = 2110
postype = p1
pos = -280 * const(size.xscale) * parent,fvar(22),-400 * const(size.yscale) * parent,fvar(22)
scale = const(size.xscale) * 2, const(size.yscale) * 2
sprpriority = 4

[state 4207, gas]
type = explod
trigger1 = anim = 4209
trigger1 = animelemtime(4) > 0 && animelemtime(14) < 0
anim = 2120
postype = p1
pos = -280 * const(size.xscale) * parent,fvar(22),(-400 + random%80) * const(size.yscale) * parent,fvar(22)
scale = const(size.xscale) * 3, const(size.yscale) * 3
sprpriority = 3
accel = 0, -0.22
vel = -36 + random%24,-4 + random%8
persistent = 4

[state 4207, gas]
type = explod
trigger1 = anim = 4209
trigger1 = animelemtime(4) > 0 && animelemtime(14) < 0
anim = 2120
postype = p1
pos = -280 * const(size.xscale) * parent,fvar(22),(-440 + random%80) * const(size.yscale) * parent,fvar(22)
scale = const(size.xscale) * 3, const(size.yscale) * 3
sprpriority = 1
accel = 0, -0.22
vel = -36 + random%24,-4 + random%8
persistent = 4


[state 4207, changeanim]
type = changeanim
trigger1 = anim = 4208
trigger1 = animtime = 0
value = 4209

[state 4206, Buttcheek]
type = explod
trigger1 = anim = 4209
trigger1 = !numexplod(4209)
id = 4209
anim = 4219
postype = p1
pos = 0,0
scale = const(size.xscale) * parent,fvar(22), const(size.yscale) * parent,fvar(22)
bindtime = -1
sprpriority = 3

[state 4206, removeexplod]
type = removeexplod
trigger1 = anim = 4209
id = 4208

[state 4207, targetstate]
type = targetstate
trigger1 = time = 40
value = 4262


[state 4207, targetbind 1]
type = targetbind
trigger1 = anim = 4208
trigger1 = animelemtime(2) < 0
pos = -245 * const(size.xscale) * parent,fvar(22), -490 * const(size.yscale) * parent,fvar(22)

[state 4207, targetbind 2]
type = targetbind
trigger1 = anim = 4208
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
pos = -210 * const(size.xscale) * parent,fvar(22), -490 * const(size.yscale) * parent,fvar(22)

[state 4207, targetbind 3]
type = targetbind
trigger1 = anim = 4208
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = -245 * const(size.xscale) * parent,fvar(22), -490 * const(size.yscale) * parent,fvar(22)

[state 4207, targetbind 4]
type = targetbind
trigger1 = anim = 4208
trigger1 = animelemtime(4) >= 0 
pos = -280 * const(size.xscale) * parent,fvar(22), -490 * const(size.yscale) * parent,fvar(22)

[state 4207, targetbind 5]
type = targetbind
trigger1 = anim = 4209
trigger1 = animelemtime(4) < 1 
pos = -280 * const(size.xscale) * parent,fvar(22), -490 * const(size.yscale) * parent,fvar(22)

[state 4207, targetstate]
type = targetstate
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 1
value = 4263

[state 4041, spawner]
type = helper
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 0
postype = p2
pos = 0,0
stateno = 4045
id = 4045
name = "Stink lines"

[state 4207, targetdrop]
type = targetdrop
trigger1 = anim = 4209
trigger1 = animelemtime(4) = 1


[state 4208, removeexplod]
type = removeexplod
trigger1 = anim = 4209
trigger1 = animtime = 0
id = 4209

[state 4208, changestate]
type = changestate
trigger1 = anim = 4209
trigger1 = animtime = 0
value = 4201


;==================================================================================
;Fart Knockback
[statedef 4210]
type = S
movetype = A
anim = 4210

[State 4210, HitDef]
type = HitDef
trigger1 = !movecontact
attr = S,HP       ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = HAF        ;HLAFD+-
guardflag = MA         ;HLA
affectteam = F          ;B,E,F
animtype = Back          ;Light, Medium, Hard, Back, Up, DiagUp
air.animtype = Back
;fall.animtype = Back
;priority = 4,Hit
damage = 30
pausetime = 0,0
;guard.pausetime = 0,0
sparkno = -1
guard.sparkno = S3100
sparkxy = 0,0
hitsound = -1
guardsound = S2,0
ground.type = High      ;Low, Trip, None
;air.type = High
ground.slidetime = 0
;guard.slidetime = 
ground.hittime = 0
;guard.hittime = 
air.hittime = 20
;guard.ctrltime = 
;guard.dist = 320
;yaccel = 0.5
ground.velocity = 80,-10
;guard.velocity = 0
air.velocity = 80,-10
;airguard.velocity = 0,0
;ground.cornerpush.veloff = 0
;air.cornerpush.veloff = 0
;down.cornerpush.veloff = 0
;guard.cornerpush.veloff = 0
;airguard.cornerpush.veloff = 0
;airguard.ctrltime = 
;air.juggle = 0
;mindist = 0,0
;maxdist = 0,0
;snap = 

;p1facing = 

;p2facing = 
;p1stateno = 
p2stateno = 675
;p2getp1state = 1
;forcestand = 0
fall = 1
fall.xvelocity = -10
fall.yvelocity = -20
fall.recover = 0
fall.recovertime = 45
down.bounce = 1
id = 0
chainID = -1
nochainID = -1
hitonce = 1
kill = 0
guard.kill = 0
fall.kill = 1
numhits = 1



[state 4210, end]
type = destroyself
trigger1 = animtime = 0

;-----------------------------------------------------------------------------------
;Caramel hurt
[statedef 4240]
type = A
movetype = A
physics = N
anim = 4240

[state 4290, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4240, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4205

[state 4240, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4206

[state 4240, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4207

[state 4240, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4208

[State 4240, 0]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, HA
damage    = 120
guardflag = 
hitflag = M
affectteam = F
getpower = 250
givepower = 250
id = 4240
nochainid = 4240
priority = 4
pausetime = 0,0
sparkno = -1
sparkxy = 0,0
hitsound   = S240,0
guardsound = S120,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
p1sprpriority = 3
p2sprpriority = -2
down.hittime = 60
guard.velocity = -45            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -28,10
airguard.hittime = 35
guard.dist = 320
kill = 1

[state 4240, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = target,statetype != A
value = 661
;------------------------------------------------
;Ride down mechanic
[state 4240, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = target,statetype = A
pos = 0, -20

[state 4240, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype = A
value = 655

[state 4240, not throwable]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1

[state 4240, velset]
type = velset
trigger1 = time = 0
x = -gethitvar(xvel) * 0.25
y = ifelse(gethitvar(yvel) < 0, gethitvar(yvel), -4)

[state 4240, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
slot = 1
stateno = 4240
ignorehitpause = 1
persistent = 1

[state 4240, gravity]
type = gravity
trigger1 = pos y < 0

[state 4240, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger2 = time > 180
value = 4241

;-----------------------------------------------------------------------------------
;Caramel Land Hurt
[statedef 4241]
type = C
movetype = A
physics = C
anim = 4241

[state 4241, envshake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 24

[state 4241, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4241, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4241, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0


[state 4241, helper]
type = helper
trigger1 = time = 1
trigger1 = !numhelper(2500)
postype = p1
pos = 0,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0

[State 4241, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 120
guardflag = 
getpower = 250
givepower = 250
Affectteam = F
hitflag = FD
priority = 4
nochainid = 4240
id = 4240
pausetime = 12,12
sparkno = -1
p1sprpriority = 3
p2sprpriority = -2
sparkxy = -10,-40
hitsound   = S240,0
guardsound = S120,0
animtype = back
p2stateno = 661
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state 4092, statetypeset]
type = statetypeset
trigger1 = time > 2
movetype = H

[state 4092, Dizzy Stars]
type = explod
trigger1 = time = 1
trigger1 = !numexplod(4530)
anim = 2530
id = 4530
postype = p1
pos = 310 * const(size.xscale) * parent,fvar(22), -240 * const(size.yscale) * parent,fvar(22)
ownpal = 1
ontop = 1
removetime = 120
removeongethit = 1
ignorehitpause = 1

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(22), parent,fvar(22)
persistent = 1
ignorehitpause = 1

[state 4240, not throwable]
type = nothitby
trigger1 = time < 24
value = , AT
ignorehitpause = 1

[state 4240, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4241, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4240, nothitby]
type = nothitby
trigger1 = time >= 24
value = SCA
ignorehitpause = 1

[state 4241, nothitby]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
slot = 1
stateno = 4240
ignorehitpause = 1
persistent = 1


[state 4241, changestate]
type = changestate
trigger1 = time > 120
value = 4201
;-----------------------------------------------------------------------------------
;Ride in
[statedef 4250]
type = A
movetype = A
physics = N
sprpriority = 2
anim = 4250

[state 4200, turn]
type = turn
triggerall = numhelper(4200)
trigger1 = time = 0
trigger1 = facing != helper(4200),facing
ignorehitpause =1 

[state 4200, nothitby]
type = nothitby
trigger1 = 1 
value = SCA

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1

[state 4200, posset 1]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201] 
trigger1 = helper(4200), animelemtime(2) < 0
x = (helper(4200),pos x - 15 * helper(4200),facing ) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 340)  * const(size.yscale) * parent,fvar(22)

[state 4200, posset 2]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201]
trigger1 = helper(4200), animelemtime(2) >= 0 && helper(4200),animelemtime(3) < 0
x = (helper(4200),pos x - 5 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 305)  * const(size.yscale) * parent,fvar(22)

[state 4200, posset 3]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201]
trigger1 = helper(4200), animelemtime(3) >= 0 && helper(4200),animelemtime(4) < 0
x = (helper(4200),pos x - 5 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 325)  * const(size.yscale) * parent,fvar(22)

[state 4200, posset 4]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201]
trigger1 = helper(4200), animelemtime(4) >= 0 && helper(4200),animelemtime(5) < 0
x = (helper(4200),pos x - 5 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 355) * const(size.yscale) * parent,fvar(22)

[state 4200, posset 5]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201]
trigger1 = helper(4200), animelemtime(5) >= 0 && helper(4200),animelemtime(6) < 0
x =(helper(4200),pos x - 0 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 375) * const(size.yscale) * parent,fvar(22)

[state 4200, posset 6]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201]
trigger1 = helper(4200), animelemtime(6) >= 0 && helper(4200),animelemtime(7) < 0
x = (helper(4200),pos x - 0 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 390) * const(size.yscale) * parent,fvar(22)

[state 4200, posset 8]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = [4200,4201]
trigger1 = helper(4200), animelemtime(7) >= 0 
x = (helper(4200),pos x - 0 ) * const(size.xscale) * parent,fvar(22)
y =(helper(4200),pos y - 370) * const(size.yscale) * parent,fvar(22)

[state 4200, Headcrush]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno =  4205
x = (helper(4200),pos x + 5 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 325) * const(size.yscale) * parent,fvar(22)
ignorehitpause = 1
persistent = 1

[state 4200, changestate]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4205
trigger1 = helper(4200), animelemtime(7) >= 0
value = 4251

[state 4200, knocked off]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno != [4200,4209]
value = 4290

[state 4250, end]
type = destroyself
trigger1 = frontedgebodydist < -400
trigger2 = time > 400
;====================================================================================
;Switch to back
[statedef 4251]
type = A
movetype = I
physics = N

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1

[state 4251, changeanim]
type = changeanim
trigger1 = time = 0
value = 4251

[state 4251, sprpriority]
type = sprpriority
trigger1 = animelemtime(3) = 0 
value = -1

[state 4200, posset 7]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4205
trigger1 = helper(4200), animelemtime(7) >= 0 && helper(4200), animelemtime(8) < 0
x = (helper(4200),pos x - 40 * helper(4200),facing)* const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 285)* const(size.yscale) * parent,fvar(22)
persistent = 1

[state 4200, posset 8]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4205
trigger1 = helper(4200), animelemtime(8) >= 0 && helper(4200), animelemtime(9) < 0
x = (helper(4200),pos x - 100 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 460) * const(size.yscale) * parent,fvar(22)
persistent = 1

[state 4200, posset 9]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4205
trigger1 = helper(4200), animelemtime(9) >= 0 && helper(4200), animelemtime(10) < 0
x = (helper(4200),pos x - 160 * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 540) * const(size.yscale) * parent,fvar(22)
persistent = 1

[state 4200, posset 10]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4205
trigger1 = helper(4200), animelemtime(10) >= 0 
x = (helper(4200),pos x - 200  * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 555) * const(size.yscale) * parent,fvar(22)
persistent = 1

[state 4253, changestate]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno = 4200 || helper(4200),stateno = 4201
value = 4250

[state 4200, knocked off]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno != [4200,4209]
value = 4290

[state 4200, changestate]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4206
value = 4252
persistent = 1

;====================================================================================
;Lasso Pull
[statedef 4252]
type = A
movetype = A
physics = N

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1

[state 4251, changeanim]
type = changeanim
trigger1 = time = 40
value = 4252

[state 4252, playsnd]
type = playsnd
trigger1 = anim = 4252
trigger1 = animelemtime(2) = 0
value = 1050,0

[state 4200, posset 8]
type = posset
trigger1 = numhelper(4200)
trigger1 = helper(4200), stateno = 4206 
x = (helper(4200),pos x - 200  * helper(4200),facing) * const(size.xscale) * parent,fvar(22)
y = (helper(4200),pos y - 520) * const(size.yscale) * parent,fvar(22)
persistent = 1

[State 4200, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = enemynear,gethitvar(chainid) = 4200

attr = A, HT          
hitflag = AF          
priority = 1, Miss   
sparkno = -1         
p1sprpriority = 1     
id = 4250                            
p1stateno = 4253       
p2stateno = 4260      
guard.dist = 0        
fall = 1             
fall.recover = 0
fall.recovertime = 45
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -20

[state 4200, knocked off]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno != [4200,4209]
value = 4290

[state 4253, changestate]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno = 4200 || helper(4200),stateno = 4201
value = 4250

[state 4200, changestate]
type = destroyself
trigger1 = time > 180

;------------------------------------------------------------------------------------
;Lasso Yank
[statedef 4253]
type = A
movetype = A
physics = N

[state 4200, Lasso Sound]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 4200, Lasso Sound]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1


[state 4253, changeanim]
type = changeanim
trigger1 = time = 0
value = 4253

[state 4253, targetbind]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = -445 * parent,fvar(23), -95 * parent,fvar(23)

[state 4253, Yank]
type = targetvelset
trigger1 = animelemtime(2) = 0
x = -40
y = 32 

[state 4200, knocked off]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno != [4200,4209]
value = 4290

[state 4253, changestate]
type = changestate
trigger1 = numhelper(4200)
trigger1 = helper(4200),stateno = 4200 || helper(4200),stateno = 4201
value = 4250

[state 4200, changestate]
type = destroyself
trigger1 = time > 180


;===================================================================================
;Victim Grabbed
;===================================================================================
[statedef 4260]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 1

[state 4260, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4260

[state 4260, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1, 0

[state 4260, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;----------------------------------------------------------------------------------
;Wedgeds
[statedef 4261]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 2

[state 4260, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1, 0

[state 4261, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4261

[state 4261, selfstate]
type = selfstate
trigger1 = time > 90
value = 5050

;----------------------------------------------------------------------------------

;Gassed
[statedef 4262]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 2

[state 4260, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1, 0

[state 4020, color]
type = palFX
trigger1 = time = 0
time = 240
mul = 100,180,40

[state 4262, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4262

[state 4261, selfstate]
type = selfstate
trigger1 = time > 90
value = 5050

;-----------------------------------------------------------------------------------
;Blasted
[statedef 4263]
type = A
movetype = H
physics = N
velset = 80, -5

[state 4260, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0, 0

[state 4263, nothitby]
type = nothitby
trigger1 = time = 0
value = SCA
time = 80

[state 4020, color]
type = palFX
trigger1 = 1
time = 240
mul = 100,180,40

[state 4263, veladd]
type = veladd
trigger1 = 1
y = 1.22
persistent = 1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[state 4263, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > - vel y
value = 5100

[state 4263, changeanim]
type = changeanim
trigger1 = time = 0
value = 5035

;------------------------------------------------------------------------------------
;Launched upwards
[statedef 4265]
type = A
movetype = H
physics = N
velset = 0, -80

[state 4265, changeanim]
type = changeanim
trigger1 = time = 0
value = 5051

[state 4265, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1, 0
ignorehitpause = 1

[state 4265, nothitby]
type = nothitby
trigger1 = 1
value = SCA
persistent = 1

[state 4265, end]
type = changestate
trigger1 = time = 30
value = 4266

;=====================================================================================
;Coming Down
[statedef 4266]
type = A
movetype = H
physics = N
velset = 0, 8

[state 4265, posset]
type = posadd
trigger1 = time = 0
x = 1200

[state 4265, changeanim]
type = changeanim
trigger1 = time = 0
value = 5061

[state 4265, gravity]
type = veladd
trigger1 = time > 0
y = 1.22

[state 4265, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 1, 0
ignorehitpause = 1

[state 4265, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 5100

;====================================================================================
;Smiling Jacks Hurt
[statedef 4290]
type = A
movetype = H
physics = N
anim = 4290

[state 4290, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = numhelper(2501) < 3
postype = p1
pos = 0,0
stateno = 2501
id = 2501
name = "One Bullet"
persistent = 0

[state 4200, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1

[state 4290, Not throwable]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4290, velset]
type = velset
trigger1 = time = 0
x = -gethitvar(xvel)
y = ifelse(gethitvar(yvel) < 0, gethitvar(yvel), -10)

[state 4290, gravity]
type = gravity
trigger1 = pos y < 0

[state 4290, Hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
slot = 1
stateno = 4290
persistent = 1
ignorehitpause = 1

[state 4290, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4291

;------------------------------------------------------------------------------------
;Smiling Jacks Hurt down
[statedef 4291]
type = C
movetype = H
physics = C
anim = 4291

[state 4005, helper]
type = helper
trigger1 = time = 1
trigger1 = numhelper(2501) < 3
postype = p1
pos = 0,0
stateno = 2501
id = 2501
name = "One Bullet"
persistent = 0

[state 4092, Dizzy Stars]
type = explod
trigger1 = animelemtime(2) = 0
trigger1 = !numexplod(4530)
anim = 2530
id = 4530
postype = p1
pos = -40 * const(size.xscale) * parent,fvar(23), -200 * const(size.yscale) * parent,fvar(23)
ownpal = 1
ontop = 1
removetime = 180
removeongethit = 1
ignorehitpause = 1
persistent = 0

[state 4291, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1

[state 4291, NOTHITBY]
type = nothitby
trigger1 = time > 24
value = SCA
ignorehitpause = 1

[state 4291, Nothitby]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1

[state 4291, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4291, nothity]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
slot = 1
stateno = 4290
persistent = 1
ignorehitpause = 1

[state 4291, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4291, changestate]
type = changestate
trigger1 = time > 600
trigger2 = time > 180
trigger2 = p2bodydist x != [-400, 400] 
value = 4292

;-----------------------------------------------------------------------------------
;Run Away
[statedef 4292]
type = S
movetype = I
physics = S
anim = 4292

[state 4292, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = parent,fvar(23), parent,fvar(23)
persistent = 1
ignorehitpause = 1

[state 4292, nothitby]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1

[state 4292, Turn]
type = turn
trigger1 = time = 0
trigger1 = p2bodydist x > 0

[state 4292, RUN]
type = velset
trigger1 = time > 0
x = 30

[state 4292, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -800
trigger2 = backedgebodydist < -800

;------------------------------------------------------------------------------------
;Roxxie Idle
[statedef 4300]
type = S
movetype = I
physics = S
anim = 4300

[state 4314, targetstate]
type = posadd
trigger1 = time = 0
trigger1 = prevstateno = 4317
x = 442

[state 4300, removeexplod]
type = removeexplod
trigger1 = time =0
id = 4311

[state 4300, removeexplod]
type = removeexplod
trigger1 = time =0
id = 4312

[state 4300, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4300, posset]
type = posset
trigger1 = time =  0
y = 0

[state 4300, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4300, changestate]
type = changestate
trigger1 = time > 40
value = 4301

;-------------------------------------------------------------------------------------
;Roxxie Exit
[statedef 4301]
type = S
movetype = I
physics = N
anim = 4301

[state 4301, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4301, Jump Out]
type = velset
trigger1 = animelemtime(11) = 0
x = 12
y = -80

[state 4301, shockwave]
type = explod
trigger1 = animelemtime(10) = 7
anim = F61
postype = p1
pos = 0,0
scale = 3,2
sprpriority = -3

[state 4301, playsnd]
type = playsnd
trigger1 = animelemtime(11) = 0
value = 4032, 0
persistent = 0

[state 4301, destroyself]
type = destroyself
trigger1 = pos y < -1080
trigger2 = time > 300

;-------------------------------------------------------------------------------------
;Roxxie Exit Hurt
[statedef 4302]
type = S
movetype = I
physics = N
anim = 4302

[state 4300, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4092, Dizzy Stars]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4530)
anim = 2530
id = 4530
postype = p1
pos = 210 * const(size.xscale), -530 * const(size.yscale)
ownpal = 1
ontop = 1
removetime = 120
removeongethit = 1
ignorehitpause = 1

[state 4300, posset]
type = posset
trigger1 = time =  0
y = 0

[state 4092, removedizzy]
type = removeexplod
trigger1 = animelemtime(2) = 0
id = 4530

[state 4005, helper]
type = helper
trigger1 = time = 12
trigger1 = numhelper(2500) < 2
postype = p1
pos = rootdist x,0
stateno = 2503
id = 2500
name = "Large Heal"
persistent = 0


[state 4301, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4301, Jump Out]
type = velset
trigger1 = animelemtime(3) = 0
x = 12
y = -80

[state 4301, shockwave]
type = explod
trigger1 = animelemtime(2) = 7
anim = F61
postype = p1
pos = 0,0
scale = 3,2
sprpriority = -3

[state 4301, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 4032, 0
persistent = 0

[state 4301, destroyself]
type = destroyself
trigger1 = pos y < -1080
trigger2 = time > 300

;-------------------------------------------------------------------------------------
;Roxxie Butt Drop
[statedef 4310]
type = A
movetype = A
physics = N
sprpriority = -2

[state 4035, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0
ignorehitpause = 1

[state 4035, velset]
type = velset
trigger1 = time = 0
x = 0

[state 4035, veladd]
type = veladd
trigger1 = time = 0
y = 60

[state 4035, change anim]
type = changeanim
trigger1 = time = 0
value = 4310

[STATE 4310, Butt Cheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4310)
id  = 4310
anim = 4320
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
bindtime = -1
removetime = -1
removeongethit = 1
sprpriority = 3


[state 4310, gravity]
type = gravity
trigger1 = pos y < 0

[state 4035, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
persistent = 1

[State 4035, 0]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact && !movereversed
persistent = 0
attr = A, HA
damage    = 60,56
guardflag = MA
hitflag = MAF
affectteam = E
getpower = 0
givepower = 300
id = 4300
nochainid = 4300,1400
priority = 4
pausetime = 0,0
sparkno = -1
sparkxy = 0,0
hitsound   = S240,0
guardsound = S120,0
p1sprpriority = -2
p2facing = -1
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -60           
guard.hittime = 30
guard.slidetime = 30
airguard.velocity = -30,5
airguard.hittime = 35
guard.dist = 720
kill = 0

[state 4310, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Parentdist x: %d Parentdist y: %d pos y: %d"
params = parentdist x, parentdist y, pos y

[state 4310, slowmo]
type = null;pause
trigger1 = pos y = [-400, -150]
time = 4
persistent = 2

[state 4035, enemy state]
type = targetstate
triggerall = vel y > 0
triggerall = !moveguarded
trigger1 = movehit
value = 4340
persistent = 0
id = 4300
;------------------------------------------------
;Ride down mechanic
[state 4035, Ride down]
type = targetbind
triggerall = !moveguarded
trigger1 = movehit
pos = -20, -80
id = 4300
;----------------------------------------------

[state 4035, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4311

;-------------------------------------------------------------------------
; 1st Landing
[statedef 4311]
type = C
movetype = A
physics = N
movehitpersist = 1

[state 4311, targetstate]
type = targetstate
trigger1 = time = 0
value = 4341
id = 4300

[state 4311, targetbind]
type = targetbind
trigger1 = 1
pos = -20, -80

[state 4311, Front Dust]
type = explod
trigger1 = time = 0
postype = p1
pos = 0, 0
sprpriority = 4
ownpal = 1
anim = 2160
scale = 1.1,1.1

[state 4311, Back Dust]
type = explod
trigger1 = time = 0
postype = p1
pos = 0, 0
sprpriority = -2
ownpal = 1
anim = 2161
scale = 1.1,1.1


[state 4311, anim]
type = changeanim
trigger1 = time = 0
value = 4311

[STATE 4311, Butt Cheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4311)
id  = 4311
anim = 4321
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
bindtime = -1
removetime = -1
removeongethit = 1
sprpriority = 2

[state 4311, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4310

[state 4311, stopsnd]
type = stopsnd
trigger1 = time = 0
channel = 2

[state 4311, envshake]
type = envshake
trigger1 = time = 0
ampl = -24
time = 30

[state 4311, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4311, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4311, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4311, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 6,3
ownpal = 1
sprpriority = -3


[state 4311, not grabble]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
persistent = 1


[State 4311, 3]
type = HitDef
trigger1 = Time = 0
attr = A, HA
damage    = 60
guardflag = 
Affectteam = B
hitflag = FD
priority = 4
getpower = 0
p1sprpriority = -2
givepower = 300
nochainid = 4300
id = 4300
pausetime = 0,0
sparkno = -1
sparkxy = -10,-40
hitsound   = S240,0
guardsound = S120,0
animtype = Med
p2facing = -1
p2stateno = 4341
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0


[state 4311, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4311, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4311, Bounce]
type = velset
trigger1 = time = 12
y = -24

[state 4311, Gravity]
type = gravity
triggerall = time > 12
trigger1 = pos y < 0

[state 4311, Changestate]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4312

;---------------------------------------------------------------------------------------------------------
;2nd bounce
[statedef 4312]
type = C
movetype = A
physics = N
movehitpersist = 1

[state 4311, targetstate]
type = targetstate
trigger1 = time = 0
value = 4341
id = 4300

[state 4311, targetbind]
type = targetbind
trigger1 = 1
pos = -20, -80
id = 4300

[state 4312, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 4312, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(parent,fvar(10) * -30)
id = 4300
kill = 0

[state 4312, hitadd]
type = hitadd
trigger1 = time = 0
value = 1
ignorehitpause = 1
persistent = 0

[state 4312, Front Dust]
type = explod
trigger1 = time = 0
postype = p1
pos = 0, 0
sprpriority = 4
ownpal = 1
anim = 2160
scale = 1.1,1.1

[state 4312, Back Dust]
type = explod
trigger1 = time = 0
postype = p1
pos = 0, 0
sprpriority = -2
ownpal = 1
anim = 2161
scale = 1.1,1.1


[state 4312, anim]
type = changeanim
trigger1 = time = 0
value = 4312

[STATE 4312, Butt Cheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4312)
id  = 4312
anim = 4322
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
bindtime = -1
removetime = -1
removeongethit = 1
sprpriority = 3

[state 4312, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4311

[state 4312, stopsnd]
type = stopsnd
trigger1 = time = 0
channel = 2

[state 4312, envshake]
type = envshake
trigger1 = time = 0
ampl = -24
time = 30

[state 4312, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4312, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4312, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4312, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 6,3
ownpal = 1
sprpriority = -3


[state 4312, not grabble]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1
persistent = 1

[state 4312, bounce count]
type = varset
trigger1 = time = 0
var(1) = 3


[state 4312, stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4312, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4312, Bounce]
type = velset
trigger1 = time = 12
y = -18

[state 4312, Gravity]
type = gravity
triggerall = time > 12
trigger1 = pos y < 0

[state 4312, Changestate]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = movehit
value = 4313

[state 4312, Changestate]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = !movehit
value = 4300

;------------------------------------------------------------------------------------
;Wedge and Clap
[statedef 4313]
type = S
movetype = A
physics = S
anim = 4313

[state 4313, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4312

[STATE 4312, Butt Cheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4313)
id  = 4313
anim = 4323
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
bindtime = -1
removetime = -2
removeongethit = 1
sprpriority = 3



[state 4313, varset]
type = varset
trigger1 = time = 0
var(2) = 0
ignorehitpause = 1

[state 4313, targetstate]
type = targetstate
trigger1 = time = 0
id = 4300
value = 4343

[state 4313, targetbind 1]
type = targetbind
trigger1 = animelemtime(2) < 0
trigger2 = animelemtime(10) >= 0 && animelemtime(11) < 0
pos = -125 * const(size.xscale), -170 * const(size.yscale)

[state 4313, targetbind 2]
type = targetbind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
trigger2 = animelemtime(11) >= 0 && animelemtime(12) < 0
pos = -125 * const(size.xscale), -190 * const(size.yscale)

[state 4313, targetbind 3]
type = targetbind
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
trigger2 = animelemtime(12) >= 0 && animelemtime(13) < 0
pos = -125 * const(size.xscale), -210 * const(size.yscale)

[state 4313, targetbind 4]
type = targetbind
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
trigger2 = animelemtime(13) >= 0 && animelemtime(14) < 0
pos = -125 * const(size.xscale), -230 * const(size.yscale)

[state 4313, targetbind 5]
type = targetbind
trigger1 = animelemtime(5) >= 0 && animelemtime(6) < 0
trigger2 = animelemtime(14) >= 0 && animelemtime(15) < 0
pos = -160 * const(size.xscale), -225 * const(size.yscale)

[state 4313, targetbind 6]
type = targetbind
trigger1 = animelemtime(6) >= 0 && animelemtime(8) < 0
trigger2 = animelemtime(15) >= 0 && animelemtime(17) < 0
pos = -130 * const(size.xscale), -220 * const(size.yscale)

[state 4313, targetbind 8]
type = targetbind
trigger1 = animelemtime(8) >= 0 && animelemtime(9) < 0
trigger2 = animelemtime(17) >= 0 && animelemtime(18) < 0
pos = -180 * const(size.xscale), -210 * const(size.yscale)

[state 4313, targetbind 9]
type = targetbind
trigger1 = animelemtime(9) >= 0 && animelemtime(10) < 0
trigger2 = animelemtime(18) >= 0 && animelemtime(19) < 0
pos = -180 * const(size.xscale), -210 * const(size.yscale)

[state 4313, targetbind 10]
type = targetbind
trigger1 = animelemtime(10) >= 0 && animelemtime(11) < 0
trigger2 = animelemtime(19) >= 0 && animelemtime(20) < 0
pos = -130 * const(size.xscale), -170 * const(size.yscale)

[state 4313, targetbind 11]
type = targetbind
trigger1 = animelemtime(11) >= 0 && animelemtime(12) < 0
trigger2 = animelemtime(20) >= 0 
pos = -120 * const(size.xscale), -170 * const(size.yscale)

[state 4313, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(16) = 0
value = ceil(parent,fvar(10) * -15)
id = 4300
kill = 0

[state 4315, hitadd]
type = hitadd
trigger1 = animelemtime(6) = 1
trigger2 = animelemtime(16) = 1
value = 1
ignorehitpause = 1
persistent = 1

[state 4313, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(16) = 0
value = 4205, 0
persistent = 1

[state 4313, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4313, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4313, Zoom to wall]
type = changestate
trigger1 = animtime = 0
value = 4314

;------------------------------------------------------------------------------------
;Wall Crush
[statedef 4314]
type = S
movetype = A
physics = N
sprpriority = -2

[state 4313, changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(var(1) = 1, 4316, 4314)

[state 4313, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4313

[STATE 4312, Butt Cheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4314)
id  = 4314
anim = ifelse(var(1) = 1, 4326, 4324)
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
bindtime = -1
removetime = -2
removeongethit = 1
sprpriority = 3

[state 4313, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4314, targetstate]
type = targetstate
trigger1 = time = 0
trigger1 = var(1) = 3
value = 4344
id = 4300

[state 4314, targetstate]
type = posadd
trigger1 = time = 0
trigger1 = var(1) != 3
x = 470

[state 4314, dust]
type = explod
trigger1 = animelemtime(3) > 0 
anim = 2025
postype = p1
pos = 65, 0
sprpriority = 4
scale = 1, 1
persistent = 2


[state 4314, playsnd]
type = playsnd
trigger1 = time = 0
trigger1 = var(1) != 3
value = 40,0

[state 4314, envshake]
type = envshake
trigger1 = time = 0
trigger1 = var(1) != 3
ampl = -8
time = 12

;Binds
[state 4313, targetbind 1]
type = targetbind
trigger1 = animelemtime(2) < 0
trigger1 = var(1) = 3
pos = -170 * const(size.xscale), -120 * const(size.yscale)

[state 4313, targetbind 1]
type = targetbind
trigger1 = animelemtime(2) >= 0  && animelemtime(3) < 0
trigger1 = var(1) = 3
pos = -210 * const(size.xscale), -70 * const(size.yscale)

[state 4313, targetbind 1]
type = targetbind
trigger1 = animelemtime(3) >= 0  
trigger1 = var(1) = 3
pos = -420 * const(size.xscale), -420 * const(size.yscale)


[state 4313, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4313, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0



[state 4313, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = ifelse(var(1) = 1, -120, -80)
persistent = 0
ignorehitpause = 1

[state 4313, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 4032, 0
persistent = 0

[state 4314, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = backedgebodydist
text = "Ass size to wall: %d"

[state 4313, changestate]
type = changestate
TRIGGER1 = ANIMELEMTIME(3) >= 0
trigger1 = backedgebodydist < 380
value = 4315

;--------------------------------------------------------------------------------------
;Wall Crash
[statedef 4315]
type = S
movetype = A
physics = N
anim = 4315
sprpriority = 2

[state 4313, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4314

[state 4315, Wall shockwave]
type = explod
trigger1 = time = 0
anim = F72
postype = p1
pos = 0,-300
scale = 2,2
sprpriority = 4



[state 4313, varadd]
type = varadd
trigger1  = time = 2
var(2) = 1
persistent = 0

[state 4313, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4315, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 18

[state 4315, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4315, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4315, playsnd]
type = playsnd
trigger1 = time = 0
trigger1 = var(1) <= 1
value = 4090,0

[state 4315, hitadd]
type = hitadd
trigger1 = time = 0
value = 1
ignorehitpause = 1
persistent = 0

[state 4315, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
trigger1 = var(1) > 1
value = Ceil(parent,fvar(10) * -80)
id = 4300
kill = 0

[state 4315, Targetstate]
type = targetstate
trigger1 = time = 0
value = 4345 + var(2)
id = 4300

[state 4312, bounce count]
type = varadd
trigger1 = time = 0
var(1) = -1
ignorehitpause = 1


[state 3042, posset]
type = posset
trigger1 = time = 0
x = (-facing*(gamewidth/2))

[state 3042, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3042, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = ifelse(var(1) = 1, 18, 12)
y = ifelse(var(1) = 1, -30,-21)

[state 3042, gravity]
type = gravity
trigger1 = animelemtime(3) >= 0
trigger1 = pos y < 0

[state 4315, Repeat]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = var(1) > 1
value = 4314

[state 4315, Repeat]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = var(1) = 1
value = 4316

[state 4315, Repeat]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger1 = var(1) <= 0
value = 4300

;---------------------------------------------------------------------------------
;Final Wall Crush
;------------------------------------------------------------------------------------
;Wall Crush
[statedef 4316]
type = S
movetype = A
physics = N
sprpriority = 1

[state 4316, changeanim]
type = changeanim
trigger1 = time = 0
value = 4316

[state 4316, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4313

[STATE 4316, Butt Cheek]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4316)
id  = 4316
anim = ifelse(var(1) = 1, 4326, 4324)
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
bindtime = -1
removetime = -2
removeongethit = 1
sprpriority = 3

[state 4316, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4316, targetstate]
type = targetstate
trigger1 = time = 0
trigger1 = var(1) = 5
value = 4344
id = 4300

[state 4316, targetstate]
type = posadd
trigger1 = time = 0
trigger1 = var(1) != 3
x = 470

[state 4316, dust]
type = explod
trigger1 = animelemtime(10) > 0 
anim = 2025
postype = p1
pos = 65, 0
sprpriority = 4
scale = 1, 1
persistent = 2


[state 4316, playsnd]
type = playsnd
trigger1 = time = 0
trigger1 = var(1) != 3
value = 40,0

[state 4316, envshake]
type = envshake
trigger1 = time = 0
trigger1 = var(1) != 3
ampl = -8
time = 12

[state 4316, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4316, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0



[state 4316, velset]
type = velset
trigger1 = animelemtime(10) = 0
x = -100
persistent = 0
ignorehitpause = 1

[state 4316, playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
value = 4032,0
persistent = 0

[state 4316, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = parentdist x
text = "Ass to Texas dist: %d"

[state 4316, changestate]
type = changestate
TRIGGER1 = ANIMELEMTIME(3) >= 0
trigger1 = backedgebodydist < 380
value = 4317
;----------------------------------------------------------------------------------------
;Final Wall Crash
[statedef 4317]
type = S
movetype = A
physics = N
anim = 4317
sprpriority = -2

[state 4317, changestate]
type = changestate
trigger1 = parent,stateno = 3122
value = 4320

[state 4317, sprite layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4317)
anim = 4327
id = 4317
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 2

[state 4317, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4316

[state 4317, Wall shockwave]
type = explod
trigger1 = time = 0
anim = F72
postype = p1
pos = 0,-300
scale = 2,2
sprpriority = 4

[state 4317, varadd]
type = varadd
trigger1  = time = 2
var(2) = 1
persistent = 0

[state 4317, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4317, envshake]
type = envshake
trigger1 = time = 0
ampl = -24
time =  24

[state 4317, slowmo]
type = pause
trigger1 = time < 18
trigger1 = parent,stateno != 3120
trigger1 = var(1) <= 1
time = 2
persistent = 1
endcmdbuftime = 2

[state 4317, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4317, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4317, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4317, hitadd]
type = hitadd
trigger1 = time = 0
value = 1
ignorehitpause = 1
persistent = 0

[state 4315, playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 4026,0
channel = 2

[state 4317, stopsnd]
type = stopsnd
trigger1 = animelemtime(27) = 0
channel = 2

[state 4317, hitadd]
type = hitadd
trigger1 = animelemtime(7) >= 0 && animelemtime(27) < 0
value = 1
ignorehitpause = 1
persistent = 4

[state 4317, playsnd]
type = playsnd
trigger1 = animelemtime(7) = 1
value = 4300, 0

[state 4317, Gas explosion]
type = explod
trigger1 = animelemtime(7) = 0
anim = 2110
postype = p1
pos = 0, -560 * const(size.yscale)
scale = 3,3
sprpriority = 3

[state 4317, Gas explosion]
type = explod
trigger1 = animelemtime(7) = 0
anim = 2110
postype = p1
pos = 0, -130 * const(size.yscale)
scale = 3,-3
sprpriority = 3

[state 4317, Gas stream]
type = explod
trigger1 = animelemtime(7) >= 0 && animelemtime(26) < 0
anim = 2120
postype = p1
pos = 0, -560 * const(size.yscale)
vel = random%6, -12 - (random&24)
accel = 0, -0.22
scale = 3,3
persistent = 2

[state 4317, Gas stream]
type = explod
trigger1 = animelemtime(7) >= 0 && animelemtime(26) < 0
anim = 2120
postype = p1
pos = 0, -130 * const(size.yscale)
vel = random%6, 12 + (random&12)
accel = 0, -0.22
persistent = 2
scale = 3,3
persistent = 2

[state 4123, StinkLines]
type = Helper
trigger1 = animelemtime(26) = 0
stateno = 4045
postype = p1
pos = 0,0
ownpal = 1
ignorehitpause = 1


[state 4317, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(7) >= 0 && animelemtime(27) < 0 
value = Ceil(parent,fvar(10) * -3)
id = 4300
persistent = 6

[state 4317, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = Ceil(parent,fvar(10) * -250)
id = 4300

[state 4317, Targetstate]
type = targetstate
trigger1 = time = 0
value = 4349 
id = 4300

[state 4317, posset]
type = posset
trigger1 = time = 0
x = (-facing*(gamewidth/2))

[state 4317, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4317, velset]
type = velset
trigger1 = animelemtime(27) = 0
x = 15
y = -30

[state 4317, gravity]
type = gravity
trigger1 = animelemtime(27) >= 0
trigger1 = pos y < 0

[state 4317, Repeat]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4300

;=============================================================================================
;Lasso'ed Roxxie

;Wall Crush
[statedef 4320]
type = A
movetype = A
physics = N
sprpriority = 2

[state 4320, changeanim]
type = changeanim
trigger1 = time = 0
value = 4318
elem = 1

[state 4320, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4313

[state 4320, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4317

[state 4320, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4320, targetstate]
type = targetstate
trigger1 = time = 0
value = 4348
id = 4300

[state 4320, targetstate]
type = posadd
trigger1 = time = 0
trigger1 = var(1) != 5
x = 470

[state 4320, dust]
type = explod
trigger1 = animelemtime(10) > 0 
anim = 2025
postype = p1
pos = 65, 0
sprpriority = 4
scale = 1, 1
persistent = 2


[state 4320, playsnd]
type = playsnd
trigger1 = time = 0
trigger1 = var(1) != 5
value = 40,0

[state 4320, envshake]
type = envshake
trigger1 = time = 0
trigger1 = var(1) != 5
ampl = -8
time = 12

[state 4320, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4320, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0



;Yanked

[state 4320, velset]
type = velset
trigger1 = time = 16
x = 30
persistent = 0
ignorehitpause = 1

[state 4320,  Whoosh]
type = playsnd
trigger1 = time = 16
value = 4032,0

[state 4320, velset]
type = veladd
trigger1 = time = 24
x = 45
persistent = 0
ignorehitpause = 1

[state 4320, slowdown]
type = velmul
trigger1 = time = 34
x = 0.5

[state 4320, slowdown]
type = velmul
trigger1 = time = 42
x = 0.5

[state 4320, explod]
type = explod
trigger1 = time = 66
anim = 8100
postype = p1
pos = 0,-150
sprpriority = -2
bindtime = -1
scale = -2, 1
id = 8100

[state 4320, velset]
type = velset
trigger1 = time = 66
x = -45
persistent = 0
ignorehitpause = 1

[state 4320,  Whoosh]
type = playsnd
trigger1 = time = 66
value = 4032,0

[state 4320, Launch back]
type = veladd
trigger1 = time = 74
x = -90

[state 4320, sprpriority]
type = sprpriority
trigger1 = time = 74
value = -2

[state 4320, playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
value = 4032,0
persistent = 0

[state 4320, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = parentdist x
text = "Ass to Texas dist: %d"

[state 4320, changestate]
type = changestate
trigger1 = vel x < 0
trigger1 = backedgebodydist < 380
value = 4321
;----------------------------------------------------------------------------------------
;Final Wall Crash
[statedef 4321]
type = S
movetype = A
physics = N
anim = 4319
sprpriority = 2

[state 4321, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4316

[state 4321, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 8100

[state 4321, Wall shockwave]
type = explod
trigger1 = time = 0
anim = F72
postype = p1
pos = 0,-300
scale = 3.25,3.25
sprpriority = 4

[state 4321, varadd]
type = varadd
trigger1  = time = 2
var(2) = 1
persistent = 0

[state 4321, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4321, envshake]
type = envshake
trigger1 = time = 0
ampl = -30
time =  30

[state 4321, slowmo]
type = pause
trigger1 = time < 15
time = 3
persistent = 1
endcmdbuftime = 3

[state 4321, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4321, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4321, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4321, playsnd]
type = playsnd
trigger1 = time = 0
value = 4090,0

[state 4321, hitadd]
type = hitadd
trigger1 = time = 0
value = 1
ignorehitpause = 1
persistent = 0

[state 4321, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = Ceil(parent,fvar(10) * -150)
id = 4300

[state 4321, Targetstate]
type = targetstate
trigger1 = time = 0
value = 4350
id = 4300

[state 4321, posset]
type = posset
trigger1 = time = 0
x = (-facing*(gamewidth/2))

[state 4321, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4321, posadd]
type = posadd
trigger1 = animelemtime(4) = 0
x = 270
ignorehitpause = 1

[state 4321, velset]
type = velset
trigger1 = animelemtime(4) = 0
x = 9
y = -30

[state 4321, gravity]
type = gravity
trigger1 = animelemtime(4) >= 0
trigger1 = pos y < 0

[state 4321, Repeat]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4302







;==================================================================================
;Victim States for Roxxie
;Face Ride
[statedef 4340]
type = A
movetype = H
physics = N

[state 4340, turn]
type = turn
trigger1 = facing != enemynear,facing
trigger1 = time = 0

[state 4340, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4340

[state 4340, movecamera 0]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 434X, Self Free]
type = selfstate
trigger1 = time > 240
value = 5050
;-------------------------------------------------------------------------------
;Face sat with Bounce
[statedef 4341]
type = A
movetype = H
physics = N

[state 4340, movecamera 0]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4341, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4341

[state 434X, Self Free]
type = selfstate
trigger1 = time > 240
value = 5050
;------------------------------------------------------------------------------
;Face Wedged for claps
[statedef 4343]
type = A
movetype = H
physics = N

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4343

[state 434X, Self Free]
type = selfstate
trigger1 = time > 240
value = 5050
;------------------------------------------------------------------------------
;Ride to Wall
[statedef 4344]
type = A
movetype = H
physics = N

[state 4340, movecamera 0]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4344

[state 434X, Self Free]
type = selfstate
trigger1 = time > 240
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 1
[statedef 4345]
type = A
movetype = H
physics = N
sprpriority = 0

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4345

[state 3051, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.1, 0.8

[state 4345, nothitby]
type = nothitby
trigger1 = time = 179
value = SCA
time = 45

[state 4345, End]
type = selfstate
trigger1 = time > 180
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 2
[statedef 4346]
type = A
movetype = H
physics = N

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4345

[state 3051, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.2, 0.6

[state 4345, nothitby]
type = nothitby
trigger1 = time = 179
value = SCA
time = 45

[state 4345, End]
type = selfstate
trigger1 = time > 180
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 3
[statedef 4347]
type = A
movetype = H
physics = N

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4345

[state 3051, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.3, 0.4

[state 4345, nothitby]
type = nothitby
trigger1 = time = 179
value = SCA
time = 45

[state 4345, End]
type = selfstate
trigger1 = time > 180
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 4
[statedef 4348]
type = A
movetype = H
physics = N

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4345

[state 3051, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.4, 0.2

[state 4345, nothitby]
type = nothitby
trigger1 = time = 239
value = SCA
time = 45

[state 4345, End]
type = selfstate
trigger1 = time > 240
value = 5050

;------------------------------------------------------------------------------
;Stick to Wall 5
[statedef 4349]
type = A
movetype = H
physics = N
velset = 0,0

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4345

[state 3051, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.5, 0.1

[state 4020, color]
type = palFX
trigger1 = time = 149
time = 300
mul = 100,180,40

[state 4345, nothitby]
type = nothitby
trigger1 = time = 159
value = SCA
time = 45

[state 4345, End]
type = selfstate
trigger1 = time > 160
value = 5050

;-----------------------------------------------------------------------------------
;Stick to Wall Hard
[statedef 4350]
type = A
movetype = H
physics = N
velset = 0,0

[state 4343, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 4345

[state 3051, posset]
type = posset
trigger1 = 1
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4343, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.5, 0.1

[state 4345, nothitby]
type = nothitby
trigger1 = time = 69
value = SCA
time = 45

[state 4345, End]
type = selfstate
trigger1 = time > 70
value = 5050



;====================================================================================
;Ammo Hud
[statedef 4900]
type = A
physics = N
movetype = I
ctrl = 0
anim = 9999

[state 4900, varset]
type = varset
trigger1 = time = 0
v = 0
value = 0

[state 4900, varset]
type = varset
trigger1 = time = 0
v = 1
value = 0

[state 4900, varset]
type = varadd
triggerall = numpartner
trigger1 = partner,name = "Katrina Crocodile"
trigger2 = partner,name = "Twiggi Bunny"
trigger3 = partner,name = "Andy Armadillo"
v = 0
value = 50
persistent = 0

[state 4900, varset]
type = varadd
triggerall = numpartner
trigger1 = partner,name = "Enorma Pig"
v = 1
value = 80
persistent = 0

[state 4900, Magnum]
type = explod
trigger1 = 1
anim = 4900 + parent,var(26)
id = 4900
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1,14 + var(1), 1266 - var(1)),180 + var(0);ifelse(teamside =1, (gamewidth*0.01),(gamewidth*0.99)),floor((gameheight*0.3))
ontop = 1
ownpal = 1
bindtime = -1

;---------------------------------------------------------------------------
;Reload Helper
[statedef 4910]
type = A
physics = N
movetype = I
ctrl = 0
anim = 9999

[state 4910, add 1]
type = parentvaradd
trigger1 = time = 899
var(26) = 1
ignorehitpause = 1
persistent = 0

[state 4910, destroyself]
type = destroyself
trigger1 = time = 900
ignorehitpause = 1
persistent = 0


;-----------------------------------------------------------------------------------------------------
;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy's projectile (helper). For use with AI.
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy's projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy's projectile helper's distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy's projectile helper's velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
 
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
;==========================================================================
;                Detect Enemy's Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = cond(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = cond(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = cond(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = cond(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = cond(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = cond(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = cond(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = cond(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = cond(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = cond(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 




;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------


;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------
[statedef -2]

[state -2, Lost hat]
type = helper
trigger1 = !alive
trigger1 = !numhelper(170)
stateno = 171
id = 170
name = "Hat"
postype = p1
pos = 40 * const(size.xscale), -430 * const(size.yscale)

;====================================================
;combo Scaling
;====================================================

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar(10)
ignorehitpause = 1 

[state -2, gatling bunn check]
type = varset
trigger1 = stateno = 0
v = 22
value = 0

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger2 = !numenemy
ignorehitpause = 1
v = 18
value = 100

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05
ignorehitpause = 1
;-----------------------------------------------------



[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(8) = 2
ignorehitpause = 1

[state -2, Stun Limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
trigger1 = (enemynear, statetype != A)
var(13) = 2
ignorehitpause = 1

[state -2, Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(11) = 2
ignorehitpause = 1

[state -2, Texas in Trouble Combo Check] ;PUnch punch Kick
type = varset
trigger1 = stateno = 0
trigger1 = stateno = 20
trigger1 = stateno = 52
trigger1 = stateno = 5120
v = 27
value = 0
ignorehitpause = 1

[state -2, Armor for Assist]
type = varset
trigger1 = !numhelper(4000)
trigger1 = !numhelper(4100)
trigger1 = !numhelper(4200)
trigger1 = !numhelper(4300)
trigger1 = var(20) != 80
v = 20
value = 80
ignorehitpause = 1
persistent = 1

[state -2, Armor for Assist]
type = varset
triggerall = !numhelper(4001)
trigger1 = var(21) != 80
v = 21
value = 80
ignorehitpause = 1
persistent = 1


;=======================Victory Quotes======================================
;=========================Win Quotes========================================




[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%6)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Jumbo Elephant"
value = 7+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ana 'Jiggly' Bunny"
value = 10+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Katrina Crocodile"
value = 13+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Bertha Hippo"
value = 16+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Aroma Skunk"
value = 19+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Enorma Pig"
value = 22+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Lardo Rat"
value = 25+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Zafta Giraffe"
value = 28+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Makuyama"
value = 31+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Pastilla Skunk"
value = 34+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Jumba Elephant"
value = 37+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Rapid Bunny"
value = 40+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Twiggi Bunny"
value = 43+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Violet Bunny"
value = 46+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Julian Hippo"
value = 49+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Akai R. Panda"
value = 52+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Andy Armadillo"
value = 55+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Sarjiri Sara Dragon"
value = 58+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Noah Sharker"
value = 61+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Montana Moth"
value = 64+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ra Lord"
value = 67+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Texas Stanton"
value = 70+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Itoka Wolf"
value = 73+(random%3)
ignorehitpause
persistent = 1



;------------------------------------------------------------------------------
;===============================================================================
; Simple Counter
;===============================================================================

[state -2, counter]
type = varset
trigger1 = gethitvar(damage) != 0
v = 31
value = 0
ignorehitpause = 1

[state -2, count up]
type = varadd
trigger1 = var(31) < var(33)
v = 31
value = 1
ignorehitpause = 0

[state -2, delay conter set]
type = varset
trigger1 = 1
v = 33
value = 300



;Debug and AI programming help
[state -2, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = p2bodydist x, Pos X, pos y, var(18)
text = "Body Distance X: %d || Pos X: %d , Pos Y: %d, combo Scale: %d"

[state -2, helper]
type = helper
triggerall = !numhelper(4001)
trigger1 = numhelper(4000)
trigger1 = helper(4000),stateno = 4030
postype = back
name = "Jesse and Jane"
pos = -1000, 0
id = 4001
stateno = 4031
persistent = 180
ownpal = 1

;Ammo Hud
[state -2, helper]
type = helper
triggerall = !numhelper(4900)
trigger1 = roundstate = 2
name = "Gun Hud"
helpertype = normal
stateno = 4900
postype = p1
pos = 0,0
id = 4900
persistent = 300
ignorehitpause = 1
ownpal = 1

[state -2, helper]
type = helper
triggerall = !numhelper(4910)
trigger1 = var(26) < 6
trigger1 = roundstate = 2
name = "Passive Reload"
stateno = 4910
postype = p1
pos = 0,0
id = 4910
persistent = 60
ignorehitpause = 1

[state -2, varset Min value]
type = varset
trigger1 = var(26) < 0
var(26) = 0
ignorehitpause = 1
persistent = 1

[state -2, varset Max Value]
type = varset
trigger1 = var(26) > 6
var(26) = 6
ignorehitpause = 1
persistent = 1

[state -2, Dizzy FX]
type = explod
trigger1 = anim = 5300
trigger1 = !numexplod(5300)
postype = p1
anim = 2530
pos = 0, -470 * const(size.yscale)
id = 5300
sprpriority = 4
ownpal = 1
removetime = -1
ignorehitpause = 1
persistent = 1

;===========================================================================
; Removeexplod
;===========================================================================
[state -2, Removeexplod]
type = removeexplod
trigger1 = stateno != [1050, 1075]
id = 1050
ignorehitpause = 1

[state -2, removeexplod]
type = removeexplod
trigger1 = anim != 5300
id = 5300
ignorehitpause = 1

;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

[state -3, Knockeddown]
type = changestate
triggerall = stateno != [3081, 3084]
triggerall = numhelper(4200)
triggerall = helper(4200),stateno = 4205 || helper(4200),stateno = 4200
trigger1 = helper(4200),parentdist x =[0, 440]
trigger1 = helper(4200),parentdist y = [0, 400]
value = 3081

;=======================AI Detect Projectile System==========================
[state -3, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1
;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.


[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
value = 40, 0
