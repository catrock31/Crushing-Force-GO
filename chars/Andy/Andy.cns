[Remap]
x = x
y = y
z = z
a = a
b = b
c = c
s = s
; KFM's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 1000
power = 5000
;attack power (more is stronger)
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 15
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1.05         ;Horizontal scaling factor.
yscale = 1.05          ;Vertical scaling factor.
ground.back = 60     ;Player width (back, ground)
ground.front = 64    ;Player width (front, ground)
air.back = 48        ;Player width (back, air)
air.front = 48       ;Player width (front, air)
height = 240         ;Height of player (for opponent to jump over)
attack.dist = 640    ;Default attack distance
proj.attack.dist = 360 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = -20, -360 ;Approximate position of head
mid.pos = -20, -240  ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 10.0      ;Walk forward
walk.back = -8.0     ;Walk backward
run.fwd  = 24.0, 0    ;Run forward (x, y)
run.back = -27.5,0     ;Hop backward (x, y)
jump.neu = 0,-37.5   ;Neutral jumping velocity (x, y)
jump.back = -10.0,-33.6 ;Jump back Speed (x, y)
jump.fwd = 10,-33.6     ;Jump forward Speed (x, y)
runjump.back = -10.2,-32.4 ;Running jump speeds (opt)
runjump.fwd = 16,-32.4    ;.
airjump.neu = 0,-32.4     ;.
airjump.back = -10.2      ;Air jump speeds (opt)
airjump.fwd = 10          ;.
air.gethit.groundrecover = -.6,-14    ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-18     ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -4       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -8         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 6        ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 0      ;Number of air jumps allowed (opt)
airjump.height = 140 ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.76         ;Vertical acceleration
stand.friction = .85  ;Friction coefficient when standing
crouch.friction = .82 ;Friction coefficient when crouching
stand.friction.threshold = 8          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .2        ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 100          ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -80 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 40   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -4  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.4    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 60      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 80            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.6              ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 48          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .2          ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes **MUGEN 1.0**
;The default language victory quotes must be implemented in English.
[Quotes]
; Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory1 = "You shoulda backed off man.  I am a scientist."
victory2 = "My lovely lady, Panacea, sure did wear a fancy outfit to this battle.  But you should really see her Sunday best."
victory3 = "This armor is of my own design, I shouldn't have to worry about most attacks on earth."
victory4 = "No, I am not Armored Armadillo. I’m just an armored armadillo."
victory5 = "I win, now go home and take care of your family."
victory6 = "As an engineer I know how handle practical problems like you."
victory7 = "How do you expect to get my 'Rolling Shield' fighting like that?"


;Custom Win Quotes

;Jumbo, crime boss, wants to stop
Victory8 = "There isn’t enough scrap in the world to cover that body."
Victory9 = "This armor can handle a lot of crushing force… I'm not sure if I wanna test it against you again. I'll make updates."
victory10 = "You are defeated. Now come quietly, or there will be...trouble."


;Jiggly, doesn't know personally.  Doesn't get how fast she is.
victory11 = "Physics shouldn't allow a big girl like you to be so fast."
victory12 = "Multiple weak hits will take a long time to wreck this armor."
victory13 = "That flip kick of yours is really evasive. I'll make sure to design something to counter it."

;Katrina
victory14 = "Let’s get you a doctor… And a chiropractor, those things look very weight inefficient."
victory15 = "Thanks, I know now my armor can resist the bite force of a crocodile."
victory16 = "If your strategy is to crush me under your enormous bossom I must let you know I've already tested against that."


;Bertha, knows of, doesn't know personally
victory17 = "You throw your ass around like quite a wrecking ball. Ya know, I'm something of a wrecking ball myself."
victory18 = "Test successful. Dat ass could do serious damage if I let it. Future designs will have increased resistance to blunt force trauma."
victory19 = "If your ass can't crush me then nothing on this planet can."


;Aroma, no previous relationship
victory20 = "Definitely gonna need to add an industrial grade air filtration unit to the suit."
victory21 = "Thanks to you I'm gonna learn ways of defending against odors like yours."
victory22 = "Baking Soda, will easily remove your smells. Don't think for a second that I don't know how to clean my suit."

;Enorma, Great Friends with
victory23 = "Because of your excessive size it may take me a while to develop a suit for you.  But I would really like to give you one so I can protect one of my dearest friends."
victory24 = "I think you still outweight me while I'm in my suit, Enorma. So its really impressive that your rockets can move you so easily."
victory25 = "Let me help you up Enorma. Your munitions stood no chance against this armor.  Your willingness to still try is inspiring."

;Lardo, criminal wants to stop
victory26 = "Dead or alive you're coming with me."
victory27 = "You burp and fart on foes, I wear a strong suit of armor. You were clearly outclassed in both offense and defense."
victory28 = "How would you even digest the metal of this suit?"


;Zafta, no knowledge of.  But she's really tall
victory29 = "I'm gonna really need to get flight working if foes get that tall."
victory30 = "I may need to consider stilts for the suit."
victory31 = "You're leg strength is impressive, I'm gonna make sure I can deflect those attacks easier in the future."

;Makuyama, Panda and Kodiak, doesn't know
victory32 = "Your size inhibitors probably don't work since you're a hybrid. I think that's why you're so big."
victory33 = "If you can't maul me then I'm pretty sure no one in your species will be able to either.  Bear Immunity is gonna be such a milestone for this armor."
Victory34 = "I don't like being hugged by you."

;Pastilla, Hybrid, witch vs science
victory35 = "Magic is so hard to understand, I don't know how you shrink and grow others. But that's something I'd like to figure out."
victory36 = "Can magic ever malfunction? What fuels it? How is it that only some can do it and others can't?"
victory37 = "Your formation is due to a fatal injury. I'm sorry for you both."


;Jumba, Elephant Ninja
Victory38 = "Aren’t you a little obvious for a ninja?"
victory39 = "You have speed power and size, but I don't think you have good defense at all."
victory40 = "I feel like I could of been overwhelmed by your combonation of speed, size and strength.  But you leave yourself open a lot."

;Rapid, ally, fellow hero, all heart to his mostly logic.
victory41 = "If you give me a chance I'd like to try to make a light weight armor for you."
victory42 = "You may have the speed but do you really think those hits are ever gonna break this armor."
victory43 = "Maybe you should invest in some form of defense."

;Twiggi, Mage, science vs Magic
victory44 = "You can teleport others?! Enorma's tech can't do that yet. That's Amazing!!"
victory45 = "You're a bit slow on the draw there Twiggi. Maybe if you want to shoot something just use a tool to do so."
victory46 = "I can block magic. You can't just wear me down with it."

;Julian, Doesn't know, not really intimidated by.
victory47 = "You actually dodged some of my missiles, but you’re so wide?!"
victory48 = "Your weight and oils make you very hard to grab. I may have to consider tech like that against grapplers in the future."
victory49 = "You are far more of a threat then you lead on."

;Akai
victory50 = "How are you so fast?!"
victory51 = "You may be fast, but you don't dodge well at all."
victory52 = "If force is mass time speed, I could have been in real trouble against you."

;Violet
victory53 = "Does your clothing reduce the friction between your thighs.  I feel like you running is a fire hazzard."
victory54 = "For a ninja your legs are very eye catching."
victory55 = "It's nice to run into someone else that creates their suits."

;Noah
victory56 = "Even demons are lacking in their defense."
victory57 = "I can defend against your entire entourage and your arrows 'Funny Fish Man'."
victory58 = "You're arrows and bombs aren't a match for my weaponry and armor."

;Ra
Victory59 = "Wow, your defense was better in your beta."
victory60 = "You are supprisingly high damage.  Not overwhelmingly so, my defenses handled your offense quite well."
victory61 = "You seem like you have a lot of tricks to you.  I'm game to fight you again to make sure my defenses can handle."

;Himself
Victory62 = "Sweet, A chance to test myself against my own armor."
victory63 = "I know I can't pierce my own armor but its nice seeing what it takes to take me down."
Victory64 = "This battle will be motivation and evidence for the next upgrades."

;Montana
Victory65 = "You're a pretty large moth, you can't eat metals can you?"
victory66 = "Flying is really good, but you may not wanna mess with someone carrying anti air missiles next time."
Victory67 = "I'm gonna need you to stay out of Texas skies when I'm around."

;Texas
Victory68 = "Ma'am I think I liked you the second I heard your name."
victory69 = "A woman with my home as her namesake deserves better armor and defense.  I would be honored to create some for you."
victory70 = "You have an iron will Ms. Stanton but we could all use some help.  I'd rather team with you than fight you again."


;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
; var(14) - Missile hit stun time
; var(15) = Armor Rank number

; var(40) - Walk Controller
; var(41) - Projectile counter
; var(42) - Panacea Summons
;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
; Win pose 1 - Dispenser
; CNS difficulty: basic
[Statedef 181]
type = S
physics = N
ctrl = 0
anim = 181
velset = 0,0

[state 181, width]
type = width
trigger1 = 1
edge = 300,300

[state 181, Beep]
type = playsnd
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(5) = 0
trigger3 = animelemtime(7) = 0
value = 185,3
persistent = 1

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 6
;trigger1 = life != lifemax
value = S180,1

[state 181, explod]
type = helper
trigger1 = animelemtime(7) = 0
trigger1 = !numhelper(185)
stateno = 185
ownpal = 1
postype = p1
pos = -180 + Random%360,0
id = 185
name = "Dispenser"

facing = ifelse(facing = -1, 1, 1)

[state 181, Jump]
type = velset
trigger1 = animelemtime(10) = 0
x = -facing* (pos x - helper(185),pos x) * 0.02
y = -25

[state 181, statetypeset]
type = statetypeset
trigger1 = animelemtime(10) = 0
statetype = A
physics = N

[state 181, gravity]
type = gravity
trigger1 = pos y < 0


[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[state 181, assertspecial]
type = assertspecial
trigger1 = 1
flag = roundnotover
ignorehitpause = 1


[state 181, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -50
value = 182

;---------------------------------------------------------------------------------------
[statedef 182]
type = S
physics = S
anim = 182

[state 182, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 182, on ground]
type = posset
trigger1 = time = 0
trigger1 = numhelper(185)
y = -40
x = helper(185),pos x

[state 182, clank]
type = playsnd
trigger1 = time = 0
value = 40,1

[state 182, clank]
type = playsnd
trigger1 = time = 0
value = 40,1


[state 181, assertspecial]
type = assertspecial
trigger1 = time < 180
trigger1 = !numhelper(4000)
trigger2 = time < 240
trigger2 = numhelper(4000)
flag = roundnotover
ignorehitpause = 1

[state 181, playsnd]
type = playsnd
trigger1 = time = 6
value = 185,0

[state 181, helper]
type = helper
trigger1 = time = 6
trigger1 = !numhelper(186)
stateno = 186
postype = p1
pos = -110,-60
name = "Hasty Cola"

[state 181, Catch Snd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 185,1

[state 181, Gulp Snd]
type = playsnd
trigger1 = animelemtime(9) = 12
trigger2 = animelemtime(9) = 48
value = 185,2

[state 181, Panacea]
type =  helper
trigger1 = var(32) >=  floor(var(34) *  0.8)
trigger1 = !numhelper(4000)
trigger1 = var(42) > 5
trigger1 = matchover
postype = p1
pos = 400, -720
stateno = 4180
ownpal = 1
id = 4000
name = "Panacea Win Pose"

[state 181, angledraw]
type = null;angledraw
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
value = 0
scale = const(size.xscale)*1.1, const(size.yscale)*0.9
persistent =1 

[state 182, modifyexplod]
type = null;modifyexplod
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
id = 185
scale = const(size.xscale)*1.40, const(size.yscale)*1.10
persistent = 1

[state 182, modifyexplod]
type = null;modifyexplod
trigger1 = animelemtime(3) >= 0 
id = 185
scale = const(size.xscale)*1.25, const(size.yscale)*1.25
persistent = 1

[state 182, changestate]
type = changestate
trigger1 = numhelper(4000)
trigger1 = helper(4000),anim = 4181
value = 183




;--------------------------------------------------
[statedef 183]
type = S
physics = N
anim = 187

[state 181, posadd]
type = posadd
trigger1 = numhelper(4000)
trigger1 = helper(4000),anim = 4182
trigger1 = time = 0
y = 100

[state 183, Helper]
type = helper
trigger1 = anim = 187
trigger1 = animelemtime(2) = 0
stateno = 187
postype = p1
pos = 270,-350
name = "Cola Toss"

[STATE 181, changeanim]
type = changeanim
trigger1 = numhelper(4000)
trigger1 = helper(4000),anim = 4182
value = 188
persistent = 0

[state 181, playsnd]
type = playsnd
trigger1 = random%10 = [7,9]
trigger1 = anim = 188
trigger1 = animelemtime(5) = 0
value = S185,4

[state 181, Position]
type = posadd
trigger1 = anim = 188
trigger1 = animelemtime(1) = 1
x = 1
y = 40


[state 181, assertspecial]
type = assertspecial
trigger1 = time < 180
flag = roundnotover
ignorehitpause = 1

;--------------------------------------------------


;--------------------------------------------------
;Dispenser
[statedef 185]
type = S
movetype = I
velset = 0,0
anim = 185

[state 185, turn]
type = turn
trigger1 = facing = -1

[state 181, width]
type = width
trigger1 = 1
edge = 150,150

[state 181, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 185, playsnd]
type = playsnd
trigger1 = numhelper(4000)
trigger1 = helper(4000), anim = 4182
value = S180,2
persistent = 0

[state 185, anim]
type = changeanim
trigger1 = numhelper(4000)
trigger1 = helper(4000),anim = 4182
value = 189

;--------------------------------------------------
;COLA
[statedef 186]
TYPE = A
PHYSICS = N
anim = 186
velset = 12, -32
sprpriority = 4

[state 186, rotate]
type = angledraw
trigger1 = 1
value = 0+ time * -8

[state 186, gravity]
type = veladd
trigger1 = 1 
y = 1.22

[state 186, destroyself]
type = destroyself
trigger1 = time = 35

;--------------------------------------------------
;COLA
[statedef 187]
TYPE = A
PHYSICS = N
anim = 186
velset = 30, -4
sprpriority = 4

[state 186, rotate]
type = angledraw
trigger1 = 1
value = 0+ time * -12

[state 186, gravity]
type = veladd
trigger1 = 1 
y = 1.22

[state 186, velmul] ;Bounce
type = velmul
trigger1 = pos y > 0
y = -1
persistent = 30

[state 186, destroyself]
type = destroyself
trigger1 = time = 35
trigger2 = pos y > 0

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0
sprpriority = 1

[state 191, posadd]
type = posadd
trigger1 = time = 0
x = -41

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 1,1
postype = Back
pos = ifelse(facing =1, 20, 157),360 ; Nice!
ontop = 1

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[state 191, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(190)
id = 190
anim = 191
postype = p1
pos = 0,0
sprpriority = 0
ownpal = 1

[state 191, Panacea]
type = helper
trigger1 = !numhelper(4000)
stateno = 4190
postype = p1
pos = -200,0
id = 4000
ownpal = 1

[state 191, velset]
type = velset
trigger1 = animelemtime(5) = 0
x = 2
y = -8

[state 191, velmul]
type = velmul
trigger1 = animelemtime(5) = 20
x = 0.1
y = 0.1

[state 191, velset]
type = velset
trigger1 = animelemtime(5) = 25
x = 0
y = 0

[state 191, Light beam]
type = helper
trigger1 = animelemtime(5) = 18
trigger1 = !numhelper(193)
stateno = 193
postype = p1
pos = 0,0
id = 193
name = "lightbeam"


[state 191, gravity]
type = gravity
trigger1 = animelemtime(6) > 20


[state 191, palfx]
type = palfx
trigger1 = animelemtime(5) = 12
add = 128,128,128
time = 6

[state 191, palfx]
type = palfx
trigger1 = animelemtime(5) = 18
add = 256,256,256
time = 24

[state 191, palfx]
type = palfx
trigger1 = animelemtime(7) = 0
add = 128,128,128
time = 6

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 192
;----------------------------------------------------------------------------

[statedef 192, Landing]
type = A
physics = N
anim = 192

[state 192, velset]
type = velset
trigger1 = time = 0
y = 0
x= 0

[state 192, playsnd]
type = playsnd
trigger1 = time  = 0
value = 40,0

[state 192, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 192, posset]
type = posset
trigger1 = time = 0
y = 0

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 191, changestate]
type = changestate
trigger1 = animtime = 0
value = 0


;---------------------------------------------------------------------------------
[statedef 193]
type = A
physics = N
anim =  193
sprpriority = 1

[state 193, playsnd]
type = playsnd
trigger1 = time = 0
value = 190, 0

[state 193, posset]
type = posset
trigger1 = time = 0
y = 0

[state 193, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = time * 0.2, 2
persistent = 1

[state 193, destroyself]
type = destroyself
trigger1 = time = 20

;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                     
movetype= A                      
physics = S                      
velset = 0,0                    
ctrl = 0                        
anim = 200                       
poweradd = 10                    
sprpriority = 2                  

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 20, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 6, 6                 ;Time attacker pauses, time opponent shakes
sparkno = 0                      ;Spark anim no (Def: set above)
sparkxy = -40, -304              ;X-offset for the "hit spark" rel. to p2,
;Y-offset for the spark rel. to p1
hitsound = 5, 1                  ;Sound to play on hit
guardsound = 6, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 10            ;Time that the opponent slides back
ground.hittime  = 10            ;Time opponent is in hit state
ground.velocity = -10           ;Velocity at which opponent is pushed
airguard.velocity = -7.6,-3.2    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -5.6,-12          ;X-velocity at which opponent is pushed,
;Y-velocity at which opponent is pushed
air.hittime = 15                 ;Time before opponent regains control in air
guard.hittime = 11
guard.velocity = -12
guard.slidetime = 11
ground.cornerpush.veloff = -20
guard.cornerpush.veloff = -40


[State 200, 2]
type = PlaySnd
trigger1 = Time = 1
value = 200, 0

[state 200, 2nd hit]
type = changestate
trigger1 = movecontact
trigger1 = command = "x"
value = 201

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1


[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;--------------------------------------------------------------------------
;---------------------------------------------------------------------------
; 2nd Punch
[Statedef 201]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 200                       ;Change animation (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 201, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 11, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 6, 6                 ;Time attacker pauses, time opponent shakes
sparkno = 0                      ;Spark anim no (Def: set above)
sparkxy = -40, -304              ;X-offset for the "hit spark" rel. to p2,
;Y-offset for the spark rel. to p1
hitsound = 5, 1                  ;Sound to play on hit
guardsound = 6, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 12            ;Time that the opponent slides back
ground.hittime  = 12            ;Time opponent is in hit state
ground.velocity = -16            ;Velocity at which opponent is pushed
airguard.velocity = -7.6,-3.2    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -5.6,-12          ;X-velocity at which opponent is pushed,
;Y-velocity at which opponent is pushed
air.hittime = 15                 ;Time before opponent regains control in air
guard.hittime = 11
guard.velocity = -12
guard.slidetime = 11


[State 201, 2]
type = PlaySnd
trigger1 = Time = 1
value = 200, 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[State 201, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
; Standing strong punch
[Statedef 210]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -1

[state 210, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 200,0


[State 210, 2]
type = HitDef
trigger1 = !movecontact
attr = S, NA
animtype  = Hard
damage    = 60
guardflag = MA
pausetime = 12,12
sparkno = 3
sparkxy = -40,-300
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -24
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -22
air.velocity = -10,-16
forcenofall = 1



[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Spinning Backhand
[Statedef 215]
type    = S
movetype= A
physics = S
poweradd= 35
ctrl = 0
velset = 0,0
anim = 216
sprpriority = -1

[state 1000, explod]
type = explod
trigger1 = time = 1
anim = 9998
postype = p1
pos = 0,0
id = 9998
persistent = 1

[state 215, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 215,0

[state 215, posadd]
type = posadd
trigger1 = animelemtime(3) = 0
x = 93

[state 215, posadd]
type = posadd
trigger1 = animelemtime(4) = 0
x = 110

[state 215, posadd]
type = posadd
trigger1 = animelemtime(5) = 0
x = -30
ignorehitpause = 0
persistent = 0

[state 215, posadd]
type = posadd
trigger1 = animelemtime(6) = 0
x = -40

[state 215, posadd]
type = posadd
trigger1 = animelemtime(7) = 0
x = -133

[State 215, 2]
type = HitDef
trigger1 = !movecontact
attr = S, NA
animtype  = Hard
damage    = 80
guardflag = MA
pausetime = 14,14
sparkno = 3
sparkxy = -40,-280
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = -30
guard.hittime = 9
guard.slidetime = 9
guard.velocity = -24
air.velocity = -24, 8
airguard.velocity = -12,-2
envshake.ampl = 6
envshake.time = 14
air.fall = 1
fall.recover = 1
fall.recovertime = 30
guard.dist = 720


[state 215, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 14
ignorehitpause = 1
value = 1050,0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[State 215, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 11
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 25
guardflag = MA
pausetime = 8,8
sparkno = 0
sparkxy = -40,-180
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 15
ground.hittime  = 15
ground.velocity = -14
air.velocity = -10,-14
guard.hittime = 12
guard.velocity = -16
guard.slidetime = 12

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Sparta Kick Start
[Statedef 240]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
anim = 240
velset = 0,0
sprpriority = 2

[state 240, explod]
type = explod
trigger1 = animelemtime(2) = 0
anim = F61
postype = p1
pos = 0, 0
scale = 0.75, 0.75
sprpriority = -1

[state 240, velset]
type = velset
trigger1 = animelemtime(2) = 0
y = -10

[state 240, veladd]
type = velset
trigger1 = animelemtime(2) = 0
x = 24

[state 240, gravity]
type = gravity
trigger1 = pos y < 0

[state 240, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
physics = N

[State 240, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 241



;---------------------------------------------------------------------------
;Sparta Kick landing
[statedef 241]
type = S
movetype = A
physics = S
anim = 241

[state 241, stop Y]
type = velset
trigger1 = time = 0
y = 0

[state 241, pos set]
type = posset
trigger1 = time = 0
y = 0

[State 241, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Heavy
damage    = 70
guardflag = MA
pausetime = 12,12
sparkno = 2
id = 240
sparkxy = -40,-230
hitsound   = 5,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -12
air.velocity = -20,10
air.fall = 1
fall.recover = 1
fall.recovertime = 30
guard.hittime = 7
guard.slidetime = 7
guard.velocity = -50
airguard.hittime = 17
airguard.velocity = -20,-2
guard.dist = 640 

[state 241, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Running Sparta Kick 
[Statedef 245]
type    = S
movetype= A
physics = N
poweradd= 30
ctrl = 0
anim = 245
sprpriority = 2

[state 245, velset]
type = velset
trigger1 = animelemtime(2) = 0
y = -12

[state 245, veladd]
type = veladd
trigger1 = animelemtime(2) = 0
x = 12

[state 245, gravity]
type = gravity
trigger1 = pos y < 0

[state 245, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
physics = N

[State 245, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 246



;---------------------------------------------------------------------------
;Sparta Kick landing
[statedef 246]
type = S
movetype = A
physics = S
anim = 246

[state 246, stop Y]
type = velset
trigger1 = time = 0
y = 0

[state 246, pos set]
type = posset
trigger1 = time = 0
y = 0

[State 246, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Heavy
damage    = 80,8
guardflag = MA
pausetime = 18,18
guard.pausetime = 12,10
sparkno = 3
sparkxy = -40,-230
hitsound   = 5,4
guardsound = 6,0
ground.type = Low
envshake.ampl = 10
envshake.time = 18
ground.slidetime = 27
ground.hittime  = 27
ground.velocity = -60,-20
air.velocity = -60,-20
air.fall = 1
fall.recover = 1
fall.recovertime = 30
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -50
airguard.hittime = 17
airguard.velocity = -24,-12
guard.dist = 640 
guard.kill = 0

[state 246, Varadd]
type = varadd
trigger1 = movehit
v = 7
value = -1
ignorehitpause = 1
persistent = 0

[state 246, Wall Bounce]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 1
trigger1 = var(7) > 0
value = 670
ignorehitpause = 1


[state 246, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light punch
; CNS difficulty: easy
; Description: Simple crouching attack. The HitDef's guardflag parameter
;     is set to "L", meaning that the move can only be guarded low
;     (crouching), and not by standing or jumping opponents.
;     Like for all light attacks, it's a good idea to keep the slidetime
;     and hittime parameters at a smaller number, so the opponent isn't
;     stunned for too long. For all crouching attacks you have to
;     remember to set the attr parameter to indicate that it is crouching
;     attack. In this case, "C, NA" stands for "crouching, normal attack".
;     The HitDef's priority is set at 3, instead of the default of 4,
;     so this attack has a lower priority than most others, meaning
;     KFM will get hit instead of trading hits with his opponent if
;     their attack collision boxes (Clsn1) intersect each other's Clsn2
;     boxes at the same time.
[Statedef 400]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 8
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 0

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 20
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = MA
pausetime = 8,8
sparkno = 0
sparkxy = -40,-240
hitsound   = 5,0
guardsound = 6,0
ground.type = Low
ground.slidetime = 10
ground.hittime  = 10
ground.velocity = -12
air.velocity = -6,-12
guard.hittime = 9
guard.slidetime = 9
guard.velocity = -14
ground.cornerpush.veloff = -20
guard.cornerpush.veloff = -40

[state 400, addon]
type = changestate
trigger1 = movecontact
trigger2 = animelemtime(4) > 1
triggerall = command = "x"
triggerall = command = "holddown"
value = 405

[state 400, addon]
type = changestate
triggerall = movecontact
trigger1 = command = "x"
trigger1 = command != "holddown"
value = 201

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;--------------------------------------------------------------------------
;Crouching Strong, change animation later
[Statedef 405]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 8
ctrl = 0
anim = 405
sprpriority = 2

[State 401, 1]
type = PlaySnd
trigger1 = animelemtime(3) =0
value = 405, 0

[state 401, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = 25

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 45
priority  = 3
animtype  = medium
hitflag = MAF
guardflag = MA
pausetime = 12,12
sparkno = 2
sparkxy = -40,-240
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -12
air.velocity = -6,-12
guard.hittime = 15
guard.slidetime = 15
guard.velocity = -14
ground.cornerpush.veloff = -30
guard.cornerpush.veloff = -60
forcenofall = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching strong punch
; CNS difficulty: easy
; Description: This is a 2-hit move. It is done by having two HitDefs
;     triggered, one for each frame of animation that hits.
;     Notice how the first hit cannot be guarded by an opponent in the
;     air, because of the "M" in the guardflag, meaning it can only
;     be guarded "middle". The second hit has an "MA" guardflag, so
;     it can be guarded both on the ground and in the air.
[Statedef 410]
type    = C
movetype= A
physics = C
poweradd= 50
ctrl = 0
sprpriority = 2


;===========
;Armor start
;===========
[state 410, animation]
type = changeanim
trigger1 = anim != 410
value = 410

;determine what frame
[state 410, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 410, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = anim
elem = var(22)

[state 410, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = 1
ignorehitpause = 1
;--------------------------

[state 410, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.5)
persistent = 1

[state 410, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = ifelse(p2statetype = A, 42, 81)
persistent = 0
ignorehitpause = 1


[state 410, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
trigger1 = animelemtime(2) >= 0 && animelemtime(5) < 0
attr = A, AA, AP
stateno = 410
time = 1
persistent = 1
ignorehitpause = 1

[State 410, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 410, Launching]
type = velset
trigger1 = animelemtime(3) = 0
y = -18
x = 1
persistent = 0

[state 410, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 4
value = S410,0

[state 410, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A
physics = N

[state 410, gravity]
type = gravity
trigger1 = pos y < 0

[state 410, additional gravity]
type = gravity
trigger1 = movehit
persistent = 1

[state 410, explod]
type = explod
trigger1 = animelemtime(2) = 6
anim = F61
postype = p1
pos = 0,0
scale = 1.5, 1.5

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = !movecontact 
attr = C, NA
damage    = 50
animtype  = Up
hitflag = MAF
id = 410
guardflag = MA
pausetime = 12,18
guard.pausetime = 8,8
envshake.ampl = 12
envshake.time = 12
getpower = 150
givepower = 80
sparkno = 3
sparkxy = -40,-520
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 45
ground.hittime  = 45
air.hittime = 45
ground.velocity = ifelse(var(11) > 0, 0,-12),ifelse(var(11) > 0, -42, -24)
air.velocity = ifelse(var(11) > 0, 0,-12),ifelse(var(11) > 0, -38, -19)
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -24
airguard.velocity = -15, -21

[state 410, varadd]
type = varadd
trigger1 = movehit
var(11) = -1
ignorehitpause = 1
persistent = 0

[state 410, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 12
ignorehitpause = 1
value = 1050,0

[state 410, spikeback down]
type = veladd
trigger1 = vel y > 0
trigger1 = movehit
y = 4
persistent = 2

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 410, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 411
ignorehitpause = 1


;----------------------------------------------------------------------------
;Landing
[statedef 411]
type = S
movetype = I
anim = 412
movehitpersist = 1


[state 410, Jump Cancel]
type = changestate
triggerall = time > 0
trigger1 = !ailevel
trigger1 = movehit
trigger1 = command = "holdup"
trigger2 = ailevel
trigger2 = movehit
trigger2 = power < 3000 
value = 42
ignorehitpause = 1

[state 411, velset]
type = velset
trigger1 = time = 0 
x = 0 
y = 0 

[state 411, posset]
type = posset
trigger1 = time = 0
y = 0

[state 411, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
poweradd= 11
juggle = 4
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 25
animtype  = medium
hitflag = MAFD
guardflag = L
pausetime = 8,8
sparkno = 1
sparkxy = -40,-50
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 17
ground.velocity = -16
air.velocity = -8,-12
down.velocity = -20,0
down.hittime = 22
guard.hittime = 13
guard.slidetime = 13
guard.velocity = -18
guard.dist = 640

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching Medium kick
; CNS difficulty: easy
[Statedef 435]
type    = C
movetype= A
physics = C
poweradd= 25
juggle = 7
ctrl = 0
sprpriority = 2

;===========
;Armor start
;===========
[state 435, animation]
type = changeanim
trigger1 = anim != 435
value = 435

;determine what frame
[state 435, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 435, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 435, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = 1
ignorehitpause = 1
;--------------------------

[state 435, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1
kill = 0

[state 435, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -80
persistent = 0
ignorehitpause = 1


[state 435, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
trigger1 = animelemtime(2) > 0 && animelemtime(8) < 0
attr = SCA, AP
stateno = 435
time = 1
persistent = 1
ignorehitpause = 1

[State 435, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------


[state 435, Rocket Burst]
type = veladd
trigger1 = animelemtime(2) = 0
x = 20

[state 435, no friction.  Ball form]
type = statetypeset
trigger1 = animelemtime(2) = 0
physics = N

[state 435, Friction on]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = C

[state 435, Rocket sound]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 40,0

[state 435, ROCKET PULSE]
type = explod
Trigger1 = animelemtime(2) = 0
trigger1 = !numexplod(435)
anim = 2010
postype = p1
pos = -135, -330
removetime = 8
bindtime = -1
scale = const(size.xscale), const(size.yscale)
sprpriority = 1
id = 435

[state 435, speed dust]
type = Explod
trigger1 = animelemtime(2) = 0
anim = 2110
postype = p1
pos = -310, 0
sprpriority = 4
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
id = 2110

[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 35
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 12,12
sparkno = 3
sparkxy = -40,-185
hitsound   = 5,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = -40
air.velocity = -8,-12
down.velocity = 0,0
down.hittime = 22
guard.hittime = 15
guard.slidetime = 15
guard.velocity = -21
guard.dist = 640
forcenofall = 1

[state 430, roll over]
type = playerpush
trigger1 = p2statetype = L
value = 0


[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
;Running Version
;---------------------------------------------------------------------------
;Rolling Attack
[Statedef 436]
type    = C
movetype= A
physics = C
juggle = 7
poweradd= 25
ctrl = 0
sprpriority = 2

;===========
;Armor start
;===========
[state 436, animation]
type = changeanim
trigger1 = anim != 436
value = 436

;determine what frame
[state 436, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 436, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 436, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = 1
ignorehitpause = 1
;--------------------------

[state 436, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.5)
persistent = 1
kill = 0

[state 436, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -80
persistent = 0
ignorehitpause = 1


[state 436, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
trigger1 = animelemtime(2) > 0 && animelemtime(8) < 0
attr = SCA, AP
stateno = 436
time = 1
persistent = 1
ignorehitpause = 1

[State 436, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------


[state 436, Rocket Burst]
type = veladd
trigger1 = animelemtime(2) = 0
x = 20

[state 436, no friction.  Ball form]
type = statetypeset
trigger1 = animelemtime(2) = 0
physics = N

[state 436, Friction on]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = C

[state 436, Rocket sound]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 40,0

[state 436, ROCKET PULSE]
type = explod
Trigger1 = animelemtime(2) = 0
trigger1 = !numexplod(435)
anim = 2010
postype = p1
pos = -135, -330
removetime = 8
bindtime = -1
scale = const(size.xscale), const(size.yscale)
sprpriority = 1
id = 435

[state 436, speed dust]
type = Explod
trigger1 = animelemtime(2) = 0
anim = 2110
postype = p1
pos = -310, 0
sprpriority = 4
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
id = 2110

[State 436, 2]
type = HitDef
trigger1 = animelemtime(4) >= 0  && animelemtime(6) < 0
attr = C, NA
damage    = ifelse(p2statetype != L, 15, 60)
persistent = 0
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 6,6
sparkno = 2
sparkxy = -40,-185
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = -16
air.velocity = -8,-12
down.velocity = 0,0
down.hittime = 22
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -25
guard.dist = 640

[State 436, 2]
type = HitDef
trigger1 = animelemtime(6) >= 0  && animelemtime(8) < 0
attr = C, NA
persistent = 0
damage    = ifelse(p2statetype != L, 15, 60)
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 6,6
sparkno = 2
sparkxy = -40,-185
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = -16
air.velocity = -8,-12
down.velocity = -20,0
down.hittime = 22
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -25
guard.dist = 640

[State 436, 2]
type = HitDef
trigger1 = animelemtime(8) >= 0  && animelemtime(10) < 0
attr = C, NA
persistent = 0
damage    = ifelse(p2statetype != L, 15, 60)
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 12,12
sparkno = 3
sparkxy = -40,-185
hitsound   = 5,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 25
ground.hittime  = 25
ground.velocity = -16
air.velocity = -8,-12
airguard.velocity = -15, -24
down.velocity = -20,0
down.hittime = 22
guard.hittime = 15
guard.slidetime = 15
guard.velocity = -40
guard.dist = 640
id = 436

[state 436, playerpush]
type = playerpush
trigger1 = p2statetype = L
value = 0
ignorehitpause = 1

[state 436, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = p2statetype = L
value = 662
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 436, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1


;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = C
juggle  = 6
poweradd= 35
ctrl = 0
anim = 440
sprpriority = 2

[state 440, posadd]
type = posadd
trigger1 = animelemtime(2) = 0
trigger1 = p2bodydist x > 80
x = 80

[state 440, posadd]
type = posadd
trigger1 = animelemtime(6) = 0
trigger1 = p2bodydist x > 90
x = 90

[state 440, playsnd]
type = playsnd
trigger1 = animelemtime(1) = 2
value = 440, 0
ignorehitpause = 1

[state 440, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 4
value = 440, 1
ignorehitpause = 1

[State 440, 3]
type = HitDef
trigger1 = animelem = 4
attr = C, NA
damage    = ifelse(p2statetype = A, 30, 60)
hitflag = MAFD
guardflag = L
pausetime = 14,14
guard.pausetime = 6,6
id = 440
nochainid = 1400
sparkno = 3
sparkxy = -20,-140
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 0,-10
air.velocity = 0,-10
down.velocity = 0,-10
yaccel = 1.22
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -16
fall = 1
fall.recover = 0
fall.recovertime = 40

[State 440, 3]
type = HitDef
trigger1 = animelem = 8
attr = C, NA
damage    = ifelse(numtarget(440) = 1, 30, ifelse(p2statetype = A, 40, 80))
hitflag = MAFD
guardflag = L
id = 441
nochainid = 1400
pausetime = 14,14
guard.pausetime = 12,1
sparkno = 3
sparkxy = -20,-150
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -8,-18
air.velocity = -8,-18
down.velocity = -8, -18
guard.velocity = -20
fall = 1
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -16
fall.recover = 0
fall.recovertime  = 30

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
trigger1 = animelemtime(8) >= 0 
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 440, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
poweradd= 5
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 15
guardflag = HA
priority = 3
pausetime = 6,6
sparkno = 0
sparkxy = -40,-220
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -16
air.velocity = -2,-8
air.hittime = 14
fall.recovertime = 24
fall.recover = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 600, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Strong Punch
; CNS difficulty: easy
[Statedef 610]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 610, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 70
guardflag = HA
priority = 5
pausetime = 14,14
sparkno = 3
sparkxy = -40,-50
hitsound   = 5,4
guardsound = 6,0
animtype = Hard
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -24
envshake.ampl = 4
envshake.time = 14
air.velocity = -20,60
down.bounce = 1
fall.xvelocity = -10
fall.yvelocity = -30
air.fall = 1
p2facing = 1
fall.recover = 1
fall.recovertime = 35
guard.velocity = -26
airguard.velocity = -16,-4

[state 610, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 12
ignorehitpause = 1
value = 1050,0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 610, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = A
poweradd= 10
ctrl = 0
anim = 630
sprpriority = 2

[State 630, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 630, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 20
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 2
sparkxy = -20,-325
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 15
ground.hittime  = 15
ground.velocity = -16
air.velocity = -6,-12
air.hittime = 18
guard.velocity = -14
airguard.velocity = -8,-4
guard.hittime = 14
guard.slidetime = 14

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 630, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
anim = 640
sprpriority = 2

[state 640, removeexplod]
type = removeexplod
trigger1 = time = 2
id = 2040

[state 640, removeexplod]
type = removeexplod
trigger1 = time = 2
id = 2041

[State 640, 2]
type = PlaySnd
trigger1 = Time = 2
value = 440, 1

[state 640, veladd]
type = veladd
trigger1 = command = "holdback"
trigger1 = movecontact
trigger1 = p2statetype = A
x = -24
persistent = 0

[State 640, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 60
guardflag = HA
priority = 4
pausetime = 12,12
sparkno = 3
sparkxy = -40,-140
hitsound   = 5,4
envshake.ampl = 8
envshake.time = 12
guardsound = 6,0
animtype = Hard
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -28
air.velocity =  -60, ifelse(var(7) > 0, -12, 18)
guard.hittime = 14
guard.slidetime = 14
airguard.velocity = -12,-8
air.fall = 1
fall.recover = 0
fall.recovertime = 40

[state 640, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = p2statetype = A
trigger1 = var(7) > 0
trigger1 = hitpausetime = 11
value = 675
ignorehitpause = 1
persistent = 0

[state 640, Jet Boot]
type = explod
trigger1 = animelemtime(5) = 0
anim = 2640
id = 2640
postype = p1
pos = 0,0
sprpriority = 4
removeongethit = 1
bindtime = 2
ignorehitpause = 1

[state 640, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 40,0

[state 640, wall bounce limiter]
type = varadd
trigger1 = movehit
trigger1 = statetype = A
var(7) = -1
ignorehitpause = 1
persistent = 0


[state 640, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;--------------------------------------------------------------------------
;Armor Ball
[Statedef 650]
type    = A
movetype= A
physics = A
ctrl = 0
sprpriority = 1

[state 650, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 60,6
guardflag = HA
priority = 4
pausetime = 12,12
sparkno = 2
sparkxy = -40,-140
hitsound   = 5,3
guardsound = 6,0
animtype = Hard
envshake.ampl = -8
envshake.time = 12
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -28
air.velocity = -36, 18
guard.hittime = 14
guard.slidetime = 14
airguard.velocity = -12,-8


[state 1050, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 12
ignorehitpause = 1
persistent = 0
value = 1050,0
;===========
;Armor start
;===========
[state 650, animation]
type = changeanim
trigger1 = anim != 650
value = 650

;determine what frame
[state 650, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 650, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = anim
elem = var(22)

[state 650, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = 1
ignorehitpause = 1
;--------------------------

[state 650, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.5)
persistent = 1

[state 650, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -gethitvar(damage)
persistent = 0
ignorehitpause = 1


[state 650, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
trigger1 = animelemtime(2) >= 0 && animelemtime(8) < 0
attr = SCA, AA, AP
stateno = 650
time = 1
persistent = 1
ignorehitpause = 1

[state 650, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

;--------------------------

[state 650, enemy state]
type = targetstate
triggerall = vel y > 0
triggerall = numenemy
trigger1 = movehit
trigger1 = enemy,statetype != A
value = 661
persistent = 0

;Ride down mechanic
[state 650, Ride down]
type = targetbind
triggerall = numenemy
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = 0, -20

[state 650, state of ride down]
type = targetstate
triggerall = numenemy
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 656
persistent = 0

;--------------------------------------

[state 650, steering]
type = veladd
trigger1 = command = "holdfwd"
x = 0.22
persistent = 1

[state 650, steering]
type = veladd
trigger1 = command = "holdback"
x = -0.22
persistent = 1



[state 650, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 651
ctrl = 0

;---------------------------------------------------------------------------
;Landing 1
[statedef 651]
type = C
movetype = A
physics = N

[state 651, Panacea Summon Counter]
type = varadd
trigger1 = time = 0
trigger1 = !numhelper(4000)
trigger1 = var(32) > 0
var(42) = 1
ignorehitpause = 1
persistent = 0

[state 651, Panacea assist]
type = helper
trigger1 = time = 0
trigger1 = !numhelper(4000)
trigger1 = var(32) > 0
stateno = 4065
postype = p1
pos = 0,-1440
ownpal = 1
id = 4000
name = "Panacea Cow - Bust Drop assist" 



[state 651, angledraw]
type = angledraw
trigger1 = time < 4
value = 0
scale = const(size.xscale)*1.2 , const(size.yscale)*0.8
ignorehitpause = 1

[state 651, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,0

[state 651, envshake]
type = envshake
trigger1 = time = 0
ampl = -6
time = 12

[state 651, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 651, posset]
type = posset
trigger1 = time = 0
y = 0

[state 651, statetypeset]
type = statetypeset
trigger1 = time = 4
statetype = A

[state 651, Bounce]
type = velset
trigger1 = time = 4
y = -45

[state 651, gravity]
type = gravity
trigger1 = pos y < 0

[state 651, End]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 652

;---------------------------------------------------------------------------
;Landing 2
[statedef 652]
type = C
movetype = I
physics = N

[state 651, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,0
volumescale = 50

[state 651, envshake]
type = envshake
trigger1 = time = 0
ampl = -4
time = 12

[state 652, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 652, posset]
type = posset
trigger1 = time = 0
y = 0

[state 652, Bounce]
type = velset
trigger1 = animelemtime(2) = 0
x = -30

[state 652, slow]
type = velmul
trigger1 = animelemtime(8) = 0
x = 0.25

[state 652, Stop]
type = velset
trigger1 = animelemtime(9) = 0


[state 651, End]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1


;---------------------------------------------------------------------------
;Rode down
[statedef 655]
type = A
movetype = H
physics = N

[state 655, anim]
type = changeanim2
trigger1 = time = 0
value = 655

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 660

;---------------------------------------------------------------------------
;Rode down Comboable
[statedef 656]
type = A
movetype = H
physics = N

[state 655, anim]
type = changeanim2
trigger1 = time = 0
value = 655

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 661

;===========================================================================
;---------------------------Crushed State-----------------------------------
;===========================================================================

; Moderate Crushed State
[statedef 660]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.3,0.7

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 660, invunerable]
type = nothitby
trigger1 = 1
value = SCA


[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 660, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0 
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0


[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 1108, nothitby]
type = nothitby
trigger1 = time = 140
value = SCA
time = 4

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 132 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 132
value = 5150

;---------------------------------------------------------------------------
;Brief Crushed State
[statedef 661]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5080


[state 661, 1]
type = changeanim
trigger1 = time = 12
value = 5080


[state 661, 1]
type = changeanim
trigger1 = time = 24
value = 5080

[state 661, 1]
type = changeanim
trigger1 = time = 32
value = 5110

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 661, Width]
type = Width
trigger1 = time > 0
value = 0,0


[State 661, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 661, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 661, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 661, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 661, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 661, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 661, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 661, get up]
type = selfstate
trigger1 = alive
trigger1 = time > 80
value = 5110

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 75
value = 5150

;---------------------------------------------------------------------------
;Super Brief Crush State
[statedef 662]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[State 661, flatten]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1.25,0.2

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 661, Width]
type = Width
trigger1 = time > 0
value = 0,0


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 661, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0
[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 662, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 662, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 662, hitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 662, recover i frames]
type = nothitby
trigger1 = time = 29
value = SCA
time = 8

[State 662, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 30
value = 5110

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 29
value = 5150


;---------------------------------------------------------------------------
;Winning Crushed State
[statedef 665]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 665, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[state 665, scream]
type = playsnd
trigger1 = 1
value = 11,0
persistent = 0


[State 665, flatten]
type = AngleDraw
trigger1 = time > 0  && time <25
value = 0
scale = 1.3,0.1

[state 665, on ground]
type = posset
trigger1 = 1
y = 0

[state 665, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 665, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 665, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 665, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 665, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 665, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 665, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 665, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 665, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 665, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 665, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 665, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 665, hitby]
type = hitby
trigger1 = time > 0
value = SCA, AA
ignorehitpause = 1

[State 665, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 600
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150


;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;===========================================================================
;------------------------------Wall Bounce State
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

[state 671, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 670, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 670, Gravity]
type = veladd
trigger1 = 1
y = 1.05

[State 670, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 120
trigger2 = FrontEdgeBodyDist < 120
value = 1
movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 672, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 672, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 672, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 673, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -18

[State 673, Vel X]
type = VelSet
trigger1 = Time = 0
x = ceil(abs(p2dist x *0.02))

[State 673, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

;[state 673, gravity]
;type = gravity
;trigger1 = 1

[State 673, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 673, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 673, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 673, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;============================================================================
; Neutral Wall Bounce
;============================================================================
[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 675]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 675, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[state 676, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 676, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 676, Gravity]
type = veladd
trigger1 = 1
y = 1.05

[State 670, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 676, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 677, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -18

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 6

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

;[state 678, gravity]
;type = gravity
;trigger1 = 1

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 678, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;============================================================================
; Super Wall Bounce
;============================================================================
[statedef 6750]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 675]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 675, changestate]
type = changestate
trigger1 = hitshakeover
value = 6760
;------------------------------------------------------------------------

[statedef 6760]
type    = A
movetype= H
physics = N

[state 676, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 676, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 676, Gravity]
type = veladd
trigger1 = 1
y = 1.05

;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 6770

[State 6760, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 6770]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 677, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 6780
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 6780]
type    = A
movetype= H
physics = N

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -18

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 2

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

;[state 678, gravity]
;type = gravity
;trigger1 = 1

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 678, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100




;=============================================================================
;Ground Bounce
;=============================================================================
;Hit Freeze small
[statedef 680]
type = A
movetype = H
physics = N

[State 680, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 680]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 680, changestate]
type = changestate
trigger1 = hitshakeover
value = 681

;-----------------------------------------------------------------------------
;Soft Ground bounce - Going down
[statedef 681]
;Custom Hit state, ground bounce
type = A
movetype = H
physics = N


[state 681, velocity]
type = hitvelset
trigger1 = time = 0
y = 40

[state 681, anim]
type = changeanim
trigger1 = time = 0
value = 5160


[state 681, stop x]
type = velmul
trigger1 = time = 0
x = 0.25


[state 681]
type = veladd
trigger1 = 1
y = 1.05

[state 681, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 682

;-----------------------------------------------------------------------------
;Ground Bounce - Impact / bouncing
[statedef 682]
type = A
movetype = H
physics = N
anim = 5160

[state 682, impact]
type = velset
trigger1 = time = 0
y = 0

[State 682, 8]
type = Explod
trigger1 = Time = 0
anim = F62 
pos = 0, 0
ontop = 1
scale = 1.7, 0.5
persistent = 0
ownpal = 1

[State 682, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,2
persistent = 0

[state 682, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10

[state 682, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 682, bounce]
type = velset
trigger1 = time = 1
y = -30

[state 682, gravity]
type = veladd
trigger1 = time > 1
y = 1.05

[state 682, down]
type = selfstate
trigger1 = time >= 2 
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5110
;--------------------------------------------------------------------------


;Hit Freeze big
[statedef 685]
type = A
movetype = H
physics = N

[State 685, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 685]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 685, changestate]
type = changestate
trigger1 = hitshakeover
value = 686
;---------------------------------------------------------------------------
;Hard Ground bounce - going down
[statedef 686]
;Custom Hit state, ground bounce
type = A
movetype = H
physics = N


[state 686, anim]
type = changeanim
trigger1 = time = 0
value = 5160

[state 686, velocity]
type = hitvelset
trigger1 = time = 0
y = 20
x = 0

[state 686]
type = veladd
trigger1 = 1
y = 1.05

[state 686, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 687

;-----------------------------------------------------------------------------
;Hard Ground Bounce - Impact/bounce
[statedef 687]
type = A
movetype = H
physics = N
anim = 5160

[state 687, impact]
type = velset
trigger1 = time = 0
y = 0

[state 685, velmul]
type = velmul
trigger1 = time = 0
x = 0.1
persistent = 0

[State 687, 8]
type = Explod
trigger1 = Time = 0
anim = F62 
pos = 0, 0
ontop = 1
scale = 2, 1
persistent = 0
ownpal = 1

[State 687, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,2
persistent = 0

[state 687, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10

[state 687, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 687, bounce]
type = velset
trigger1 = time = 1
y = -20

[state 687, gravity]
type = veladd
trigger1 = time > 1
y = 0.9

[state 687, down]
type = selfstate
trigger1 = time >= 2 
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

; Notes: The '-' symbol in the hitflag field means that it only affects
;   players who are not in a hit state. This prevents KFM from combo-ing
;   into the throw. The priority should be set to a low number, such as
;   1 or 2, so that the throw does not take precedence over normal attacks.
;   The type of priority must always be set to "Miss" or "Dodge" for throws,
;   otherwise strange behavior can result.
[State 800, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = p2stateno != [150,155]
attr = S, NT          ;Attributes: Standing, Normal Throw
hitflag = M-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 1     ;Draw p1's sprite in front of p2
                      ;p2's sprite priority is set to 0 by default
id = 800
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 810       ;On success, KFM changes to state 810
p2stateno = 820       ;If hit, p2 changes to state 820 in KFM's cns
guard.dist = 0        ;This prevents p2 from going into a guard state if close
fall = 1              ;Force p2 into falling down

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p2
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
facep2 = 1
sprpriority = 4

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120


[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -50 ;-const(velocity.run.fwd.x) * 4


[state 805, velmul]
type = velmul
trigger1 = time = 29
x = 0.125

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p1
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0


[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(130)
value = 130

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 130

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, turn]
type = turn
trigger1 = prevstateno = 820
trigger1 = time = 0
persistent = 0
ignorehitpause

[state 805, velset]
type = velset
trigger1 = time = 10
x= -50;-const(velocity.run.fwd.x) * 2


[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Kung Fu Throw - Throwing the opponent
; Description: In this state, KFM throws the opponent by binding him to
;     various offsets based on his current frame of animation. For
;     example, [State 810, Bind 1] binds the opponent to an offset of
;     28 pixels in front of KFM. That puts him around where KFM's hand
;     is at. Is is important to keep the opponent bound using a
;     TargetBind controller at all times, until you let him go. This
;     is especially important if your player has a Clsn2 box that
;     allows him to get hit while throwing someone. Each time a player
;     gets hit, all his bound targets will be set to a fall state. If
;     the opponent is not bound, then he may get stuck in his thrown
;     state when his attacker is knocked out of the throw halfway.
; Notes: There is a TargetLifeAdd controller to decrease the opponent's
;     life, and a TargetState controller to change his state to a
;     falling state when KFM lets go of him.
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 0

[state 810, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 805
value = 806
persistent = 1

; Here a variable, var(2), is used to remember whether or not the
; player was holding forward at the start of the state. This variable
; is checked later on to turn KFM around if necessary.
[State 810, Holding fwd?]
type = VarSet
triggerall = !Ailevel
trigger1 = Time = 0
var(2) = command = "holdfwd"

[State 810, Holding fwd?]
type = VarSet
triggerall = Ailevel
trigger1 = Time = 0
var(2) = ifelse(backedgebodydist < 230, 1, 0)

[State 810, Width 2-11]
type = Width
trigger1 = 1
edge = 240,100

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 5
value = 800, 0

[State 810, Bind 1-2]
type = TargetBind
trigger1 = AnimElemTime(3) < 0
pos = 272, -392


[State 810, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 214, -518

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -216, -252

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(5) < 1
pos = -12, -76

;Turn------------------

[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = Animelemtime(2)  = 8

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = Animelemtime(2)  = 8
x = 0

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = Animelemtime(2)  = 8
value = -1
;----------------------

[state 810, movement]
type = velset
trigger1 = animelemtime(3) = 0
y = -20
x = -5

[state 810, Jet boots]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 40,0

[state 810, explod]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2040
postype = p1
pos = 100,0
sprpriority = -3
id = 810
bindtime = -1
removetime = -1

[state 810, removeexplod]
type = removeexplod
trigger1 = animelemtime(4) = 0
id = 810

[state 810, veladd]
type = veladd
triggerall = animelemtime(4) > 0
trigger1 = vel y =[0,1]
y = 5
persistent = 4

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 5
value = -20
kill = 0

[state 810, gravity]
type = gravity
trigger1 = animelemtime(5) > 0

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElemtime(5) = 1
value = 821

[State 810, State End]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 811

;---------------------------------------------------------------------------
[statedef 811]
type = A
movetype = A
physics = N

[state 811, angledraw]
type = angledraw
trigger1 = time < 2
value = 0
scale = 1.1, 0.9
persistent = 1

[state 811, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,0

[state 811, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 811, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 811, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 811, angledraw]
type = angledraw
trigger1 = time >= 2 && time < 6
value = 0
scale = 1.25, 0.75

[state 811, angledraw]
type = angledraw
trigger1 = time >= 6 && time < 8
value = 0
scale = 1.1, 0.9

[state 811, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 3, 3
sprpriority = -3

[state 811, envshake]
type = envshake
trigger1 = time = 0
ampl = -16
time = 18



[state 811, velset]
type = velset
trigger1 = time = 0
y = 0

[state 811, targetstate]
type = targetstate
trigger1 = time = 0
value = 661

[state 811, posset]
type = posset
trigger1 = time = 0
y = 0

[state 811, target h ealth]
type = targetlifeadd
trigger1 = time = 0
value = -100

[state 811, velset, bounce]
type = velset
trigger1 = time = 8
x = -8
y = -30

[state 811, Steering]
type = veladd
triggerall = time > 8
trigger1 = command = "holdback"
x = -0.5
persistent = 1

[state 811, steering]
type = veladd
triggerall = time > 8
trigger1 = command = "holdfwd"
x = 1.25
persistent = 1

[state 811, gravity]
type = gravity
trigger1 = time > 8

[state 811, end]
type = turn
trigger1 = vel y > 0
trigger1 = pos y > -vel y


[state 811, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52



;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 805

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = 20,30
poweradd = 40

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = 1.6

[state 820, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 821, 2] 
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y > -vel y 
value = 822

;-------------------------------------------------------------------------------
;Crash into ground
[statedef 822]
type = L
movetype = H
physics = C

[state 822, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 822, possset]
type = posset
trigger1 = time = 0
y = 0

[state 822, changestate]
type = changeanim
trigger1 = time = 0
value = 5170

[state 822, changeanim]
type = changeanim
trigger1 = time = 8
value = 5110

[state 822, selfstate]
type = selfstate
trigger1 = time = 180
value = 5120

;====================================================================================
; Air Grab
;====================================================================================
;
;---------------------------------------------------------------------------
; Air Grab Non Comboable
[Statedef 830]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 830
sprpriority = 2


[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = A, NT          ;Attributes: Standing, Normal Throw
hitflag = A-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 1     ;Draw p1's sprite in front of p2
                      ;p2's sprite priority is set to 0 by default
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 840       ;On success, KFM changes to state 810
p2stateno = 850       ;If hit, p2 changes to state 820 in KFM's cns
id = 800
guard.dist = 0        ;This prevents p2 from going into a guard state if close
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1              ;Force p2 into falling down

[state 830, damage set]
type = varset
trigger1 = time = 0
var(16) = -150

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Air Grab Comboable
[Statedef 831]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 830
sprpriority = 2


[State 831, 1]
type = HitDef
Trigger1 = p2stateno != [150,155]
attr = A, ST          
hitflag = AF          
priority = 1, Miss    
sparkno = -1         
p1sprpriority = 1     
                      
p1facing = 1
p2facing = 1          
p1stateno = 840       
p2stateno = 850       
id = 800
guard.dist = 0       
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1              ;Force p2 into falling down

[state 830, damage set]
type = varset
trigger1 = time = 0
var(16) = ceil(fvar(10)*-90)

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 50
ctrl = 1

;--------------------------------------------------------------------------
;Grab Escape - p2
[statedef 835]
type = A
movetype = H
physics = N
anim = 43
ctrl = 0

;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 835, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 835, posset]
type = posset
trigger1 = time = 0
y = enemynear,pos y 
persistent = 0
ignorehitpause = 1


[state 835, targetfacing]
type = targetfacing
trigger1 = time = 0
value = -1
persistent = 1

[state 835, velset]
type = velset
trigger1 = time = 0
x= -12
y= -2

[state 835, gravity]
type = veladd
trigger1 = time > 0
y = 1.25

[state 835, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 835, end1]
type = selfstate
trigger1 = time >= 30
value = 50
ctrl = 1

[state 835, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;Grab Escape - p1
[statedef 836]
type = A
movetype = H
physics = N
anim = 43
ctrl = 0

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 12
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 835, targetfacing]
type = targetfacing
trigger1 = time = 0
value = -1
persistent = 1

[state 835, velset]
type = velset
trigger1 = time = 0
x= -12
y= -2

[state 835, removeexplod]
type = removeexplod
trigger1 = numexplod(840)
id = 840
ignorehitpause = 1

[state 835, gravity]
type = veladd
trigger1 = time > 0
y = 1.25

[state 835, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 835, end1]
type = selfstate
trigger1 = time >= 29
value = 50
ctrl = 1

[state 835, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
[Statedef 840]
type    = A
movetype= A
physics = N
anim = 840
poweradd = 0
sprpriority = -2

[State 840, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdback"

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 835
value = 836
persistent = 1

[state 840, velmul]
type = velmul
trigger1 = time = 0
x = 0.25
y = 0.25

[state 3010, bounce]
type = velset
trigger1 = time = 1
y = -18


[state 840, playerpush]
type = playerpush
trigger1 = 1
value = 0

[State 840, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[state 840, sprpriority]
type = sprpriority
trigger1 = animelem = 3
value = -2

;==========================================
;Binds
;==========================================

[State 840, Bind 1-2]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 310, -260

[State 840, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 255, -205

[State 840, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 
pos = 150, -80


[State 840, holdfwd - Turn 6] 
type = Turn
trigger1 = var(2)
trigger1 = AnimElemtime(1) = 6


[State 840, holdfwd - Turn Target 6] 
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElemtime(1) = 6
value = -1

[state 840, holdback, turn explod]
type = modifyexplod
trigger1 = var(2)
trigger1 = animelemtime(1) = 6
scale = -const(size.xscale),const(size.yscale)
id = 840




[state 840, gravity]
type = gravity
trigger1 = 1

[State 840, State End]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > 20
value = 841


;---------------------------------------------------------------------------
;Landing
[statedef 841]
type = C
movetype = A
physics = C
anim = 841

[state 841, velset]
type = velset
trigger1 = time = 0
y = 0

[state 841, posset]
type = posset
trigger1 = time = 0
y = 0

[state 841, squash]
type = angledraw
trigger1 = animelemtime(1) > 4  & animelemtime(2) < 2
value = 0
scale = const(size.xscale) * 1, const(size.yscale) * 0.8
persistent = 1

[state 841, targetbind]
type = targetbind
trigger1 = animelemtime(4) < 0
pos = 150, -80

[State 841, Hurt 11]
type = TargetLifeAdd
trigger1 = time = 0
value = var(16)

[State 840, Throw 11]
type = TargetState
trigger1 = time = 0
value = 851

[state 841, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 1.5,1.5

[state 841, explod]
type = explod
trigger1 = time = 2
anim = F61
postype = p1
pos = 0,0
scale = 1.5,1.5


[State 840, Throw 11]
type = TargetState
trigger1 = animelemtime(4) = 0
value = 852

[state 841, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 18

[state 841, playsnd]
type = playsnd
trigger1 = time = 0
value = S810, 0

[state 841, playsnd]
type = playsnd
trigger1 = time = 2
value = S830,0

[state 841, playsnd]
type = playsnd
trigger1 = time = 2
value = S830,0

[state 841, Bounce off]
type = velset
trigger1 = animelemtime(4) = 0
x = 12
y = -24

[state 841, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
statetype = A
physics = N

[state 841, gravity]
type = gravity
trigger1 = pos y < 0

[state 841, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52



;---------------------------------------------------------------------------
;Victime states
[Statedef 850]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 850, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 850

[state 850, tech throw]
type = changestate
triggerall = time < 12
triggerall = p2stateno != 841
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
value = 835

[state 850, screenbound]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 0

[State 850, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------

[Statedef 851]
type    = L
movetype= H
physics = N
velset = 0,0
poweradd = 40

[state 851, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 851


[state 841, squash]
type = angledraw
trigger1 = animelemtime(1) > 4  & animelemtime(4) < 8
value = 0
scale = const(size.xscale) * 1.2, const(size.yscale) * 0.6
persistent = 1

[state 851, screenbound]
type = screenbound
trigger1 = time < 12
movecamera = 0,1
value = 1

[State 851, 4] ;Hit ground
type = SelfState
trigger1 = time > 300
value = 5050 ;Hit ground

;-----------------------------------------------------------------------------------

[Statedef 852]
type    = A
movetype= H
physics = N
velset = 12,-24
poweradd = 40

[state 852, changeanim2]
type = changeanim
trigger1 = time = 0
value = 5061

[State 851, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = 1.6

[State 851, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;------------------------------------------------------------------------------------
;Missile Launch
[statedef 1000]
type = S
movetype = A
physics = S
velset = 0, 0
ctrl = 0
anim = 1000
poweradd = 80

[state 1000, explod]
type = explod
trigger1 = time = 5
anim = 9998
postype = p1
pos = 0,0
id = 9998

;Sounds
[state 1000, Playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1000,0

[state 1000, Playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 1000,1

[state 1000, Dust]
type = explod
trigger1 = animelemtime(6) = 0
anim = 2110
postype = p1
pos = 158, -388
sprpriority = -3

[state 1000, helper]
type = helper
trigger1 = animelemtime(6) = 0
trigger1 = !numhelper(1000)
postype = p1
pos =  282,-388
stateno = 2000
id = 1000
name = "Missile Light"
ownpal = 1

[state 1000, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------------
;Missile Launch Heavy
[statedef 1010]
type = S
movetype = A
physics = S
velset = 0, 0
ctrl = 0
anim = 1000
poweradd = 80

[state 1000, explod]
type = explod
trigger1 = time = 5
anim = 9998
postype = p1
pos = 0,0
id = 9998

;Sounds
[state 1000, Playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1000,0

[state 1000, Playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 1000,1

[state 1010, Dust]
type = explod
trigger1 = animelemtime(6) = 0
anim = 2110
postype = p1
pos = 158, -366
sprpriority = -3

[state 1010, helper]
type = helper
trigger1 = animelemtime(6) = 0
trigger1 = !numhelper(1000)
postype = p1
pos =   282,-388
stateno = 2010
id = 1000
name = "Missile Heavy"
ownpal = 1

[state 1010, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------------
;Missile Launch EX
[statedef 1020]
type = S
movetype = A
physics = S
velset = 0, 0
ctrl = 0
anim = 1020
poweradd = -500 


[state 1000, explod]
type = explod
trigger1 = time = 5
anim = 9998
postype = p1
pos = 0,0
id = 9998

;Sounds
[state 1000, Playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1000,0

[state 1000, Playsnd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 1000,1

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1020, Dust]
type = explod
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(6) = 6
anim = 2110
postype = p1
pos = 158, -366
sprpriority = -3
ownpal = 1

[state 1020, helper]
type = helper
trigger1 = animelemtime(6) = 0
postype = p1
pos = 282,-388
stateno = 2020
id = 1000
name = "Missile EX 1st"
ownpal = 1

[state 1020, helper]
type = helper
trigger1 = animelemtime(6) = 6
postype = p1
pos =  282,-388
stateno = 2021
id = 1000
name = "Missile EX 2nd"
ownpal = 1

[state 1020, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;-----------------------------------------------------------------------------------
;                              Anti Air Rolling
;------------------------------------------------------------------------------------
;Light Version
[statedef 1050]
type = S
movetype = A
physics = S
ctrl = 0
poweradd = 100*prevstateno != stateno
movehitpersist = prevstateno = stateno

[state 1050, explod]
type = explod
trigger1 = time = 5
anim = 9998
postype = p1
pos = 0,0
id = 9998

;===========
;Armor start
;===========
[state 1050, animation]
type = changeanim
trigger1 = anim != 1050
value = 1050

[state 1050, nothitby]
type = nothitby
trigger1 = animelemtime(4) < 0
value = A

;determine what frame
[state 1050, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1050, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 1050, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = 1
ignorehitpause = 1
;--------------------------

[state 1050, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1
kill = 0

[state 1050, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = floor(-gethitvar(damage))
persistent = 0
ignorehitpause = 1


[state 1050, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
attr = A, AA, AP
stateno = 1050
time = 1
persistent = 1
ignorehitpause = 1

[State 1050, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 1050, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2110
postype = p1
pos = -170, 0
scale = 1.2, 1.2
ownpal = 1

[state 1050, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2110
postype = p1
pos = 200, 0
scale = -1.2, 1.2
ownpal = 1

[state 1050, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2, 2
ownpal = 1

[State 1050, 2]
type = HitDef
trigger1 = !movecontact
attr = A, SA
animtype  = Up
damage    = 120,ifelse(p2statetype = A, 36, 12)
id = 1050
nochainid = 1050
guardflag = MA
pausetime = 14,14
envshake.ampl = 8
envshake.time = 14
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -18,-28
guard.hittime = 15
guard.slidetime = 15
guard.velocity = -18
air.hittime = 30
airguard.velocity = -12,-33
airguard.ctrltime = 18
air.velocity = -18,-24
guard.dist = 640
fall = 1
fall.recover = 0
fall.recovertime = 40

[state 1050, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 14
ignorehitpause = 1
persistent = 0
value = 1050,0

[state 1050, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1050,1
persistent = 0

[state 1050, posset]
type = posset
trigger1 = time = 0
trigger1 = prevstateno = [40,42]
y = 0

[state 1050, Jump]
type = velset
trigger1 = animelemtime(4) = 1 
trigger1 = prevstateno != 1050
y = -30
x = 14

[state 1050, movecontact]
type = velmul
trigger1 = movecontact
x = ifelse(movehit = 1, -0.1,-0.25)
y = ifelse(movehit = 1, 0.8, 1.0)
persistent = 0
ignorehitpause =0 

[state 1050, Statetypeset]
type = statetypeset
trigger1 = animelemtime(4) >= 0
physics = N
statetype = A
ignorehitpause = 1

[state 1050, gravity]
type = gravity
trigger1 = animelemtime(8) > 0
trigger1 = pos y < 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1050, changestate]
type = changestate
trigger1 = vel y > 0
value = 1051

;----------------------------------------------------------------------------------
[statedef 1051]
type = A
movetype = I
physics = N
anim = 45
movehitpersist = 1

[state 1051, velmul]
type = velmul
trigger1 = time = 0
x = 0.35

[state 1051,gravity]
type = gravity
trigger1 = pos y < 0


[state 1051, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1052

;------------------------------------------------------------------------------
[statedef 1052]
type = C
movetype = I
physics = C
anim = 47

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 52, 0

[state 1052, envshake]
type = envshake
trigger1 = time = 0
ampl = -6
time = 12

[state 1052, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
ownpal = 1
scale = 1,1

[state 1052, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1052, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1052, end]
type = changestate
trigger1 = time = 6
value = 0
ctrl = 1
;--------------------------------------------------------------------------------------------
;Hard Version
[statedef 1060]
type = S
movetype = A
physics = S
ctrl = 0
poweradd = 120*prevstateno != stateno
movehitpersist = prevstateno = stateno

[state 1060, explod]
type = explod
trigger1 = time = 5
anim = 9998
postype = p1
pos = 0,0
id = 9998

;===========
;Armor start
;===========
[state 1060, nothitby]
type = nothitby
trigger1 = animelemtime(4) < 0
value = A



[state 1060, animation]
type = changeanim
trigger1 = anim != 1060
value = 1060

;determine what frame
[state 1060, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1060, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 1060, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = 1
ignorehitpause = 1
;--------------------------

[state 1060, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1
kill = 0

[state 1060, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = floor(-gethitvar(damage))
persistent = 0
ignorehitpause = 1


[state 1060, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
attr = A, AA, AP
stateno = 1060
time = 1
persistent = 1
ignorehitpause = 1

[State 1060, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 1060, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2110
postype = p1
pos = -170, 0
scale = 1.2, 1.2
ownpal = 1

[state 1060, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2110
postype = p1
pos = 200, 0
scale = -1.2, 1.2
ownpal = 1

[state 1060, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2, 2
ownpal = 1

[State 1060, 2]
type = HitDef
trigger1 = !movecontact
attr = A, SA
animtype  = Up
damage    = 150, ifelse(p2statetype = A, 45, 15)
id = 1060
nochainid = 1060
guardflag = MA
pausetime = 16,16
envshake.ampl = 8
envshake.time = 16
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -18,-35
guard.hittime = 15
guard.slidetime = 15
guard.velocity = -18
airguard.velocity = -12,-30
air.velocity = -18,-24
airguard.ctrltime = 20
guard.dist = 640
fall = 1
fall.recover = 0
fall.recovertime = 45

[state 1060, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 14
ignorehitpause = 1
persistent = 0
value = 1050,0

[state 1060, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1050,1
persistent = 0

[state 1060, posset]
type = posset
trigger1 = time = 0
trigger1 = prevstateno = [40,42]
y = 0

[state 1060, Jump]
type = velset
trigger1 = animelemtime(4) = 1 
trigger1 = prevstateno != 1060
y = -36
x = 16

[state 1050, movecontact]
type = velmul
trigger1 = movecontact
x = ifelse(movehit = 1, -0.1,-0.25)
y = ifelse(movehit = 1, 0.8, 1.0)
persistent = 0
ignorehitpause =0 

[state 1060, Statetypeset]
type = statetypeset
trigger1 = animelemtime(4) >= 1
physics = N
statetype = A
ignorehitpause = 1
persistent = 1

[state 1060, gravity]
type = gravity
trigger1 = animelemtime(8) > 0
trigger1 = pos y < 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1060, changestate]
type = changestate
trigger1 = vel y > 0
value = 1061

;----------------------------------------------------------------------------------
[statedef 1061]
type = A
movetype = I
physics = N
anim = 45

[state 1061, velmul]
type = velmul
trigger1 = time = 0
x = 0.35

[state 1061,gravity]
type = gravity
trigger1 = pos y < 0


[state 1061, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1062

;------------------------------------------------------------------------------
[statedef 1062]
type = C
movetype = I
physics = C
anim = 47

[state 1062, playsnd]
type = playsnd
trigger1 = time = 0
value = 52, 0

[state 1062, envshake]
type = envshake
trigger1 = time = 0
ampl = -6
time = 12

[state 1062, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
ownpal = 1
scale = 1,1

[state 1062, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1062, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1062, end]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------------
;EX Version
[statedef 1070]
type = S
movetype = A
physics = S
ctrl = 0
movehitpersist = prevstateno = stateno

[state 1070, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1070
value = -500

[state 1070, explod]
type = explod
trigger1 = time = 5
anim = 9998
postype = p1
pos = 0,0
id = 9998

[state 1070, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

;===========
;Armor start
;===========
[state 1070, animation]
type = changeanim
trigger1 = anim != 1070
value = 1070

;determine what frame
[state 1070, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1070, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 1070, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = 1
ignorehitpause = 1
;--------------------------

[state 1070, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1

[state 1070, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = floor(-gethitvar(damage))
persistent = 0
ignorehitpause = 1


[state 1070, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
attr = SCA, AA, AP
stateno = 1070
time = 1
persistent = 1
ignorehitpause = 1

[State 1070, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 1070, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2110
postype = p1
pos = -170, 0
scale = 1.2, 1.2
ownpal = 1

[state 1070, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2110
postype = p1
pos = 200, 0
scale = -1.2, 1.2
ownpal = 1

[state 1070, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2, 2
ownpal = 1

[State 1070, 2]
type = HitDef
trigger1 = !movecontact
attr = A, SA
animtype  = Up
damage    = 150, ifelse(p2statetype = A, 45, 15)
id = 1070
nochainid = 1070
guardflag = MA
pausetime = 18,18
envshake.ampl = 10
envshake.time = 18
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -12,-40
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -21
airguard.velocity = -12,-40
airguard.ctrltime = 40
air.velocity = -12,-36
guard.dist = 640
fall = 1
fall.recover = 0
fall.recovertime = 45

[state 1070, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = hitpausetime = 14
ignorehitpause = 1
persistent = 0
value = 1050,0

[state 1070, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1050,1
persistent = 0

[state 1070, posset]
type = posset
trigger1 = time = 0
trigger1 = prevstateno = [40,42]
y = 0

[state 1070, Jump]
type = velset
trigger1 = animelemtime(4) = 1 
trigger1 = prevstateno != 1070
y = -42
x = 24

[state 1070, movecontact]
type = velmul
trigger1 = movecontact
x = ifelse(movehit = 1, -0.1,-0.25)
y = ifelse(movehit = 1, 0.8, 1.0)
persistent = 0
ignorehitpause =0 

[state 1070, Statetypeset]
type = statetypeset
trigger1 = animelemtime(4) >= 1
physics = N
statetype = A
persistent = 1
ignorehitpause = 1

[state 1070, gravity]
type = gravity
trigger1 = animelemtime(8) > 0
trigger1 = pos y < 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1070, changestate]
type = changestate
trigger1 = vel y > 0
value = 1071

;----------------------------------------------------------------------------------
[statedef 1071]
type = A
movetype = I
physics = N
anim = 45

[state 1071, velmul]
type = velmul
trigger1 = time = 0
x = 0.35

[state 1071,gravity]
type = gravity
trigger1 = pos y < 0


[state 1071, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1072

;------------------------------------------------------------------------------
[statedef 1072]
type = C
movetype = I
physics = C
anim = 47

[state 1072, playsnd]
type = playsnd
trigger1 = time = 0
value = 52, 0

[state 1072, envshake]
type = envshake
trigger1 = time = 0
ampl = -6
time = 12

[state 1072, explod]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
ownpal = 1
scale = 1,1

[state 1072, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1072, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1072, end]
type = changestate
trigger1 = time = 6
value = 0
ctrl = 1

;=========================================================================
;  Rocket Shield
;=========================================================================
;Light Version
[statedef 1100]
type = S
movetype = A
physics = N
velset = 0,0
ctrl = 0

[state 1100, explod]
type = explod
trigger1 = time = 5
trigger1 = prevstateno != 1100
anim = 9998
postype = p1
pos = 0,0
id = 9998

[state 1100, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1100
value = 100

;===========
;Armor start
;===========
[state 1100, animation]
type = changeanim
trigger1 = anim != 1100
value = 1100

;determine what frame
[state 1100, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1100, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = anim
elem = var(22)

[state 1100, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = 1
ignorehitpause = 1
;--------------------------

[state 1100, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1

[state 1100, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = animelemtime(3) >= 0  && animelemtime(9) < 0
attr = SCA, AP
stateno = 1100
time = 1
persistent = 1
ignorehitpause = 1

[State 1100, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 1100, velset]
type = velset
trigger1 = animelemtime(3) >= 0  && animelemtime(9) < 0
x = 30

[state 1100, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 4
value = 1050,1
ignorehitpause = 1


[state 1100, Dust]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2110
postype = p1
pos = -120, 10
sprpriority = -2
bindtime = 0

[state 1100, Shield Aura]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2120
postype = p1
pos = 00,0
bindtime = -1
removetime = 18
id = 2120
sprpriority = 3
trans = addalpha
alpha = 256,192

[state 1100, removeaura]
type = removeexplod
trigger1 = animelemtime(9) = 0
id = 2120
ignorehitpause = 1


[state 1100, stopping dust]
type = explod
trigger1 = animelemtime(9) > 0 && animelemtime(10) < 6
anim = 2045
postype = p1
pos = 150, -10
persistent = 3
sprpriority = 3
scale = 0.5, 0.5

[state 1100, stopping dust]
type = explod
trigger1 = animelemtime(9) > 0 && animelemtime(10) < 6
anim = 2045
postype = p1
pos = -70, 10
persistent = 4
sprpriority = 3
scale = 0.5, 0.5

[state 1100, Jets]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = numexplod(1100) < 3
anim = 2010
id = 1100
postype = p1
pos = -100,-60
sprpriority = -2
bindtime = -1
removetime = 18
ignorehitpause = 0

[state 1100, Jets]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = numexplod(1100) < 3
anim = 2010
postype = p1
id = 100
pos = -260,-10
sprpriority = -2
bindtime = -1
removetime = 18
ignorehitpause = 0

[State 1100, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = Back
damage    = 120,24
id = 1100
nochainid = 1100
guardflag = MA
pausetime = 14,14
priority = 6,dodge
envshake.ampl = 10
envshake.time = 14
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -30,-15
guard.hittime = 19
guard.slidetime = 19
guard.velocity = -20
airguard.velocity = -25,-2
air.velocity = -30,-15
guard.dist = 640
fall = 1
fall.recover = 0
fall.recovertime = 45


[state 1100, statetypeset]
type = statetypeset
trigger1 = animelemtime(9) = 0
physics = S
movetype = I

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1100, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Hard Version
[statedef 1110]
type = S
movetype = A
physics = N
velset = 0,0
ctrl = 0

[state 1100, AI check charge time]
type = explod
trigger1 = time = 5
trigger1 = prevstateno != 1100
anim = 9998
postype = p1
pos = 0,0
id = 9998

[state 1110, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1110
value = 120

;===========
;Armor start
;===========
[state 1110, animation]
type = changeanim
trigger1 = anim != 1110
value = 1110

;determine what frame
[state 1110, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1110, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.50)
value = anim
elem = var(22)

[state 1110, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.50)
value = 1
ignorehitpause = 1
;--------------------------

[state 1110, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1

[state 1110, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = animelemtime(3) >= 0  && animelemtime(12) < 0
attr = SCA, AP
stateno = 1110
time = 1
persistent = 1
ignorehitpause = 1

[State 1110, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 1110, velset]
type = velset
trigger1 = animelemtime(3) >= 0  && animelemtime(12) < 0
x = 35

[state 1110, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 4
value = 1050,1
ignorehitpause = 1


[state 1110, Dust]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2110
postype = p1
pos = -120, 10
sprpriority = -2
bindtime = 0

[state 1110, Shield Aura]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2120
postype = p1
pos = 00,0
bindtime = -1
removetime = 36
id = 2120
sprpriority = 3
trans = addalpha
alpha = 256,192

[state 1110, removeaura]
type = removeexplod
trigger1 = animelemtime(12) = 0
id = 2120
ignorehitpause = 1


[state 1110, stopping dust]
type = explod
trigger1 = animelemtime(12) > 0 && animelemtime(13) < 6
anim = 2045
postype = p1
pos = 150, -10
persistent = 3
sprpriority = 3
scale = 0.5, 0.5

[state 1110, stopping dust]
type = explod
trigger1 = animelemtime(12) > 0 && animelemtime(13) < 6
anim = 2045
postype = p1
pos = -70, 10
persistent = 3
sprpriority = 3
scale = 0.5, 0.5

[state 1110, Jets]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = numexplod(1100) < 3
anim = 2010
id = 1100
postype = p1
pos = -100,-60
sprpriority = -2
bindtime = -1
removetime = 30
ignorehitpause = 0

[state 1110, Jets]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = numexplod(1100) < 3
anim = 2010
postype = p1
id = 100
pos = -260,-10
sprpriority = -2
bindtime = -1
removetime = 30
ignorehitpause = 0

[State 1110, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = Back
damage    = 150,30
id = 1110
nochainid = 1110
guardflag = MA
pausetime = 14,14
envshake.ampl = 10
envshake.time = 14
priority = 6,dodge
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -40,-20
guard.hittime = 19
guard.slidetime = 19
guard.velocity = -25
airguard.velocity = -35,-2
air.velocity = -40,-20
guard.dist = 640
fall = 1
fall.recover = 0
fall.recovertime = 45


[state 1110, statetypeset]
type = statetypeset
trigger1 = animelemtime(12) = 0
physics = S
movetype = I

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1110, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
;EX
[statedef 1120]
type = S
movetype = A
physics = N
velset = 0,0
ctrl = 0

[state 1120, nothitby]
type = nothitby
trigger1 = animelemtime(3) < 0
value = ,AP
ignorehitpause = 1

[state 1100, AI check charge time]
type = explod
trigger1 = time = 5
trigger1 = prevstateno != 1100
anim = 9998
postype = p1
pos = 0,0
id = 9998

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1120, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1120
value = -500
ignorehitpause = 1
persistent = 0

;===========
;Armor start
;===========
[state 1120, animation]
type = changeanim
trigger1 = anim != 1120
value = 1120

;determine what frame
[state 1120, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1120, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = anim
elem = var(22)

[state 1120, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.5)
value = 1
ignorehitpause = 1
;--------------------------

[state 1120, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.1)
persistent = 1

[state 1120, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = animelemtime(3) >= 0 && animelemtime(12) < 0
attr = SCA, AP
stateno = 1120
time = 1
persistent = 1
ignorehitpause = 1

[State 1120, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 1120, velset]
type = velset
trigger1 = animelemtime(3) >= 0  && animelemtime(12) < 0
x = 40

[state 1120, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 3
value = 1050,1
ignorehitpause = 1


[state 1120, Dust]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2110
postype = p1
pos = -120, 10
sprpriority = -2
bindtime = 0

[state 1120, Shield Aura]
type = explod
trigger1 = animelemtime(3) = 0
anim = 2120
postype = p1
pos = 00,0
bindtime = -1
removetime = 36
id = 2120
sprpriority = 3
trans = addalpha
alpha = 256,192

[state 1120, removeaura]
type = removeexplod
trigger1 = animelemtime(12) = 0
id = 2120
ignorehitpause = 1


[state 1120, stopping dust]
type = explod
trigger1 = animelemtime(12) > 0 && animelemtime(13) < 6
anim = 2045
postype = p1
pos = 150, -10
persistent = 3
sprpriority = 3
scale = 0.5, 0.5

[state 1120, stopping dust]
type = explod
trigger1 = animelemtime(12) > 0 && animelemtime(13) < 6
anim = 2045
postype = p1
pos = -70, 10
persistent = 3
sprpriority = 3
scale = 0.5, 0.5

[state 1120, Jets]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = numexplod(1100) < 3
anim = 2010
id = 1100
postype = p1
pos = -100,-60
sprpriority = -2
bindtime = -1
removetime = 30
ignorehitpause = 0

[state 1120, Jets]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = numexplod(1100) < 3
anim = 2010
postype = p1
id = 100
pos = -260,-10
sprpriority = -2
bindtime = -1
removetime = 30
ignorehitpause = 0

[State 1120, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = Back
damage    = 60,12
id = 1120
nochainid = 1120
guardflag = MA
pausetime = 14,14
envshake.ampl = 10
envshake.time = 14
priority = 6,dodge
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -90,-30
guard.hittime = 17
guard.slidetime = 17
guard.velocity = -25
airguard.velocity = -35,-2
air.velocity = -90,-30
guard.dist = 640
fall = 1
fall.recover = 0
fall.recovertime = 45

[state 1120, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 13
value = 675
id = 1120
ignorehitpause =1 


[state 1120, statetypeset]
type = statetypeset
trigger1 = animelemtime(12) = 0
physics = S
movetype = I

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1120, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;==========================================================================
;                    Anti-Air Missile
;==========================================================================
;Light Missile
[statedef 1150]
type = C
movetype = A
physics = C
anim = 1150
ctrl = 0
sprpriority = 1
poweradd = 100
velset = 0,0

[state 1000, explod]
type = explod
trigger1 = time = 2
anim = 9998
postype = p1
pos = 0,0
id = 9998

[state 1150, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 8040

[state 1150, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1150, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 40,1

[state 1150, Rocket Exhaust]
type = helper
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(7) = 17
stateno = 1155
postype = p1
pos = 5,-315
id = 1155

[state 1150, Rocket Exhaust]
type = helper
trigger1 = animelemtime(7) = 11
stateno = 1155
postype = p1
pos = 95,-320
id = 1155

[state 1150, helper]
type = helper
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(7) = 17
triggerall = numhelper(1150) < 3
id = 1150
stateno = 2050
postype = p1
pos = -8, -300
name = "Anti-Air Missiles 1&2"

[state 1150, helper]
type = helper
trigger1 = animelemtime(7) = 11
trigger1 = numhelper(1150) < 3
id = 1150
stateno = 2050
postype = p1
pos = 64, -320
name = "Anti-Air Missiles 3"


[state 1150, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Rocket Exhaust
[statedef 1155]
type = A
physics = N
movetype = I
anim = 3025
sprpriority = 3

[state 1155, angledraw]
type = angledraw
trigger1 = 1
value = -50
scale = 0.5, 0.5
ignorehitpause = 1
persistent = 1

[state 1155, destroyself]
type = destroyself
trigger1 = animtime = 0
trigger2 = time = 120

;--------------------------------------------------------------------------
;Heavy Missile
[statedef 1160]
type = C
movetype = A
physics = C
anim = 1150
ctrl = 0
sprpriority = 1
poweradd = 100
velset = 0,0

[state 1160, explod]
type = explod
trigger1 = time = 2
anim = 9998
postype = p1
pos = 0,0
id = 9998

[state 1160, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 8040

[state 1160, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1160, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 40,1

[state 1160, Rocket Exhaust]
type = helper
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(7) = 17
stateno = 1165
postype = p1
pos = 5,-315
id = 1155

[state 1160, Rocket Exhaust]
type = helper
trigger1 = animelemtime(7) = 11
stateno = 1165
postype = p1
pos = 95,-320
id = 1155

[state 1160, helper]
type = helper
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(7) = 17
triggerall = numhelper(1000) < 3
id = 1000
stateno = 2051
postype = p1
pos = -8, -300
name = "Anti-Air Missiles 1&2"

[state 1160, helper]
type = helper
trigger1 = animelemtime(7) = 11
trigger1 = numhelper(1150) < 3
id = 1150
stateno = 2051
postype = p1
pos = 64, -320
name = "Anti-Air Missiles 3"


[state 1160, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Rocket Exhaust
[statedef 1165]
type = A
physics = N
movetype = I
anim = 3025
sprpriority = 3

[state 1155, angledraw]
type = angledraw
trigger1 = 1
value = -30
scale = 0.5, 0.5
ignorehitpause = 1
persistent = 1

[state 1155, destroyself]
type = destroyself
trigger1 = animtime = 0
trigger2 = time = 120

;--------------------------------------------------------------------------
;EX Missile
[statedef 1170]
type = C
movetype = A
physics = C
anim = 1170
ctrl = 0
sprpriority = 1
velset = 0,0

[state 1170, explod]
type = explod
trigger1 = time = 2
anim = 9998
postype = p1
pos = 0,0
id = 9998

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1170, poweradd]
type = poweradd
trigger1 = time = 0
value = -500

[state 1170, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 8040

[state 1170, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1170, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 40,1

[state 1160, Rocket Exhaust]
type = helper
trigger1 = animelemtime(7) = 0
stateno = 1175
postype = p1
pos = 5,-315
id = 1155

[state 1160, Rocket Exhaust]
type = helper
trigger1 = animelemtime(7) = 11
stateno = 1175
postype = p1
pos = 95,-320
id = 1155



[state 1170, helper]
type = helper
triggerall = numhelper(1150) < 4
trigger1 = animelemtime(7) = 0
id = 1170
stateno = 2052
postype = p1
pos = -8, -300
name = "Anti-Air Missiles 1&2"

[state 1170, helper]
type = helper
trigger1 = animelemtime(7) = 11
triggerall = numhelper(1150) < 4
id = 1170
stateno = 2052
postype = p1
pos = 64, -320
name = "Anti-Air Missiles 3"


[state 1170, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Rocket Exhaust
[statedef 1175]
type = A
physics = N
movetype = I
anim = 3025
sprpriority = 3

[state 1175, angledraw]
type = angledraw
trigger1 = 1
value = 10
scale = 0.5, 0.5
ignorehitpause = 1
persistent = 1

[state 1175, destroyself]
type = destroyself
trigger1 = animtime = 0
trigger2 = time = 120



;==========================================================================
;Panacea Summon
;==========================================================================
;Breast Splash
[statedef 1200]
type = U
movetype = I
physics = N
anim = 1200
ctrl = 0

[state 1200, Changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(statetype = A, 1202, ifelse(statetype = C, 1201, 1200))

[State X, Blink Yellow]
type = PalFX
trigger1 = animelemtime(2) = 0
time = 8
add = 150,150,150 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1200, velmul]
type = velmul
triggerall = statetype = A
trigger1 = time = 0
x = 0.2
y = 0.2

[state 1200, velset]
type = velset
triggerall = statetype != A
trigger1 = time = 0
x = 0
y = 0

[state 1200, Panacea]
type = helper
triggerall = command = "holddown"
triggerall = statetype != A
trigger1 = animelemtime(2) = 0
triggerall = !numhelper(4000)
triggerall = !numexplod(4000)
stateno = 4000
postype = back
pos = -1000, 0
ownpal = 1
id = 4000
name = "Panacea Cow - Breast Splash"

[state 1120, Panacea]
type = helper
triggerall = command != "holddown"
Triggerall = statetype != A
triggerall = !numhelper(4000)
triggerall = !numexplod(4000)
trigger1 = animelemtime(2) = 0
id = 4000
name = "Panacea Cow - Breast Crush"
stateno = 4030
postype = back
ownpal = 1
pos = -300,0
ignorehitpause =1 

[state 1120, Panacea]
type = helper
triggerall = Statetype = A
triggerall = !numhelper(4000)
triggerall = !numexplod(4000)
trigger1 = animelemtime(2) = 0
id = 4000
name = "Panacea Cow - Butt Drop"
stateno = 4065
postype = p1
ownpal = 1
pos = ifelse(p2dist x < 400 && p2dist x > 0, p2dist x , 400),-720
ignorehitpause =1 

[state 1200, Panacea summon Count]
type = varadd
trigger1 = animelemtime(2) = 0
var(42) = 1
ignorehitpause =1 
persistent = 0

[state 1200, changestate]
type = changestate
trigger1 = animtime = 0
trigger1 = statetype != A
value = ifelse(statetype = C, 11, 0)
ctrl = 1

[state 1200, changestate]
type = changestate
trigger1 = animtime = 0
trigger1 = statetype = A
value = 50
ctrl = 1

[state 1200, landing]
type = changestate
triggerall = statetype = A
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;==========================================================================
;Healing cast
[statedef 1210]
type = S
movetype = I
physics = S
velset = 0,0
anim = 1200
ctrl = 0

[state 1210, Panacea]
type = helper
trigger1 = animelemtime(2) = 0
trigger1 = !numhelper(4000)
trigger1 = !numexplod(4000)
stateno = 4520
postype = p1
pos = -600, -720
ownpal = 1
id = 4500
name = "Panacea Cow - Healing"

[state 1200, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;==========================================================================
;  Tail Whip (Push Block)
;==========================================================================
[statedef 1400]
type = S
movetype = I
physics = S
velset = 0,0
anim = 1400
facep2 = 1

[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -250

[state 1400, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[State 330, Spark]
type = Explod
trigger1 = AnimElem = 2
id = 1410
anim = 1410
postype = p1
pos = 225,-300
sprpriority = 4
bindtime = 1
scale = 4.5,4.5
ownpal = 1

[state 1400, snd]
type = playsnd
trigger1 = time = 4
value = 1400,0

[State 1400, Push]
type = Helper
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(2) = 2
ignorehitpause = 1
ID = 1401
name = "Shove"
pos = -20,0
postype = p1
stateno = 1401
keyctrl = 0
ownpal = 1
helpertype = normal

[state 1400, moveforward]
type = velset
trigger1 = animelemtime(2) = 0
x = 5

[state 1400, HB]
Type = hitby
trigger1 = 1
value = SCA,AT

[state 1400, previous state]
type = varset
trigger1 = time = 0
v = 5
value = prevstateno


[State 1400, 3]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Pushing part
[Statedef 1401]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 1401

[State 1440, Push]
type = posset
trigger1 = time = 0
y = 0

[State 1440, Push]
type = PlayerPush
trigger1 = 1
value = 1

[State 1440, NHB]
type = NotHitBy
Trigger1 = 1
value = SCA
Time = 1

[State 1440, Vel]
type = VelSet
trigger1 = Time >= 0
x = 60

[State 345, End]
type = DestroySelf
trigger1 = Time = 15

;----------------------------------------------------------------------------------
;Light Missile
[statedef 2000]
type = A
movetype = A
physics = N
anim = 2100
ctrl = 0
sprpriority = 3

[State 2000, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2000, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,2

[state 2000, velset]
type = velset
trigger1 = 1
x = 10

[state 2000, veladd]
type = veladd
trigger1 = pos y < -280
y = 0.22

[state 2000, vel add]
type = veladd
trigger1 = pos y > - 200
y = -0.66

[state 2000, vel stablize]
type = velmul
trigger1 = vel y < 0
trigger1 = pos y = [-280, -200]
y = 0.5
persistent = 7


[State 2000, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Hard
damage    = 7
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,2
sparkno = -1
sparkxy = -40, 0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = 0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -2
air.velocity = 0,-4
forcenofall = 1
;fall = ifelse(time < 5, 1, 0)


[state 2000, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 2005
ignorehitpause = 1
persistent = 1

[state 2000, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 2005
slot = 1
persistent = 1
ignorehitpause = 1

[state 2000, NOTHITBY]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 2000, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = pos y
text = "Pos y: %d"


[state 2000, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -100

;----------------------------------------------------------------------------------
;Heavy Missile
[statedef 2010]
type = A
movetype = A
physics = N
anim = 2100
ctrl = 0

[State 2010, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2010, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,2

[state 2010, velset]
type = velset
trigger1 = time = 0
x = 25

[state 2000, veladd]
type = veladd
trigger1 = pos y < -280
y = 0.44

[state 2000, vel add]
type = veladd
trigger1 = pos y > - 200
y = -1.32

[state 2000, vel stablize]
type = velmul
trigger1 = vel y < 0
trigger1 = pos y = [-280, -200]
y = 0.5
persistent = 7

[state 2010, veladd]
type = null;veladd
trigger1 = time%20
x = 0.5
persistent = 1

[State 2010, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Hard
damage    = 7
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,2
sparkno = -1
sparkxy = -40, 0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = 0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -2
air.velocity = 0,-4
;fall = ifelse(time < 3, 1, 0)

[state 2010, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 2005
ignorehitpause = 1
persistent = 1

[state 2010, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 2005
slot = 1
persistent = 1
ignorehitpause = 1

[state 2010, NOTHITBY]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1


[state 2010, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -100

;----------------------------------------------------------------------------------
;EX Missile
[statedef 2020]
type = A
movetype = A
physics = N
anim = 2100
ctrl = 0
sprpriority = 3

[State 2020, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2020, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,2

[state 2020, velset]
type = velset
trigger1 = time = 0
x = 40

[state 2000, veladd]
type = veladd
trigger1 = pos y < -280
y = 0.88

[state 2000, vel add]
type = veladd
trigger1 = pos y > - 200
y = -2.64

[state 2000, vel stablize]
type = velmul
trigger1 = vel y < 0
trigger1 = pos y = [-280, -200]
y = 0.5
persistent = 15

[state 2020, veladd]
type = null;veladd
trigger1 = time%20
x = 1.0
persistent = 1

[State 2020, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Hard
damage    = 5
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,4
getpower = 0
sparkno = -1
sparkxy = -40,0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = 0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -2
air.velocity = 0,-4
fall.recover = 1
fall.recovertime = 20


[state 2020, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 2025
ignorehitpause = 1
persistent = 1

[state 2020, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 2025
slot = 1
persistent = 1
ignorehitpause = 1

[state 2020, NOTHITBY]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1


[state 4020, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -100
;---------------------------------------------------------------------------

;EX Missile
[statedef 2021]
type = A
movetype = A
physics = N
anim = 2100
ctrl = 0
sprpriority = 3

[State 2021, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2021, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,2

[state 2021, velset]
type = velset
trigger1 = time = 0
x = 40

[state 2000, veladd]
type = veladd
trigger1 = pos y < -280
y = 0.66

[state 2000, vel add]
type = veladd
trigger1 = pos y > - 200
y = -1.98

[state 2000, vel stablize]
type = velmul
trigger1 = vel y < 0
trigger1 = pos y = [-280, -200]
y = 0.5
persistent = 7

[state 2021, veladd]
type = null;veladd
trigger1 = time%20
x = 1.0
persistent = 1

[State 2021, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Hard
damage    = 5
guardflag = MA
hitflag = MAF
pausetime = 2,2
guard.pausetime = 2,2
getpower = 0
sparkno = -1
sparkxy = -40,0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = 0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -2
air.velocity = 0,-4
fall.recover = 1
fall.recovertime = 20

[state 2021, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 2026
ignorehitpause = 1
persistent = 1

[state 2021, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 2026
slot = 1
persistent = 1
ignorehitpause = 1

[state 2021, NOTHITBY]
type = nothitby
trigger1 = 1
value = SCA, AA,AT
ignorehitpause = 1


[state 2021, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -100
;---------------------------------------------------------------------------
;Light Missle Explosion
[statedef 2005]
type = A
movetype = A
physics = N
velset = 0,0
anim = 2105
sprpriority = 3

[state 2005, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1  



[State 2005, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2005, Explosion sound]
type = playsnd
trigger1 = time = 0
value = 1000,3

[state 2005, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2005, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Hard
damage    = 59,6
guardflag = MA
pausetime = 0,0
guard.pausetime = 2,6
sparkno = -1
sparkxy = -40,0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
envshake.ampl = -8
envshake.time = 12
ground.slidetime = parent,var(12)
ground.hittime  = parent,var(12)
ground.velocity = -20,0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -22
airguard.velocity = -6,-4
air.velocity = -14,-16
air.fall = 1
fall.recover = 1
fall.recovertime = 30

[state 2005, varadd] ;Hitstun
type = parentvaradd
trigger1 = movehit
var(12) = -2
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = parentvaradd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 2005, explod]
type = explod
trigger1 = animtime = 0
anim = 2106
postype = p1
pos = 0,0
ownpal = 1
sprpriority = 3


[state 2005, end]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;EX Missle Explosion - No Knockedown
[statedef 2025]
type = A
movetype = A
physics = N
velset = 0,0
anim = 2105
sprpriority = 3

[state 2025, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1  


[State 2025, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2025, Explosion sound]
type = playsnd
trigger1 = time = 0
value = 1000,3

[state 2025, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2025, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Back
damage    = 44,5
guardflag = MA
pausetime = 0,0
guard.pausetime = 2,2
getpower = 0
sparkno = -1
sparkxy = -40,0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
envshake.ampl = -8
envshake.time = 12
ground.slidetime = parent,var(12)
ground.hittime  = parent,var(12)
ground.velocity = -2,0
guard.hittime = 8
guard.slidetime = 8
airguard.velocity = -6,-4
guard.velocity = -4
air.velocity = -2,-4
fall.recover = 1
fall.recovertime = 20

[state x, combo damage score]
type = parentvaradd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 2025, explod]
type = explod
trigger1 = animtime = 0
anim = 2106
postype = p1
pos = 0,0
ownpal = 1
sprpriority = 3


[state 2025, end]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;EX Missle Explosion - No Knockedown
[statedef 2026]
type = A
movetype = A
physics = N
velset = 0,0
anim = 2105
sprpriority = 3

[state 2026, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1  




[State 2026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2026, Explosion sound]
type = playsnd
trigger1 = time = 0
value = 1000,3

[state 2026, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 2026, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SP
animtype  = Back
damage    = 44,5
guardflag = MA
pausetime = 0,0
guard.pausetime = 2,2
getpower = 0
sparkno = -1
sparkxy = -40,0
hitsound   = 5,3
guardsound = 6,0
ground.type = High
envshake.ampl = -8
envshake.time = 12
ground.slidetime = parent,var(12)
ground.hittime  = parent,var(12)
ground.velocity = -12,-24
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -24
airguard.velocity = -10,-6
air.velocity = -12,-24
fall = 1
fall.recover = 1
fall.recovertime = 20

[state 2005, varadd] ;Hitstun
type = parentvaradd
trigger1 = movehit
var(12) = -2
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = parentvaradd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 2026, explod]
type = explod
trigger1 = animtime = 0
anim = 2106
postype = p1
pos = 0,0
ownpal = 1
sprpriority = 3


[state 2026, end]
type = destroyself
trigger1 = animtime = 0

;-----------------------------------------------------------------------------

;Anti Air Missiles

;-----------------------------------------------------------------------------
;Anti Air Missile Low Angle Missile
[statedef 2050]
Type = A
movetype = A
physics = N
anim = 2150
velset = 37.5,-12.5 ; 30, -10  Times 1.25 to increase speed
sprpriority = 3

[State 2026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2050, hitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 2050, hittoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
slot = 1
time = 1
stateno = 2055
ignorehitpause = 1
persistent = 1


[State 1120, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = C, SP
animtype  = Light
damage    = 3
guardflag = MA
hitflag = HAF
pausetime = 2,2
guard.pausetime = 2,2
envshake.ampl = 10
envshake.time = 14
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = 0
airguard.velocity = 0,-9
air.velocity = 0,-12
guard.dist = 640
fall = 0
fall.recover = 0
fall.recovertime = 45

[state 2000, playsnd]
type = playsnd
trigger1 = time = 0
value = 1150,0

[state 2050, angledraw]
type = angledraw
trigger1 = 1
value = -65
ignorehitpause = 1
persistent = 1

[state 2050, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
;trigger3 = time = 55
value = 2055
ignorehitpause = 1

[state 2050, destroyself]
type = destroyself
trigger1 = backedgebodydist < -400
trigger2 = frontedgebodydist < -400

;-----------------------------------------------------------------------------
;Anti-Air Missile Heavy Steep angle
[statedef 2051]
Type = A
movetype = A
physics = N
anim = 2150
velset = 25,-25 ; 20, -20 time 1.5 for more speed
sprpriority = 3

[State 2026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2051, hitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 2051, hittoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
slot = 1
time = 1
stateno = 2055
ignorehitpause = 1
persistent = 1


[State 2051, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = C, SP
animtype  = Light
damage    = 3
guardflag = MA
hitflag = HAF
pausetime = 2,2
guard.pausetime = 2,2
envshake.ampl = 10
envshake.time = 14
sparkno = 3
sparkxy = -40,-310
hitsound   = 5,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = 0
airguard.velocity = 0,-9
air.velocity = 0,-12
guard.dist = 640
fall = 0
fall.recover = 0
fall.recovertime = 45

[state 2051, playsnd]
type = playsnd
trigger1 = time = 0
value = 1150,0

[state 2051, angledraw]
type = angledraw
trigger1 = 1
value = -45
ignorehitpause = 1
persistent = 1

[state 2050, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
;trigger3 = time = 45
value = 2055
ignorehitpause = 1

[state 2050, destroyself]
type = destroyself
trigger1 = backedgebodydist < -400
trigger2 = frontedgebodydist < -400

;-----------------------------------------------------------------------------
;Anti-Air Missile Homming, will be coded later
[statedef 2052]
Type = A
movetype = A
physics = N
anim = 2150
velset = 0,-12
sprpriority = 3

[State 2026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2052, Helper varset angle]
type = varset
trigger1 = time = 0
var(1) = -10


[state 2052, Helper varset Clock notation]
type = varset
trigger1 = time = 0
var(2) = 12

[state 2052, clock don't go over 12]
type = varset
trigger1 = var(2) >= 13
var(2) = 1
persistent = 1

[state 2052, clock don't go over 12]
type = varset
trigger1 = var(2) <= 0
var(2) = 12
persistent = 1

;======================================================
;Angles
[state 2052, UP]
type = varset
trigger1 = var(2) = 12
var(1) = 0

[state 2052, UP-FORWARD 1]
type = varset
trigger1 = var(2) = 1
var(1) = -30

[state 2052, UP-FORWARD 2]
type = varset
trigger1 = var(2) = 2
var(1) = -60

[state 2052, FORWARD]
type = varset
trigger1 = var(2) = 3
var(1) = -90

[state 2052, DOWN-FORWARD 2]
type = varset
trigger1 = var(2) = 4
var(1) = -120

[state 2052, DOWN-FORWARD 1]
type = varset
trigger1 = var(2) = 5
var(1) = -150

[state 2052, DOWN]
type = varset
trigger1 = var(2) = 6
var(1) = 180

[state 2052, DOWN-BACK 1]
type = varset
trigger1 = var(2) = 7
var(1) = 150

[state 2052, DOWN-BACK 2]
type = varset
trigger1 = var(2) = 8
var(1) = 120

[state 2052, BACK]
type = varset
trigger1 = var(2) = 9
var(1) = 90

[state 2052, UP-BACK 1]
type = varset
trigger1 = var(2) = 10
var(1) = 60

[state 2052, UP-BACK 2]
type = varset
trigger1 = var(2) = 11
var(1) = 30

;======================================================
; X  Velocities
;======================================================
[state 2052, UP]
type = varset
trigger1 = var(2) = 12
var(3) = 0 ; X


[state 2052, UP-FORWARD 1]
type = varset
trigger1 = var(2) = 1
var(3) = 6


[state 2052, UP-FORWARD 2]
type = varset
trigger1 = var(2) = 2
var(3) = 12

[state 2052, FORWARD]
type = varset
trigger1 = var(2) = 3
var(3) = 18

[state 2052, DOWN-FORWARD 2]
type = varset
trigger1 = var(2) = 4
var(3) = 12

[state 2052, DOWN-FORWARD 1]
type = varset
trigger1 = var(2) = 5
var(3) = 6

[state 2052, DOWN]
type = varset
trigger1 = var(2) = 6
var(3) = 0

[state 2052, DOWN-BACK 1]
type = varset
trigger1 = var(2) = 7
var(3) = -6

[state 2052, DOWN-BACK 2]
type = varset
trigger1 = var(2) = 8
var(3) = -12

[state 2052, BACK]
type = varset
trigger1 = var(2) = 9
var(3) = -18

[state 2052, UP-BACK 1]
type = varset
trigger1 = var(2) = 10
var(3) = -12

[state 2052, UP-BACK 2]
type = varset
trigger1 = var(2) = 11
var(3) = -6

;======================================================
; Y  Velocities
;======================================================
[state 2052, UP]
type = varset
trigger1 = var(2) = 12
var(4) = -12

[state 2052, UP-FORWARD 1]
type = varset
trigger1 = var(2) = 1
var(4) = -8

[state 2052, UP-FORWARD 2]
type = varset
trigger1 = var(2) = 2
var(4) = -4

[state 2052, FORWARD]
type = varset
trigger1 = var(2) = 3
var(4) = 0

[state 2052, DOWN-FORWARD 2]
type = varset
trigger1 = var(2) = 4
var(4) = 4

[state 2052, DOWN-FORWARD 1]
type = varset
trigger1 = var(2) = 5
var(4) = 8

[state 2052, DOWN]
type = varset
trigger1 = var(2) = 6
var(4) = 12

[state 2052, DOWN-BACK 1]
type = varset
trigger1 = var(2) = 7
var(4) = 8

[state 2052, DOWN-BACK 2]
type = varset
trigger1 = var(2) = 8
var(4) = 4

[state 2052, BACK]
type = varset
trigger1 = var(2) = 9
var(4) = 0

[state 2052, UP-BACK 1]
type = varset
trigger1 = var(2) = 10
var(4) = -4

[state 2052, UP-BACK 2]
type = varset
trigger1 = var(2) = 11
var(4) = -8


[state 2052, hitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 2052, hittoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
slot = 1
time = 1
stateno = 2056
ignorehitpause = 1
persistent = 1


[State 2052, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = C, SP
animtype  = Light
damage    = 4
guardflag = MA
HitFlag = MAF
pausetime = 2,2
guard.pausetime = 2,2
envshake.ampl = 10
envshake.time = 14
sparkno = 3
givepower = 3
getpower = 0
sparkxy = -40,-310
hitsound   = 5,1
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 8
guard.slidetime = 8
guard.velocity = 0
airguard.velocity = 0,-9
air.velocity = 0,-12
guard.dist = 640
fall = 0
fall.recover = 0
fall.recovertime = 45

[state 2052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1150,0

[state 2052, angledraw]
type = angledraw
trigger1 = time >= 0 && time < 24
value = -10
ignorehitpause = 1
persistent = 1

[state 2052, SLOW]
type = velmul
trigger1 = time = 24
x = 0.1
y = 0.1

[state 2052, Stop]
type = velset
trigger1 = time = 30
x = 0
y = 0

[state 2052, Clockset] ;Forward
type = varadd
triggerall = time >= 32
trigger1 = p2bodydist x > 90 
trigger1 = var(2) != 3
trigger2 = p2bodydist x < -90
trigger2 = var(2) != 9
trigger3 = p2bodydist y > 400
trigger3 = p2bodydist x = [-140,140]
trigger3 = var(2) != 6
trigger4 = p2bodydist y < -400
trigger4 = p2bodydist x = [-140, 140]
trigger4 = var(2) != 12
var(2) = 1
persistent = 9

[state 2052, angledraw]
type = angledraw
trigger1 = time >= 32
value = var(1)
persistent = 1
ignorehitpause = 1


[state 2052, Velocity]
type = velset
trigger1 = time >= 32
x = var(3)
y = var(4)
persistent = 1
ignorehitpause = 1

[state 2052, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
trigger3 = pos y > 0
trigger4 = time = 932
value = 2056
ignorehitpause = 1

[state 2052, destroyself]
type = destroyself
trigger1 = time > 950



[state 2052, displayto clipboard]
type = displaytoclipboard
trigger1 = 1
text = "Angle: %d Clock: %d  Vel X:%d Vel Y:%d  Offset X: %d  Offset y: %d"
params = var(1), var(2), var(3), var(4), p2bodydist x, p2bodydist y
ignorehitpause = 1

;=============================================================================
;Explosion
[statedef 2055]
type = A
movetype = A
physics = N
anim = 2151
velset = 0,0

[State 2026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2055, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2055, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,3

[State 1120, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = C, SP
animtype  = Back
damage    = 27,ifelse(p2statetype = A, 9, 3)
guardflag = MA
hitflag = MAF
getpower = ifelse(prevstateno = 2052, 0, 30)
givepower = 40
pausetime = 2,2
guard.pausetime = 12,12
envshake.ampl = 10
envshake.time = 14
sparkno = -1
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -12,-15
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -18
airguard.velocity = -10,-24
air.velocity = -12,-15
guard.dist = 640
fall = 1
fall.recover = 1
fall.recovertime = 35

[state 2055, parentvaradd]
type = parentvaradd
trigger1 = movehit
var(18) = -6
ignorehitpause = 1
persistent = 0

[state 2055, end]
type = destroyself
trigger1 = animtime = 0

;=============================================================================
;EX Explosion
[statedef 2056]
type = A
movetype = A
physics = N
anim = 2151
velset = 0,0

[State 2026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 2055, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2055, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,3

[State 1120, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = C, SP
animtype  = Back
damage    = 36,ifelse(p2statetype = A, 12, 4)
guardflag = MA
hitflag = MAFD
getpower = ifelse(prevstateno = 2052, 0, 30)
givepower = 40
pausetime = 2,2
guard.pausetime = 12,12
envshake.ampl = 15
envshake.time = 6
sparkno = -1
sparkxy = -40,-310
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 6,-24
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -18
airguard.velocity = -8,-21
air.velocity = 6,-24
down.velocity = 6,-36
guard.dist = 640
fall = 1
fall.recover = 1
fall.recovertime = 45

[state 2055, parentvaradd]
type = parentvaradd
trigger1 = movehit
var(18) = -6
ignorehitpause = 1
persistent = 0

[state 2055, end]
type = destroyself
trigger1 = animtime = 0



;------------------------------------------------------------------------------
;Panacea's Milk
[statedef 2500]
type = A
movetype = A
physics = N
anim = 2510
sprpriority = 5

[state 2500, angledraw]
type = angledraw
trigger1 = 1
value = 0 - (time*8)
persistent = 1

[state 2500, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause =1 

[state 2500, velset]
type = velset
trigger1 = time = 0
x = p2dist x * 0.0125
y = -18

[state 2500, Steering]
type = null;veladd
trigger1 = p2dist x > 150
x = 0.6
persistent = 2

[state 2500, steering]
type = null;veladd
trigger1 = p2dist x < -150
x = -0.6
persistent = 2

[state 2500, velmul]
type = null;velmul
trigger1 = p2dist x = [-150,150]
x = 0.5
persistent = 90

[state 2500, veladd]
type = veladd
trigger1 = pos y < 0
y = 0.44
persistent = 1

[state 2500, hitoverride]
type = null;hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 2501
slot = 1
time = 1
ignorehitpause = 1

[State 2500, 2]
type = HitDef
trigger1 = enemynear,movetype = I
;trigger1 = enemynear,movetype = I || enemynear,movetype = H
persistent = 0
attr = S, SP
animtype  = light
damage    = 0,0
affectteam = E
guardflag = 
hitflag = MA
pausetime = 0,0
sparkno = -1
sparkxy = -40,-180
id = 2500
hitsound   = S2500,0
guardsound = 6,0
ground.type = high
ground.slidetime = 1
ground.hittime  = 1
ground.velocity = 0
air.velocity = 0,0
guard.hittime = 1
guard.velocity = 0
guard.slidetime = 1
guard.dist = 0

[state 2500, targetstate]
type = targetstate
trigger1 = movecontact
value = 2510
ignorehitpause = 1

[state 2500, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed

value = 2501
ignorehitpause = 1

[state 2500, destroyself]
type = destroyself
trigger1 = frontedgebodydist < -300
trigger2 = backedgebodydist < - 300

[state 2500, changestate]
type = changestate
trigger1 = pos y > 0
value = 2505


;---------------------------------------------------------------------------
[statedef 2501]
type = A
movetype = I
physics = N
velset = 0,0
anim = 2512

[state 2501, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 2501, if on ground]
type = posset
trigger1 = time = 0
trigger1 = pos y > 0
y = 0

[state 2501, destroyself]
type = destroyself
trigger1 = animtime = 0

;-------------------------------------------------------------------------
;On Ground
[statedef 2505]
type = C
movetype = A
physics = N
anim = 2511

[state 2500, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause =1 

[state 2500, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 2500, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 2501
slot = 1
time = 1
ignorehitpause = 1

[State 2500, 2]
type = HitDef
trigger1 = enemynear,movetype = I
;trigger1 = enemynear,movetype = I || enemynear,movetype = H
persistent = 1
attr = S, SP
animtype  = light
damage    = 0,0
affectteam = E
guardflag = 
hitflag = MA
pausetime = 0,0
sparkno = -1
sparkxy = -40,-180
id = 2500
hitsound   = S2500,0
guardsound = 6,0
ground.type = high
ground.slidetime = 1
ground.hittime  = 1
ground.velocity = 0
air.velocity = 0,0
guard.hittime = 1
guard.velocity = 0
guard.slidetime = 1
guard.dist = 0

[state 2500, targetstate]
type = targetstate
trigger1 = movecontact
value = 2510
ignorehitpause = 1

[state 2500, changestate]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 2501
ignorehitpause = 1

[state 2500, Andy pickup]
type = changestate
trigger1 = rootdist x = [-150, 150]
trigger1 = root,statetype != A
trigger1 = root,movetype != H
value = 2509

[state 2500, destroyself]
type = destroyself
trigger1 = time > 720


;---------------------------------------------------------------------------
;Andy Pick up - No health reward
[statedef 2509]
type = A
movetype = I
physics = N
anim = 2519

[state 2509, Coin Snd]
type = playsnd
trigger1 = time = 0
value = S3040,0

[state 2509, poweradd]
type = poweradd
trigger1 = time = 0
value = 200
persistent = 0


[state 2509, poweradd]
type = velset
trigger1 = time = 0
y = -1.5

[state 2509, destroyself]
type = destroyself
trigger1 = animtime = 0

;--------------------------------------Heals--------------------------------
[statedef 2510]
type = U
movetype = I
physics = U

[state 2510, lifeadd]
type = lifeadd
trigger1 = time = 0
value = 80
absolute = 1
persistent = 0
ignorehitpause = 1

[state 2510, poweradd]
type = poweradd
trigger1 = time = 0
value = floor(powermax * 0.05)

[state 2510, nothitby]
type = nothitby
trigger1 = time = 0
value = SCA
ignorehitpause =1 
persistent = 1
time = 2

[state -3, Visual indicator]
type = palfx
trigger1 = time = 0
time = 24
add = 196,196,196;32,150,32 
;sinadd = ;32,64,5,3
ignorehitpause
persistent = 1

[state 2510, return]
type = selfstate
trigger1 = time = 1
value = ifelse(statetype = A, 50, ifelse(statetype = C, 11, 0))
ctrl = 1




;===========================================================================

;                              SUPERS

;===========================================================================

;Armored Anti Air Assault
[statedef 3000]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0
sprpriority = 2


[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = A
ignorehitpause = 1

[state 3000, on ground]
type = posset
trigger1 = time = 0
trigger1 = prevstateno != 3000
y = 0


[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 80
v = 18
value = 80

;===========
;Armor start
;===========

[state 3000, anim]
type = changeanim
trigger1 = anim != 3000
value = 3000


;determine what frame
[state 3000, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 3000, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = anim
elem = var(22)

[state 3000, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.25)
value = 1
ignorehitpause = 1
;--------------------------

[state 3000, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*0.25)
persistent = 1

[state 410, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -gethitvar(damage)
persistent = 0
ignorehitpause = 1

[state 3000, Unstoppable]
type = hitoverride
trigger1 = alive
attr = SCA, AP, AA
stateno = 3000
time = 1
persistent = 1
ignorehitpause = 1

[State 3000, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------

[state 3000, helper]
type = helper
trigger1 = !numhelper(3000)
trigger1 = animelemtime(3) = 0
stateno = 3010
postype = p1
pos = 0,-100
id = 3000
name = "Giant Turret"

[state 3000, changestate]
type = changestate
trigger1 = numhelper(3000)
trigger1 = helper(3000),stateno = 3011
value = 3001


;-----------------------------------------------------------------------------
;Catch and Hold
[statedef 3001]
type = S
movetype = A
physics = S
ctrl = 0


[state 3001, nothitby]
type = nothitby
trigger1 = animelemtime(4) < 0
value = A

;===========
;Armor start
;===========

[state 3001, anim]
type = changeanim
trigger1 = anim != 3001
value = 3001


;determine what frame
[state 3001, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 3001, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 3001, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = 1
ignorehitpause = 1
;--------------------------

[state 3001, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = ceil(-gethitvar(damage)*1)
persistent = 1
ignorehitpause = 1

[state 3001, armor subtract]
type = varadd
trigger1 = gethitvar(damage) != 0
var(20) = -gethitvar(damage)
persistent = 0
ignorehitpause = 1

[state 3001, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = var(20) >  0
attr = SCA, AP,AA
stateno = 3001
time = 1
persistent = 1
ignorehitpause = 1

[State 3001, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;--------------------Armor End-------------------------------------



[state 3001, no bg]
type = assertspecial
trigger1 = time = [0,60]
triggerall = prevstateno != 3001
triggerall = !numhelper(3002)
flag = nobg
ignorehitpause = 1

[State 3001, Super Pause]
type = SuperPause
trigger1 = time = 0
triggerall = prevstateno != 3001
triggerall = !numhelper(3002)
sound = S3000, 0
;poweradd = -3000
pos = 80,-80
time = 60
movetime = 60
unhittable = 1
ignorehitpause =1 

[state 3001, Super Portrait]
type = explod
trigger1 = time = [1,15]
triggerall = prevstateno != 3001
triggerall = !numhelper(3002)
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1
ignorehitpause =1 

[state 3001, Super Portrait]
type = explod
trigger1 = time = 15
triggerall = prevstateno != 3001
triggerall = !numhelper(3002)
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1
ignorehitpause = 1

[state 3001, Helper] ;Stop repeate FX
type = helper
trigger1 = time = 0
trigger1 = !numhelper(3002)
stateno = 3002
id = 3002
name = "Stop Repeat FX"
ignorehitpause = 1
persistent = 0

[state 3001, changestate]
type = changestate
trigger1 = numhelper(3000)
trigger1 = helper(3000), stateno = 3019
value = 3009

;-----------------------------------------------------------------------------
;DON'T REPEAT SUPER FREEZE
[statedef 3002]
type = U
movetype = I
physics = N
anim = 9999

[state 3002, poweradd]
type = poweradd
trigger1 = time = 0
value = -3000

[state 3002, destroyself]
type = destroyself
trigger1 = time > 180

;-----------------------------------------------------------------------------
;Zip Down
[statedef 3005]
type = A
movetype = I
physics = N
anim = 3005
ctrl = 0

[State 3005, Blink White]
type = PalFX
trigger1 = time >= 0 & time < 12
trigger1 = time%2
time = 1
add = 255,255,255 ;32,16,0
ignorehitpause

[state 3005, gravity]
type = gravity
trigger1 = 1

[state 3005, velset]
type = velset
trigger1 = time = 0
y = 30
x = 45

[state 3005, SUPER]
TYPE = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3000



;-----------------------------------------------------------------------------
[statedef 3009]
type = S
movetype = I
physics = S
anim = 3009


[state 3009, changestate]
type = changestate
trigger1 = animtime =  0
value = 0
ctrl = 1


;--------------------------------------------------------------------------
;Summoned Giant Turret
[statedef 3010]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
anim = 3010

[State 2000, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3010, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HA
animtype  = Hard
damage    = 40,ifelse(p2statetype = A, 12,4)
guardflag = MA
hitflag = MAF
getpower = 0
givepower = 1
pausetime = 6,6
sparkno = 0
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = (root,p2bodydist x + 100) * 0.02,-36
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -22
air.velocity = (root,p2bodydist x + 100) * 0.02,-27
airguard.velocity = -1,-30
DOWN.velocity = 0,0
yaccel = 0.88
down.hittime = 24
p1sprpriority = 0
fall = 1
fall.recover = 0
fall.recovertime = 60

[state 3010, gravity]
type = veladd
trigger1 = animelemtime(4) > 0
y = 2.5
persistent = 1

[state 3010, Stick]
type = posset
trigger1 = pos X != root, pos X
x = root, pos x
ignorehitpause = 1

[state 3010, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3011

[state 3010, destroyself]
type = destroyself
trigger1 = root,stateno != [3000,3030]

;--------------------------------------------------------------------------
;Giant Turret Tilt
[statedef 3011]
type = S
movetype = A
physics = S
ctrl = 0
anim = 3011
sprpriority = 0


[state 3010, gravity]
type = velset
trigger1 = time = 0
y = 0

[state 3010, posset]
type = posset
trigger1 = time = 0
y = 0
x = root, pos x

[state 3010, posset]
type = posset
trigger1 = time = 4
y = 20

[state 3010, posset]
type = posset
trigger1 = time = 8
y = 0
x = root,pos x

[state 3010, Stick]
type = posset
trigger1 = pos X != root, pos X
x = root, pos x
ignorehitpause = 1

[state 3010, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,0

[state 3010, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0


;Missile Turret 1
[state 3011, Missile 1]
type = helper
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(12) = 0
trigger3 = animelemtime(20) = 0
postype = p1
pos = -140, -480
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 2
[state 3011, Missile 2]
type = helper
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(13) = 0
trigger3 = animelemtime(21) = 0
postype = p1
pos = -60, -500
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 3
[state 3011, Missile 3]
type = helper
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(14) = 0
trigger3 = animelemtime(22) = 0
postype = p1
pos = 0, -510
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 4
[state 3011, Missile 4]
type = helper
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(23) = 0
postype = p1
pos = -80, -500
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 5
[state 3011, Missile 5]
type = helper
trigger1 = animelemtime(8) = 0
trigger2 = animelemtime(16) = 0
trigger3 = animelemtime(24) = 0
postype = p1
pos = 0, -510
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 6
[state 3011, Missile 6]
type = helper
trigger1 = animelemtime(9) = 0
trigger2 = animelemtime(17) = 0
trigger3 = animelemtime(25) = 0
postype = p1
pos = -60, -470
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 7
[state 3011, Missile 7]
type = helper
trigger1 = animelemtime(10) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(26) = 0
postype = p1
pos = -10, -470
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 8
[state 3011, Missile 8]
type = helper
trigger1 = animelemtime(11) = 0
trigger2 = animelemtime(19) = 0
postype = p1
pos = 40, -470
stateno = 3020
ownpal = 1
name = "Super Missile"
id = 3020

;Missile Turret 8
[state 3011, Missile 8]
type = helper
trigger1 = animelemtime(27) = 0
postype = p1
pos = 40, -470
stateno = 3024
ownpal = 1
name = "Super Missile"
id = 3020


;-----------------------------------------------
;   Exhaust
;-----------------------------------------------
;Missile Turret 1
[state 3011, Exhaust hole 1]
type = Explod
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(12) = 0
trigger3 = animelemtime(20) = 0
postype = p1
pos = -140, -480
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 2
[state 3011, Exhaust hole 2]
type = Explod
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(13) = 0
trigger3 = animelemtime(21) = 0
postype = p1
pos = -60, -500
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 3
[state 3011, Exhaust hole 3]
type = Explod
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(14) = 0
trigger3 = animelemtime(22) = 0
postype = p1
pos = 0, -510
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 4
[state 3011, Exhaust hole 4]
type = Explod
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(23) = 0
postype = p1
pos = -80, -500
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 5
[state 3011, Exhaust hole 5]
type = Explod
trigger1 = animelemtime(8) = 0
trigger2 = animelemtime(16) = 0
trigger3 = animelemtime(24) = 0
postype = p1
pos = 0, -510
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 6
[state 3011, Exhaust hole 6]
type = Explod
trigger1 = animelemtime(9) = 0
trigger2 = animelemtime(17) = 0
trigger3 = animelemtime(25) = 0
postype = p1
pos = -60, -470
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 7
[state 3011, Exhaust hole 7]
type = Explod
trigger1 = animelemtime(10) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(26) = 0
postype = p1
pos = -10, -470
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3

;Missile Turret 8
[state 3011, Exhaust hole 8]
type = Explod
trigger1 = animelemtime(11) = 0
trigger2 = animelemtime(19) = 0
trigger3 = animelemtime(27) = 0
postype = p1
pos = 40, -470
anim  = 3025
ownpal = 1
id = 3025
sprpriority = 3


[state 3010, changestate]
type = changestate
trigger1 = animtime = 0
value = 3019

[state 3010, destroyself]
type = destroyself
trigger1 = root,stateno != [3000,3030]
;-----------------------------------------------------------------------------
;Giant Turret, Leave
[statedef 3019]
type = A
movetype = I
physics = N
anim = 3019

[state 3010, Stick]
type = posset
trigger1 = animelemtime(4) > 0
trigger1 = pos X != root, pos X
x = root, pos x
ignorehitpause = 1

[state 3019, float away]
type = velset
trigger1 = animelemtime(4) > 0
y = -2

[state 3019, destroyself]
type = destroyself
trigger1 = animtime = 0


;------------------------------------------------------------------------------
[statedef 3020]
type = A
movetype = A
physics = N
velset = 40, -80
anim = 3020
ctrl = 0
sprpriority = 2

[state 3021, nothitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 3021, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 3023
slot = 1
time = 1
ignorehitpause = 1

[state 3020, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,0

[State 3020, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3020, 2]
type = HitDef
trigger1 = !movecontact
attr = A, HP
persistent = 0
animtype  = Hard
damage    = 3,1
getpower = 0
givepower = 0
guardflag = MA
hitflag = MAF
pausetime = 0,2
sparkno = -1
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 12
guard.slidetime = 12
guard.velocity = 0
air.velocity = 0,0
DOWN.velocity = 0,0
down.hittime = 12
fall = 1
fall.recover = 0
fall.recovertime = 60

[state 3020, changestate]
type = changestate 
trigger1 = movecontact
trigger2 = movereversed
value = 3023
ignorehitpause = 1


[state 3020, changestate]
type = changestate
trigger1 = pos y < -1800
trigger2 = time > 180
value = 3021

;----------------------------------------------------------
[statedef 3021]
type = A
movetype = A
physics = N
velset = 0,64
anim = 3021

[state 3021, movecontact]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 3023
ignorehitpause =1 

[state 3021, nothitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 3021, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 3023
slot = 1
time = 1
ignorehitpause = 1


[State 3020, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3020, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = A, HP
animtype  = Hard
damage    = 3,1
getpower = 0
givepower = 0
guardflag = MA
hitflag = MAF
pausetime = 0,2
sparkno = -1
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 12
guard.slidetime = 12
guard.velocity = 0
air.velocity = 0,0
DOWN.velocity = 0,0
down.hittime = 12
fall = 1
fall.recover = 0
fall.recovertime = 60


[state 3020, posset]
type = posset
trigger1 = time = 0
y = -1800
x = enemynear,pos x - 60  + (random%120)


[state 3020, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3022

;-----------------------------------------------------------
;Explosion on Ground
[statedef 3022]
type = A
movetype = A
physics = N
velset = 0,0
anim = 3022
sprpriority = 3

[State 3020, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3022, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HP
persistent = 0
animtype  = Hard
damage    = 17,ifelse(p2statetype = A, 8, 2)
guardflag = MA
givepower = 41
getpower = 0
hitflag = MAFD
pausetime = 0,4
sparkno = -1
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = 0,-8
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -22
air.velocity = 0,-12
DOWN.velocity = 0,0
down.hittime = 24
fall = 1
fall.recover = 0
fall.recovertime = 60

[state 3022, posadd]
type = posadd
trigger1 = time = 0
y = -50

[state 3022, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3022, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,1

[state 3022, end]
type = destroyself
trigger1 = animtime = 0
ignorehitpause = 1

;-----------------------------------------------------------
;Explosion
[statedef 3023]
type = A
movetype = A
physics = N
velset = 0,0
anim = 3022
sprpriority = 3

[State 3020, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3022, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HP
persistent = 0
animtype  = Hard
damage    = 17,ifelse(p2statetype = A, 8, 2)
guardflag = MA
hitflag = MAFD
pausetime = 0,4
givepower = 41
getpower = 0
sparkno = -1
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = 0,-8
guard.hittime = 12
guard.slidetime = 12
guard.velocity = 0
air.velocity = 0,-12
DOWN.velocity = 0,0
down.hittime = 24
fall = 1
fall.recover = 0
fall.recovertime = 60


[state 3022, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3022, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,1

[state 3022, end]
type = destroyself
trigger1 = animtime = 0
ignorehitpause = 1

;------------------------------------------------------------------------------
;Last Missile
[statedef 3024]
type = A
movetype = A
physics = N
velset = 30, -80
anim = 3020
ctrl = 0
sprpriority = 2

[state 3024, nothitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 3024, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 3027
slot = 1
time = 1
ignorehitpause = 1

[state 3024, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,0

[State 3024, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3024, 2]
type = HitDef
trigger1 = !movecontact
attr = A, HP
persistent = 0
animtype  = Hard
damage    = 3,1
guardflag = MA
hitflag = MAF
pausetime = 0,2
givepower = 42
getpower = 0
sparkno = -1
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 12
guard.slidetime = 12
guard.velocity = 0
air.velocity = 0,0
DOWN.velocity = 0,0
down.hittime = 12
fall = 1
fall.recover = 0
fall.recovertime = 60

[state 3024, changestate]
type = changestate 
trigger1 = movecontact
trigger2 = movereversed
value = 3027
ignorehitpause = 1


[state 3024, changestate]
type = changestate
trigger1 = pos y < -1800
trigger2 = time > 150
value = 3025

;----------------------------------------------------------
;Last Missile
[statedef 3025]
type = A
movetype = A
physics = N
velset = 0,64
anim = 3021

[state 3025, nothitby]
type = hitby
trigger1 = 1
value = SCA, AP
ignorehitpause = 1

[state 3025, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 3027
slot = 1
time = 1
ignorehitpause = 1

[state 3025, movecontact]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 3027
ignorehitpause =1 

[State 3025, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3025, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = A, HP
animtype  = Hard
damage    = 3,1
guardflag = MA
hitflag = MAF
pausetime = 0,2
givepower = 42
getpower = 0
sparkno = -1
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = 0,0
guard.hittime = 12
guard.slidetime = 12
guard.velocity = 0
air.velocity = 0,0
DOWN.velocity = 0,0
down.hittime = 12
fall = 1
fall.recover = 0
fall.recovertime = 60


[state 3025, posset]
type = posset
trigger1 = time = 0
y = -1800
x = enemynear,pos x - 60  + (random%120)


[state 3025, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3026

;-----------------------------------------------------------
;Explosion on Ground
[statedef 3026]
type = A
movetype = A
physics = N
velset = 0,0
anim = 3022
sprpriority = 3

[State 3026, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3026, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HP
persistent = 0
animtype  = Hard
damage    = 17,ifelse(p2statetype = A, 8, 2)
guardflag = MA
hitflag = MAFD
pausetime = 0,12
sparkno = 0
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -30,-24
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -27
air.velocity = -30,-21
DOWN.velocity = 0,0
p1sprpriority = 3
down.hittime = 24
fall = 1
fall.recover = 0
fall.recovertime = 60

[state 3026, posadd]
type = posadd
trigger1 = time = 0
y = -50

[state 3026, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3026, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,1

[state 3026, end]
type = destroyself
trigger1 = animtime = 0
ignorehitpause = 1

;-----------------------------------------------------------
;Explosion
[statedef 3027]
type = A
movetype = A
physics = N
velset = 0,0
anim = 3022
sprpriority = 3

[State 3027, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[State 3027, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HP
persistent = 0
animtype  = Hard
damage    = 17,ifelse(p2statetype = A, 8, 2)
guardflag = MA
hitflag = MAFD
pausetime = 0,12
sparkno = 0
sparkxy = -40,-300
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 23
ground.hittime  = 23
ground.velocity = -30,-24
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -27
p1sprpriority = 3
air.velocity = -30,-21
DOWN.velocity = 0,0
down.hittime = 24
fall = 1
fall.recover = 0
fall.recovertime = 60


[state 3027, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3027, playsnd]
type = playsnd
trigger1 = time = 0
value = 3010,1

[state 3027, end]
type = destroyself
trigger1 = animtime = 0
ignorehitpause = 1


;===========================================================================
; Super:   Fortify
;Defense boost till end of round

;===========================================================================
[statedef 3040]
type = S
movetype = I
physics = S
anim = 3040
ctrl = 0



[state 3040, Panacea]
type = helper
triggerall = var(32) > 0
trigger1 = time = 52
trigger1 = !Numhelper(4000)
trigger1 = !numexplod(4000)
stateno = 4020
postype = p1
pos = -600, -720
ownpal = 1
id = 4000
name = "Panacea Cow - Healing"
ignorehitpause = 1

[state 1200, Panacea summon Count]
type = varadd
triggerall = var(32) > 0
trigger1 = time = 52
trigger1 = !Numhelper(4000)
trigger1 = !numexplod(4000)
var(42) = 1
ignorehitpause =1 
persistent = 0




[state 3040, capped]
type = helper
trigger1 = var(15) >= 3
trigger1 = animelemtime(6) = 10
stateno = 3049
id = 3049
postype = back
pos = 0,0
ownpal = 1


[state 3040, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 10
value = 3040,0

[state 3040, Rank Up]
type = varadd
trigger1 = animelemtime(6) = 10
var(15) = 1
ignorehitpause = 1



[state 3040, shockwaves]
type = explod
trigger1 = animelemtime(4) > 61 && animelemtime(6) <10
anim = F61
postype = p1
pos = 0,0
scale = 2.1,1.5
sprpriority = -2
persistent = 8

[state 3040, Shields]
type = explod
trigger1 = animelemtime(4) > 60 && animelemtime(6) < 10
anim = 3047
postype = p1
pos = const(size.mid.pos.x)-150 + random%300,const(size.mid.pos.y)-200 + random%400
scale = 1, 1
sprpriority = 4
persistent = 3 * var(15)
vel = -5+random%10, -5+random%5
accel = 0,-0.22

[state 3040, Rank Up Text]
type = explod
trigger1 = time = 60
anim = ifelse(facing = 1, 3045, 3046)
postype = p1
pos = -60,-600
removeongethit = 1
ontop = 1
ownpal = 1
bindtime = -1
ignorehitpause = 1 
scale = const(size.xscale)*2, const(size.yscale)*2


[state 3040, no bg]
type = assertspecial
trigger1 = time = [0,60]
flag = nobg
ignorehitpause = 1

[State 3001, Super Pause]
type = SuperPause
trigger1 = time = 0
sound = S3000, 0
poweradd = -1000
pos = 10,-370
time = 60
movetime = 60
ignorehitpause =1 
persistent = 0

[state 3001, Super Portrait]
type = explod
trigger1 = time = [0,14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1
ignorehitpause =1 

[state 3001, Super Portrait]
type = explod
trigger1 = time = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1
ignorehitpause = 1


[state 3001, End]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Temporary High defense
[statedef 3049]
type = A
movetype = I
physics = N
anim = 9999
velset = 0,0



[state 3049, removeself]
type = changestate
triggerall = root,movetype != H
trigger1 = time >= 900
value = 3048

;---------------------------------------------------------------------------
[statedef 3048]
type = A
movetype = I
physics = N
anim = 9999
velset = 0,0

[state 3049, parentvaradd]
type = parentvaradd
trigger1 = time = 0
var(15) = -1
persistent = 0

[state 3049, removeself]
type = destroyself
trigger1 = time = 1








;===========================================================================
; Panacea States
;===========================================================================
;Entrance - Breast Crush Vertical
[statedef 4000]
type = S
movetype = I
physics = S
anim = 4100
sprpriority = -1

[state  4000, posset]
type = posset
trigger1 = time = 0
y = 0

[state  4000, Playsnd]
type = playsnd
value = S4520,0
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
persistent = 1

[state  4000, envshake]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12

[state  4000, Panacea Run Speed]
type = velset
trigger1 = 1
x = 28
y = 0

[state  4000, gravity]
type = null; gravity
trigger1 = 1

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4000, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4000, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance to Andy:  %d"
params = rootdist x
persistent = 1

[state  4000, land]
type = changestate
trigger1 = rootdist x = [0,350]
value = 4001

[state  4000, End]
type = destroyself
trigger1 = frontedgebodydist < -400

;-------------------------------------------------------------------------
; Landing
[statedef 4001]
type = C
movetype = I
physics = C
anim = 4011



[state 4001, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4001, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1


[state  4001, posset]
type = posset
trigger1 = time = 0
y = 0

[state  4001, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[state  4001, playsnd]
type = playsnd
trigger1 = time = 0
value = 4500,0

[state  4001, playsnd]
type = playsnd
trigger1 = time = 0
value = 4520,0

[state  4001, playsnd]
type = playsnd
trigger1 = time = 2
value = 4520,0

[state  4001, envshake]
type = envshake
trigger1 = time =  0
ampl = -12
time = 15

[state 4001, playsnd]
type = playsnd
trigger1 = animtime = -2
value = 4510,0

[state  4001, Jump]
type = changestate
trigger1 = animtime = 0
value = 4002

;-----------------------------------------------------------------------
;Jump
[statedef 4002]
type = A
movetype = A
physics = N
anim = 4012
sprpriority = -1

[state  4002, Sprite Layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4015)
id = 4015
anim = 4015
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ignorehitpause = 1
sprpriority = 4
removeongethit = 1
bindtime = -1

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state  4002, sprpriority]
type = sprpriority
trigger1 = time = 12
value = 2


[State  4002, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state  4001, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[State  4002, 3]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
trigger1 = pos y < enemynear,pos y
persistent = 0
attr = A, SA
damage    = 180,18
guardflag = HA
hitflag = MAF
getpower = 100
givepower = 250
id = 4500
nochainid = 1400
priority = 3
pausetime = 0,0
guard.pausetime = 15,15
sparkno = 3
sparkxy = 0,0
hitsound   = F5,4
guardsound = F6,0
animtype = heavy
p1sprpriority = 2
p2sprpriority = 3
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -80            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -27,6
airguard.hittime = 35
guard.dist = 640
guard.kill = 0
kill = 0

[state 4002, bounce]
type = velmul
trigger1 = moveguarded
x = -0.25
persistent = 0

[state 4002, bounce]
type = veladd
trigger1 = moveguarded
y = -15
persistent = 0


;Ride down mechanic
[state  4002, Ride down]
type = targetbind
triggerall = !moveguarded
trigger1 = movehit
trigger1 = target,statetype = A
pos = 100, -40


[state  4002, state of ride down]
type = targetstate
triggerall = !moveguarded
trigger1 = movehit
trigger1 = target,statetype = A
value = 655

[state  4002, Crushed]
type = targetstate
triggerall = !moveguarded
trigger1 = movehit
trigger1 = target,statetype != A
value = 660
;-------------

[state  4002, jump]
type = velset
trigger1 = time = 0
x =  Floor(p2bodydist x *0.025)
y = -35

[state  4002, gravity]
type = gravity
trigger1 = time > 1

[state  4002, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4003
ignorehitpause = 1
;-------------------------------------------------------------------------
;Intro
[statedef 4190]
type = S
anim= 4190
sprpriority = -1

[state 4190, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4190, Breast]
type = explod
trigger1 = !numexplod(4191)
trigger1 = time = 0
id = 4191
anim = 4191
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = 2

[state 4190, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4190, changeanim]
type = changeanim
trigger1 = animtime = 0
trigger1 = anim = 4190
value = 4004

[state 4190, turn]
type = turn
trigger1 = animelemtime(1) = 1
trigger1 = anim = 4004

[state 4190, changeanim]
type = changeanim
trigger1 = anim = 4004
trigger1 = animtime = 0
value = 4000

[state 4190, exit]
type = changestate
trigger1 = anim = 4000
trigger1 = animtime = 0
value = 4005
;----------------------------------------------------------------------
;Breast Crush landing 1
[statedef  4003]
type = C
movetype = A
physics = N
anim = 4013

[state 4003, Sprite Layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4016)
id = 4016
anim = 4016
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ignorehitpause = 1
sprpriority = 4
removeongethit = 1
bindtime = -1

[state  4003, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4015

[state 4003, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state 4003, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state  4003, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[State  4003, 3]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, SA
damage    = 180,18
guardflag = 
hitflag = FD
getpower = 250
givepower = 200
id = 4510
nochainid = 1400
priority = 3
pausetime = 0,0
sparkno = 3
sparkxy = 0,0
p1sprpriority = 2
p2sprpriority = 4
hitsound   = F5,4
guardsound = F6,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -30            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -18,4
airguard.hittime = 35
guard.dist = 640
p2stateno = 660
guard.kill = 0 
kill = 0

[state  4003, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state  4003, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state  4003, envshake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 15

[state 4003, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state  4003, pos]
type = posset
trigger1 = time = 0
y = 0

[state  4003, Bounce]
type = velset
trigger1 = time = 12
y = -15


[state  4003, gravity]
type = gravity
trigger1 = pos y < 0

[state  4003, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4004

;---------------------------------------------------------------------------
;Breast Crush landing 2
[statedef  4004]
type = C
movetype = A
physics = N
anim = 4014

[state  4004, Sprite Layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4017)
id = 4017
anim = 4017
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ignorehitpause = 1
sprpriority = 4
removeongethit = 1
bindtime = -1

[state 4004, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4016

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4xxx, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1


[state 4004, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[state 4004, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0
volumescale = 70

[state 4004, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state  4004, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4004, pos]
type = posset
trigger1 = time = 0
y = 0


[state 4004, limiter]
type = explod
trigger1 = animtime = -1
anim = 9400
id = 4000
removetime = 361
postype = back
pos = 0,0

[state 4004, poweradd]
type = poweradd
trigger1 = animtime = 0
value = 250
ignorehitpause = 1

[state  4004, destroyself]
type = changestate
trigger1 = animtime = 0
value = 4510
;-------------------------------------------------------------
;Panacea Healing Jump in
[statedef 4020]
type = A
movetype = I
physics = N
anim = 4010
velset = 10, 80
sprpriority = -1

[state  4020, gravity]
type = gravity
trigger1 = 1

[state  4020, NOTHITBY]
type = nothitby
trigger1 = 1
value = SCA

[state  4020, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4021

;-------------------------------------------------------------------------
; Landing
[statedef  4021]
type = C
movetype = I
physics = C
anim = 4011
velset = 0,0


[state  4021, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1


[state  4021, posset]
type = posset
trigger1 = time = 0
y = 0

[state  4021, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[state  4021, playsnd]
type = playsnd
trigger1 = time = 0
value = 4500,0

[state  4021, playsnd]
type = playsnd
trigger1 = time = 0
value = 4520,0

[state  4021, playsnd]
type = playsnd
trigger1 = time = 2
value = 4520,0

[state  4021, envshake]
type = envshake
trigger1 = time =  0
ampl = -12
time = 15

[state  4021, playsnd]
type = playsnd
trigger1 = animtime = -2
value = 4510,0

[state  4021, Jump]
type = changestate
trigger1 = animtime = 0
value =  4022

;--------------------------------------------------------------
;Panacea Heal Cast
[statedef 4022]
type = S
movetype = A
physics = S
anim = 4020

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state  4022, nothitby]
type = nothitby
trigger1 = animelemtime(5) > 2  && animelemtime(9) < 0
value = ,AP
ignorehitpause = 1

[state  4022, lifeadd]
type = null;lifeadd
triggerall = rootdist x = [-200,400]
trigger1 = animelemtime(6) = 0
value = 160
persistent = 0
ignorehitpause = 1

[state  4022, Helper]
type = null;helper
trigger1 = animelemtime(6) = 0
postype = p1
pos = 380, -340
stateno = 2500
id = 2500
name = "Healing shot"
ownpal = 1

[state 4022, Confirmation]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 2500,0
persistent = 0

[state 4022, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state  4022, end]
type = changestate
trigger1 = animtime = 0
value = 4005

;==============================================================
;Panacea Wall Crush
;==============================================================
;Entrance - Breast Crush Vertical
[statedef 4030]
type = A
movetype = I
physics = S
anim = 4100
sprpriority = -1

[state  4030, posset]
type = posset
trigger1 = time = 0
y = 0

[state  4030, Playsnd]
type = playsnd
value = S4520,0
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
persistent = 1

[state  4030, envshake]
type = envshake
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12

[state  4030, Panacea Run Speed]
type = velset
trigger1 = 1
x = 28
y = 0

[state  4030, gravity]
type = null; gravity
trigger1 = 1

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4030, nothitbyprojectiles]
type = hitby
trigger1 = 1
value = SCA, AA,AP
IGNORehitpause = 1

[state  4030, land]
type = changestate
trigger1 = p2bodydist x =[200,500]
trigger1 = p2bodydist y = [-800,0]
value = 4031

[state  4030, End]
type = destroyself
trigger1 = frontedgebodydist < -400

;--------------------------------------------------------------
;Panacea Jump
[statedef  4031]
type = S
movetype = A
physics = S
anim = 4040

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4XXX, Not throwable]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state  4031, Jump]
type = velset
trigger1 = animelemtime(2) = 0
x = 36
y = -21

[State  4031, 2]
type = HitDef
trigger1 = Time = 0
attr = S, SA
animtype  = Heavy
damage    = 40,32
guardflag = MA
getpower = 70
givepower = 80
id = 4030
pausetime = 0,0
guard.pausetime = 14,14
sparkno = 0
sparkxy = -40,-180
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 15
ground.hittime  = 15
ground.velocity = -14
air.velocity = -10,-14
guard.hittime = 15
p1stateno = 4032
p2stateno = 4050
p2facing = 1
guard.velocity = -80
guard.slidetime = 15
guard.kill = 0
airguard.velocity = -21, -4
kill = 0

[state  4031, Statetype]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
physics = N

[state  4031, Gravity]
TYPE = GRAVITY
trigger1 = pos y < 0

[state  4031, Bounce off Block]
type = velmul
trigger1 = moveguarded
x = -0.25

[state  4031, Miss Landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value =  4038
;----------------------------------------------------------------------------
;Carry to wall
[statedef  4032]
type = A
movetype = A
physics = N
anim = 4041

[state 4032, combo scaling]
type = parentvaradd
trigger1 = time = 0
var(18) = -27
ignorehitpause = 1
persistent = 0

[state  4032, no y axis movement]
type = velset
trigger1 = time = 0
y = 0

[state  4032, targetbind]
type = targetbind
trigger1 = 1
pos = 425, -235
id = 4030

[state  4032, velset]
type = Velset
trigger1 = time = 0
x = 36

[state 4032, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance to wall: %d"
params = frontedgebodydist

[state  4032, Crash!!]
type = changestate
trigger1 = frontedgebodydist < 320
value =  4033

;----------------------------------------------------------------------------
;Wall Crash and Jump off
[statedef 4033]
Type = A
movetype = A
physics = N
anim = 4042


[state  4033, targetstate]
type = targetstate
trigger1 = time = 0
value = 4051

[state 4033, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = Ceil(parent,fvar(10) * -120)
id = 4030
kill = 0

[state 4033, poweradd]
type = poweradd
trigger1 = time = 0
value = 70


[state 4033, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4033, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4033, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 16


[state 4033, sprpriority]
type = sprpriority
trigger1 = animelemtime(4) = 0
value = -2

[state 4033, STOP]
type = velset
trigger1 = time = 0
x = 0

[state 4033, posset]
type = posset
trigger1 = animelemtime(4) < 0
x = (facing*(gamewidth/2))
y = 0
persistent = 1

[state 4033, bounce off wall]
type = velset
trigger1 = animelemtime(4) = 0
x = -27
y = -24

[state  4033, targetstate]
type = targetstate
trigger1 = animelemtime(4) = 0
value = 4052

[state 4033, gravity]
type = gravity
trigger1 = animelemtime(4) > 0
trigger1 = pos y < 0

[state 4033, end]
type = changestate
trigger1 = animelemtime(4) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4034

;---------------------------------------------------------------------------
; Landing
[statedef  4034]
type = C
movetype = I
physics = C
anim = 4011

[state  4034, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0


[state  4034, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state  4034, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1


[state  4034, posset]
type = posset
trigger1 = time = 0
y = 0

[state  4034, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[state  4034, playsnd]
type = playsnd
trigger1 = time = 0
value = 4500,0

[state  4034, playsnd]
type = playsnd
trigger1 = time = 0
value = 4520,0

[state  4034, playsnd]
type = playsnd
trigger1 = time = 2
value = 4520,0

[state  4034, envshake]
type = envshake
trigger1 = time =  0
ampl = -12
time = 15

[state  4034, playsnd]
type = playsnd
trigger1 = animtime = -2
value = 4510,0

[state  4034, Jump]
type = changestate
trigger1 = animtime = 0
value = 4005


;----------------------------------------------------------------------------
;Panacea Landing
[statedef 4038]
type = C
movetype = I
physics = N
anim = 4013

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4XXX, Not throwable]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4038, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4038, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 12

[state 4038, stop]
type = velset
trigger1 = time = 0
y = 0

[STATE 4038, velmul]
type = velmul
trigger1 = time = 0
x = 0.25

[state 4038, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4038, bounce]
type = velset
trigger1 = time = 8
y = -15

[state 4038, gravity]
type = gravity
trigger1 = pos y < 0

[state 4038, Miss Landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4039

;----------------------------------------------------------------------------
;Panacea Landing 2
[statedef  4039]
type = C
movetype = I
physics = C
anim = 4014

[state 4038, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0
volumescale = 50

[state 4038, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4XXX, Not throwable]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4039, stop]
type = velset
trigger1 = time = 0
y = 0

[state 4039, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4039, Miss Landing]
type = changestate
trigger1 = animtime = 0
value = 4510


;--------------------------------------------------------------
; Panacea Victim Wedge in breast
;--------------------------------------------------------------

[statedef 4050]
type = A
movetype = H
physics = N

[state 4050, anim]
type = changeanim2
trigger1 = time = 0
value = 4050

[state 40450, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4050, freedom]
type = selfstate
trigger1 = !gethitvar(isbound)
trigger1 = time > 20
value = 5050


;--------------------------------------------------------------
[statedef 4051]
type = A
movetype = H
physics = N
velset = 0,0

[state 4041, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4041, anim]
type = changeanim
trigger1 = time = 0
value = 5110

[state 4041, rotate]
type = angledraw
trigger1 = anim = 5110
value = -90

[state 4041, posset]
type = posset
trigger1 = time = 0
x = -(facing*(gamewidth/2))
y = -100 + const(size.mid.pos.y)
;----------------------------------------------------------------------------
;fall off wall
[statedef 4052]
type = A
movetype = H
physics = N
velset = 8,-8

[state 4041, posadd]
type = posadd
trigger1 = time = 0
y = -const(size.mid.pos.y)

[state 4042, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4042, anim]
type = changeanim
trigger1 = time = 0
value = 5051

[state 4042, anim]
type = changeanim
trigger1 = vel y > 0
trigger1 = anim != 5061
value = 5061


[state 4042, angledraw]
type = angledraw
trigger1 = time < 36
scale = 0.6,1.1
value = 0

[state 4042, velmul]
type = velmul
trigger1 = time = 36
x = 0.25

[state 4042, veladd]
type = veladd
trigger1 = time < 36
y = 0.44

[state 4042, veladd]
type = veladd
trigger1 = time >= 36
y = 1.22

[state 4042, nothitby]
type = null;nothitby
trigger1 = 1
value = SCA

[state 4042, nothitby]
type = nothitby
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = SCA
time = 36

[state 4042, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100


;---------------------------------------------------------------------

;Assist Squash
[statedef 4065]
type = A
movetype = A
physics = N
anim = 4030
sprpriority = 2

[state 4065, Sprite Layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4035)
id = 4035
anim = 4035
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ignorehitpause = 1
sprpriority = 4
removeongethit = 1
bindtime = -1

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state 4065, sprpriority]
type = sprpriority
trigger1 = time = 12
value = 3


[State 4065, attack scaling]
type = attackMulSet
trigger1 = 1
value = root,fvar(10)
ignorehitpause = 1

[state 4051, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[State 4065, 3]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, SA
damage    = 120,12
guardflag = HA
hitflag = MAF
getpower = 100
givepower = 250
id = 4500
nochainid = 1400
priority = 3
pausetime = 0,0
sparkno = 3
sparkxy = 0,0
hitsound   = F5,4
guardsound = F6,0
animtype = heavy
p1sprpriority = -2
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -40            
guard.hittime = 42
guard.slidetime = 42
airguard.velocity = -18,4
airguard.hittime = 35
guard.dist = 640
guard.kill = 0
kill = 0


;Ride down mechanic
[state 4065, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = target,statetype = A
pos = 100, -40

[state 4065, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype = A
value = 655

[state 4065, Crushed]
type = targetstate
trigger1 = movehit
trigger1 = target,statetype != A
value = 660
;-------------

[state 4065, jump]
type = velset
trigger1 = time = 0
x =  0
y = 10

[state 4065, gravity]
type = gravity
trigger1 = time > 1

[state 4065, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4066
ignorehitpause = 1

;------------------------------------------------------------------------

;Butt Drop landing 1
[statedef 4066]
type = C
movetype = A
physics = N
anim = 4031
sprpriority = 2

[state 4066, Sprite Layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4036)
id = 4036
anim = 4036
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ignorehitpause = 1
sprpriority = 4
removeongethit = 1
bindtime = -1

[state 4066, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4035

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4066, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[State 4066, 3]
type = HitDef
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, SA
damage    = 120,12
guardflag = 
hitflag = FD
getpower = 250
givepower = 200
id = 4510
nochainid = 1400
priority = 3
pausetime = 0,0
sparkno = 3
sparkxy = 0,0
hitsound   = F5,4
guardsound = F6,0
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -30            
guard.hittime = 42
guard.slidetime = 42
p2sprpriority = 3
airguard.velocity = -18,4
airguard.hittime = 35
guard.dist = 640
p2stateno = 660
guard.kill = 0 
kill = 0

[state 4066, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4066, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4066, envshake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 15

[state 4502, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4066, pos]
type = posset
trigger1 = time = 0
y = 0

[state 4066, Bounce]
type = velset
trigger1 = time = 12
y = -15


[state 4066, gravity]
type = gravity
trigger1 = pos y < 0

[state 4066, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4067

;---------------------------------------------------------------------------
;Butt Drop landing 2
[statedef 4067]
type = C
movetype = A
physics = N
anim = 4032
sprpriority = 2

[state 4067, Sprite Layering]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(4037)
id = 4037
anim = 4037
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
ignorehitpause = 1
sprpriority = 4
removeongethit = 1
bindtime = -1

[state 4067, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 4036

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1

[state 4xxx, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1


[state 4067, NOTHITBY]
type = nothitby
trigger1 = 1
value = ,AT

[state 4067, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0
volumescale = 70

[state 4067, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 4067, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4067, pos]
type = posset
trigger1 = time = 0
y = 0


[state 4067, limiter]
type = explod
trigger1 = animtime = -1
anim = 9400
id = 4000
removetime = 361
postype = back
pos = 0,0

[state 4067, poweradd]
type = poweradd
trigger1 = animtime = 0
value = 250
ignorehitpause = 1



[state 4067, destroyself]
type = changestate
trigger1 = animtime = 0
value = 4510

;----------------------------------------------------------

;--------------------------------------------------------------
;Panacea Exit
[statedef 4005]
type = S
movetype = I
physics = S
anim = 4000
sprpriority = -2

[state  4005, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state  4005, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state  4005, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4005, turn animation]
type = changeanim
trigger1 = backedgebodydist < frontedgebodydist
trigger1 = time = 6
value = 4004


[state  4005, Turn or not]
type = turn
trigger1 = backedgebodydist < frontedgebodydist
trigger1 = time = 6


[state 4005, changeanim]
type = changeanim
trigger1 = anim = 4004
trigger1 = animtime = 0
value = 4000

[state  4005, changeanim]
type =  changeanim
trigger1 = time = 24
trigger1 = anim != 4100
value = 4100

[state  4005, Jump]
type = velset
trigger1 = anim = 4100
x = 24

[state  4005, Playsnd]
type = playsnd
value = S4520,0
triggerall = anim = 4100
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
persistent = 1

[state  4005, envshake]
type = envshake
triggerall = anim = 4100
trigger1 = animelemtime(2) = 0
trigger2 = animelemtime(6) = 0
ampl = -8
time = 12

[state  4005, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 4005, Timer]
type = Explod
triggerall = !numexplod(4000)
trigger1 = backedgebodydist < -200
trigger2 = frontedgebodydist < -500
id = 4000
postype = back
pos = 0,0
anim = 4999

[state  4005, destroyself]
type = destroyself
trigger1 = backedgebodydist < -500
trigger2 = frontedgebodydist < -800
ignorehitpause = 1

;-------------------------------------------------------
;Pancea Fall in (win Pose)
[statedef 4180]
type = A
movetype = I
anim = 4010
sprpriority = -3

[state 4180, gravity]
type = gravity
trigger1 = pos y < 0

[state 4180, End]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4181

;--------------------------------------------------------
[statedef 4181]
type = S
movetype = I
anim = 4180

[state 4181, Shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1.5
sprpriority = -3

[state 4181, stop]
type = velset
trigger1 = time = 0
y = 0

[state 4181, on ground]
type = posset
trigger1 = time = 0
y = 0


[state 4181, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 15

[state 4181, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4181, animation]
type = changeanim
trigger1 = time = 90
value = 4004

[state 4181, changeanim]
type = changeanim
trigger1 = anim = 4004
trigger1 = animtime = 0
value = 4000

[state 4181, Turn]
type = turn
trigger1 = time = 90

[state 4181, sprpriority]
type = sprpriority
trigger1 = time = 91
value = 4

[state 4181, changeanim]
type = changeanim
trigger1 = time = 128
value = 4181

[state 4181, statetypeset]
type = statetypeset
trigger1 = anim = 4181
trigger1 = animelemtime(2) = 0
Physics = N
statetype = A

[state 4181, velset]
type = velset
trigger1 = anim = 4181
trigger1 = animelemtime(2) = 0
x = rootdist x * 0.04
y = -24

[state 4181, gravity]
type = gravity
trigger1 = pos y < 0

[state 4181, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -100
trigger1 = anim = 4181
value = 4182

;-----------------------------------------------------------------------------
;Landing
[statedef 4182]
type = S
anim = 4182

[state 4181, Shockwave]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1.5
sprpriority = -3

[state 4182, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4182, posset]
type = posset
trigger1 = time = 0
y = 0
x = root, pos x

[state 4182, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 15

[state 4182, playsnd]
type = playsnd
trigger1 = time = 0
value = S810, 0






;----------------------------------------------------
;Panacea Get hit
[statedef 4500]
type = A
movetype = H
physics = N
anim = 4500

[state -3, playsnd]
type = playsnd
trigger1 = var(32) < 0
trigger1 = time = 0
value = 4011, 0
persistent = 0
ignorehitpause = 1

[state  4500, heal enemy!?!?!]
type = helper
trigger1 = time = 3
trigger1 = numhelper(2500) < 3
stateno = 2500
id = 2500
postype = p1
pos = 320, -300
ownpal = 1
ignorehitpause = 1

[state  4500, heal enemy!?!?!]
type = helper
trigger1 = time = 4
trigger1 = numhelper(2500) < 3
stateno = 2500
postype = p1
pos = 110, -290
ownpal = 1
id = 2500
ignorehitpause = 1

[state 4500, NOT LONGER HITABLE]
TYPE = nothitby
trigger1 = parent,var(32) <= 0
value = SCA
ignorehitpause = 1

[state 4XXX, no thrown]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state  4500, velset]
type = velset
trigger1 = time = 0
x = -floor(gethitvar(xvel) * 0.5)
y = ifelse(gethitvar(yvel) < 0, gethitvar(yvel), -5)

[state  4500, gravity]
type = gravity
trigger1 = 1

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno =  4500
slot = 1
ignorehitpause = 1
persistent = 1


[state 4601, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4501

;------------------------------------------------------
;Land on Butt 1
[statedef  4501]
type = C
movetype = H
physics = N
anim = 4501

[state 4600, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state  4501, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state  4501, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 12

[state 4501, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state 4XXX, no thrown]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4501, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4501, velset]
type = velset
trigger1 = animelemtime(2) = 0
x = -8
y = -15

[state 4501, gravity]
type = gravity
trigger1 = animelemtime(2) >= 0

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1


[state 4501, changestate]
type = changestate
trigger1 = animelemtime(2) > 0
trigger1 = vel Y > 0
trigger1 = pos y > -vel y
value = 4502

;------------------------------------------------------
;Land on Butt 2
[statedef 4502]
type = C
movetype = H
physics = N
anim = 4502

[state  4501, playsnd]
type = playsnd
trigger1 = time = 0
value = 810,0

[state 4601, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 4500, damage]
type = parentvaradd
trigger1 = gethitvar(damage) != 0
V = 32
value = ceil(-gethitvar(damage))
persistent = 1

[state 4XXX, no thrown]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4600, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 4600, posset]
type = posset
trigger1 = time = 0
y = 0

[state  4502, destroyself]
type = changestate
trigger1 = animtime = 0
value = 4510

[state 4XXX, Panacea gethit]
type = hitoverride
trigger1 = 1
attr  = SCA, AA,AP
stateno = 4500
slot = 1
ignorehitpause = 1
persistent = 1


;-----------------------------------------------------------------------
;Panacea Recover
[statedef 4510]
type = C
movetype = I
physics = C
anim = 4510
sprpriority = -2

[state 4505, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 4510, end]
type = changestate
trigger1 = animtime = 0
value = 4005


;---------------------------------------------------------------------------
;Hud display
[statedef 4900]
type = A
movetype = I
physics = N
anim = 9999
ctrl = 0

[state -3, playsnd]
type = playsnd
trigger1 = root,var(32) < 0
value = 4011, 0
persistent = 0
ignorehitpause = 1

[state 4900, value]
type = varset
trigger1 = 1
fvar(32) = root,var(32)
ignorehitpause = 1
persistent = 1

[state 4900, value]
type = varset
trigger1 = 1
fvar(34) = root,var(34)
ignorehitpause = 1
persistent = 1

[state 0, varset]
type = varset
trigger1 = time = 0
var(0) = 0


[State 0, VarSet]
type = Varadd
triggerall = numpartner
trigger1 = partner,name = "Katrina Crocodile" 
trigger2 = partner,name = "Twiggi Bunny"
var(0) = 75
persistent = 0

;Eliza health Bar
[state 4900, Icon]
type = explod
trigger1 = !numexplod(4900)
anim = 4900
id = 4900
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1, 12, 1268),(130 + var(0)) ;ifelse(teamside =1, (gamewidth0.01),(gamewidth0.99)),floor((gameheight0.18))
sprpriority = 5
OWNPAL = 1
bindtime = -1
removetime = -1



[state 4900, HP BAR]
type = explod
trigger1 = !numexplod(4910)
anim = 4910
id = 4910
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1, 102, 1178),(158 + var(0)) ;ifelse(teamside =1,(gamewidth0.08),(gamewidth0.92)),floor((gameheight0.22))
scale = 2, 2
sprpriority = 5
ownpal = 1
removetime = -1
bindtime = -1

[state 4900, HP BAR empty]
type = explod
trigger1 = !numexplod(4911)
anim = 4911
id = 4911
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1, 102, 1178),(158 + var(0)) ;ifelse(teamside =1,(gamewidth0.08),(gamewidth0.92)),floor((gameheight0.22))
Scale = 2,2
sprpriority = 5
ownpal = 1
bindtime = -1
removetime = -1

[state 4900, Defense Icon]
type = explod
trigger1 = !numexplod(4920)
anim = 4920
id = 4920
postype = Left
facing = ifelse(teamside = 1, 1, -1)
pos = ifelse(teamside = 1, 5, 1275), (200 + var(0))
scale = 1.25,1.25
sprpriority = 5
ownpal = 1
bindtime = -1
removetime = -1

[state 4900, Defense Level]
type = explod
trigger1 = 1
anim = 4929 +  parent,var(15)
id = 4930
postype = left
facing = ifelse(teamside = 1, 1, 1)
pos = ifelse(teamside = 1, 80, 1080), (220 + var(0))
scale = 2,2
sprpriority = 5
ownpal = 1
bindtime = -1
persistent = 1

[state 4900, modifier HP bar]
type = modifyexplod
trigger1 = numexplod(4910)
id = 4910
anim = 4910
scale = ifelse(fvar(32)>0,((fvar(32)*1)/(fvar(34)*1))*2,0) , 2
postype = left
pos = ifelse(teamside = 1, 102, 1178),(158 + var(0))

;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy projectile (helper). For use with AI. ( M.U.G.E.N | IKEMEN )
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy projectile helper distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy projectile helper velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
 
;==========================================================================
;                Detect Enemy Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = IfElse(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = IfElse(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = IfElse(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = IfElse(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = IfElse(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = IfElse(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = IfElse(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = IfElse(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = IfElse(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = IfElse(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 

;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------
[statedef -2]

;============================================
[state -2, Defense Scaling]
type = DefenceMulSet
trigger1 = 1
value = fvar(11)
ignorehitpause = 1

[state -2, gradual Buffing]
type= varset
trigger1 = var(15) = 1
fvar(11) = 0.9
ignorehitpause =1 

[state -2, gradual Buffing]
type= varset
trigger1 = var(15) = 2
fvar(11) = 0.75
ignorehitpause =1 

[state -2, gradual Buffing]
type= varset
trigger1 = var(15) = 3
fvar(11) = 0.66
ignorehitpause =1 

[state -2, gradual Buffing]
type= varset
trigger1 = var(15) = 4
fvar(11) = 0.5
ignorehitpause =1 

[state -2, Visual indicator]
type = palfx
triggerall = var(15) = 4
trigger1 = time%2
time = 1
add = 32,150,32 ;32,16,0
sinadd = 32,64,5,3
ignorehitpause

;------------------------------------------------------

[state -2, defensemulset]
type = null;lifeadd
triggerall = alive && movetype = H
trigger1 =(fvar(8) - life)> 0
value = ifelse((fvar(8)-life)< life, -floor((fvar(8)-life)/4),0)

[State -2, Combo]
type =null; VarSet
trigger1 = 1
fvar(8) = life
ignorehitpause = 1

;---------------------------------------------------





;============================================

;===========================================
;  Combo damage reduction
;===========================================

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar(10)
ignorehitpause = 1

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger2 = !numenemy
ignorehitpause = 1
v = 18
value = 100

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05

;===============================================================================
; Simple Counter
;===============================================================================

[state -2, counter]
type = varset
trigger1 = gethitvar(damage) != 0
v = 31
value = 0
ignorehitpause = 1

[state -2, count up]
type = varadd
trigger1 = var(31) < var(33)
v = 31
value = 1
ignorehitpause = 0

[state -2, delay conter set]
type = varset
trigger1 = 1
v = 33
value = 300


[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%6)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumbo Elephant"
value = 8+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ana 'Jiggly' Bunny"
value = 11+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Katrina Crocodile"
value = 14+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Bertha Hippo"
value = 17+(random%3)
ignorehitpause
persistent = 1


[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Aroma Skunk"
value = 20+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Enorma Pig"
value = 23+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Lardo Rat"
value = 26+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Zafta Giraffe"
value = 29+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Makuyama"
value = 32+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Pastilla Skunk"
value = 35+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumba Elephant"
value = 38+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Rapid Bunny"
value = 41+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Twiggi Bunny"
value = 44+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Julian Hippo"
value = 47+(random%3)
ignorehitpause
persistent = 1


[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Akai R. Panda"
value = 50+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Violet 'Tyla' Bunny"
value = 53+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Noah Sharker"
value = 56+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ra Lord"
value = 59+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Andy Armadillo"
value = 62+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Montana Moth"
value = 65+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Texas Stanton"
value = 68+(random%3)
ignorehitpause
persistent = 1




;------------------------------------------------------------------------------
;Limiters
;------------------------------------------------------------------------------
[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(8) = 2
ignorehitpause = 1

[state -2, Stun Limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(13) = 2
ignorehitpause = 1

[state -2, Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(11) = 2
ignorehitpause = 1

[state -2, Missile Stun Duration] ;Goes down in combos with multiple missiles to prevent infinites.
type = varset
triggerall = numenemy
triggerall = var(12) != 30
trigger1 = (enemynear,movetype != H)
var(12) = 30;36
ignorehitpause = 1

[state -2, Armor limiter]
type = varset
triggerall = var(20) != 100
trigger1 = stateno = 0
trigger2 = stateno = 52
trigger3 = stateno = 5120
var(20) = 80
ignorehitpause = 1



[state -2, Playsnd]
type = playsnd
triggerall = time = 1
trigger1 = stateno = 5100
trigger2 = stateno = 5110
value = S5000,1

[state -2, envshake]
type = envshake
triggerall = time = 1
trigger1 = stateno = 5100
trigger2 = stateno = 5110
ampl = -8
time = 12

[state -2, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = p2bodydist x, p2bodydist y, pos y , Var(15), fvar(11)
text = "Bodydist x: %d   y: %d  Pos Y:  %d  Armor Rank: %d  Defense mul: %f"
ignorehitpause = 1

;Run animations

[state -2, jet sound]
type = playsnd
triggerall = anim = 100
triggerall = stateno != 100
trigger1 = time = 0
value = 40,0

[state -2, Jetboots Explod]
type = explod
triggerall = anim = 100
triggerall = stateno != 100
trigger1 = !numexplod(100)
id = 100
anim = 2010
postype = p1
pos =  -240, -30
bindtime = -1
sprpriority = 0

[state -2, no Guard break]
type = changestate
trigger1 = stateno = 15910
value = 120
ctrl =1 
persistent = 1

[state -2, Jetboots Explod]
type = explod
triggerall = anim = 100
triggerall = stateno != 100
trigger1 = !numexplod(101)
id = 101
anim = 2010
postype = p1
pos =  -80, -60
bindtime = -1
sprpriority = 0

[state -2, Clank while dizzy]
type = playsnd
trigger1 = animelemtime(10) = 6
triggerall = anim = 5300
value = S40,1
persistent = 1

;===========================================================================
;Panacea Hud
;===========================================================================
[state -2, helper]
type = helper
triggerall = roundstate = 2
trigger1 = !numhelper(4900)
name = "Panacea Hud"
helpertype = normal
stateno = 4900
postype = p1
pos = 0,0
id = 4900
persistent = 300
ignorehitpause = 1

[state -2, Max Health Panacea]
type = varset
trigger1 = var(32) > var(34)
var(32) = var(34)


[state -2, Panacea healing]
type = varadd
triggerall = !numhelper(4000)
triggerall = roundstate = 2
triggerall = var(32) > 0
trigger1 = gametime%60 = 5
trigger1 = var(32) < var(34)
v = 32
value = 8
;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.


[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
value = 40, (random%2)+1

[state -3, Clank while dizzy]
type = playsnd
trigger1 = animelemtime(10) = 6
triggerall = anim = 5300
value = S40,1
persistent = 1

[state -3, landing quake]
type = envshake
triggerall = time = 1
trigger1 = stateno = 52
ampl = -4
time = 6

[state -3, Visual indicator]
type = palfx
triggerall = numhelper(4000)
trigger1 = helper(4000),stateno =  4022
trigger1 = helper(4000),animelem = 5
time = 8
add = 32,150,32 ;32,16,0
sinadd = 32,64,5,3
ignorehitpause
persistent = 1

[state -3, Panacea Heals Andy]
type = lifeadd
triggerall = numhelper(4000)
triggerall = movetype != H
trigger1 = helper(4000),stateno =  4022
trigger1 = helper(4000),animelem = 5
value = ifelse(var(15) < 3, 180, 60)
absolute = 1
ignorehitpause = 1
persistent = 8





;AI projectile detection
[state -3, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
;trigger1 = var(59) = 1 ;M.U.G.E.N below 1.0 that uses Winane's AI Activation Method.
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1