
; KFM's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 950
power = 5000
;attack power (more is stronger)
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 15
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1.1         ;Horizontal scaling factor.
yscale = 1.1         ;Vertical scaling factor.
ground.back = 150    ;Player width (back, ground)
ground.front = 130    ;Player width (front, ground)
air.back = 150        ;Player width (back, air)
air.front = 130       ;Player width (front, air)
height = 225         ;Height of player (for opponent to jump over)
attack.dist = 640    ;Default attack distance
proj.attack.dist = 360 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = -20, -360 ;Approximate position of head
mid.pos = -20, -240  ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 13.0      ;Walk forward
walk.back = -10.0     ;Walk backward
run.fwd  = 40, 0   ;Run forward (x, y)
run.back = -24,-10.0 ;Hop backward (x, y)
jump.neu = 0,-35.0   ;Neutral jumping velocity (x, y)
jump.back = -11.5,-33.6 ;Jump back Speed (x, y)
jump.fwd = 11.5,-33.6     ;Jump forward Speed (x, y)
runjump.back = -10.2,-32.4 ;Running jump speeds (opt)
runjump.fwd = 16,-32.5    ;.
airjump.neu = 0,-32.5     ;.
airjump.back = -11.5    ;Air jump speeds (opt)
airjump.fwd = 11.5          ;.
air.gethit.groundrecover = -.6,-14    ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-18     ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -4       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -8         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 6        ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 1      ;Number of air jumps allowed (opt)
airjump.height = 140 ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.5        ;Vertical acceleration
stand.friction = .85  ;Friction coefficient when standing
crouch.friction = .82 ;Friction coefficient when crouching
stand.friction.threshold = 8          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .2        ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 100          ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -80 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 40   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -4  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.4    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 60      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 80            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.6              ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 48          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .2          ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes **MUGEN 1.0**
;The default language victory quotes must be implemented in English.
[Quotes]
; Win Quotes
; Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory1 = "No one takes the threat of a chubby red panda seriously until 500 lbs of ass hits them in the face."
victory2 = "Super speed was more fun before I got in debt to the wrong crowd."
victory3 = "You just got a real nice look at the underside of these shorts.  Hope it was worth it."
victory4 = "I could of just outran you but I don't like running long distance.  "
victory5 = "Don't be embarassed by being outsped so much.  Despite how big I am super speed is still super speed."
victory6 = "I don't like fighting, but I do enjoy sitting on peeps."
victory7 = "You can't handle my mass nor my speed."

;Vs Jumbo / Mob Boss/Buissnessman;  Boss, Got loan sharks off of Akai, Works directly for.
victory8 = "You're power is scary but maybe now you should invest in trying to be a bit faster."
victory9 = "Don't get worried boss, after all you've done for me you're still in charge."
victory10 = "Maybe now you'll treat me as just as much a threat as Lardo and Makuyama."

;Vs Jiggly / Pro Wrestler/Massuse;  Doesn't know, both fast, both rush down.  EX girlfriend to rival
victory11 = "Damn, girl! Calm down. I don't know what happened to you but you don't have to be that aggressive."
victory12 = "Did you really weaponize twerking?!  That's so cool I wanna learn how to do that."
victory13 = "I think its badass that you go in so hard when you're in fight mode.  I could use confidence like that, but I rather not die."

;Vs Katrina / Pro Wrestler; Doesn't know.  Share's problem of excessive bust
victory14 = "When you get up can you give me any tips on how to handle my chest?  Just assuming you'd be an expert."
victory15 = "Weaponizing your chest seems like a fantastic idea.  I'm not sure I can do it like you though."
victory16 = "I hope you figured out how to avoid back pains and such issues.  I was hoping I could learn from you."

;vs Bertha / Pro Wrestler; Knows of, butt throwing techniques.
victory17 = "I can go one one one with the queen of ass attacks."
victory18 = "You're ass in motion is terrifying. I think I'll rather stick to just watching you." 
victory19 = "I've seen bigger than you before.  You're not as intimidating as you think you are."

;vs Aroma / War Profiteerer; doesn't know about
victory20 = "You sell poison gas to various gangs and mobs as well as make a perfume out of it?!  That's freaking brilliant!"
victory21 = "You better stick to just selling perfume trying gas me will get you beat each time."
victory22 = "Well I'll have to clean out my fur now.  Its not a big deal since I know a fantastic bathhouse."

;vs Enorma / Gun Toting Engineer; Doesn't know about.
victory23 = "You're guns aren't gonna save you from this ass!"
victory24 = "I may be fast but I'm quite a wide target, your guns make me feel uneasy."
victory25 = "I hope my ass did a number on you!  I dispise being shot at."

;vs Lardo / Fat ass, thug; works with, knows about.
Victory26 = "I think I'll pass on including some of your techniques on mine bro.  High speed booty doesn't need stink to it as well."
victory27 = "Nice try with your tail grabs, but it looks like you're having trouble keeping up with me Lardo."
victory28 = "You really are gonna need new tech.  Body odor is not a good weapon.  Plus the skunks kinda outdo you at it."

;vs Zafta / Tall athlete looking for work; Doesn't know 
Victory29 = "Oooow.  Your kicks really hurt, but don't think I won't be able to harm you."
victory30 = "Too bad for you that I'm a fantastic climber."
victory31 = "Ha girl,  you're head has a long distance to go to hit the ground.  That's easy to take advantage of."

;vs Makuayama / Sumo Panda, finds handsome, Has crush on.
victory32 = "I may have super speed but I like taking my time around you."
victory33 = "Wait, you were able to quit working for Jumbo and he just let you go?  How do I get out then?"
victory34 = "I miss being in your arms, your strength made me fell better about everything.  I really miss those times." 

;vs Pastilla / terrible fated, twosome merged together, witch.  Doesn't know.
victory35 = "I thought being in debt to the wrong guys weas bad, but you two have it way worse."
victory36 = "That really sucks what happened to ya, I hope you get your revenge."
victory37 = "You magic and stink won't be enough to stop me."

;vs Jumba / Sister of boss, has no interest in.  Doesnt' know personally.
victory38 = "Your brother rocks that look better than you do."
victory39 = "I know about the advantage of being faster than you look so you're not gonna trick me with that."
victory40 = "Fast, huge, strong what don't you have girl?  Oh yeah, the victory."

;vs Rapid / Super speed hero, rival, knows will flirt with.
victory41 = "Jumbo helped me more than you 'Super Heroes' ever did."
victory42 = "Bertha is gonna be mad at me for how hard I sit on you.  But like she could ever catch me."
victory43 = "All super heroes like you do is maintain a status quo.  A society for big bodies sounds way better than the BS we get now."

;vs Twiggi / Cursed Form Witch / Doesn't know, creeps out.
victory44 = "heh heh, Anyone ever tell you how creepy you look."
victory45 = "You're limbs may be long you have no mass on them."
victory46 = "You can teleport all you like, with super speed I'm never far from anyone."

;vs Violet / Ninja/ Fashion Designer/ Doesn't know.
victory47 = "By any chance can you make jogging shorts in my size.  Not like I don't like what I got now but I heard good things about you."
victory48 = "I love how you have multiple outfits to fight in.  Even if they are just variations of having pants or not."
victory49 = "Are we both named after colors that we are.  That's so simple."

;vs Julian / Underwear model/ Knows
victory50 = "Sorry I'm late for our photoshoot.  But I think ariviving like this is better for both of us."
Victory51 = "You're ass his like a freight train Julian.  "
victory52 = "We should team up.  We can be the flamboyant sexy boys!"

;Vs Himself
Victory53 = "I'm not a brand, there should only be one of me."
victory54 = "Seeing myself from of body is so delightful.  Look at my killer hips!"
victory55 = "Damn me!  I mean I knew I had fantastic body but being able to look at it like this just gets me."

;Vs Noah
Victory56 = "I'm not fond of having to go around projectiles for a seat."
victory57 = "Your whole crew got a nice view of me sitting on your face."
Victory58 = "You're quite cute and tiny for a shark, Noah."

;vs Ra
Victory59 = "So many snakes, are you someones nightmare fuel?  Even your hands are just more snakes."
Victory60 = "Did you think having fangs would save you from my rear?  The thickness of my ass has nothing to fear."
victory61 = "You're way more fancy looking than everyone else I've ran into.  Didn't really help you in combat though."

;Vs Texas
Victory62 = "Oh hun, don't talk to me about laws.  You'd never catch me anyway nor would you be able to handle all of me."
Victory63 = "Shoving my ass into your face at high speed is one of the more enjoyable things I've done this week."
Victory64 = "Do the Outlaws of the past have a habbit of sitting on you?  Since you're extremly comfy to sit on, like you've been worn down to being a perfect butt cushion."
;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
;var(3) projectile detect
;var(4) = running stance
;var(5) = bounce count.
;Var(12) = Option
;var(24) = reversal option
;var(23) = Butt kiss count

;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
; Win pose 1 - Jump
; CNS difficulty: basic
[Statedef 181]
type = S
physics = N
ctrl = 0
anim = 181
velset = 0,0

[state 181, Jump]
type = velset
trigger1 = animelemtime(2) = 0
y = -15
x = -facing*(pos x *0.03)

[state 181, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 182

[state 181, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A

[state 181, gravity]
type = gravity
trigger1 = pos y < 0

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;-------------------------------------------------------------------------------
;Landing
[statedef 182]
type = S
physics = S
anim = 182

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 6
;trigger1 = life != lifemax
value = S180,1

[state 182, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 182, on ground]
type = posset
trigger1 = time = 0
y = 0

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 52, 4]
type = EnvShake
trigger1 = time = 0
time = 12
ampl = 6

[state 182, playsnd]
type = playsnd
trigger1 = time = 0
value = 40,0




;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0
sprpriority = -2

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190
persistent = 1

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 1,1
postype = Back
pos = ifelse(facing =1, 20, 157),360 ; Nice!
ontop = 1

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 190, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 190,0


[State 191, Keda]
type = Explod
trigger1 = time = 0
trigger1 = !numexplod(1910)
persistent = 0
anim = 1910
id = 1910
postype = p1
pos = 0, 0
scale = const(size.xscale),const(size.yscale)
sprpriority = -1
removetime = -1

[State 191, Extra Limb]
type = Explod
trigger1 = time = 0
trigger1 = !numexplod(1930)
persistent = 0
anim = 1930
id = 1930
postype = p1
pos = 0, 0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
removetime = -1

[State 191, Extra Limb]
type = Explod
trigger1 = roundstate != 0
trigger1 = !numexplod(193)
anim = 193
id = 193
postype = p1
pos = 0, 0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
persistent = 0

[state 191, sprpriority]
type = sprpriority
trigger1 = animelemtime(8) = 0
value = 0

[state 191, modifyexplod]
type = modifyexplod
trigger1 = animelemtime(8) = 0
id = 191
postype = p1
pos = 0,0
velocity = -24,-15
accel = 0, 1.22

[state 191, modifyexplod]
type = modifyexplod
trigger1 = animelemtime(8) = 0
id = 192
postype = p1
pos = 0,0
velocity = -12,-8
accel = 0, 1.22


[State 191, Keda]
type = Explod
trigger1 = roundstate != 0
trigger1 = !numexplod(191)
persistent = 0
anim = 191
id = 191
postype = p1
scale = const(size.xscale),const(size.yscale)
pos = 0, 0
sprpriority = -1

[state 191, removeexplod]
type = removeexplod
trigger1 = numexplod(191)
id = 1910

[state 191, removeexplod]
type = removeexplod
trigger1 = numexplod(192)
id = 1920

[state 191, removeexplod]
type = removeexplod
trigger1 = numexplod(193)
id = 1930

[state 191, playsnd]
type = playsnd
trigger1 = animelemtime(8) = 0
value = 240,0



[State 191, Bench]
type = Explod
trigger1 = time = 0
trigger1 = !numexplod(1920)
anim = 1920
id = 1920
postype = p1
pos = 0, 0
velocity = 0, 0
accel = 0, 0
scale = const(size.xscale),const(size.yscale)
sprpriority = -3
removetime = -1

[State 191, Bench]
type = Explod
trigger1 = roundstate != 0
trigger1 = !numexplod(192)
anim = 192
id = 192
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0, 0
sprpriority = -3

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air               
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 200                       ;Change animation (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 17, 0                   ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 6, 6                 ;Time attacker pauses, time opponent shakes
sparkno = 0                      ;Spark anim no (Def: set above)
sparkxy = -40, -340             ;X-offset for the "hit spark" rel. to p2,
;Y-offset for the spark rel. to p1
hitsound = 5, 0                  ;Sound to play on hit
guardsound = 6, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 8             ;Time that the opponent slides back
ground.hittime  = 8             ;Time opponent is in hit state
ground.velocity = -12            ;Velocity at which opponent is pushed
airguard.velocity = -7.6,-3.2    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -2,-6          ;X-velocity at which opponent is pushed,
;Y-velocity at which opponent is pushed
air.hittime = 12                 ;Time before opponent regains control in air
guard.hittime  = 8
guard.velocity = -18
guard.slidetime = 8
fall.recovertime = 24


[State 200, 2]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1 

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing Med Punch
[Statedef 205]
type    = S
movetype= A
physics = S
poweradd= 20
ctrl = 0
velset = 0,0
anim = 205
sprpriority = 2

[State 205, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 2
trigger2 = animelemtime(5) = 1
value = 200, 0

[State 205, 2]
type = HitDef
trigger1 = animelem = 3
attr = S, NA
animtype  = Medium
damage    = 25
guardflag = MA
pausetime = 2,2
sparkno = 1
id = 205
sparkxy = -40,-370
hitsound   = S205,0
guardsound = 6,0
ground.type = high
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 2
air.velocity = 2,-6
guard.hittime = 15
guard.velocity = 6
guard.slidetime = 15
fall.recovertime = 20

[State 205, 2]
type = HitDef
trigger1 = animelem = 6
attr = S, NA
animtype  = Medium
damage    = 25
guardflag = MA
pausetime = 8,8
sparkno = 1
sparkxy = -40,-370
hitsound   = S205,0
guardsound = 6,0
id = 206
ground.type = high
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -18
air.velocity = -8,-6
guard.hittime = 15
guard.velocity = -20
guard.slidetime = 15
fall.recovertime = 20

[state XXX, Combo Scaling]
type = varadd
trigger1 = numtarget(205)
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state XXX, Combo Scaling]
type = varadd
trigger1 = numtarget(206)
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[State 205, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong punch
; CNS difficulty: easy
; Note the width controller. It makes KFM's push box larger, so he doesn't
; stand so close to the opponent. Hit Ctrl-C and look at the red bar at his
; feet.
; The sprpriority for this state is at -1, instead of the usual 2 for
; attacks. This makes KFM appear behind the opponent initially.
; The SprPriority controller in [State 210, 4] brings KFM to the front when
; his arm has swung over.
; To stop KFM from pausing in his swing frame, there is a ChangeAnim in
; [State 210, 3] that detects if the hit has come in contact with the
; opponent during that frame, and switches to the next animation element
; (notice the elem=6 parameter). If you don't see what I mean, try commenting
; out that controller, then hit someone with this attack.
[Statedef 210]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -1

[State 210, 1]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = S210, 0

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 5
attr = S, NA
animtype  = Medium
damage    = 35
id = 210
guardflag = MA
pausetime = 4,12
guard.pausetime = 2,2
sparkno = 1
sparkxy = -40,-280
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = 2
air.velocity = -2,-8
fall.recovertime = 24
guard.hittime = 12
guard.slidetime = 12
guard.velocity = 2


[State 210, 2]
type = HitDef
trigger1 = AnimElem = 6
attr = S, NA
animtype  = Medium
damage    = 35
guardflag = MA
pausetime = 8,8
guard.pausetime = 8,8
sparkno = 1
id = 211
sparkxy = -40,-280
hitsound   = 5,3
guardsound = 6,0
ground.type = High
ground.slidetime = 21
ground.hittime  = 21
ground.velocity = -21
air.velocity = -12,-8
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -24
fall.recovertime = 24

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[State 210, 4]
type = SprPriority
trigger1 = AnimElem = 5
value = 2

[state 210, Not Active]
type = statetypeset
trigger1 = animelemtime(7) = 0
movetype = I

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
poweradd= 11
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 1
value = 230, 0

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 20
guardflag = MA
pausetime = 6,8
sparkno = 0
sparkxy = -40,-210
hitsound   = 5,1
guardsound = 6,0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -14
air.velocity = -4,-12
guard.hittime = 11
guard.velocity = -16
guard.slidetime = 11
fall.recovertime = 18

[state 230, ctrlset]
type = ctrlset
trigger1 = animelemtime(6) > 0
value = 1
ignorehitpause = 1

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
;Standing Medium Kick
[statedef 235]
type = S
movetype = A
physics = S
poweradd = 20
ctrl = 0
anim = 235

[State 235, 1]
type = PlaySnd
trigger1 = animelemtime(2) = 0
value = S235, random%2

[state 235, velset]
type = velset
trigger1 = animelemtime(2) = 0
x = 20

[State 235, 2]
type = HitDef
trigger1 = animelem = 4
attr = S, NA
animtype  = Medium
damage    = 40
guardflag = MA
pausetime = 10,10
guard.pausetime = 6,5
sparkno = 0
sparkxy = -40,-210
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 19
ground.hittime  = 19
ground.velocity = -16
air.velocity = -12,-4
guard.hittime = 12
guard.velocity = -18
guard.slidetime = 12
fall = 0
fall.recover = 1
fall.recovertime = 14

[state 235, changeanim]
type = changeanim
trigger1 = movehit
value = 236
elem = 4
ignorehitpause = 1
persistent = 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[State 235, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 240
sprpriority = 2

[state 240, posadd]
type = posadd
trigger1 = p2dist x > 180
trigger1 = animelemtime(1) = 0
x = 60

[state 240, posadd]
type = posadd
trigger1 = p2dist x > 120
trigger1 = animelemtime(2) = 0
x = 120

[state 240, posadd]
type = velset
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
x = 15

[state 240, posadd]
type = posadd
trigger1 = p2dist x > 60
trigger1 = animelemtime(9) = 0
x = 60

[state 240, posadd]
type = posadd
trigger1 = p2dist x > 60
trigger1 = animtime = 0
x = 60

[State 240, 2]
type = HitDef
trigger1 = animelem = 5
attr = S, NA
animtype  = Medium
damage    = 60
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,7
sparkno = 3
id = 240
sparkxy = -40,-240
hitsound   = S240,0
guardsound = 6,0
ground.type = Low
ground.slidetime = 22
ground.hittime  = 22
air.hittime = 26
airguard.hittime = 22
ground.velocity = -22
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -45
air.velocity = -16,-2
air.fall = 1
fall.recovertime = 24

[State 240, 2]
type = HitDef
trigger1 = animelem = 6
trigger1 = !movecontact
attr = S, NA
animtype  = Medium
damage    = 15
guardflag = MA
pausetime = 6,6
guard.pausetime = 6,4
sparkno = 1
id = 241
nochainid = 240
sparkxy = -40,-240
hitsound   = 5,0
guardsound = 6,0
ground.type = Low
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -12
air.velocity = -16,-2
guard.hittime = 9
guard.slidetime = 9
guard.velocity = -14
fall.recovertime = 24

[state 240, heavy woosh]
type = playsnd
trigger1 = animelemtime(2) = 2
value = S1102, 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 240, Not Active]
type = statetypeset
trigger1 = animelemtime(7) = 0
movetype = I

[State 240, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light punch
; CNS difficulty: easy
; Description: Simple crouching attack. The HitDef's guardflag parameter
;     is set to "L", meaning that the move can only be guarded low
;     (crouching), and not by standing or jumping opponents.
;     Like for all light attacks, it's a good idea to keep the slidetime
;     and hittime parameters at a smaller number, so the opponent isn't
;     stunned for too long. For all crouching attacks you have to
;     remember to set the attr parameter to indicate that it is crouching
;     attack. In this case, "C, NA" stands for "crouching, normal attack".
;     The HitDef's priority is set at 3, instead of the default of 4,
;     so this attack has a lower priority than most others, meaning
;     KFM will get hit instead of trading hits with his opponent if
;     their attack collision boxes (Clsn1) intersect each other's Clsn2
;     boxes at the same time.
[Statedef 400]
type    = C
movetype= A
physics = C
poweradd= 8
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 20
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = MA
pausetime = 8,8
sparkno = 0
sparkxy = -40,-185
hitsound   = 5,0
guardsound = 6,0
ground.type = Low
ground.slidetime = 11
ground.hittime  = 11
ground.velocity = -12
air.velocity = -6,-12
guard.hittime = 11
guard.slidetime = 11
guard.velocity = -14
fall.recovertime = 12

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching strong punch
; CNS difficulty: easy
; Description: This is a 2-hit move. It is done by having two HitDefs
;     triggered, one for each frame of animation that hits.
;     Notice how the first hit cannot be guarded by an opponent in the
;     air, because of the "M" in the guardflag, meaning it can only
;     be guarded "middle". The second hit has an "MA" guardflag, so
;     it can be guarded both on the ground and in the air.
[Statedef 410]
type    = C
movetype= A
physics = C
poweradd= 25
ctrl = 0
anim = 410
sprpriority = 2

[State 410, 1]
type = PlaySnd
trigger1 = Time = 1
value = S1102, 0

[state 410, velset]
type = velset
trigger1 = animelemtime(1) = 1
x = 28

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = AnimElem = 4
attr = C, NA
damage    = 40
animtype  = Heavy
id = 410
hitflag = MAF
guardflag = MA
pausetime = 6,6
sparkno = 1
sparkxy = -40,-220
hitsound   = 5,1
guardsound = 6,0
ground.type = High
guard.dist = 480
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 2
guard.hittime = 8
guard.slidetime = 8
air.velocity = 2,-8
fall.recovertime = 30
fall.recover = 0
fall.recovertime = 24

;This is the second hit, triggered on the 4th element of animation.
[State 410, 3]
type = HitDef
trigger1 = AnimElem = 6
attr = C, NA
damage    = ifelse(numtarget(410) = 1, 25, 60),ifelse(p2statetype = A, 5,0)
animtype  = up
hitflag = MAF
guardflag = MA
pausetime = 18,18
guard.pausetime = 12,12
sparkno = 4
id = 411
sparkxy = -40,-332
hitsound   = 5,4
envshake.ampl = 8
envshake.time = 18
guardsound = 6,0
ground.type = High
ground.slidetime = 45
ground.hittime  = 45
air.hittime = 45
guard.hittime = 13
guard.slidetime = 13
guard.velocity = -32
guard.dist = 480
airguard.velocity = -20, -12
ground.velocity = -2, ifelse(var(11) > 0, -42, -18)
air.velocity = -2,-36 ;ifelse(var(11) > 0, floor((-650 - enemynear,pos y)*0.0555),-18)
fall = ifelse(var(11) > 0, 0, 1)
fall.recovertime = 45

[state 410, launch inhibitor]
type = varadd
trigger1 = movehit
trigger1 = numtarget(411)
var(11) = -1
ignorehitpause = 1
persistent = 0

[state 410, Jump Cancel]
type = changestate
trigger1 = !ailevel
trigger1 = movehit
trigger1 = command = "holdup"
triggerall = animelemtime(6) > 1
trigger2 = ailevel
trigger2 = movehit
value = 42

[state x, combo damage score]
type = varadd
trigger1 = movehit
trigger1 = numtarget(411)
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 410, Not Active]
type = statetypeset
trigger1 = animelemtime(7) = 0
movetype = I

[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
juggle  = 7
poweradd= 11
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 25
animtype  = Light
hitflag = MAFD
guardflag = L
nochainid = 1400
pausetime = 8,8
guard.pausetime = 6,5
sparkno = 0
sparkxy = -40,-50
hitsound   = 5,1
guardsound = 6,0
ground.type = Low
ground.slidetime = 11
ground.hittime  = 11
ground.velocity = -12
air.velocity = -8,-12
down.velocity = -20,0
down.hittime = 22
guard.hittime = 10
guard.slidetime = 10
guard.velocity = -16
fall.recovertime = 12

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = N
juggle = 7
poweradd= 35
ctrl = 0
anim = 440
sprpriority = 2

[State 440, 2]
type = PlaySnd
trigger1 = Time = 2
value = S1102, 0

[state 1101, dust]
type = explod
trigger1 = animelemtime(5) > 0 && animelemtime(10) < 0
persistent = 4
anim = 2025
postype = p1
pos = 370,-30
vel = 2,-2
scale = 1,1
sprpriority = 3

[state 440, movefwd]
type = null;posadd
triggerall = p2bodydist x > 52
trigger1 = animelemtime(2) = 0
x = 52

[state 440, movefwd]
type = null;posadd
triggerall = p2bodydist x > 143
trigger1 = animelemtime(3) = 0
x = 143

[state 440, velset]
type = velset
;trigger1 = p2bodydist x <= 143
trigger1 = animelemtime(2) = 0
x = 25

[state 440, physics]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = C

[state 440, movefwd]
type = null;posadd
triggerall = p2bodydist x > 130
trigger1 = animelemtime(4) = 0
x = 130

[state 440, dodge projectiles]
type = nothitby
trigger1 = animelemtime(5) > 0
value = ,AP
ignorehitpause = 1
persistent = 1

[state 440, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = S1050,1
persistent = 0
volumescale = 40

[state 440, envshake]
type = envshake
trigger1 = animelemtime(5) = 0
ampl = -6
time = 12

[State 440, 3]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = ifelse(p2statetype = A, 33,75)
hitflag = MAFD
guardflag = L
pausetime = 14,14
id = 440
nochainid = 1400
sparkno = 1
sparkxy = -20,-75
hitsound   = 5,4
guardsound = 6,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -6,-18
air.velocity = -6,-18
down.velocity = -30,0
down.hittime = 24
guard.velocity = -36
guard.hittime = 14
guard.slidetime = 14
fall = 1
fall.recovertime = 30
fall.recover = 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 440, Not Active]
type = statetypeset
trigger1 = animelemtime(6) = 0
movetype = I

[State 440, 4]
type = ChangeState
triggerall = animelemtime(10) > 0
trigger1 = command != "holddown"
value = 441


;---------------------------------------------------------------------------
;go back
[statedef 441]
type = C
movetype = I
physics = C
anim = 441
velset = 0,0

[state 440, velset]
type = velset
trigger1 = animelemtime(1) = 1
x = -20

[state 440, movefwd]
type = null;posadd
trigger1 = animelemtime(1) = 1
x = -100

[state 440, movefwd]
type = null;posadd
trigger1 = animelemtime(2) = 0
x = -120

[state 440, movefwd]
type = null;posadd
trigger1 = animelemtime(3) = 0
x = -30

[State 441, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
poweradd= 5
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 15
guardflag = HA
priority = 3
pausetime = 6,6
sparkno = 0
sparkxy = -40,-232
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -16
air.velocity = -4,-16
air.hittime = 20
fall.recovertime = 24

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 600, 3]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
;Jump Medium Punch
[Statedef 605]
type    = A
movetype= A
physics = A
poweradd= 15
ctrl = 0
anim = 605
sprpriority = 2

[State 605, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 605, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 35
guardflag = HA
priority = 3
pausetime = 6,10
guard.pausetime = 10,10
sparkno = 0
sparkxy = -40,-232
hitsound   = S610,0
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -20
air.velocity = -4,-8
air.hittime = 20
fall.recovertime = 24

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[State 605, 3]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1


;---------------------------------------------------------------------------
;Jump Strong Punch
; CNS difficulty: easy
[Statedef 610]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 2]
type = PlaySnd
trigger1 = Time = 2
value = S210, 0

[state 610, leapfrog]
type = veladd
trigger1 = !ailevel
triggerall = movehit
triggerall = p2statetype = A
trigger1 = command = "holdfwd"
trigger2 = ailevel
trigger2 = frontedgebodydist < 500
trigger2 = random < ailevel * 24
x = 30
persistent = 0
ignorehitpause = 1

[state 610, leapfrog]
type = velset
trigger1 = movehit
trigger1 = p2statetype = A
y = ifelse(command = "holdup", -24, -15)
persistent = 0
ignorehitpause = 1


[State 610, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 55
guardflag = HA
priority = 4
pausetime = 12,12
guard.pausetime = 12,12
sparkno = 1
sparkxy = -40,-220
hitsound   = 5,3
guardsound = 6,0
animtype = back
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -24
air.velocity = -6,4
air.fall = 1
fall.recover = 0

guard.hittime = 14
guard.slidetime = 14
guard.velocity = -18
fall.recovertime = 45

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 610, Not Active]
type = statetypeset
trigger1 = animelemtime(5) = 0
movetype = I


[state 610, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = A
poweradd= 10
ctrl = 0
anim = 630
sprpriority = 2

[State 630, 1]
type = PlaySnd
trigger1 = animelemtime(1) = 2
trigger2 = animelemtime(3) = 1
value = 630, 0
persistent = 1

[State 630, 2]
type = HitDef
trigger1 = animelem = 2
attr = A, NA
damage = 15
persistent = 2
guardflag = HA
priority = 3
pausetime = 2,2
sparkno = 1
sparkxy = -20,-70
id = 630
hitsound   = 5,1
guardsound = 6,0
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -12
air.velocity = -4, -8;-8,-12
air.hittime = 14
guard.hittime = 14
guard.slidetime = 14
guard.velocity = -14
fall.recovertime = 24

[State 630, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, NA
damage = 15
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 1
id = 631
sparkxy = -20,-200
hitsound   = 5,1
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -12
air.velocity = -4, -8;-8,-12
air.hittime = 20
guard.hittime = 14
guard.velocity = -14
guard.slidetime = 14
fall.recovertime = 24

[state 630, popup]
type = veladd
triggerall = p2statetype = A
triggerall = movehit
trigger1 = animelem = 2
trigger2 = animelem = 4
persistent = 2
y = -7.5
ignorehitpause = 1 


[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 630, Changestate]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------------
;Jump Medium Kick
[Statedef 635]
type    = A
movetype= A
physics = N
poweradd= 25
ctrl = 0
anim = 635
sprpriority = 2


[state 635, veladd]
type = veladd
trigger1 = vel y > 0
trigger1 = animelemtime(3) >= 0 && animelemtime(6) < 0
y = -3
persistent = 1
IGNOREHITPAUSE = 1

[state 635, veladd]
type = veladd
trigger1 = movecontact
trigger1 = animelemtime(3) >= 0  && animelemtime(6) < 0
y = -2
persistent = 3
ignorehitpause = 1

[state 635, gravity]
type = gravity
trigger1 = animelemtime(4) < 0
trigger2 = animelemtime(8) > 0
ignorehitpause = 0


[State 635, 1]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 635, 0
persistent = 1

[state 635, sound]
type = playsnd
trigger1 = animelemtime(6) = 0
value = S235, random%2


[State 635, 2]
type = HitDef
trigger1 = animelem = 4
trigger2 = animelem = 5
persistent = 2
attr = A, NA
damage = 15
persistent = 2
guardflag = HA
priority = 3
pausetime = 2,2
sparkno = 1
sparkxy = -20,-70
id = 635
hitsound   = 5,1
guardsound = 6,0
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -12
air.velocity = -4, -8;-8,-12
air.hittime = 14
guard.hittime = 10
guard.slidetime = 10
guard.velocity = -14
fall.recovertime = 24

[State 635, 2]
type = HitDef
trigger1 = animelem = 7
attr = A, NA
damage = 30
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 1
id = 636
sparkxy = -20,-200
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -12
air.velocity = -4, -8;-8,-12
air.hittime = 20
guard.hittime = 12
guard.velocity = -14
guard.slidetime = 12
fall.recovertime = 24


[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[state 635, Changestate]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 635, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
poweradd= 30
ctrl = 0
anim = 640
sprpriority = 2

[State 640, 2]
type = PlaySnd
trigger1 = Time = 2
value = S210, 0

[State 640, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 65
hitflag = MAFD
guardflag = HA
priority = 4
pausetime = 18,18
sparkno = 1
sparkxy = -40,-160
hitsound   = 5,4
guardsound = 6,0
animtype = Med
id = 640
ground.type = High
ground.slidetime = 14
ground.hittime  = 20
ground.velocity = -24
air.velocity = -8,50
air.fall = 1
fall.recover = 0
down.bounce = 1
DOWN.velocity = 0,0
down.hittime = 24
fall.xvelocity = -4
fall.yvelocity = -25
envshake.ampl = 12
envshake.time = 18
guard.hittime = 14
guard.slidetime = 14
guard.velocity = -18
fall.recovertime = 45



[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 640, Not Active]
type = statetypeset
trigger1 = animelemtime(5) = 0
movetype = I

[state 640, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Butt Drop
[Statedef 645]
type    = A
movetype= A
physics = N
poweradd= 30
ctrl = 0
anim = 645
sprpriority = 2
facep2 = 1

[state 645, Bounces]
type = varset
trigger1 = time = 0
var(5) = 0

;MAX tripple jump height
[state -2, butt drop damage]
type = varSet
trigger1 = pos y < -660
trigger1 = time = 0
var(9) = 180


;super jump peak
[state -2, drop damage]
type = varset
trigger1 = pos y >= -660 && pos y < -550
trigger1 = time = 0
var(9) = 160


;super jump any
[state -2, drop damage]
type = varset
trigger1 = pos y >= -550 && pos y < -430
trigger1 = time = 0
var(9) = 140


;normal jump peak
[state -2, drop damage]
type = varset
trigger1 = pos y >= -430 && pos y < -390
trigger1 = time = 0
var(9) = 120


;normal jump any
[state -2, drop damage]
type = varset
trigger1 = pos y >= -390 && pos y < -280
trigger1 = time = 0
var(9) = 100


;small hop
[state -2, drop damage]
type = varset
trigger1 = pos y >= -280 && pos y < 0
trigger1 = time = 0
var(9) = 80

[state 645, playerpush]
type = playerpush
trigger1 = !movecontact
value = 0



[state 645, freeze in air]
type = velmul
trigger1 = animelemtime(1) = 1
x = 0.1
y = 0.1

[state 645, gravity]
type = gravity
trigger1 = animelemtime(7) > 0

[state 645, gravity]
type = gravity
trigger1 = animelemtime(7) > 0

[state 645, gravity]
type = gravity
trigger1 = animelemtime(7) > 0

[state 645,veladd]
type = veladd
trigger1 = animelemtime(7) = 0
x = 18

[state 641, aim]
type = veladd
triggerall = animelemtime(7) > 1
trigger1 = command = "holdfwd"
trigger1 = ailevel = 0
trigger2 = p2bodydist x > 50
trigger2 = ailevel > 0
x = 0.75
persistent = 1

[state 641, aim]
type = veladd
triggerall = animelemtime(7) > 1
trigger1 = command = "holdback"
trigger1 = ailevel = 0
trigger2 = p2bodydist x < -50
trigger2 = ailevel > 0
x = -1.25
persistent = 1


[State 645, 3]
type = HitDef
trigger1 = animelem = 5  
attr = A, SA
damage  = var(9),floor(var(9) * 0.2)
hitflag = MAFD
guardflag = HAF
priority = 4
pausetime = 14,14
guard.pausetime = 12,8
sparkno = 3
sparkxy = -10,-80
hitsound   = 5,4
id = 1050
nochainid = 1400
guardsound = S120, 0
animtype = heavy
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = 0,0
air.velocity = 0,0
persistent = 0
guard.velocity = -80    
guard.hittime = 30
guard.slidetime = 30
airguard.velocity = -40,5
airguard.ctrltime = 35
guard.dist = 480
fall = 1
fall.recover = 0
;----------------------------------------------

[state 650, enemy state]
type = targetstate
triggerall = vel y > 0
triggerall = numenemy
trigger1 = movehit
trigger1 = enemy,statetype != A
value = 660

;Ride down mechanic
[state 650, Ride down]
type = targetbind
triggerall = numenemy
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = -80, -100

[state 650, state of ride down]
type = targetstate
triggerall = numenemy
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 655

;--------------------------------------------------

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 645, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 646

;---------------------------------------------------------------------------
;landing 1
[statedef 646]
type = C
movetype = A
physics = N
anim = 646
movehitpersist = 1


[state 646, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5) 

[State 646, 3]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = C, SA
damage    = var(9) 
hitflag = FD
guardflag = MA 
getpower = 75
id = 1050
priority = 4
pausetime = 14,14
guard.pausetime = 14,14
guard.hittime = 14
sparkno = 3
sparkxy = 0,0
hitsound   = 5,4
guardsound = S120, 0
animtype = back
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = 0
air.velocity = 0,0
persistent = 0
p2stateno = 660

[state 646, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 646, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 646, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1


[state 646, quake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 24

[state 646, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 646, posset]
type = posset
trigger1 = time = 0
y = 0

[state 646, bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -18

[state 646, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A

[state 646, gravity]
type = gravity
trigger1 = animelemtime(3) >= 0
trigger1 = pos y < 0


[state 646, Chain Sit Rest]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 646, Chain Sit Eat]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 646, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 646, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = -36,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = -36,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = -36,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = -36,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = -36,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 646, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 647

;---------------------------------------------------------------------------
;landing 2
[statedef 647]
type = C
movetype = A
physics = N
anim = 647
movehitpersist = 1

[state 647, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 646, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
trigger1 = !ailevel
trigger2 = var(12) = 1
trigger2 = ailevel 
var(24) = 1

[state 646, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
trigger1 = !ailevel
trigger2 = var(12) = 2
trigger2 = ailevel 
var(24) = 2

[state 646, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
trigger1 = !ailevel
trigger2 = var(12) = 3
trigger2 = ailevel 
var(24) = 3

[state 646, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = inguarddist
var(24) = 4

[state 10X6, add on Drain]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 4 && animelemtime(3) <= 36 
triggerall = anim = 647
triggerall = movehit
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1370)

[state 10X6, add on Damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 4 && animelemtime(3) <= 36
triggerall = anim = 647
triggerall = movehit
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380, 1310)

[state 10X6, add on Rest]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 4 && animelemtime(3) <= 36
triggerall = anim = 647
triggerall = movehit
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1330)

[state 10X6, add on Eat]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 4 && animelemtime(3) <= 36 
triggerall = anim = 647
triggerall = movehit
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1350)

[state 10X6, add on damage]
type = changestate
triggerall = animelemtime(3) > 0 && animelemtime(3) <= 36 
triggerall = anim = 647
triggerall = movehit
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = !numtarget(1050)
value = 648

[state 646, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1
volumescale = 50

[state 646, quake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 647, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 647, posset]
type = posset
trigger1 = time = 0
y = 0

[state 647, land]
type = changestate
trigger1 = enemynear,stateno = [660,669]
trigger1 = animtime = 0
trigger2 = enemynear,stateno != [660, 669]
trigger2 = animelemtime(3) = 4
value = 648

;-----------------------------------------------------------------------------
;Jump off
[statedef 648]
type = A
movetype = I
physics = N
anim = 43
movehitpersist = 1

[state 648, Passive increase]
type = varadd
trigger1 = time = 0
trigger1 = movehit
var(23) = 1

[state 648, velset]
type = velset
trigger1 = time = 0
x = -18
y = -24

[state 648, changeanim]
type = changeanim
trigger1 = vel y > 0
value = 46
persistent = 0

[state 648, gravity]
type = gravity
trigger1 = pos y < 0

[state 648, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52


;---------------------------------------------------------------------------
;Banzai Drop
[statedef 650]
type = A
movetype = A
physics = N
velset = 0,0
poweradd = 80
anim = 650
sprpriority = 2

[state 650, varset]
type = varset
trigger1 = time = 0
var(5) = 0

[state 650, gravity]
type = gravity
trigger1 = animelemtime(3) > 0

[state 650, double gravity]
type = veladd
trigger1 = animelemtime(3) > 0
trigger1 = vel y > 0
y = 0.35
persistent = 1

[state 650, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 650, edge]
type = width
trigger1 = 1
edge = 90,100

[state 650, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = const(velocity.jump.fwd.x)*1.25
y = const(velocity.jump.y)*0.9

[state 650, veladd]
type = veladd
triggerall = vel x < const(velocity.jump.fwd.x)*2.5
triggerall = animelemtime(4) > 0
trigger1 = command = "holdfwd"
trigger1 = ailevel = 0
trigger2 = ailevel > 0
trigger2 = p2bodydist x > 150
x =  const(velocity.jump.fwd.x)*0.125
persistent = 1

[state 650, veladd]
type = veladd
triggerall = vel x > const(velocity.jump.back.x)*2.5
triggerall = animelemtime(4) > 0
trigger1 = command = "holdback"
trigger1 = ailevel = 0
trigger2 = ailevel > 0
trigger2 = p2bodydist x < -150
x =  const(velocity.jump.back.x)*0.125
persistent = 1

[state 650, vel mul]
type = velmul
trigger1 = !ailevel
trigger1 = command != "holdfwd" && command != "holdback"
trigger2 = ailevel
trigger2 = p2bodydist x > 25 && p2bodydist x > -100
x = 0.75
persistent = 8

[State 650, 3]
type = HitDef
triggerall = p2bodydist y > 0
trigger1 = vel y > 0
trigger1 = !movecontact || !movereversed
persistent = 0
attr = A, SA
damage    = floor(var(16))
getpower = floor(var(16) * 0.75)
givepower = floor(var(16))
guardflag = 
hitflag = MAFD
priority = 2,miss
pausetime = 0,0
sparkno = -1
id = 1000
nochainid = 1400
sparkxy = 0,0
hitsound   = 5,4
guardsound = S120, 0
p1sprpriority = 2
animtype = heavy
ground.type = high
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = 0
air.velocity = 0,0
down.hittime = 60
guard.velocity = -50            
guard.hittime = 45
guard.slidetime = 45
airguard.velocity = -28,10
airguard.hittime = 35
guard.dist = 0

; Ride Down
;--------------------------
[state 650, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = enemy,statetype != A
value = 661

;Ride down mechanic
[state 650, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = -100, -30

[state 650, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 655
;-------------------------------

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 1102, varadd]
type = varadd
trigger1 = movecontact
var(23) = 1
ignorehitpause = 1
persistent = 0

[state 650, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 651


;--------------------------------------------------------------------------------
; 1st Landing
[statedef 651]
type    = C
movetype= A
physics = N
poweradd= 30
movehitpersist = 1

[state 651, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)
ignorehitpause = 1

[state 651, anim]
type = changeanim
trigger1 = time = 0
value = 651

[state 651, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 5,2
ownpal = 1
sprpriority = -4


[state 651, snd]
type = playsnd
trigger1 = time = 0
value =S1000,0

[state 651, snd]
type = playsnd
trigger1 = time = 0
value =S1000,0

[state 651, snd]
type = playsnd
trigger1 = time = 0
value =S1000,0

[state 651, pos]
type = posset
trigger1 = time = 0
y = 0

[state 651, playerpush]
type = playerpush
trigger1 = time > 2
value = 1

[State 651, 3]
type = HitDef
trigger1 = Time = 0
attr = A, SA
damage    = var(16)
guardflag = 
hitflag = FD
nochainid = 1400
priority = 4
pausetime = 0,0
sparkno = 1
sparkxy = -10,-40
hitsound = S5000, 2
guardsound = S120, 0
animtype = Med
p1sprpriority = -2
p2stateno = 661
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state 651, vel]
type = velset
trigger1 = time = 0
y = 0
x = 0

;--------------------------
;squashed stretch
[state 651, angledraw]
type = angledraw
trigger1 = animelemtime(2) = 1
trigger2 = animelemtime(2) = 2
value = 0
scale = 1.1,0.8
persistent = 1

[state 651, angledraw]
type = angledraw
trigger1 = animelemtime(2) = 3
trigger2 = animelemtime(2) = 4
value = 0
scale = 1.2,0.6
persistent = 1

[state 651, angledraw]
type = angledraw
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(3) = 2
value = 0
scale = 1.1,0.8
persistent = 1


[state 651, angledraw]
type = angledraw
trigger1 = time >= 13 && time < 15
value = 0
scale = 0.8,1.2
persistent = 1


[state 651, earthquakes]
type = envshake
trigger1 = time = 0
time = 32
ampl = -24

[state 651, velset]
type = velset
trigger1 = animelemtime(4) = 0
y = -21
persistent = 0

[state 651, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
statetype = A

[state 651, gravity]
type = gravity
trigger1 = animelemtime(4) > 0


[state 651, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 651, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 651, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 651, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 651, end]
type = changestate
trigger1 = animelemtime(4) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 652

;--------------------------------------------------------------------------
;Landing Rest
[statedef 652]
type    = C
movetype= I
physics = N
movehitpersist = 1
anim = 652

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 652, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 652, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 652, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 652, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

[state 652, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 652, posset]
type = posset
trigger1 = time = 0
y = 0

[state 652, playerpush]
type = playerpush
trigger1 = 1
value = 1

[state 652, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 652, snd]
type = playsnd
trigger1 = time = 0
value =S1000,0

[state 652, earthquakes]
type = envshake
trigger1 = time = 0
time = 15
ampl = 12

[state 652, add on Drain]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 4 && animelemtime(4) <= 36 
triggerall = anim = 652
triggerall = movehit
triggerall = numenemy
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1360)

[state 652, add on damage]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 4 && animelemtime(4) <= 36
triggerall = anim = 652
triggerall = movehit
triggerall = numenemy
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380, 1300)


[state 10X6, add on Rest]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(3) > 4 && animelemtime(3) <= 36 
triggerall = anim = 652
triggerall = movehit
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1320)

[state 10X6, add on Eat]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(3) > 4 && animelemtime(3) <= 36 
triggerall = anim = 652
triggerall = movehit
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1340)

[state 10X6, add on damage]
type = changestate
triggerall = animelemtime(3) > 0 && animelemtime(3) <= 36 
triggerall = anim = 652
triggerall = movehit
trigger1 = command = "holdfwd"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = !numtarget(1000)
value = 653

[state 652, end]
type = changestate
trigger1 = animtime = 0
value = 653


;---------------------------------------------------------------------------
;;Dismount
[statedef 653]
type = A
movetype = I
physics = N
anim = 43
movehitpersist = 1

[state 648, Passive increase]
type = varadd
trigger1 = time = 0
trigger1 = movehit
var(23) = 1

[state 653, turn]
type = turn
trigger1 = time = 0

[state 653, velset]
type = velset
trigger1 = time = 0
x = -18
y = -24

[state 653, gravity]
type = gravity
trigger1 = pos y < 0

[state 653, change anim]
type = changeanim
trigger1 = vel y > 0
value =  46

[state 653, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 1

;---------------------------------------------------------------------------
;Rode down
[statedef 655]
type = A
movetype = H
physics = N

[state 655, anim]
type = changeanim2
trigger1 = time = 0
value = 655

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 660

;===========================================================================
;---------------------------Crushed State-----------------------------------
;===========================================================================
; Moderate Crushed State
[statedef 660]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -1

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[state 1081, posadd]
type = posadd
triggerall = prevstateno = 1031
trigger1 = time = 0
x = -floor(const(size.mid.pos.y)*0.7)

[state 660, 1]
type = null;changeanim
trigger1 = time = 4
value = 5110


[state 660, 1]
type = null;changeanim
trigger1 = time = 5
value = 5080

[state 660, 1]
type = null;changeanim
trigger1 = time = 9
value = 5110

[state 660, 1]
type = null;changeanim
trigger1 = time = 10
value = 5080

[state 660, 1]
type = null;changeanim
trigger1 = time = 14
value = 5110

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.2,0.4

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[state 660, invunerable]
type = nothitby
trigger1 = 1
value = SCA,AA

[State 660, 7]
type = null;GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0



;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 92 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 20
value = 5150
;--------------------------------------------------------------------------------
; Moderate Crushed State
[statedef 661]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = -1

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[state 661, posadd]
type = posadd
triggerall = prevstateno = 1031
trigger1 = time = 0
x = -floor(const(size.mid.pos.y)*0.8)

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.3,0.2

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[state 660, invunerable]
type = nothitby
trigger1 = 1
value = SCA,AA

[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 660, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = selfState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 130 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 20
value = 5150

;===========================================================================
;      Wall Bounce State - Bring to Player
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

[state 671, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 670, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 670, Gravity]
type = veladd
trigger1 = 1
y = 0.44


;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = back
sprpriority = 3
ownpal = 1

[state 672, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 672, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 672, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 673, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -35

[State 673, Vel X]
type = VelSet
trigger1 = Time = 0
x = abs(p2bodydist x*0.02)

[State 673, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[state 673, gravity]
type = gravity
trigger1 = 1

[State 673, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 673, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 673, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 673, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;===========================================================================
; Neutral Wall Bounce State
;===========================================================================

[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 675, anim]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 675, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[State 676, Velocity]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[state 676, anim]
type = changeanim
trigger1 = time = 0
value = 5030

[State 676, Gravity]
type = gravity
trigger1 = 1

[State 676, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 676, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[STATE 677, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 677, envshake]
type = envshake
trigger1 = time =0
ampl = -12
time = 12


[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3
ownpal = 1

[State 677, Anim]
type = ChangeAnim
trigger1 = Time = 0
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

[State 678, 1]
type = NotHitBy
trigger1 = 1
value = SCA

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -28

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 6

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[state 678, gravity]
type = gravity
trigger1 = 1

;[State 678, Gravity]
;type = VelAdd
;trigger1 = 1
;y = .35

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 678, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;-----------------------------------------------------------------------------
;Ground Bounce
;-----------------------------------------------------------------------------
;Hit Freeze small
[statedef 680]
type = A
movetype = H
physics = N

[State 680, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 680, posadd]
type = posadd
trigger1 = time = 0
y = -20

[state 680]
type = changeanim
trigger1 = time = 0
value = 5035
ignorehitpause = 1

[state 680, changestate]
type = changestate
trigger1 = hitshakeover
value = 681

;-----------------------------------------------------------------------------
;Soft Ground bounce - Going down
[statedef 681]
;Custom Hit state, ground bounce
type = A
movetype = H
physics = N


[state 681, velocity]
type = velset ;hitvelset
trigger1 = time = 0
y = 60

[state 681, anim]
type = changeanim
trigger1 = time = 0
value = 5061


[state 681, stop x]
type = velmul
trigger1 = time = 0
x = 0.25


[state 681]
type = veladd
trigger1 = 1
y = 1.05

[state 681, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 682

;-----------------------------------------------------------------------------
;Ground Bounce - Impact / bouncing
[statedef 682]
type = A
movetype = H
physics = N
anim = 5100

[state 682, impact]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 682, 8]
type = Explod
trigger1 = Time = 0
anim = F62 
pos = 0, 0
ontop = 1
scale = 1.7, 0.5
persistent = 0
ownpal = 1
persistent = 0

[State 682, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,2
persistent = 0

[state 682, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10
persistent = 0

[state 682, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 682, end]
type = changestate
trigger1 = animtime = 0
value = 683
;-----------------------------------------------
[statedef 683]
movetype = H
physics = N
anim = 5160

[state 683, bounce]
type = velset
trigger1 = time = 1
y = -20

[state 683, gravity]
type = veladd
trigger1 = time > 1
y = 1.05

[state 683, down]
type = selfstate
trigger1 = time >= 2 
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5110
;--------------------------------------------------------------------------


;Hit Freeze big
[statedef 685]
type = A
movetype = H
physics = N

[State 685, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 685]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 685, changestate]
type = changestate
trigger1 = hitshakeover
value = 686
;---------------------------------------------------------------------------
;Hard Ground bounce - going down
[statedef 686]
;Custom Hit state, ground bounce
type = A
movetype = H
physics = N


[state 686, anim]
type = changeanim
trigger1 = time = 0
value = 5160

[state 686, velocity]
type = hitvelset
trigger1 = time = 0
y = 60
x = -8


[state 686, stop x]
type = velmul
trigger1 = time = 0
x = 0


[state 686]
type = veladd
trigger1 = 1
y = 1.05

[state 686, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 687

;-----------------------------------------------------------------------------
;Hard Ground Bounce - Impact/bounce
[statedef 687]
type = A
movetype = H
physics = N
anim = 5160

[state 687, impact]
type = velset
trigger1 = time = 0
y = 0

[State 687, 8]
type = Explod
trigger1 = Time = 0
anim = F62 
pos = 0, 0
ontop = 1
scale = 2, 1
persistent = 0
ownpal = 1

[State 687, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,2
persistent = 0

[state 687, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10

[state 687, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 687, bounce]
type = velset
trigger1 = time = 1
y = -20

[state 687, gravity]
type = veladd
trigger1 = time > 1
y = 1.05

[state 687, down]
type = selfstate
trigger1 = time >= 2 
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;---------------------------------------------------------------------------




;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2


[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-          
priority = 1, Miss   
sparkno = -1                    
p1facing = 1
p2facing = 1         
p1stateno = 810      
p2stateno = 820       
id = 800
guard.dist = 0        
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1              

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p2
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
facep2 = 1
sprpriority = 4

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120

;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -32

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p1
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(130)
value = 130

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 130

[state 805, removeexplod]
type = removeexplod
trigger1 = numexplod(811)
id = 811
ignorehitpause = 1

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, turn]
type = turn
trigger1 = prevstateno = 820
trigger1 = time = 0
persistent = 0
ignorehitpause

[state 805, velset]
type = velset
trigger1 = time = 10
x= -32

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1


;---------------------------------------------------------------------------
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 0
sprpriority = 2
; Here a variable, var(2), is used to remember whether or not the
; player was holding forward at the start of the state. This variable
; is checked later on to turn KFM around if necessary.
[State 810, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdback"

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 805
value = 806
persistent = 1

[state 810, extra]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(811)
anim = 811
id = 811
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 7
value = 800, 0

[state 810, sprpriority]
type = sprpriority
trigger1 = animelem = 3
value = -2


[state 810, sprpriority]
type = sprpriority
trigger1 = animelem = 9
value = 3
;==========================================
;Binds
;==========================================

[State 810, Bind 1-2]
type = TargetBind
trigger1 = AnimElemTime(3) < 0
pos = 254, 0

[State 810, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 126, 0

[State 810, Bind 4]
type = Bindtotarget
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -2, 388, Head

[State 810, Bind 5]
type = Bindtotarget
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -124, 402, Head

[State 810, Bind 6]
type = Bindtotarget
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = -124,402, Head

[State 810, Bind 7]
type = Bindtotarget
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = -124,402, Head

[State 810, Bind 8]
type = targetbind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = 72, -408;-408

[State 810, Bind 9]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
pos = 268, -200

[state 810, posset]
type = posset
trigger1 = animelem = 9
y = 0



[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElemtime(2) = 4

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElemtime(2) = 4
x = -148

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElemtime(2) = 4
value = -1

[state 810, holdback, turn explod]
type = modifyexplod
trigger1 = var(2)
trigger1 = animelemtime(2) = 4
scale = -const(size.xscale),const(size.yscale)
id = 811



[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 9
value = -130

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 10
value = 821

[state 810, varadd]
type = varadd
trigger1 = animelemtime(10) = 0
var(23) = 1
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = animtime = 0
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 805

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = -24,-12
poweradd = 40

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = 1.6

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;---------------------------------------------------------------------------
; Air Grab Non Comboable
[Statedef 830]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 830
sprpriority = 2


[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = A, NT          ;Attributes: Standing, Normal Throw
hitflag = A-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 1     ;Draw p1's sprite in front of p2
                      ;p2's sprite priority is set to 0 by default
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 840       ;On success, KFM changes to state 810
p2stateno = 850       ;If hit, p2 changes to state 820 in KFM's cns
id = 800
guard.dist = 0        ;This prevents p2 from going into a guard state if close
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1              ;Force p2 into falling down

[state 830, damage set]
type = varset
trigger1 = time = 0
var(16) = -150

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Air Grab Comboable
[Statedef 831]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 830
sprpriority = 2


[State 831, 1]
type = HitDef
Trigger1 = p2stateno != [150,155]
attr = A, ST          
hitflag = AF          
priority = 1, Miss    
sparkno = -1         
p1sprpriority = 1     
                      
p1facing = 1
p2facing = 1          
p1stateno = 841       
p2stateno = 850       
id = 800
guard.dist = 0       
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1              ;Force p2 into falling down

[state 830, damage set]
type = varset
trigger1 = time = 0
var(16) = ceil(fvar(10)*-90)

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 50
ctrl = 1

;--------------------------------------------------------------------------
;Grab Escape - p2
[statedef 835]
type = A
movetype = H
physics = N
anim = 43
ctrl = 0

;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 835, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 835, posset]
type = posset
trigger1 = time = 0
y = enemynear,pos y 
persistent = 0
ignorehitpause = 1


[state 835, targetfacing]
type = targetfacing
trigger1 = time = 0
value = -1
persistent = 1

[state 835, velset]
type = velset
trigger1 = time = 0
x= -12
y= -2

[state 835, gravity]
type = veladd
trigger1 = time > 0
y = 1.25

[state 835, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 835, end1]
type = selfstate
trigger1 = time >= 30
value = 50
ctrl = 1

[state 835, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;Grab Escape - p1
[statedef 836]
type = A
movetype = H
physics = N
anim = 43
ctrl = 0

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 12
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 835, targetfacing]
type = targetfacing
trigger1 = time = 0
value = -1
persistent = 1

[state 835, velset]
type = velset
trigger1 = time = 0
x= -12
y= -2

[state 835, removeexplod]
type = removeexplod
trigger1 = numexplod(840)
id = 840
ignorehitpause = 1

[state 835, gravity]
type = veladd
trigger1 = time > 0
y = 1.25

[state 835, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 835, end1]
type = selfstate
trigger1 = time >= 29
value = 50
ctrl = 1

[state 835, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------


;--------------------------------------------------------------------------------------------------
[Statedef 840]
type    = A
movetype= A
physics = N
anim = 840
poweradd = 0
sprpriority = -2

[State 840, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdfwd"

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 835
value = 836
persistent = 1

[state 840, velmul]
type = velmul
trigger1 = time = 0
x = 0.1
y = 0.1

[state 840, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 840, extra]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(840)
anim = 841
id = 840
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3

[State 840, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 840, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 7
value = 800, 0

[state 840, sprpriority]
type = sprpriority
trigger1 = animelem = 3
value = -2


[state 840, sprpriority]
type = sprpriority
trigger1 = animelem = 9
value = 3
;==========================================
;Binds
;==========================================

[State 840, Bind 1-2]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 15, -250

[State 840, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 120, -275

[State 840, Bind 4]
type = targetbind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 190, -375

[State 840, Bind 5]
type = targetbind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = 120, -450

[State 840, Bind 6]
type = targetbind
trigger1 = AnimElemTime(5) = 0 
pos = -20, -180



[State 840, holdfwd - Turn 6] 
type = Turn
trigger1 = var(2)
trigger1 = AnimElemtime(1) = 8


[State 840, holdfwd - Turn Target 6] 
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElemtime(1) = 8
value = -1

[state 840, holdback, turn explod]
type = modifyexplod
trigger1 = var(2)
trigger1 = animelemtime(1) = 8
scale = -const(size.xscale),const(size.yscale)
id = 840


[state 3010, bounce]
type = veladd
trigger1 = animelemtime(6) = 0
y = -6
x = 0.5

[State 840, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 5
value = var(16)

[State 840, Throw 11]
type = TargetState
trigger1 = AnimElemtime(5) = 1
value = 851

[state 840, varadd]
type = varadd
trigger1 = animelemtime(5) = 1
var(23) = 2
ignorehitpause = 1
persistent = 0

[state 840, vel add]
type = veladd
trigger1 = animtime = 0
y = -8

[state x, combo damage score]
type = varadd
trigger1 = animtime = 0
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[State 840, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;comboable
;--------------------------------------------------------------------------------------------------
[Statedef 841]
type    = A
movetype= A
physics = N
anim = 840
poweradd = 0
sprpriority = -2

[state 841, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 835
value = 836
persistent = 1

[state 841, velmul]
type = velmul
trigger1 = time = 0
x = 0.1
y = 0.1

[state 841, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 841, extra]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(840)
anim = 841
id = 840
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3

[State 841, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 841, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 7
value = 800, 0

[state 841, sprpriority]
type = sprpriority
trigger1 = animelem = 3
value = -2


[state 841, sprpriority]
type = sprpriority
trigger1 = animelem = 9
value = 3
;==========================================
;Binds
;==========================================

[State 841, Bind 1-2]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 15, -250

[State 841, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 120, -275

[State 841, Bind 4]
type = targetbind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 190, -375

[State 841, Bind 5]
type = targetbind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = 120, -450

[State 841, Bind 6]
type = targetbind
trigger1 = AnimElemTime(5) = 0 
pos = -20, -180



[State 841, holdfwd - Turn 6] 
type = Turn
trigger1 = var(2)
trigger1 = AnimElemtime(1) = 8


[State 841, holdfwd - Turn Target 6] 
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElemtime(1) = 8
value = -1

[state 841, holdback, turn explod]
type = modifyexplod
trigger1 = var(2)
trigger1 = animelemtime(1) = 8
scale = -const(size.xscale),const(size.yscale)
id = 840


[state 3010, bounce]
type = veladd
trigger1 = animelemtime(6) = 0
y = -6
x = 0.5


[State 841, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 5
value = var(16)

[State 841, Throw 11]
type = TargetState
trigger1 = AnimElemtime(5) = 1
value = 851

[state 840, varadd]
type = varadd
trigger1 = animelemtime(5) = 1
var(23) = 1
ignorehitpause = 1
persistent = 0

[state 841, vel add]
type = veladd
trigger1 = animtime = 0
y = -8

[state x, combo damage score]
type = varadd
trigger1 = animtime = 0
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[State 841, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Victime states
[Statedef 850]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 850, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 850

[state 850, tech throw]
type = changestate
triggerall = time < 12
triggerall = p2stateno != 841
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
value = 835

[state 850, screenbound]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 0

[State 850, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------

[Statedef 851]
type    = A
movetype= H
physics = N
velset = 40,15
poweradd = 40

[State 851, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = 1.6

[state 851, screenbound]
type = screenbound
trigger1 = time < 12
movecamera = 0,1
value = 1

[State 851, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground


;===========================================================================
;                            Rolling Facesit
;===========================================================================
;Light Version
[statedef 1000]
type = C
movetype = A
physics = S
anim = 1000
ctrl = 0
velset = 0,0
poweradd = 150
sprpriority = -2

[state 1000, varset]
type = varset
trigger1 = time = 0
var(5) = 1

[state 1101, dust]
type = explod
trigger1 = animelemtime(5) = 0
anim = 2020
postype = p1
pos = -180,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 1

[state 1000, velset]
type = velset
trigger1 = animelemtime(5) >= 0 && animelemtime(8) < 0
x = 30



[state 1000, nothitby]
type = nothitby
trigger1 = animelemtime(3) >= 0  
value = ,AP
ignorehitpause = 1

[state 1000, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = N
statetype = A
ignorehitpause = 1

[state 1000, velset]
type = velset
trigger1 = animelemtime(8) = 0
x = 30
y = -18

[state 1000, velset]
type = velmul
trigger1 = moveguarded
x = -0.25
persistent = 0
ignorehitpause = 1

[state 1000, Bounce]
type = velset
trigger1 = moveguarded
y = -18
persistent = 0
ignorehitpause = 1

[State 1000, Hitdef]
type = HitDef
trigger1 = !movecontact
trigger1 = p2stateno != [150,155]
attr = S, ST
persistent = 0
priority = 1,miss
animtype  = Medium
damage    = 0
guardflag = 
hitflag = M-
id = 1000
pausetime = 0,0
sparkno = 0
hitonce = 1
sparkxy = -40,-210
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
guard.hittime = 12
p2facing = 1
guard.velocity = -16
guard.slidetime = 14
guard.dist = 0
p1stateno = 1005
p2stateno = 1030

[state 1000, Explod]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1002
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
id = 1000
removeongethit = 1
sprpriority = 2

[state 1000, gravity]
type = gravity
trigger1 = animelemtime(8) > 0
trigger1 = pos y < 0


[state 1000, landing]
type = changestate
triggerall = animelemtime(8) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1001

;---------------------------------------------------------------------------
;Missed Landing
[statedef 1001]
type = S
movetype = I
physics = S
anim = 1001

[state 1001, removexplod]
type = removeexplod
trigger1 = numexplod(1000)
id = 1000

[state 1001, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1001, poset]
type = posset
trigger1 = time = 0
y = 0

[state 1001, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1 

;----------------------------------------------------------------------------
;Hit
[statedef 1005]
type = A
movetype = A
physics = N
anim = 1005
sprpriority = -3
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1005, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 1005, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 1005, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 1005, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

[state 651, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)
ignorehitpause = 1

[state 651, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 1005, width]
type = width
trigger1 = 1
edge = 200,200
ignorehitpause = 1

[state 1005, removeexplod]
type = removeexplod
trigger1 = numexplod(1000)
ignorehitpause = 1
id = 1000

[state 1000, Explod]
type = Explod
trigger1 = !numexplod(1005)
anim = 1007
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
id = 1005
removeongethit = 1
sprpriority = 2
ignorehitpause = 1

[state 1005, damage]
type = targetlifeadd
trigger1 = time = 0
value = -ceil(fvar(10) * -10)

[state 1005, velset]
type = velset 
trigger1 = time = 0 
y = -8

[state 1005, gravity]
type = gravity
trigger1 = 1

;----------
;Binds
;----------
[state 1005, Bind 1]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = 114, -334

[state 1005, bind 2]
type = targetbind
trigger1 = animelemtime(2) >= 0
pos = 142, -148

[state 1005, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1006

;--------------------------------------------------------------------------
;Landing with target
[statedef 1006]
type = C
movetype = A
physics = C
anim = 1006
poweradd = 20
sprpriority = -3
movehitpersist = 1

[state 1006, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 1006, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 1006, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 1006, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 1006, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice


[state 1006, velset]
type = velset
trigger1 = anim = 1006
trigger1 = time = 0
x = 0
y = 0

[state 1006, removeexplod]
type = removeexplod
trigger1 = numexplod(1005)
id = 1005

[state 1006, explod]
type = explod
trigger1 = time = 0
anim = 1008
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
id = 1006
removeongethit = 1
sprpriority = 2
bindtime = -1

[state 1006, evnshake]
type = envshake
trigger1 = time = 0
ampl = -16
time = 24

[state 1006, playsnd]
type = playsnd
trigger1 = time = 0
value = S1000,0

[state 1006, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -150)
id = 1000

[state 1006, Targetstate]
type = targetstate
trigger1 = time = 0
value = 1031
id = 1000

[state 1006, on face]
type = posset
trigger1 = anim = 1006
trigger1 = time = 0
y = 0

[state 1006, statetypeset]
type = statetypeset
trigger1 = animtime = 0
trigger1 = anim = 1006
physics = N


[state 1006, targetbind]
type = targetbind
trigger1 = anim = 1006
pos = 40,0

[state 1006, targetstate]
type = targetstate
trigger1 = anim = 1006
trigger1 = animtime = 0
value = 1032

[state 1006, turn]
type = turn
trigger1 = anim = 1006
trigger1 = animtime = 0

[state 1006, Bounce]
type = velset
trigger1 = anim = 1006
trigger1 = animtime = 0
x = -16
y = -24

[state 1006, nothitby]
type = nothitby
trigger1 = anim = 43
value = SCA

[state 1006, add on Drain]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) >= 4 && animelemtime(4) < 36 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1360)

[state 1006, add on Damage]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) >= 4 && animelemtime(4) < 36 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380, 1300)


[state 1006, add on Meter Gain]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) >= 4 && animelemtime(4) < 36 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1320)

[state 1006, add on Heal]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) >= 4 && animelemtime(4) < 36 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1340)

[state 1006, anim]
type = changeanim
trigger1 = anim = 1006
trigger1 = animtime = 0
value = 43

[state 648, Passive increase]
type = varadd
trigger1 = anim = 43
var(23) = 1
persistent = 0

[state 1006, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1006, gravity]
type = gravity
trigger1 = anim != 1006
trigger1 = pos y < 0

[state 1006, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 1

;--------------------------------------------------------------------------
;Heavy Version
[statedef 1010]
type = C
movetype = A
physics = S
anim = 1010
poweradd = 180
ctrl = 0
velset = 0,0
sprpriority = -2

[state 1010, varset]
type = varset
trigger1 = time = 0
var(5) = 1

[state 1010, velset]
type = velset
trigger1 = animelemtime(5) >= 0 && animelemtime(8) < 0
x = 22

[state 1101, dust]
type = explod
trigger1 = animelemtime(5) = 0
anim = 2020
postype = p1
pos = -180,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 1

[state 1010, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
statetype = A
physics = N
ignorehitpause = 1

[state 1010, nothitby]
type = nothitby
trigger1 = animelemtime(3) >= 0  
value = ,AP
ignorehitpause = 1

[state 1010, velset]
type = velset
trigger1 = animelemtime(8) = 0
x = 18
y = -18

[state 1010, velset]
type = velmul
trigger1 = moveguarded
x = -0.25
persistent = 0
ignorehitpause = 1

[state 1010, Bounce]
type = velset
trigger1 = moveguarded
y = -24
persistent = 0
ignorehitpause = 1

[State 1010, Hitdef]
type = HitDef
trigger1 = p2stateno != [150,155]
attr = S, ST
animtype  = Medium
damage    = 0,15
guardflag = 
hitflag = M-
id = 1000
hitonce = 1
pausetime = 0,0
sparkno = 0
sparkxy = -40,-210
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
guard.hittime = 12
guard.velocity = -16
guard.slidetime = 14
p2facing = 1
guard.dist = 0
p1stateno = 1015
p2stateno = 1030

[state 1010, Explod]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1012
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
id = 1000
removeongethit = 1
sprpriority = 2

[state 1010, gravity]
type = gravity
trigger1 = pos y < 0
trigger1 = animelemtime(8) > 0


[state 1010, landing]
type = changestate
triggerall = animelemtime(8) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1011

;---------------------------------------------------------------------------
;Missed Landing
[statedef 1011]
type = S
movetype = I
physics = S
anim = 1011

[state 1011, removexplod]
type = removeexplod
trigger1 = numexplod(1000)
id = 1000

[state 1011, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1011, poset]
type = posset
trigger1 = time = 0
y = 0

[state 1011, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1 

;----------------------------------------------------------------------------
;Hit
[statedef 1015]
type = A
movetype = A
physics = N
anim = 1005
sprpriority = -3
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1015, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 1015, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 1015, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 1015, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

[state 1015, removeexplod]
type = removeexplod
trigger1 = numexplod(1000)
ignorehitpause = 1
id = 1000

[state 651, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)
ignorehitpause = 1

[state 1015, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 1005, width]
type = width
trigger1 = 1
edge = 200,200
ignorehitpause = 1

[state 1015, Explod]
type = Explod
trigger1 = !numexplod(1005)
anim = 1007
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
id = 1005
removeongethit = 1
sprpriority = 2
ignorehitpause = 1

[state 1015, damage]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -10)

[state 1015, velset]
type = velset 
trigger1 = time = 0 
y = -15

[state 1015, gravity]
type = gravity
trigger1 = 1

;----------
;Binds
;----------
[state 1015, Bind 1]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = 114, -334

[state 1015, bind 2]
type = targetbind
trigger1 = animelemtime(2) >= 0
pos = 142, -148

[state 1015, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1016

;--------------------------------------------------------------------------
;Landing with target
[statedef 1016]
type = C
movetype = A
physics = C
anim = 1006
poweradd = 20
sprpriority = -3
movehitpersist = 1

[state 1016, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 1016, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 1016, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 1016, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 1016, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4


;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1016, velset]
type = velset
trigger1 = anim = 1006
trigger1 = time = 0
x = 0
y = 0

[state 1016, removeexplod]
type = removeexplod
trigger1 = numexplod(1005)
id = 1005

[state 1016, explod]
type = explod
trigger1 = time = 0
anim = 1008
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
id = 1006
removeongethit = 1
sprpriority = 2
bindtime = -1

[state 1016, evnshake]
type = envshake
trigger1 = time = 0
ampl = -16
time = 18

[state 1016, playsnd]
type = playsnd
trigger1 = time = 0
value = S1000,0

[state 1016, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -170)

[state 1016, Targetstate]
type = targetstate
trigger1 = time = 0
value = 1031

[state 1016, on face]
type = posset
trigger1 = anim = 1006
trigger1 = time = 0
y = 0

[state 1016, statetypeset]
type = statetypeset
trigger1 = anim = 1006
trigger1 = animtime = 0
physics = N


[state 1016, targetbind]
type = targetbind
trigger1 = anim = 1006
pos = 40,0

[state 652, add on Drain]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 12 && animelemtime(4) <= 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) =3
value = ifelse(var(24) = 3, 1380, 1360)

[state 652, add on damage]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 12 && animelemtime(4) <= 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) =4
value = ifelse(var(24) = 4, 1380, 1300)


[state 10X6, add on Rest]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 12 && animelemtime(4) <= 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1320)

[state 10X6, add on Heal]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) >= 12 && animelemtime(4) < 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1340)

[state 1016, targetstate]
type = targetstate
trigger1 = anim = 1006
trigger1 = animtime = 0
value = 1032

[state 1016, turn]
type = turn
trigger1 = anim = 1006
trigger1 = animtime = 0

[state 1016, Bounce]
type = velset
trigger1 = anim = 1006
trigger1 = animtime = 0
x = -16
y = -24

[state 1006, nothitby]
type = nothitby
trigger1 = anim = 43
value = SCA
persistent = 1

[state 1016, anim]
type = changeanim
trigger1 = anim = 1006
trigger1 = animtime = 0
value = 43

[state 1016, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 648, Passive increase]
type = varadd
trigger1 = anim = 43
var(23) = 1
persistent = 0

[state 1016, gravity]
type = gravity
trigger1 = anim != 1006

[state 1016, end]
type = changestate

trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 1

;---------------------------------------------------------------------------
;EX version
[statedef 1020]
type = C
movetype = A
physics = S
anim = 1020
ctrl = 0
velset = 0,0
sprpriority = -2
poweradd = -500

[state 1020, varset]
type = varset
trigger1 = time = 0
var(5) = 2

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1101, dust]
type = explod
trigger1 = animelemtime(5) = 0
anim = 2020
postype = p1
pos = -180,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 1

[state 1020, velset]
type = velset
trigger1 = animelemtime(5) >= 0 && animelemtime(8) < 0
x = 60


[state 1020, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
statetype = A
physics = N
ignorehitpause = 1

[state 1020, nothitby]
type = nothitby
trigger1 = 1 
value = ,AP
ignorehitpause = 1

[state 1020, velset]
type = velset
trigger1 = animelemtime(8) = 0
x = 33
y = -18

[state 1020, velset]
type = velmul
trigger1 = moveguarded
x = -0.5
persistent = 0
ignorehitpause = 1

[state 1020, Bounce]
type = velset
trigger1 = moveguarded
y = -15
persistent = 0
ignorehitpause = 1

[State 1020, Hitdef]
type = HitDef
trigger1 = p2stateno != [150,155]
attr = S, ST
animtype  = Medium
damage    = 0,12
guardflag = 
hitflag = M-
id = 1000
pausetime = 0,0
sparkno = 0
hitonce = 1
sparkxy = -40,-210
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
guard.hittime = 12
guard.velocity = -16
guard.slidetime = 14
p2facing = 1
guard.dist = 0
p1stateno = 1025
p2stateno = 1030

[state 1020, Explod]
type = Explod
trigger1 = animelemtime(7) = 0
anim = 1022
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
id = 1000
removeongethit = 1
sprpriority = 2

[state 1020, gravity]
type = gravity
trigger1 = pos y < 0
trigger1 = animelemtime(8) > 0


[state 1020, landing]
type = changestate
triggerall = animelemtime(8) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1021

;---------------------------------------------------------------------------
;Missed Landing
[statedef 1021]
type = S
movetype = I
physics = S
anim = 1021

[state 1021, removexplod]
type = removeexplod
trigger1 = numexplod(1000)
id = 1000

[state 1021, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1021, poset]
type = posset
trigger1 = time = 0
y = 0

[state 1021, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1 

;----------------------------------------------------------------------------
;Hit
[statedef 1025]
type = A
movetype = A
physics = N
anim = 1005
sprpriority = -3
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1025, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 1025, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 1025, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 1025, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

[state 651, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)
ignorehitpause = 1

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1025, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 1025, removeexplod]
type = removeexplod
trigger1 = numexplod(1000)
ignorehitpause = 1
id = 1000

[state 1005, width]
type = width
trigger1 = 1
edge = 200,200
ignorehitpause = 1

[state 1025, Explod]
type = Explod
trigger1 = !numexplod(1005)
anim = 1007
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
id = 1005
removeongethit = 1
sprpriority = 2
ignorehitpause = 1

[state 1025, damage]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -10)

[state 1025, velset]
type = velset 
trigger1 = time = 0 
y = -15

[state 1025, gravity]
type = gravity
trigger1 = 1

;----------
;Binds
;----------
[state 1025, Bind 1]
type = targetbind
trigger1 = animelemtime(2) < 0
pos = 114, -334

[state 1025, bind 2]
type = targetbind
trigger1 = animelemtime(2) >= 0
pos = 142, -148

[state 1025, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1026

;--------------------------------------------------------------------------
;Landing with target
[statedef 1026]
type = C
movetype = A
physics = C
anim = 1006
sprpriority = -3
movehitpersist = 1

[state 1026, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 1026, Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "x"
var(24) = 1

[state 1026, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "y"
var(24) = 2

[state 1026, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "a"
var(24) = 3

[state 1026, opponents guess]
type = varset
trigger1 = numtarget(1000)
trigger1 = target(1000),command = "b"
var(24) = 4

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1000)
trigger1 = target(1000),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1026, velset]
type = velset
trigger1 = anim = 1006
trigger1 = time = 0
x = 0
y = 0

[state 1026, removeexplod]
type = removeexplod
trigger1 = numexplod(1005)
id = 1005

[state 1026, explod]
type = explod
trigger1 = time = 0
anim = 1008
scale = const(size.xscale),const(size.yscale)
postype = p1
id = 1006
pos = 0,0
removeongethit = 1
sprpriority = 2
bindtime = -1

[state 1026, evnshake]
type = envshake
trigger1 = time = 0
ampl = -16
time = 18

[state 1026, playsnd]
type = playsnd
trigger1 = time = 0
value = S1000,0

[state 1026, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -170)

[state 1026, Targetstate]
type = targetstate
trigger1 = time = 0
value = 1031

[state 1026, on face]
type = posset
trigger1 = anim = 1006
trigger1 = time = 0
y = 0

[state 1026, statetypeset]
type = statetypeset
trigger1 = anim = 1006
trigger1 = animtime = 0
physics = N


[state 1026, targetbind]
type = targetbind
trigger1 = anim = 1006
pos = 40,0

[state 652, add on Drain]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 12 && animelemtime(4) <= 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1360)

[state 652, add on damage]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 12 && animelemtime(4) <= 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380, 1300)


[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) > 12 && animelemtime(4) <= 24 
triggerall = anim = 1006
triggerall = movehit
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1320)

[state 1006, add on damage]
type = changestate
triggerall = numtarget(1000)
triggerall = target(1000),alive
triggerall = animelemtime(4) >= 12 && animelemtime(4) < 24 
triggerall = anim = 1006
triggerall = movehit
triggerall = numenemy
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1340)

[state 1026, targetstate]
type = targetstate
trigger1 = anim = 1006
trigger1 = animtime = 0
value = 1032

[state 1006, nothitby]
type = nothitby
trigger1 = anim = 43
value = SCA
persistent = 1

[state 1026, turn]
type = turn
trigger1 = anim = 1006
trigger1 = animtime = 0

[state 1026, Bounce]
type = velset
trigger1 = anim = 1006
trigger1 = animtime = 0
x = -16
y = -30

[state 1026, anim]
type = changeanim
trigger1 = anim = 1006
trigger1 = animtime = 0
value = 43

[state 648, Passive increase]
type = varadd
trigger1 = anim = 43
var(23) = 1
persistent = 0

[state 1026, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1026, gravity]
type = gravity
trigger1 = anim != 1006

[state 1026, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 1

;---------------------------------------------------------------------------
;Eat that ass!
[Statedef 1030]
type    = A
movetype= H
physics = N
velset = 0,0

[State 1030, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1030

[State 1030, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Face Up Ass down
[Statedef 1031]
type    = A
movetype= H
physics = N
velset = 0,0

[State 1031, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1031

[state 1031, angledraw]
type = angledraw
trigger1 = 1
scale = 1.2,0.2
value = 0

[State 1031, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
[Statedef 1032]
type    = A
movetype= H
physics = N
velset = 2,-18
poweradd = 40

[State 1032, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = 1.6

[State 1032, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground


;===========================================================================
;                           Anti Air Facesit
;===========================================================================
;Light/Default version
[statedef 1050]
type = A
movetype = A
physics = N
anim = 1050
poweradd = 120
ctrl = 0
velset = 0,0

[state 1050, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1050, Bounces]
type = varset
trigger1 = time = 0
var(5) = 1

[state 1050, Jump]
type = velset
trigger1 = animelemtime(3) = 0
x = 14
y = -35

[state 1052, fx]
type = explod
trigger1 = animelemtime(3) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1
ownpal = 1

[state 1050, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1050,0

[State 1050, Hitdef]
type = HitDef
trigger1 = !movecontact
trigger1 = enemynear,stateno != [150,155]
attr = A, ST
animtype  = Up
damage    = 0
persistent = 0
guardflag = 
hitflag = A-
priority = 1, miss
id = 1050
pausetime = 0,0
sparkno = 0
hitonce = 1
getpower = 0
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
p2facing = 1
guard.dist = 0
p1stateno = 1052
p2stateno = 1080
kill = 0

[state 1050, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1050,2

[state 1050, gravity]
type = gravity
trigger1 = pos y < 0

[state 1050, x brakes]
type = velmul
trigger1 = movecontact
trigger1 = vel y > 1
x = 0.1
persistent = 0


[state 1050, nothitby]
type = nothitby
trigger1 = animelemtime(4) < 8
value = A
ignorehitpause = 1

[state 1050, Miss land]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1051

[state 1050, Hit land]
type = changestate
triggerall = movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1053

;---------------------------------------------------------------------------
;Miss Landing
[statedef 1051]
type = C
movetype = I
physics = C
anim = 1051

[state 1051, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 12

[state 1051, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1051, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1051, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------
;Hit Air
[statedef 1052]
type = A
movetype = A
physics = N
anim = 1052
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1052 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1052, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1052, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1052, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1,1

[state 1052, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 1052, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1052)
anim = 1056
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 1052

[state 1052, bounce up]
type = velmul
trigger1 = time = 1
x = 0.1
y = 0.1


[state 1052, posset]
type = posadd
trigger1 = time = 0
y = -100

[state 1052, gravity]
type = veladd
trigger1 = animelemtime(3) > 0 && animelemtime(7) < 0
y = 0.22
persistent = 1
;======================================================
;                   Binds
;=====================================================
[state 1050, targetbind]
type = targetbind
trigger1 = animelem = 1
pos = 298, -377
persistent = 1


[state 1050, targetbind]
type = targetbind
trigger1 = animelem = 2
pos = 294, -300
persistent = 1


[state 1050, targetbind]
type = targetbind
trigger1 = animelem = 3
pos = 290, -222
persistent = 1


[state 1050, targetbind]
type = targetbind
trigger1 = animelem = 4
pos = 166, -204
persistent = 1


[state 1050, targetbind]
type = targetbind
trigger1 = animelem = 5
pos = 142, -148
persistent = 1

[state 1050, targetbind]
type = targetbind
trigger1 = animelem = 6
pos = 50, -100
persistent = 1

[state 1050, veladd]
type = velset
trigger1 = animelemtime(7) = 0
y = 30
x = 0
persistent = 0

[state 1050, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1050, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1050, targetbind]
type = targetbind
trigger1 = animelemtime(7) >= 0
pos = 56, -122
persistent = 1

[state 1052, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1053


;----------------------------------------------------------------------------
;Hit Landing1
[statedef 1053]
type = C
movetype = A
physics = C
anim = 1053
sprpriority = -2
poweradd = 130
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1053 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1053, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1053, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1053, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 1053, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)

[state 1053, width]
type = width
trigger1 = 1
edge = 200,200

[state 1052, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1053)
anim = 1057
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removetime = -1
removeongethit = 1
id = 1053

[state 1052, removeexplod]
type = removeexplod
trigger1 = numexplod(1052)
id = 1052

[state 1052, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 5,2
ownpal = 1
sprpriority = -3

[state 1052, targetstate]
type = targetstate
trigger1 = time = 0
value = 1081

[state 1052, targetdamage]
type = targetlifeadd
trigger1 = time = 0
id = 1050
value = ceil(fvar(10) * -150)
persistent = 0

[state 1073, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
id = 1050
value = 130
persistent = 0

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1052, quakes]
type = envshake
trigger1 = time = 0
ampl = 18
time = 24


[state 1052, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1052, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1052, Bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -12

[state 1052, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A

[state 1052, gravity]
type = gravity
trigger1 = animelemtime(3) > 0

[state 1052, Miss land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1054

;----------------------------------------------------------------------------
;Hit Landing2
[statedef 1054]
type = C
movetype = A
physics = C
anim = 1054
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1054 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1054, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1054, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1054, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1370)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380, 1310)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1330)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1350)


[state 1052, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1054)
anim = 1058
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 1054

[state 1054, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1.5
ownpal = 1
sprpriority = -3

[state 1052, removeexplod]
type = removeexplod
trigger1 = numexplod(1053)
id = 1053

[state 1053, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1
volumescale = 50

[state 1052, quakes]
type = envshake
trigger1 = time = 0
ampl = 12
time = 18

[state 1053, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1052, Miss land]
type = changestate
trigger1 = animtime = 0
value = 1055

;-----------------------------------------------------------------------------
;Jump off
[statedef 1055]
type = A
movetype = I
physics = N
velset = 18,-24
anim = 42

[state 648, Passive increase]
type = varadd
trigger1 = time = 0
var(23) = 1
persistent = 0

[state 1054, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1054, gravity]
type = gravity
trigger1 = pos y < 0

[state 1054, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52

;-----------------------------------------------------------------------------
;Heavy Version
[statedef 1060]
type = A
movetype = A
physics = N
anim = 1060
poweradd = 140
ctrl = 0
velset = 0,0

[state 1060, Bounces]
type = varset
trigger1 = time = 0
var(5) = 1

[state 1060, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1060, Jump]
type = velset
trigger1 = animelemtime(3) = 0
x = 16
y = -41

[state 1060, fx]
type = explod
trigger1 = animelemtime(3) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1
ownpal = 1

[state 1060, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1050,0

[State 1060, Hitdef]
type = HitDef
trigger1 = time = 0
attr = A, ST
animtype  = Up
damage    = 0
guardflag = 
hitflag = A-
priority = 1, miss
id = 1050
pausetime = 0,0
sparkno = 0
hitonce = 1
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
guard.hittime = 12
guard.velocity = -16
guard.slidetime = 14
guard.dist = 0
p2facing = 1
p1stateno = 1062
p2stateno = 1080
kill = 0

[state 1060, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1050,2



[state 1060, gravity]
type = gravity
trigger1 = pos y < 0

[state 1060, nothitby]
type = nothitby
trigger1 = animelemtime(4) < 8
value = A
ignorehitpause = 1

[state 1060, Miss land]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1061

[state 1060, hit land]
type = changestate
triggerall = movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1063

;---------------------------------------------------------------------------
;Miss Landing
[statedef 1061]
type = C
movetype = I
physics = C
anim = 1061

[state 1051, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 12

[state 1051, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1051, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1051, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------
;Hit Air
[statedef 1062]
type = A
movetype = A
physics = N
anim = 1052
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1062 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1062, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1062, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1062, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1,1

[state 1062, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 1062, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1052)
anim = 1056
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 1052

[state 1062, bounce up]
type = velmul
trigger1 = time = 1
x = 0.1
y = 0.1


[state 1062, posset]
type = posadd
trigger1 = time = 0
y = -100

[state 1062, gravity]
type = veladd
trigger1 = animelemtime(3) > 0 && animelemtime(7) < 0
y = 0.22
persistent = 1
;======================================================
;                   Binds
;=====================================================
[state 1062, targetbind]
type = targetbind
trigger1 = animelem = 1
pos = 298, -377
persistent = 1


[state 1062, targetbind]
type = targetbind
trigger1 = animelem = 2
pos = 294, -300
persistent = 1


[state 1062, targetbind]
type = targetbind
trigger1 = animelem = 3
pos = 290, -222
persistent = 1


[state 1062, targetbind]
type = targetbind
trigger1 = animelem = 4
pos = 166, -204
persistent = 1


[state 1062, targetbind]
type = targetbind
trigger1 = animelem = 5
pos = 142, -148
persistent = 1

[state 1062, targetbind]
type = targetbind
trigger1 = animelem = 6
pos = 50, -100
persistent = 1

[state 1062, veladd]
type = velset
trigger1 = animelemtime(7) = 0
y = 30
x = 0
persistent = 0

[state 1062, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1062, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1062, targetbind]
type = targetbind
trigger1 = animelemtime(7) >= 0
pos = 56, -122
persistent = 1

[state 1062, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1063


;----------------------------------------------------------------------------
;Hit Landing1
[statedef 1063]
type = C
movetype = A
physics = C
anim = 1053
sprpriority = -2
poweradd = 160
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1063 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1063, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1063, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1063, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 1063, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)

[state 1053, width]
type = width
trigger1 = 1
edge = 200,200

[state 1063, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1053)
anim = 1057
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removetime = -1
removeongethit = 1
id = 1053

[state 1063, removeexplod]
type = removeexplod
trigger1 = numexplod(1052)
id = 1052

[state 1063, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 5,2
ownpal = 1
sprpriority = -3

[state 1063, targetstate]
type = targetstate
trigger1 = time = 0
value = 1081

[state 1063, targetdamage]
type = targetlifeadd
trigger1 = time = 0
id = 1050
value = floor(fvar(10) * -180)
persistent = 0

[state 1073, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
id = 1050
value = 180
persistent = 0

[state 1063, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1063, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1063, quakes]
type = envshake
trigger1 = time = 0
ampl = 18
time = 24


[state 1063, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1063, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1063, Bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -15

[state 1063, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A

[state 1063, gravity]
type = gravity
trigger1 = animelemtime(3) > 0

[state 1063, Miss land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1064

;----------------------------------------------------------------------------
;Hit Landing2
[statedef 1064]
type = C
movetype = A
physics = C
anim = 1054
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1064 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1064, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1064, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1064, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1370)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380, 1310)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24)= 1, 1380, 1330)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1350)


[state 1064, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1054)
anim = 1058
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 1054

[state 1054, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1.5
ownpal = 1
sprpriority = -3

[state 1064, removeexplod]
type = removeexplod
trigger1 = numexplod(1053)
id = 1053

[state 1064, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1064, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1
volumescale = 50

[state 1064, quakes]
type = envshake
trigger1 = time = 0
ampl = 12
time = 18

[state 1064, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1064, Miss land]
type = changestate
trigger1 = animtime = 0
value = 1065

;-----------------------------------------------------------------------------
;Jump off
[statedef 1065]
type = A
movetype = I
physics = N
velset = 15,-26
anim = 42

[state 648, Passive increase]
type = varadd
trigger1 = time = 0
var(23) = 1
persistent = 0

[state 1065, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1065, gravity]
type = gravity
trigger1 = pos y < 0

[state 1065, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52

;-----------------------------------------------------------------------------
;Ex Version
[statedef 1070]
type = A
movetype = A
physics = N
anim = 1070
ctrl = 0
poweradd = -500
velset = 0,0


[state 1060, Bounces]
type = varset
trigger1 = time = 0
var(5) = 2

[state 1070, playerpush]
type = playerpush
trigger1 = 1
value = 0

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1070, Jump]
type = velset
trigger1 = animelemtime(3) = 0
x = 24
y = -38

[state 1070, fx]
type = explod
trigger1 = animelemtime(3) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1
ownpal = 1

[state 1070, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1050,0

[State 1070, Hitdef]
type = HitDef
trigger1 = time = 0
trigger1 = p2stateno != [150,155]
attr = A, ST
animtype  = Up
damage    = 0
guardflag = 
getpower = 0
hitflag = A-
priority = 1, miss
id = 1050
pausetime = 0,0
sparkno = 0
hitonce = 1
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
guard.hittime = 12
guard.velocity = -16
guard.slidetime = 14
guard.dist = 0
p2facing = 1
p1stateno = 1072
p2stateno = 1080
kill = 0

[state 1070, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1050,2



[state 1070, gravity]
type = gravity
trigger1 = pos y < 0

[state 1070, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 1070, Miss land]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1071

[state 1070, Hit land]
type = changestate
triggerall = movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1073

;---------------------------------------------------------------------------
;Miss Landing
[statedef 1071]
type = C
movetype = I
physics = C
anim = 1071

[state 1071, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 12

[state 1071, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1071, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1071, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------
;Hit Air
[statedef 1072]
type = A
movetype = A
physics = N
anim = 1052
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1072 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1072, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1072, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1072, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1072, varadd]
type = varadd
trigger1 = time = 0
trigger1 = var(23) != 0
var(5) = var(23)
ignorehitpause = 1
persistent = 0

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 1,1

[state 1072, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1052)
anim = 1056
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 1052

[state 1072, bounce up]
type = velmul
trigger1 = time = 1
x = 0.1
y = 0.1


[state 1072, posset]
type = posadd
trigger1 = time = 0
y = -100

[state 1072, gravity]
type = veladd
trigger1 = animelemtime(3) > 0 && animelemtime(7) < 0
y = 0.22
persistent = 1
;======================================================
;                   Binds
;=====================================================
[state 1072, targetbind]
type = targetbind
trigger1 = animelem = 1
pos = 298, -377
persistent = 1


[state 1072, targetbind]
type = targetbind
trigger1 = animelem = 2
pos = 294, -300
persistent = 1


[state 1072, targetbind]
type = targetbind
trigger1 = animelem = 3
pos = 290, -222
persistent = 1


[state 1072, targetbind]
type = targetbind
trigger1 = animelem = 4
pos = 166, -204
persistent = 1


[state 1072, targetbind]
type = targetbind
trigger1 = animelem = 5
pos = 142, -148
persistent = 1

[state 1072, targetbind]
type = targetbind
trigger1 = animelem = 6
pos = 50, -100
persistent = 1

[state 1072, veladd]
type = velset
trigger1 = animelemtime(7) = 0
y = 30
x = 0
persistent = 0

[state 1072, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1072, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1072, gravity]
type = gravity
trigger1 = animelemtime(7) > 0 

[state 1072, targetbind]
type = targetbind
trigger1 = animelemtime(7) >= 0
pos = 56, -122
persistent = 1

[state 1072, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1073


;----------------------------------------------------------------------------
;Hit Landing1
[statedef 1073]
type = C
movetype = A
physics = C
anim = 1053
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 647, Option AI]
type = varset
trigger1 = time = 0
var(12) = (random%5)

[state 1073 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1073, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1073, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1073, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 1053, width]
type = width
trigger1 = 1
edge = 200,200

[state 1073, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1053)
anim = 1057
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removetime = -1
removeongethit = 1
id = 1053

[state 1073, removeexplod]
type = removeexplod
trigger1 = numexplod(1052)
id = 1052

[state 1073, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 5,2
ownpal = 1

[state 1073, targetstate]
type = targetstate
trigger1 = time = 0
value = 1081

[state 1073, targetdamage]
type = targetlifeadd
trigger1 = time = 0
id = 1050
value = floor(fvar(10) * -150)
persistent = 0

[state 1073, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
id = 1050
value = 150
persistent = 0

[state 1073, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1073, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 1073, quakes]
type = envshake
trigger1 = time = 0
ampl = 21
time = 24


[state 1073, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1073, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1073, Bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -18

[state 1073, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A

[state 1073, gravity]
type = gravity
trigger1 = animelemtime(3) > 0

[state 1073, Miss land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1074

;----------------------------------------------------------------------------
;Hit Landing2
[statedef 1074]
type = C
movetype = A
physics = C
anim = 1054
sprpriority = -2
movehitpersist = 1

;Enemy Choice

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 0
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 00,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4040
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 1
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4042
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 2
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4043
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 3
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4044
persistent = 1

[state 1026, explod enemy choice]
type = explod
trigger1 = var(24) = 4
trigger1 = numtarget(1050)
trigger1 = target(1050),alive
postype = p1
pos = 0,-500
ontop = 1
scale = ifelse(facing = 1, const(size.xscale) * 1.5,const(size.xscale)*-1.5) ,const(size.yscale)*1.5
id = 4040
anim = 4041
persistent = 1

;Test Run enemy Choice

[state 1074 Chain Sit Opponents Guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "x"
var(24) = 1

[state 1074, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "y"
var(24) = 2

[state 1074, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "a"
var(24) = 3

[state 1074, opponents guess]
type = varset
trigger1 = numtarget(1050)
trigger1 = target(1050),command = "b"
var(24) = 4

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "a"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 3
value = ifelse(var(24) = 3, 1380, 1370)

[state 10X6, add on damage]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "b"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 4
value = ifelse(var(24) = 4, 1380,1310)

[state 10X6, add on Meter]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "x"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 1
value = ifelse(var(24) = 1, 1380, 1330)

[state 10X6, add on Healing]
type = changestate
triggerall = numtarget(1050)
triggerall = target(1050),alive
triggerall = animelemtime(3) > 12 && animelemtime(3) <= 24 
triggerall = anim = 1054
triggerall = movehit
trigger1 = command = "y"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = var(12) = 2
value = ifelse(var(24) = 2, 1380, 1350)


[state 1074, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(1054)
anim = 1058
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 1054

[state 1054, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1.5
ownpal = 1
sprpriority = -3

[state 1074, removeexplod]
type = removeexplod
trigger1 = numexplod(1053)
id = 1053

[state 1074, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 1074, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1
volumescale = 50

[state 1074, quakes]
type = envshake
trigger1 = time = 0
ampl = 12
time = 18

[state 1074, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1074, Miss land]
type = changestate
trigger1 = animtime = 0
value = 1075

;-----------------------------------------------------------------------------
;Jump off
[statedef 1075]
type = A
movetype = I
physics = N
velset = 12,-28
anim = 42

[state 648, Passive increase]
type = varadd
trigger1 = time = 0
var(23) = 1
persistent = 0

[state 1075, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1075, gravity]
type = gravity
trigger1 = pos y < 0

[state 1075, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52






;-----------------------------------------------------------------------------
;Face ridden
[statedef 1080]
type = A
movetype = H
physics = N
sprpriority = -1

[state 1080, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1080
persistent = 0

[state 1080, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

;---------------------------------------------------------------------------
;Face ridden impact
[statedef 1081]
type = L
movetype = H
physics = C
sprpriority = -1

[state 1081, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1081, posadd]
type = posadd
trigger1 = time = 0
x = -const(size.mid.pos.y)

[state 1080, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1080, ground]
type = posset
trigger1 = time = 0
y = 0

[state 1080, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1081

[state 1080, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = 1.1, 0.4


[state 1082, end]
type = selfstate
trigger1 = alive
trigger1 = animtime = 0
value = 5120

[state 1082, end]
type = selfstate
trigger1 = !alive
trigger1 = animtime = 0
value = 5150
;---------------------------------------------------------------------------
;Face ridden impact 2
[statedef 1082]
type = L
movetype = H
physics = C
sprpriority = -1

[state 1080, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1082

[state 1080, pos set]
type = posset
trigger1 = animelemtime(4) = 0
y = 0

[state 1082, end]
type = selfstate
trigger1 = animtime = 0
value = 5120
;-----------------------------------------------------------------------------





;===========================================================================
;                            Running Start
;===========================================================================
;Running start - Ready : Light
[statedef 1100]
type = C
movetype = A
physics = S
velset = 0,0
anim = 1100
poweradd = 20
ctrl = 0

[state 1100, end - Dash]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command != "holda"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = random < ailevel * 36
value = 1101
persistent = 1


[state 1100, end - Cancel]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = command = "holda"
trigger2 = roundstate != 2
trigger3 = time > 180
value = 1109
persistent = 1

;----------------------------------------------------------------------------
; Sprint forward
[Statedef 1101]
type    = S
physics = S
movetype = A
anim = 1101
sprpriority = 1
ctrl = 0

[state 1101, Voice]
type = playsnd
trigger1 = time = 0
value = 1101,(random%3)
channel = 0
persistent = 0

[state 1101, running set]
type = varset
trigger1 = time = 0
var(4) = 1

[state 1101, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1100, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1100,0
persistent = 0
channel = 1

[state 1101, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 250,-176
scale = const(size.xscale)*7,const(size.yscale)*7
sprpriority = 3
bindtime = 2
persistent = 0
trans = addalpha
alpha = 256,192

[state 1111, meter gain]
type = poweradd
trigger1 = time%2
value = 4
persistent = 1

[state 1101, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = -218,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 0

[State 1101, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*ifelse(command = "holdfwd", 1.375, 1.25)
y = 0
persistent = 1

[state 1101, dust]
type = explod
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(1) = 1
anim = 2020
postype = p1
pos = -218,0
vel = 0,0
scale = const(size.xscale)*1,const(size.yscale)*1
persistent = 1


[state 1101, attack]
type = changestate
trigger1 = command = "b" 
value = 1102

[state 1101, attack]
type = changestate
trigger1 = command = "y" 
value = 1111

[state 1101, attack]
type = changestate
trigger1 = command = "x" 
value = 1108

[state 1101, attack]
type = changestate
trigger1 =  command = "a"
value = 1110

[State 1101, 4]
type = ChangeState
triggerall = time > 6
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = roundstate != 2
trigger3 = time > 60
value = 1108


;--------------------------------------------------------------------------------------------------
;Running Butt Bump
[statedef 1102]
type = A
movetype = A
physics = N
anim = 1102
ctrl = 0
poweradd = 80
sprpriority = -3

[state 1102, slowdown]
type = velmul
trigger1 = time = 0
x = 0.75

[state 1102, Jump]
type = velset
trigger1 = time = 0
y = -18

[state 1102, gravity]
type = gravity
trigger1 = time > 0

[State 1102, Hitdef]
type = HitDef
trigger1 = AnimElem = 4
attr = S, SA
persistent = 0
animtype  = Back
damage    = 120,ifelse(p2statetype = A, 36, 12)
guardflag = MA
pausetime = 18,12
sparkno = 3
sparkxy = -40,-280
hitsound   = S240,0
guardsound = 6,0
ground.type = High
envshake.time = 18
envshake.ampl = 8
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -36,-8
air.velocity = -36,-8
guard.hittime = 29
guard.velocity = -53
guard.slidetime = 29
airguard.velocity = -19,-6
airguard.hittime = 26
fall = 1
fall.recover = 0
fall.recovertime = 40
p1sprpriority = -2
p2sprpriority = 1

[state 1102, Bounce off]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 1103
ignorehitpause = 0

[state 1102, varadd]
type = varadd
trigger1 = movecontact
var(23) = 1
ignorehitpause = 1
persistent = 0

[state 1102, Explod Butt cheek]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = !numexplod(1102)
anim = 1106
id = 1102
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removeongethit = 1
ignorehitpause = 1
sprpriority = 3

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 


[state 1102, Miss landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 1104


;--------------------------------------------------------------------------------------------------
;Blanka Bounce
[statedef 1103]
type = A
movetype = I
physics = N
anim = 1103
movehitpersist = 1

[state 1103, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1103, Bounce]
type = velset
trigger1 = time = 0
x = -4
y = ifelse(p2statetype = A, -10, -20)

[state 1103, gravity]
type = gravity
trigger1 = 1

[state 1103, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Landing Miss
[statedef 1104]
type = C
movetype = I
physics = C
anim = 1104

[state 1103, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1104, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1104, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1104, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1104, Jump]
type = velset
trigger1 = animelemtime(4) = 3
y = -15

[state 1104, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 3
statetype = A
physics = N

[state 1104, gravity]
type = gravity
trigger1 = pos y < -1

[state 1104, end]
type = changestate
trigger1 = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52


;--------------------------------------------------------------------------------------------------
;Brake
[statedef 1108]
type = S
movetype = I
physics = S
anim = 1108
movehitpersist = 1

[state 101, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 11xx, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1108, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1108, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[state 1101, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 4
anim = 2025
postype = p1
pos = 136,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1108, end]
type = changestate
trigger1 = animtime = 0
trigger2 = movehit
trigger2 = time = 3
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------------
;Cancel
[statedef 1109]
type = C
movetype = I
physics = C
anim = 1109

[state 1109, power refund]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno = 1120
value = 500

[state 1109, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------
;Running Slide
[statedef 1110]
type = C
movetype = A
physics = N
anim = 1110
poweradd = 80
ctrl = 0

[state 1110, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = ,AT

[STATE 1110, nothitby]
type = nothitby
trigger1 = animelemtime(2) >= 0  && animelemtime(9) <0
value = ,AP

[state 1110, velmul]
type = velmul
trigger1 = animelemtime(3) = 0
x = 0.8

[state 1110, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = C

[state 1110, statetypeset]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = C

[state 1110, playerpush]
type = playerpush
trigger1 = movehit
trigger1 = p2statetype != L
value = 0
ignorehitpause = 1

[state 1110, Skid sound]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1110,0

[state 1102, varadd]
type = varadd
trigger1 = movehit
var(23) = 2
ignorehitpause = 1
persistent = 0

[state 1101, dust]
type = explod
trigger1 = animelemtime(3) > 0  && animelemtime(5) < 0
persistent = 2
anim = 2025
postype = p1
pos = 400,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1101, dust]
type = explod
trigger1 = animelemtime(3) > 2  && animelemtime(5) < 2
persistent = 2
anim = 2025
postype = p1
pos = -350,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[State 1110, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
persistent = 0
animtype  = Back
damage    = 80,8
guardflag = L
hitflag = MAFD
pausetime = 2,4
sparkno = 3
id = 1110
nochainid = 1400
sparkxy = -40,-15
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 4,-24
air.velocity = 4,-24
guard.hittime = 16
guard.velocity = -20
guard.slidetime = 16
down.velocity = -60,0
down.hittime = 20
airguard.velocity = -2,-4
airguard.hittime = 26
fall = 1
fall.recover = 0
fall.recovertime = 40
p1sprpriority = -2
p2sprpriority = 1



[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 1110, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;----------------------------------------------------------------------------------------------
;Running Crossbody
[statedef 1111]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1111
poweradd = 80

[state 1111, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0
ignorehitpause = 1

[state 1111, width]
type = width
trigger1 = 1
player = -100,50
edge = 200,200

[state 1111, playerpush]
type = playerpush
trigger1 = movehit
value = 0
ignorehitpause = 1


[state 1111, Jump]
type = velset
trigger1 = anim = 1111
trigger1 = animelemtime(2) = 0
y = -18  ;-18

[state 1111, velmul]
type = velmul
trigger1 = anim = 1111
trigger1 = time = 0
x = 0.6 ;0.666

[state 1102, varadd]
type = varadd
trigger1 = movehit
var(23) = 2
ignorehitpause = 1
persistent = 0

[State 1111, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
persistent = 0
animtype  = Back
damage    = 10,10
guardflag = HA
hitflag = MAF
priority = 1,miss
pausetime = 2,2
guard.pausetime = 12,10
sparkno = 3
id = 1111
nochainid = 1400
sparkxy = -40,-15
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
p2facing = 1

guard.hittime = 26
guard.velocity = -20
guard.slidetime = 26
airguard.velocity = -24,-8
p1sprpriority = 2
p2sprpriority = -1
fall = 1

[state 1111, guard velocity]
type = changestate
trigger1 = moveguarded
value = 1113
persistent = 0
ignorehitpause = 1

[state 1111, nothiby]
type = nothitby
trigger1 = movehit
value = SCA
ignorehitpause = 1




[state 1111, Targetstate]
type = targetstate
trigger1 = movehit
id = 1111
value = 1160
ignorehitpause = 1

[state 1111, targetbind]
type = targetbind
trigger1 = movehit
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = 112, -222
id = 1111
persistent = 1

[state 1111, targetbind]
type = targetbind
trigger1 = movehit
trigger1 = animelemtime(4) >= 0
pos = 68, -110
id = 1111
persistent = 1



[state 1101, dust]
type = explod
trigger1 = animelemtime(2) < 0
persistent = 2
anim = 2025
postype = p1
pos = 114,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1101, dust]
type = explod
trigger1 = animelemtime(2) < 0
persistent = 2
anim = 2025
postype = p1
pos = -36,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1111, gravity]
type = gravity
trigger1 = pos y < 0

[state 1131, more gravity]
type = veladd
trigger1 = vel y > 0
trigger1 = pos y < 0
y = 1.22
persistent = 1


[state 1111, Landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1112



;----------------------------------------------------------------------------------------------
;Landing
[statedef 1112]
type = C
movetype = A
physics = C
anim = 1112

[state 1112, targetstate]
type = targetstate
trigger1 = time = 0
id = 1111
value = 1161

[state 1112, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
id = 1111
value = ceil(fvar(10) * -110)
persistent = 0

[state 1112, onkill bone crunch]
type = playsnd
trigger1 = time = 1
trigger1 = numtarget(1111)
trigger1 = !target(1111),alive
value = S1112,0

[state 1152, targetdrop]
type = targetdrop
trigger1 = animelemtime(4) = 0

[state 1120, quake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 18

[state 1112, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 3,1.5
ownpal = 1
sprpriority = -3

[state 1120, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,1

;----------------------
;Morphing
[state 1112, Distort]
type = angledraw
trigger1 = animelemtime(2) >= 0  && animelemtime(3) < 0
value = 0
scale = 1.2, 0.8
persistent = 1

[state 1112, Distort]
type = angledraw
trigger1 = animelemtime(4) >=0 && animelemtime(4) < 4
value = 0
scale = 0.8, 1.2
persistent = 1

[state 1120, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 1120, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1120, bounce]
type = velset
trigger1 = animelemtime(4) = 0
y = -15
x = 18


[state 1120, gravity]
type = gravity
trigger1 = pos y < 0

[state 1120, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
statetype = A
physics = N
ignorehitpause = 1
persistent = 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = time = 5
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 1120, land again]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Blanka Bounce
[statedef 1113]
type = A
movetype = I
physics = N
anim = 1103
movehitpersist = 1

[state 1113, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1113, Bounce]
type = velset
trigger1 = time = 0
x = -9
y = -18

[state 1113, gravity]
type = gravity
trigger1 = 1

[state 1113, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1114

;----------------------------------------------------------------------------------------------
;Blocked Landing
[statedef 1114]
type = S
movetype = I
physics = S
anim = 47

[state 1114, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 1114, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1114, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1114, sound]
type = playsnd
trigger1 = time = 0
value = 40,0

[state 1114, changestate]
type= changestate
trigger1 = time = 6
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------
;Running start - Ready : Heavy
[statedef 1120]
type = C
movetype = A
physics = S
velset = 0,0
anim = 1120
poweradd = 20
ctrl = 0




[state 1120, end - Dash]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command != "holdb"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = random < ailevel * 36
value = 1121
persistent = 1

[state 1120, end - Cancel]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = command = "holdb"
trigger2 = roundstate != 2
trigger3 = time > 180
value = 1109
persistent = 1

;----------------------------------------------------------------------------
; Sprint forward
[Statedef 1121]
type    = S
physics = S
movetype = A
anim = 1121
sprpriority = 1
ctrl = 0

[state 1121, Voice]
type = playsnd
trigger1 = time = 0
value = 1101,(random%3)
channel = 0
persistent = 0

[state 1121, running set]
type = varset
trigger1 = time = 0
var(4) = 1

[state 1121, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1121, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1100,0
persistent = 0
channel = 1

[state 1121, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 250,-176
scale = const(size.xscale)*7,const(size.yscale)*7
sprpriority = 3
bindtime = 2
persistent = 0
trans = addalpha
alpha = 256,192

[state 1121, meter gain]
type = poweradd
trigger1 = time%2
value = 8
persistent = 1

[state 1121, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 0

[State 1121, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*ifelse(command = "holdfwd",1.625, 1.5)
y = 0
persistent = 1

[state 1121, dust]
type = explod
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(1) = 1
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1,const(size.yscale)*1
persistent = 1

[state 1121, attack]
type = changestate
trigger1 = command = "x" 
value = 1128

[state 1121, attack]
type = changestate
trigger1 = command = "y" 
value = 1131


[state 1121, attack]
type = changestate
trigger1 = command = "b" 
value = 1122

[state 1121, attack]
type = changestate
trigger1 =  command = "a"
value = 1130

[State 1121, 4]
type = ChangeState
triggerall = time > 6
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = roundstate != 2
trigger3 = time > 60
value = 1128


;--------------------------------------------------------------------------------------------------
;Running Butt Bump
[statedef 1122]
type = A
movetype = A
physics = N
anim = 1122
ctrl = 0
poweradd = 80
sprpriority = -3

[state 1122, slowdown]
type = velmul
trigger1 = time = 0
x = 0.75

[state 1122, Jump]
type = velset
trigger1 = time = 0
y = -18

[state 1122, gravity]
type = gravity
trigger1 = time > 0

[State 1122, Hitdef]
type = HitDef
trigger1 = AnimElem = 4
attr = S, SA
persistent = 0
animtype  = Medium
damage    = 150,ifelse(p2statetype = A, 45, 15)
guardflag = MA
pausetime = 18,12
sparkno = 1
sparkxy = -40,-280
hitsound   = S240,0
guardsound = 6,0
ground.type = High
envshake.time = 18
envshake.ampl = 8
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -42,-10
air.velocity = -42,-10
guard.hittime = 29
guard.velocity = -64
airguard.velocity = -20,-6
guard.slidetime = 29
fall = 1
fall.recover = 0
fall.recovertime = 40
p1sprpriority = -2
p2sprpriority = 1

[state 1122, Bounce off]
type = changestate
trigger1 = movecontact
value = 1123
ignorehitpause = 0

[state 1122, varadd]
type = varadd
trigger1 = movecontact
var(23) = 1
ignorehitpause = 1
persistent = 0

[state 1122, Explod Buttcheek]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = !numexplod(1102)
anim = 1106
id = 1102
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removeongethit = 1
ignorehitpause = 1
sprpriority = 3

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 


[state 1122, Miss landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 1124


;--------------------------------------------------------------------------------------------------
;Blanka Bounce
[statedef 1123]
type = A
movetype = I
physics = N
anim = 1123
movehitpersist = 1

[state 1123, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1123, Bounce]
type = velset
trigger1 = time = 0
x = -2
y = ifelse(p2statetype = A, -12,-24)

[state 1123, gravity]
type = gravity
trigger1 = 1

[state 1123, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Landing Miss
[statedef 1124]
type = C
movetype = I
physics = C
anim = 1124

[state 1124, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1124, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1124, skid]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1124, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1124, Jump]
type = velset
trigger1 = animelemtime(4) = 3
y = -18

[state 1124, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 3
statetype = A
physics = N

[state 1124, gravity]
type = gravity
trigger1 = pos y < -1

[state 1124, end]
type = changestate
trigger1 = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52


;--------------------------------------------------------------------------------------------------
;Brake
[statedef 1128]
type = S
movetype = I
physics = S
anim = 1128
movehitpersist = 1

[state 1128, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 1128, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1128, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1128, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[state 1128, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 4
anim = 2025
postype = p1
pos = 136,0
vel = 8,-4
scale = 1,1
sprpriority = 3

[state 1128, end]
type = changestate
trigger1 = animtime = 0
trigger2 = movehit
trigger2 = time = 3
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------
;Running Slide
[statedef 1130]
type = C
movetype = A
physics = N
anim = 1130
poweradd = 80
ctrl = 0

[state 1150, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = ,AT

[STATE 1110, nothitby]
type = nothitby
trigger1 = animelemtime(2) >= 0  && animelemtime(9) <0
value = ,AP

[state 1110, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = C

[state 1130, velmul]
type = velmul
trigger1 = animelemtime(3) = 0
x = 0.8

[state 1130, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = C

[state 1130, varadd]
type = varadd
trigger1 = movehit
var(23) = 2
ignorehitpause = 1
persistent = 0

[state 1130, playerpush]
type = playerpush
trigger1 = movehit
trigger1 = p2statetype != L
value = 0
ignorehitpause = 1

[state 1110, Skid sound]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1110,0

[state 1130, dust]
type = explod
trigger1 = animelemtime(3) > 0  && animelemtime(8) < 0
persistent = 2
anim = 2025
postype = p1
pos = 400,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1130, dust]
type = explod
trigger1 = animelemtime(3) > 2  && animelemtime(8) < 2
persistent = 2
anim = 2025
postype = p1
pos = -350,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[State 1130, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
persistent = 0
animtype  = Back
damage    = 100,10
guardflag = L
hitflag = MAFD
pausetime = 2,4
pausetime = 10,10
sparkno = 3
id = 1110
nochainid = 1400
sparkxy = -40,-15
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 6,-30
air.velocity = 6,-30
guard.hittime = 17
guard.velocity = -20
guard.slidetime = 25
down.velocity = -60,0
down.hittime = 20
airguard.velocity = -2,-4
airguard.hittime = 26
fall = 1
fall.recover = 0
fall.recovertime = 40
p1sprpriority = -2
p2sprpriority = 1

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 1130, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1
;----------------------------------------------------------------------------------------------

;Running Crossbody
[statedef 1131]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1131
poweradd = 80


[state 1131, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0
ignorehitpause = 1

[state 1111, width]
type = width
trigger1 = 1
player = -100,-140
edge = 200,200

[state 1131, playerpush]
type = playerpush
trigger1 = movehit
value = 0
ignorehitpause = 1

[state 1102, varadd]
type = varadd
trigger1 = movehit
var(23) = 2
ignorehitpause = 1
persistent = 0


[state 1131, Jump]
type = velset
trigger1 = anim = 1131
trigger1 = animelemtime(2) = 0
y = -20

[state 1131, velmul]
type = velmul
trigger1 = anim = 1131
trigger1 = time = 0
x = 0.6

[State 1131, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
persistent = 0
animtype  = Back
damage    = 10,12
guardflag = HA
hitflag = MAF
priority = 1,miss
pausetime = 2,2
guard.pausetime = 12,2
sparkno = 3
id = 1111
nochainid = 1400
sparkxy = -40,-15
hitsound   = 5,3
guardsound = 6,0
ground.type = high
guard.hittime = 27
guard.velocity = -20
guard.slidetime = 27
airguard.velocity = -24,-8
p1sprpriority = 2
p2sprpriority = -1
p2facing = 1
fall = 1

[state 1111, nothiby]
type = nothitby
trigger1 = movehit
value = SCA
ignorehitpause = 1

[state 1131, guard velocity]
type = changestate
trigger1 = moveguarded
value = 1133
persistent = 0
ignorehitpause = 1




[state 1131, Targetstate]
type = targetstate
trigger1 = movehit
id = 1111
value = 1160
ignorehitpause = 1

[state 1131, targetbind]
type = targetbind
trigger1 = movehit
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = 112, -222
id = 1111
persistent = 1

[state 1131, targetbind]
type = targetbind
trigger1 = movehit
trigger1 = animelemtime(4) >= 0
pos = 68, -110
id = 1111
persistent = 1



[state 1131, dust]
type = explod
trigger1 = animelemtime(2) < 0
persistent = 2
anim = 2025
postype = p1
pos = 114,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1131, dust]
type = explod
trigger1 = animelemtime(2) < 0
persistent = 2
anim = 2025
postype = p1
pos = -36,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1131, gravity]
type = gravity
trigger1 = pos y < 0

[state 1131, more gravity]
type = veladd
trigger1 = vel y > 0
trigger1 = pos y < 0
y = 1.22
persistent = 1



[state 1131, Landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1132



;----------------------------------------------------------------------------------------------
;Landing
[statedef 1132]
type = C
movetype = A
physics = C
anim = 1112

[state 1132, targetstate]
type = targetstate
trigger1 = time = 0
id = 1111
value = 1161

[state 1112, onkill bone crunch]
type = playsnd
trigger1 = time = 1
trigger1 = numtarget(1111)
trigger1 = !target(1111),alive
value = S1112,0

[state 1132, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
id = 1111
value = ceil(fvar(10) * -130)
persistent = 0

[state 1132, quake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 18

[state 1132, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 3,1.5
ownpal = 1
sprpriority = -3

[state 1152, targetdrop]
type = targetdrop
trigger1 = animelemtime(4) = 0

[state 1132, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,1

[state 1132, stop]
type = velset

trigger1 = time = 0
y = 0
x = 0

;----------------------
;Morphing
[state 1112, Distort]
type = angledraw
trigger1 = animelemtime(2) >= 0  && animelemtime(3) < 0
value = 0
scale = 1.2, 0.8
persistent = 1

[state 1112, Distort]
type = angledraw
trigger1 = animelemtime(4) >=0 && animelemtime(4) < 4
value = 0
scale = 0.8, 1.2
persistent = 1

[state 1132, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1132, bounce]
type = velset
trigger1 = animelemtime(4) = 0
y = -18
x = 18


[state 1132, gravity]
type = gravity
trigger1 = pos y < 0

[state 1132, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
statetype = A
physics = N
ignorehitpause = 1
persistent = 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = time = 5
v = 18
value = -3
persistent = 0
ignorehitpause = 1 

[state 1132, land again]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Blanka Bounce
[statedef 1133]
type = A
movetype = I
physics = N
anim = 1103
movehitpersist = 1

[state 1133, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1133, Bounce]
type = velset
trigger1 = time = 0
x = -6
y = -20

[state 1133, gravity]
type = gravity
trigger1 = 1

[state 1133, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1134
;----------------------------------------------------------------------------------------------
;Blocked Landing
[statedef 1134]
type = S
movetype = I
physics = S
anim = 47

[state 1134, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 1134, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1134, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1134, sound]
type = playsnd
trigger1 = time = 0
value = 40,0

[state 1134, changestate]
type= changestate
trigger1 = time = 6
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;EX
[statedef 1140]
type = C
movetype = A
physics = S
velset = 0,0
anim = 1140
poweradd = -500
ctrl = 0

[state 1140, end - Dash]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command != "holdc"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = random < ailevel * 36
value = 1141
persistent = 1

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause


[state 1140, end - Cancel]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = command = "holdc"
trigger2 = roundstate != 2
trigger3 = time > 180
value = 1109
persistent = 1

;----------------------------------------------------------------------------
; Sprint forward
[Statedef 1141]
type    = S
physics = S
movetype = A
anim = 1141
sprpriority = 1
ctrl = 0

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause


[state 1141, running set]
type = varset
trigger1 = time = 0
var(4) = 1

[state 1141, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1141, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1100,0
persistent = 0
channel = 1

[state 1141, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 250,-176
scale = const(size.xscale)*7,const(size.yscale)*7
sprpriority = 3
bindtime = 2
persistent = 0
trans = addalpha
alpha = 256,192

[state 1141, meter gain]
type = poweradd
trigger1 = time%2
value = 0
persistent = 1

[state 1141, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 0

[State 1141, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*ifelse(command = "holdfwd", 1.875, 1.75)
y = 0
persistent = 1

[state 1141, dust]
type = explod
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(1) = 1
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1,const(size.yscale)*1
persistent = 1

[state 1141, Brakes]
type = changestate
trigger1 = command = "x" 
value = 1148

[state 1141, Brakes]
type = changestate
trigger1 = command = "y" 
value = 1151

[state 1141, Med]
type = changestate
trigger1 = command = "b" 
value = 1142

[state 1141, Low]
type = changestate
trigger1 = command = "a"
value = 1150

[State 1141, 4]
type = ChangeState
triggerall = time > 6
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = roundstate != 2
trigger3 = time > 60
value = 1148


;--------------------------------------------------------------------------------------------------
;Running Butt Bump
[statedef 1142]
type = A
movetype = A
physics = N
anim = 1142
ctrl = 0
sprpriority = -3

[state 1142, slowdown]
type = velmul
trigger1 = time = 0
x = 0.75

[state 1142, Jump]
type = velset
trigger1 = time = 0
y = -18



[state 1142, gravity]
type = gravity
trigger1 = time > 0

[State 1142, Hitdef]
type = HitDef
trigger1 = AnimElem = 4
attr = S, SA
persistent = 0
animtype  = Medium
damage    = 120,ifelse(p2statetype = A, 36, 12)
guardflag = MA
pausetime = 18,18
sparkno = 1
sparkxy = -40,-280
hitsound   = S240,0
guardsound = 6,0
ground.type = High
envshake.time = 18
envshake.ampl = 8
id = 1120
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -48,-15
air.velocity = -48,-12
guard.hittime = 24
guard.velocity = -64
airguard.velocity = -22,-2
guard.slidetime = 24
fall = 1
fall.recover = 0
fall.recovertime = 45
p1sprpriority = -2
p2sprpriority = 1

[state 1142, wallbounce]
type = targetstate
trigger1 = hitpausetime = 17
trigger1 = movehit
trigger1 = numtarget(1120)
trigger1 = var(7) > 0
value = 670
ignorehitpause = 1

[state 1142, wall bounce limiter]
type = varadd
trigger1 = movehit
trigger1 = !target,ishelper
var(7) = -1
ignorehitpause = 1
persistent = 0

[state 1142, varadd]
type = varadd
trigger1 = movecontact
trigger1 = var(23) < 9
var(23) = 1
ignorehitpause = 1
persistent = 0

[state 1142, Bounce off]
type = changestate
trigger1 = movecontact
trigger2 = movereversed
value = 1143
ignorehitpause = 0

[state 1142, Explod Buttcheek]
type = explod
trigger1 = animelemtime(3) = 0
trigger1 = !numexplod(1102)
anim = 1106
id = 1102
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removeongethit = 1
ignorehitpause = 1
sprpriority = 3

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1 


[state 1142, Miss landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 1144


;--------------------------------------------------------------------------------------------------
;Blanka Bounce
[statedef 1143]
type = A
movetype = I
physics = N
anim = 1123
movehitpersist = 1

[state 1143, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1143, Bounce]
type = velset
trigger1 = time = 0
x = -16
y = ifelse(statetype = A, -8, -16)

[state 1143, gravity]
type = gravity
trigger1 = 1

[state 1143, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Landing Miss
[statedef 1144]
type = C
movetype = I
physics = C
anim = 1144

[state 1144, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1142, spindash SFX]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1120,0

[state 1144, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1144, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1144, Jump]
type = velset
trigger1 = animelemtime(4) = 3
y = -15

[state 1144, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 3
statetype = A
physics = N

[state 1144, gravity]
type = gravity
trigger1 = pos y < -1

[state 1144, end]
type = changestate
trigger1 = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52


;--------------------------------------------------------------------------------------------------
;Brake
[statedef 1148]
type = S
movetype = I
physics = S
anim = 1148
movehitpersist = 1
poweradd = 400

[state 1148, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 1128, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1128, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1128, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[state 1128, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = 2025
postype = p1
pos = 96,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 1128, end]
type = changestate
trigger1 = animtime = 0
trigger2 = movehit
trigger2 = time = 3
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------
;Running Slide
[statedef 1150]
type = C
movetype = A
physics = N
anim = 1150
ctrl = 0

[state 1150, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = ,AT

[STATE 1110, nothitby]
type = nothitby
trigger1 = animelemtime(2) >= 0  && animelemtime(9) <0
value = ,AP

[state 1110, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = C

[state 1150, velmul]
type = velmul
trigger1 = animelemtime(3) = 0
x = 0.8

[state 1150, statetypeset]
type = statetypeset
trigger1 = animelemtime(8) = 0
physics = C

[state 1102, varadd]
type = varadd
trigger1 = movehit
var(23) = 2
ignorehitpause = 1
persistent = 0

[state 1150, playerpush]
type = playerpush
trigger1 = movehit
trigger1 = p2statetype != L
value = 0
ignorehitpause = 1

[state 1110, Skid sound]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1110,0

[state 1110, ground bounce inhibitor]
type = varadd
trigger1 = movehit
trigger1 = enemynear,statetype = L  || enemynear, statetype = A
var(8) = -1
ignorehitpause = 1
persistent = 0

[state 1150, dust]
type = explod
trigger1 = animelemtime(3) > 0  && animelemtime(8) < 0
persistent = 2
anim = 2025
postype = p1
pos = 400,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1150, dust]
type = explod
trigger1 = animelemtime(3) > 2  && animelemtime(8) < 2
persistent = 2
anim = 2025
postype = p1
pos = -350,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[State 1150, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
persistent = 0
animtype  = Back
damage    = 80,8
guardflag = L
hitflag = MAFD
pausetime = 2,4
pausetime = 10,10
sparkno = 3
id = 1110
nochainid = 1400
sparkxy = -40,-15
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -8,-42
air.velocity = -12,ifelse(var(8) > 0, -42, -16)
guard.hittime = 20
guard.velocity = -24
guard.slidetime = 24
down.velocity = ifelse(var(8) > 0, -8, -30), ifelse(var(8) > 0, -42, 0)
airguard.velocity = -2,-4
airguard.hittime = 26
fall = 1
fall.recover = 0
fall.recovertime = 40
p1sprpriority = -2
p2sprpriority = 1

[state XXX, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1 

[state 1150, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1
;----------------------------------------------------------------------------------------------
;Running Crossbody
[statedef 1151]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1151

[state 1151, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 1,0
ignorehitpause = 1

[state 1111, width]
type = width
trigger1 = 1
player = -100,-140
edge = 200,200

[state 1151, playerpush]
type = playerpush
trigger1 = movehit
value = 0
ignorehitpause = 1

[state 1102, varadd]
type = varadd
trigger1 = movehit
var(23) = 2
ignorehitpause = 1
persistent = 0


[state 1151, Jump]
type = velset
trigger1 = anim = 1151
trigger1 = animelemtime(2) = 0
y = -19

[state 1151, velmul]
type = velmul
trigger1 = anim = 1151
trigger1 = time = 0
x = 0.6

[State 1151, Hitdef]
type = HitDef
trigger1 = !movecontact
attr = S, SA
persistent = 0
animtype  = Back
damage    = 10,10
guardflag = HA
hitflag = MAF
priority = 1,miss
pausetime = 2,2
guard.pausetime = 12,12
sparkno = 3
id = 1111
nochainid = 1400
sparkxy = -40,-15
hitsound   = 5,3
guardsound = 6,0
ground.type = Trip
p2facing = 1
guard.hittime = 16
guard.velocity = -20
guard.slidetime = 16
airguard.velocity = -24,-8
p1sprpriority = 2
p2sprpriority = -1
fall = 1

[state 1111, nothiby]
type = nothitby
trigger1 = movehit
value = SCA
ignorehitpause = 1

[state 1151, guard velocity]
type = changestate
trigger1 = moveguarded
value = 1153
persistent = 0
ignorehitpause = 1




[state 1151, Targetstate]
type = targetstate
trigger1 = movehit
id = 1111
value = 1160
ignorehitpause = 1

[state 1151, targetbind]
type = targetbind
trigger1 = movehit
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = 112, -222
id = 1111
persistent = 1

[state 1151, targetbind]
type = targetbind
trigger1 = movehit
trigger1 = animelemtime(4) >= 0
pos = 68, -110
id = 1111
persistent = 1

[state 1151, groundbounce inhibitor]
type = varadd
trigger1 = movehit
var(8) = -1
ignorehitpause
persistent = 0



[state 1151, dust]
type = explod
trigger1 = animelemtime(2) < 0
persistent = 2
anim = 2025
postype = p1
pos = 114,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1151, dust]
type = explod
trigger1 = animelemtime(2) < 0
persistent = 2
anim = 2025
postype = p1
pos = -36,0
vel = 6,-4
scale = 1,1
sprpriority = 3

[state 1151, gravity]
type = gravity
trigger1 = pos y < 0

[state 1131, more gravity]
type = veladd
trigger1 = vel y > 0
trigger1 = pos y < 0
y = 1.22
persistent = 1

[state 1151, Landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1152



;----------------------------------------------------------------------------------------------
;Landing
[statedef 1152]
type = C
movetype = A
physics = C
anim = 1112

[state 1152, targetstate]
type = targetstate
trigger1 = time = 0
id = 1111
value = 1161

[state 1112, onkill bone crunch]
type = playsnd
trigger1 = time = 1
trigger1 = numtarget(1111)
trigger1 = !target(1111),alive
value = S1112,0

[state 1152, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
id = 1111
value = ceil(fvar(10) * -110)
persistent = 0

[state XXX, Combo Scaling]
type = varadd
trigger1 = time = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1 

;----------------------
;Morphing
[state 1112, Distort]
type = angledraw
trigger1 = animelemtime(2) >= 0  && animelemtime(3) < 0
value = 0
scale = 1.2, 0.8
persistent = 1

[state 1112, Distort]
type = angledraw
trigger1 = animelemtime(4) >=0 && animelemtime(4) < 4
value = 0
scale = 0.8, 1.2
persistent = 1

[state 1152, targetstate]
type = targetstate
trigger1 = animelemtime(4) = 0
trigger1 = var(8) > 0
value = 1162
id = 1111

[state 1112, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 3,1.5
ownpal = 1
sprpriority = -3

[state 1152, quake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 18

[state 1152, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,1

[state 1152, stop]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 1152, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1152, bounce]
type = velset
trigger1 = animelemtime(4) = 0
y = -12
x = 12

[state 1152, gravity]
type = gravity
trigger1 = pos y < 0

[state 1152, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
statetype = A
physics = N
ignorehitpause = 1
persistent = 0

[state 1152, land again]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Blanka Bounce
[statedef 1153]
type = A
movetype = I
physics = N
anim = 1103
movehitpersist = 1

[state 1153, removeexplod]
type = removeexplod
trigger1 = numexplod(1102)
id = 1102

[state 1153, Bounce]
type = velset
trigger1 = time = 0
x = -12
y = -18

[state 1153, gravity]
type = gravity
trigger1 = 1

[state 1153, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;Crossbody
[statedef 1160]
type = A
movetype = H
physics = N

[state 1160, anim]
type = changeanim2
trigger1 = time = 0
value = 1160

[State 821, 4] ;Hit ground
type = SelfState
;trigger1 = !gethitvar(isbound)
trigger1 = time > 120
value = 5100

;--------------------------------------------------------------------------
;Crossbody
[statedef 1161]
type = L
movetype = H
physics = N
velset = 0,0

[state 1161, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1161, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1161, anim]
type = changeanim
trigger1 = time = 0
value = 5080

[state 1161, changeanim]
type = changeanim
trigger1 = anim = 5080
trigger1 = time = 12
value = 5080

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = time > 36
value = 5110

;--------------------------------------------------------------------------
;EX Launch
[statedef 1162]
type = A
movetype = H
physics = N
velset = 0, -18

[state 1162, changeanim]
type = changeanim
trigger1 = time = 0
value = 5051

[state 1162, playerpush]
type = playerpush
trigger1 = time < 24
value = 0

[state 1162, coming down]
type = changeanim
trigger1 = anim = 5051
trigger1 = vel y > 0
value = 5061

[state 1162, gravity]
type = veladd
trigger1 = pos y < 0
y = 0.66

[state 1162, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 5100


;==========================================================================
;                             Chain Sits
;--------------------------------------------------------------------------
;Butt Bounce (back)
[statedef 1300]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1300
sprpriority = -2
ctrl = 0

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1300, min damage set]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 80
var(18) = 81

[state 1300, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4000
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
bindtime = 45
ontop = 1

[state 1300, explod]
type = explod
trigger1 = !numexplod(1300)
id = 1300
anim = 1305
bindtime = -1
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
removeongethit = 1
sprpriority = 2

[state 1300, removeexplod]
type = removeexplod
trigger1 = numexplod(1006)
id = 1006

[state 1300, targetstate]
type = targetstate
trigger1 = time = 0
id = 1000
value = 660

[state 1300, bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -25


[state 1300, fast down]
type = veladd
trigger1 = vel y > 1
y = 5
persistent = 0

[state 1300, gravity]
type = veladd
trigger1 = pos y < 0
y = 2.5
persistent = 1

[state 1300, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1301

;------------------------------------------------------------------------
;Landing
[statedef 1301]
type = C
movetype = A
physics = C
anim = 1301
poweradd = 20

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA


[state 1300, explod]
type = explod
trigger1 = !numexplod(1301)
id = 1301
anim = 1306
postype = p1
pos = 0,0
bindtime = -1
scale = const(size.xscale), const(size.yscale)
removeongethit = 1
sprpriority = 0

[state 1300, removeexplod]
type = removeexplod
trigger1 = numexplod(1300)
id = 1300


[STATE 1301, varadd]
type = varadd
trigger1 = time = 0 
var(5) = -1

[state 1301, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 1301, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 3,1.5
ownpal = 1
sprpriority = -3

[state 1006, evnshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 21

[state 1006, playsnd]
type = playsnd
trigger1 = time = 0
value = S1000,0
volumescale = 90

[state 1301, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1301, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1301, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = floor(fvar(10) * -30)
persistent = 0

[state 13x1, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 30
persistent = 0


[state 1301, repeat]
type = changestate
triggerall = animtime = 0
trigger1 = numtarget(1000)
trigger1 = !target(1000),alive
value = 1309

[state 1301, repeats]
type = changestate
trigger1 = animtime = 0
value = ifelse(var(5) > 0, 1300, 1309)
 





;-------------------------------------------------------------------------
;End dismount
[statedef 1309]
type = C
movetype = I
physics = N
velset = 0,0
anim = 1308

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1300, reset bonus]
type = varset
trigger1 = time = 0
var(23) = 0


[state 1300, explod]
type = explod
trigger1 = anim = 1308
trigger1 = !numexplod(1309)
id = 1309
anim = 1309
bindtime = -1
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
removeongethit = 1
sprpriority = 2

[state 1300, targetstate]
type = targetstate
trigger1 = time = 0
value = 660
id = 1000

[state 1300, removeexplod]
type = removeexplod
trigger1 = numexplod(1301)
id = 1301

[state 1309, turn]
type = turn
trigger1 = time = 15

[state 1309, Bounce]
type = velset
trigger1 = time = 15
x = -16
y = -24

[state 1309, nothitby]
type = null;nothitby
trigger1 = 1
value = SCA

[state 1300, removeexplod]
type = removeexplod
trigger1 = numexplod(1309)
trigger1 = anim = 43
id = 1309

[state 1309, anim]
type = changeanim
trigger1 = time = 15
value = 43

[state 1309, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1309, gravity]
type = gravity
trigger1 = anim != 1308

[state 1309, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 1

;--------------------------------------------------------------------------
;Butt Bounce (Front)
[statedef 1310]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1310
sprpriority = -2
ctrl = 0

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1300, min damage set]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 80
var(18) = 81

[state 1300, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4000
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
bindtime = 45
ontop = 1

[state 1310, explod]
type = explod
trigger1 = !numexplod(1310)
id = 1310
anim = 1315
bindtime = -1
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
removeongethit = 1
sprpriority = 2

[state 1310, removeexplod]
type = removeexplod
trigger1 = numexplod(1054)
id = 1054

[state 1310, targetstate]
type = targetstate
trigger1 = time = 0
id = 1050
value = 660

[state 1310, bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -25


[state 1310, fast down]
type = veladd
trigger1 = vel y > 1
y = 5
persistent = 0

[state 1310, gravity]
type = veladd
trigger1 = pos y < 0
y = 2.5
persistent = 1


[state 1310, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1311

;------------------------------------------------------------------------
;Landing
[statedef 1311]
type = C
movetype = A
physics = C
anim = 1311
poweradd = 20

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA


[state 1311, explod]
type = explod
trigger1 = !numexplod(1311)
id = 1311
anim = 1316
bindtime = -1
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
removeongethit = 1
sprpriority = 2

[state 1311, removeexplod]
type = removeexplod
trigger1 = numexplod(1310)
id = 1310


[STATE 1311, varadd]
type = varadd
trigger1 = time = 0 
var(5) = -1

[state 1311, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 1311, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 3,1.5
ownpal = 1
sprpriority = -3

[state 1311, evnshake]
type = envshake
trigger1 = time = 0
ampl = -15
time = 21

[state 1311, playsnd]
type = playsnd
trigger1 = time = 0
value = S1000,0
volumescale = 90

[state 1311, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1311, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1311, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = floor(fvar(10) * -30)
persistent = 0

[state 13x1, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 30
persistent = 0


[state 1311, repeat]
type = changestate
triggerall = animtime = 0
trigger1 = numtarget(1050)
trigger1 = !target(1050),alive
value = 1319

[state 1311, repeats]
type = changestate
trigger1 = animtime = 0
value = ifelse(var(5) > 0, 1310, 1319)
 





;-------------------------------------------------------------------------
;End dismount
[statedef 1319]
type = C
movetype = I
physics = N
velset = 0,0
anim = 1318

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1300, reset bonus]
type = varset
trigger1 = time = 0
var(23) = 0


[state 1319, explod]
type = explod
trigger1 = anim = 1318
trigger1 = !numexplod(1319)
id = 1319
anim = 1319
bindtime = -1
postype = p1
pos = 0,0
scale = const(size.xscale), const(size.yscale)
removeongethit = 1
sprpriority = 2

[state 1319, targetstate]
type = targetstate
trigger1 = time = 0
value = 660
id = 1050

[state 1319, removeexplod]
type = removeexplod
trigger1 = numexplod(1311)
id = 1311


[state 1319, Bounce]
type = velset
trigger1 = time = 15
x = -12
y = -21

[state 1319, nothitby]
type = null;nothitby
trigger1 = 1
value = SCA

[state 1319, removeexplod]
type = removeexplod
trigger1 = numexplod(1319)
trigger1 = anim = 43
id = 1319

[state 1319, anim]
type = changeanim
trigger1 = time = 15
value = 43

[state 1319, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1319, gravity]
type = gravity
trigger1 = anim != 1318

[state 1319, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 1
;--------------------------------------------------------------------------
;Rest Sit Back
[statedef 1320]
type = C
movetype = A
physics = C
velset = 0,0
anim = 1320
sprpriority = 2
ctrl = 0

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1320, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4010
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
ontop = 1


[state 1320, poweradd]
type = poweradd
trigger1 = time >= 5 && time < 65
value = var(5) * 30
persistent = 6

[state 1320, targetpoweradd]
type = targetpoweradd
trigger1 = time >= 5 && time < 65
value = 2
persistent = 6

[state 1320, playsnd]
type = playsnd
triggerall = anim = 1320
trigger1 = animelemtime(2) = 0
value = 1320,0
persistent = 1
channel = 1

[state 1320, removeexplod]
type = removeexplod
trigger1 = numexplod(1006)
id = 1006

[state 1320, targetstate]
type = targetstate
trigger1 = time = 0
trigger2 = time = 20
id = 1000
value = 660
persistent = 1

[state 1309, statetypeset]
type = statetypeset
trigger1 = time = 65
physics = N

[state 1309, turn]
type = turn
trigger1 = time = 65

[state 1309, Bounce]
type = velset
trigger1 = time = 65
x = -16
y = -24

[state 13XX, reset bonus]
type = varset
trigger1 = time = 65
var(23) = 0

[state 1320, backflip]
type = changeanim
trigger1 = time = 65
value = 43

[state 1320, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1320, gravity]
type = gravity
trigger1 = anim != 1320

[state 1320, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
;--------------------------------------------------------------------------
;Rest Sit (Front)
[statedef 1330]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1330
sprpriority = 2
ctrl = 0

[state 1330, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4010
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
ontop = 1

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1320, poweradd]
type = poweradd
trigger1 = time >= 5 && time < 65
value = var(5) * 30
persistent = 6

[state 1330, playsnd]
type = playsnd
trigger1 = anim = 1330
trigger1 = animelemtime(2) = 0
value = 1320,0
persistent = 1
channel = 1

[state 1330, targetpoweradd]
type = targetpoweradd
trigger1 = time >= 5 && time < 65
value = 2
persistent = 6

[state 1330, removeexplod]
type = removeexplod
trigger1 = numexplod(1054)
id = 1054

[state 1330, targetstate]
type = targetstate
trigger1 = time = 0
trigger2 = time = 20
id = 1050
value = 660
persistent = 1

[state 1330, backflip]
type = changeanim
trigger1 = time = 65
value = 43

[state 1330, Bounce]
type = velset
trigger1 = time = 65
x = -12
y = -21

[state 13XX, reset bonus]
type = varset
trigger1 = time = 65
var(23) = 0

[state 1330, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 3030, gravity]
type = gravity
trigger1 = anim != 1330

[state 1330, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
;--------------------------------------------------------------------------
;Eating (back)
[statedef 1340]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1340
sprpriority = 2
ctrl = 0

[state 1300, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4020
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
ontop = 1

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1350, Pear]
type = explod
trigger1 = !numexplod(1340)
trigger1 = animelemtime(2) = 0
trigger1 = anim = 1340
anim = 1341
id = 1340
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
removeongethit = 1
removetime = -2

[state  1340, poweradd]
type = lifeadd
trigger1 = time >= 5 && time < 65
value = var(5) * 4
persistent = 6

[state 1340, Lifeadd]
type = lifeadd
trigger1 = time >= 5 && time < 65
trigger1 = random%11 < 7
value = 1
persistent = 6

[state  1340, targetpoweradd]
type = targetpoweradd
trigger1 = time >= 5 && time < 65
value = 2
persistent = 6

[state 1340, chewing]
type = playsnd
triggerall = anim = 1340
trigger1 = animelemtime(4) = 0
value = 1340,Random%2
persistent = 1
channel = 1

[state  1340, removeexplod]
type = removeexplod
trigger1 = numexplod(1006)
id = 1006

[state 1340, targetstate]
type = targetstate
trigger1 = time = 0
trigger2 = time = 20
id = 1000
value = 660
persistent = 1

[state 1340, removeexplod]
type = removeexplod
trigger1 = anim != 1340
trigger1 = numexplod(1340)
id = 1340

[state 1340, turn]
type = turn
trigger1 = time = 65

[state 1340, backflip]
type = changeanim
trigger1 = time = 65
value = 43

[state 13XX, reset bonus]
type = varset
trigger1 = time = 65
var(23) = 0

[state 1340, Bounce]
type = velset
trigger1 = time = 65
x = -12
y = -21

[state 1340, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1340, gravity]
type = gravity
trigger1 = pos y < 0

[state 1340, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;--------------------------------------------------------------------------
;Eating (Front)
[statedef 1350]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1350
sprpriority = 2
ctrl = 0

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1350, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4020
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
ontop = 1

[state 1350, Pear]
type = explod
trigger1 = !numexplod(1350)
trigger1 = animelemtime(2) = 0
trigger1 = anim = 1350
anim = 1351
id = 1350
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
removeongethit = 1
removetime = -2


[state 1350, poweradd]
type = lifeadd
trigger1 = time >= 5 && time < 65
value = var(5) * 4
persistent = 6

[state 1340, Lifeadd]
type = lifeadd
trigger1 = time >= 5 && time < 65
trigger1 = random%11 < 7
value = 1
persistent = 6

[state 1350, targetpoweradd]
type = targetpoweradd
trigger1 = time >= 5 && time < 65
value = 2
persistent = 6

[state 1350, removeexplod]
type = removeexplod
trigger1 = numexplod(1054)
id = 1054

[state 1330, targetstate]
type = targetstate
trigger1 = time = 0
trigger2 = time = 20
id = 1050
value = 660
persistent = 1

[state 1350, removeexplod]
type = removeexplod
trigger1 = anim = 43
trigger1 = numexplod(1350)
id = 1350
ignorehitpause = 1

[state 1340, chewing]
type = playsnd
triggerall = anim = 1350
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(7) = 0
value = 1340,Random%2
persistent = 1
channel = 1


[state 1350, backflip]
type = changeanim
trigger1 = time = 65
value = 43

[state 1350, Bounce]
type = velset
trigger1 = time = 65
x = -12
y = -21

[state 13XX, reset bonus]
type = varset
trigger1 = time = 65
var(23) = 0

[state 1350, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1350, gravity]
type = gravity
trigger1 = anim != 1350

[state 1350, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;Grinding (back)
[statedef 1360]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1360
sprpriority = 2
ctrl = 0

[state 1300, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4030
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
ontop = 1

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state  1340, targetpoweradd]
type = targetpoweradd
trigger1 = time >= 5 && time < 65
value = var(5) * -30
persistent = 6


[state  1340, removeexplod]
type = removeexplod
trigger1 = numexplod(1006)
id = 1006

[state 1340, targetstate]
type = targetstate
trigger1 = time = 0
trigger2 = time = 20
id = 1000
value = 660
persistent = 1

[state 1340, removeexplod]
type = removeexplod
trigger1 = anim != 1340
trigger1 = numexplod(1340)
id = 1340


[state 1370, Grinding]
type = playsnd
triggerall = anim = 1360
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(7) = 0
value = 1370,Random%2
persistent = 1
channel = 2

[state 1340, turn]
type = turn
trigger1 = time = 65

[state 1340, backflip]
type = changeanim
trigger1 = time = 65
value = 43

[state 1340, Bounce]
type = velset
trigger1 = time = 65
x = -12
y = -21

[state 13XX, reset bonus]
type = varset
trigger1 = time = 65
var(23) = 0

[state 1340, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 1340, gravity]
type = gravity
trigger1 = pos y < 0

[state 1340, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;----------------------------------------------------------------------------
;Grind (Front)
[statedef 1370]
type = C
movetype = A
physics = N
velset = 0,0
anim = 1370
sprpriority = 2
ctrl = 0

[state 13xx, I frames] ; Shouldn't be interupted durring any of these, like a command grab.
type= nothitby
trigger1 = 1
value = SCA

[state 1300, Text]
type = explod
trigger1 = time = 5
trigger1 = !numexplod(4000)
id = 4000
anim = 4030
postype = p1
pos = 0,-500
scale = ifelse(facing = 1, const(size.xscale)*1.5, const(size.xscale)*-1.5),const(size.yscale)*1.5
vel = 0, -0.5
removetime = -2
ontop = 1

[state 1370, targetpoweradd]
type = targetpoweradd
trigger1 = time >= 5 && time < 65
value = var(5) * -30
persistent = 6

[state 1370, removeexplod]
type = removeexplod
trigger1 = numexplod(1054)
id = 1054

[state 1370, targetstate]
type = targetstate
trigger1 = time = 0
trigger2 = time = 20
id = 1050
value = 660
persistent = 1

[state 1370, removeexplod]
type = removeexplod
trigger1 = anim = 43
trigger1 = numexplod(1350)
id = 1350
ignorehitpause = 1

[state 1370, Grinding]
type = playsnd
triggerall = anim = 1370
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(7) = 0
value = 1370,Random%2
persistent = 1
channel = 2


[state 1370, backflip]
type = changeanim
trigger1 = time = 65
value = 43

[state 1370, Bounce]
type = velset
trigger1 = time = 65
x = -12
y = -21

[state 1370, change anim]
type = changeanim
trigger1 = anim = 43
trigger1 = vel y > 0
value =  46

[state 13XX, reset bonus]
type = varset
trigger1 = time = 65
var(23) = 0

[state 1370, gravity]
type = gravity
trigger1 = pos y < 0

[state 1350, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52



;--------------------------------------------------------------------------
[statedef 1380]
type = A
movetype = H
physics = N
anim = 5160
velset = -12,-30
ctrl = 0

[STATE 1380, removeexplod]
type = removeexplod
trigger1 = numexplod(1006)
id = 1006

[state 1380, removeexplod]
type = removeexplod
trigger1 = numexplod(1054)
id = 1054

[state 1380, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1380, reset bonus rewards]
type = varadd
trigger1 = time = 0
var(23) = -1

[state 1380, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 1380, changeanim]
type = changeanim
trigger1 = anim = 5160
trigger1 = vel y > 0
value = 5210

[state 1380, playsnd]
type = playsnd
trigger1 = time = 0
value = 805,0

[state 1380, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1380, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1380, targetstate]
type = targetstate
trigger1 = time = 0
value = 1390

[state 1380, gravity]
type = gravity
trigger1 = pos y < 0

[state 1380, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
[statedef 1390]
type = A
movetype = I
physics = N
anim = 43


[state 1390, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1390, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1390, changeanim]
type = changeanim
trigger1 = animexist(46)
trigger1 = anim = 43
trigger1 = vel y > 0
persistent = 0
value = 46

[state 1390, turn]
type = Turn
trigger1 = facing = enemy,facing
trigger1 = time = 0

[state 1390, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1380, gravity]
type = gravity
trigger1 = pos y < 0

[state 1390, pop up]
type = velset
trigger1 = time = 1
y = -30
x = -12

[state 1390, land]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;==========================================================================
;  Tail Whip (Push Block)
;==========================================================================
[statedef 1400]
type = S
movetype = I
physics = S
velset = 0,0
anim = 1400
facep2 = 1

[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -500

[state 1400, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[State 330, Spark]
type = Explod
trigger1 = AnimElem = 3
id = 1410
anim = 1410
postype = p1
pos = 270,-230
sprpriority = 4
bindtime = 1
scale = 4,4
ownpal = 1

[state 1400, moveforward]
type = velset
trigger1 = time = 0
x = 0

[state 1400, snd]
type = playsnd
trigger1 = time = 4
value = 1400,0

[State 1400, Push]
type = Helper
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(4) = 2
ignorehitpause = 1
ID = 1401
name = "Shove"
pos = -20,0
postype = p1
stateno = 1401
keyctrl = 0
ownpal = 1
helpertype = normal

[state 1400, moveforward]
type = velset
trigger1 = time = 0
x = 5

[state 1400, HB]
Type = hitby
trigger1 = 1
value = SCA,AT

[state 1400, previous state]
type = varset
trigger1 = time = 0
v = 5
value = prevstateno


[State 1400, 3]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Pushing part
[Statedef 1401]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 1401

[State 1440, Push]
type = posset
trigger1 = time = 0
y = 0

[State 1440, Push]
type = PlayerPush
trigger1 = 1
value = 1

[State 1440, NHB]
type = NotHitBy
Trigger1 = 1
value = SCA
Time = 1

[State 1440, Vel]
type = VelSet
trigger1 = Time >= 0
x = 60

[State 345, End]
type = DestroySelf
trigger1 = Time = 15


;=====================================================================================================
;                                         SUPERS
;=====================================================================================================
; Minimum Panda
[statedef 3000]
type = U
movetype = A
physics = N
anim = 3000
ctrl = 0

[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 80
v = 18
value = 80
ignorehitpause = 1

[state 3000, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 3000, position variables]
type = varset
trigger1 = time = 0
fvar(6) = backedgebodydist /128
fvar(9) = (pos y- 700) / 128
persistent = 0
ignorehitpause = 1

[state 3000, Stop]
type = velmul
trigger1 = statetype = A
trigger1 = time = 0
x = 0.25
y = 0.25

[state 3000, Jump]
type = velset
trigger1 = statetype != A
trigger1 = time = 0
x = -16
y = -24

[state 3000, camera lock]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 1

[state 3000, veladd]
type = veladd
trigger1 = time > 0
x = ifelse(-fvar(6) > -1.8, -1.8, -fvar(6));ifelse(-ceil(backedgebodydist * 0.015) < 1.2, -1.8, -ceil(backedgebodydist * 0.025))
y = fvar(9) ;ifelse(pos y = 0, -2.4, -0.4) 
persistent = 2
ignorehitpause = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3000, no touch ground]
type = velset
trigger1 = pos y >= 1
y = -24
persistent = 12


[state 3000, CLING]
type = changestate
triggerall = time > 8
trigger1 = backedgebodydist <= 15
value = 3001

;--------------------------------------------------------------------

;----------------------------------------------------------------------------------------------------------
;Wall Cling Portion
[statedef 3001]
type = A
movetype = A
physics = N
velset = 0,0
anim = 54

[state 3001, camera lock]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 1

[state 3001, Miss Counter]
type = varset
trigger1 = time = 0
var(4) = 8
ignorehitpause = 1


[state 3001, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 90
v = 18
value = 90
ignorehitpause = 1

[state 3001, no bg]
type = assertspecial
trigger1 = time < 60
flag = nobg
ignorehitpause = 1
persistent = 1

[State 3001, Super Pause]
type = SuperPause
trigger1 = time = 0
sound = S3000, 0
poweradd = -3000
pos = -10,-200
time = 60
movetime = 60

[state 3001, varset]
type = varset
trigger1 = time = 0
v = 20
value = 7

[state 3001, varset]
type = varset
trigger1 = time = 0
v = 21
value = floor(const(velocity.run.fwd.x)*4)


[state 3001, Super Portrait]
type = explod
trigger1 = time = [0,14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3001, Super Portrait]
type = explod
trigger1 = time = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3001, width]
type= width
trigger1 = 1
player  = 40,57 ;60 works
edge = 5,30

[state 3001, posset]
type = posset
trigger1 = time = 0
x=(pos x-screenpos x)*facing

[state 3001, posfreeze]
type = posfreeze
trigger1 = time < 60
x = 1
y = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3001, end]
type = changestate
trigger1 = time = 61
value = 3002

;------------------------------------------------------------------------------------------
;Launch Thigh smother
[statedef 3002]
type = A
movetype = A
physics = N
anim = 3001
sprpriority = -2

[state 3002, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1100,0
persistent = 0
channel = 1

[state 3002, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1100,0
persistent = 0
channel = 1

[state 3002, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 250,-176
scale = const(size.xscale)*8,const(size.yscale)*8
sprpriority = 3
bindtime = 1
persistent = 0
trans = addalpha
alpha = 256,192

[State 3002, 1]
type = HitDef
Trigger1 = p2stateno != [150,155]
attr = A, HT          
hitflag = M         
priority = 1, Miss   
sparkno = -1                    
p1facing = 1
p2facing = 1            
p2stateno = 3020       
id = 3000
hitonce = 1
guard.dist = 0        
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1  

[State 3002, 1]
type = HitDef
Trigger1 = !movecontact
persistent = 0
attr = A, HT          
hitflag = FD          
priority = 1, Miss   
sparkno = -1                    
p1facing = 1
p2facing = 1            
p2stateno = 3020       
id = 3000
hitonce = 1
guard.dist = 0        
down.bounce = 1
p1sprpriority = -2
p2sprpriority = 1
fall.xvelocity = 0
fall.yvelocity = -20
fall = 1 

[state 3002, after image]
type = afterimage
trigger1 = time = 0
time = -1
length = 8
timegap = 1
framegap = 1
palcolor = 256
paladd = 256,0,0
palbright = 192,192,192
palcontrast = 256,256,256
trans = "none"

[state 3002, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(3000)
id = 3000
anim = 3002
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 0
removetime = -1

[state 3002, Velset]
type = velset
trigger1 = time = 0
y = floor((pos y+60) / -8)
x = floor((p2dist x + 300) / 8)

[state 3002, Pinned Down]
type = targetbind
trigger1 = 1
id = 3000
POS = 90, -150

[state 3002, nothitby]
type = nothitby
trigger1 = !movehit
value = ,AP
ignorehitpause = 1

[state 3002, I frames]
type = nothitby
trigger1 = movehit
value = SCA
ignorehitpause = 1

[state 3002, gravity]
type = gravity
trigger1 = pos y < 0

[state 3002, end]
type = changestate
triggerall = movehit
trigger1 = vel y > 0
trigger1 = pos y > 40
value = 3003

[state 3002, playerpush]
type = playerpush
trigger1 = !movecontact
value = 0
ignorehitpause = 1

[state 3002, end]
type = changestate
triggerall = !movehit
trigger1 = vel y > 0
trigger1 = pos y > 40
value = 3005


;------------------------------------------------------------------------------------------
;bounce
[statedef 3003]
type = C
movetype = A
physics = N
velset = 0,0

[state 3003, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3003, Reward]
type = varadd
trigger1 = time = 0
var(23) = 3
persistent = 0

[state 3003, afterimage]
type = afterimage
trigger1 = 1
time = 0

[state 3003, anim]
type = changeanim
trigger1 = time = 0
value = ifelse(numtarget(3000), 3003, 3008)

[state 3003, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 646, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 646, fx]
type = explod
trigger1 = time = 4
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 646, fx]
type = explod
trigger1 = time = 8
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 3003, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(3003)
trigger1 = anim = 3003
id = 3003
anim = 3004
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 1

[state 3003, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(3003)
trigger1 = anim = 3008
id = 3003
anim = 3009
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 1

[state 3003, removeexplod]
type = removeexplod
trigger1 = numexplod(3000)
id = 3000

[state 3003, targetstate]
type = targetstate
trigger1 = time = 0
value = 3021
id = 3000

[state 3003, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10)*-160)
id = 3000
kill = 0

[state 3003, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 250
id = 3000

[state 3003, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3003, stop vel]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3003, Pinned Down]
type = targetbind
trigger1 = anim = [3003,3009]
id = 3000
POS = 90, -10

[state 3003, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3003, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1


[state 3003, quake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 24

[state 3003, sprpriority]
type = sprpriority
trigger1 = anim = [3003, 3009]
trigger1 = animtime = 0
value = 2

[state 3003, Bounce]
type = velset
trigger1 = animelemtime(3) =0
x = 0
y = -15
persistent = 0

[state 3003, changeanim]
type = changeanim
trigger1 = anim = [3003,3009]
trigger1 = animtime = 0
value = 42

[state 3003, removeexplod]
type = removeexplod
trigger1 = anim = 42
trigger1 = numexplod(3003)
id = 3003

[state 3003, gravity]
type = gravity
trigger1 = pos y < 0

[state 3003, end]
type = changestate
trigger1 = time > 12
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 3010
;------------------------------------------------------------------------------------------
;bounce Miss
[statedef 3005]
type = C
movetype = A
physics = N
velset = 0,0



[state 3009, afterimage]
type = afterimage
trigger1 = 1
time = 0

[state 3009, anim]
type = changeanim
trigger1 = time = 0
value = 3005

[state 3009, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 646, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 646, fx]
type = explod
trigger1 = time = 4
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 646, fx]
type = explod
trigger1 = time = 8
anim = F61
postype = p1
pos = 0,0
scale = 4,1.75
ownpal = 1
sprpriority = -3

[state 3002, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(3003)
trigger1 = anim = 3005
id = 3003
anim = 3006
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 1

[state 3002, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(3003)
trigger1 = anim = 3008
id = 3003
anim = 3009
postype = p1
pos = 0,0
bindtime = -1
removeongethit = 1
sprpriority = 3
scale = const(size.xscale), const(size.yscale)
ignorehitpause = 1

[state 3009, removeexplod]
type = removeexplod
trigger1 = numexplod(3000)
id = 3000

[state 3009, targetstate]
type = targetstate
trigger1 = time = 0
value = 3021
id = 3000

[state 3009, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3009, stop vel]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3002, Pinned Down]
type = targetbind
trigger1 = anim = [3003,3009]
id = 3000
POS = 90, -40

[state 3009, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3009, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1


[state 3009, quake]
type = envshake
trigger1 = time = 0
ampl = -18
time = 24

[state 3009, sprpriority]
type = sprpriority
trigger1 = anim = [3003, 3009]
trigger1 = animtime = 0
value = 2

[state 3009, Bounce]
type = velset
trigger1 = anim = [3003, 3009]
trigger1 = animtime = 0
x = 2
y = -45
persistent = 0

[state 3009, statetypeset]
type = statetypeset
trigger1 = anim = [3003, 3009]
trigger1 = animtime = 0
statetype = A

[state 3009, changeanim]
type = changeanim
trigger1 = anim = [3003,3009]
trigger1 = animtime = 0
value = 42

[state 3009, removeexplod]
type = removeexplod
trigger1 = anim = 42
trigger1 = numexplod(3003)
id = 3003

[state 3009, gravity]
type = gravity
trigger1 = pos y < 0

[state 3009, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 3009


;------------------------------------------------------------------------------------
[statedef 3009]
type = C
movetype = I
physics = C
velset = 0,0
anim = 47

[state 3009, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 12

[state 3009, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3009, stop]
type = velset
trigger1 = time = 0
y = 0

[state 3009, changestate]
type = changestate
trigger1 = time = 30
value = 11
ctrl = 1

;------------------------------------------------------------------------------------
[statedef 3010]
type = A
movetype = A
physics = N
anim = 3010
sprpriority = -2

[state 3010, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 3005, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3010, explod Thighs]
type = explod
trigger1 = !numexplod(3010)
trigger1 = time = 0
id = 3010
anim = 3011
postype = p1
pos = 0,0
bindtime = -1
scale = const(size.xscale),const(size.yscale)
removeongethit = 1
sprpriority = 3

[state 3010, removeexplod]
type = removeexplod
trigger1 = numexplod(3003)
id = 3003

[state 3010, targetstate]
type = targetstate
trigger1 = time = 0
value = 3023

[state 3010, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3010, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3010, Leap]
type = velset
trigger1 = animelemtime(3) = 0
y = -30

[state 3010, slowdown]
type = velmul
trigger1 = animelemtime(10) = 0
y = 0.05




;Targetbinds go here
[STATE 3011, targetbind  01]
type = targetbind
trigger1 = animelemtime(2) < 0
id = 3000
pos = 60, -40

[STATE 3011, targetbind  02]
type = targetbind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
id = 3000
pos = 75, -85

[STATE 3011, targetbind  03]
type = targetbind
trigger1 = animelemtime(3) >= 0 && animelemtime(10) < 0
id = 3000
pos = 10, -250

[state 3011, Playsnd]
type = playsnd
trigger1 = animelemtime(10) = 0
trigger2 = animelemtime(14) = 0
trigger3 = animelemtime(18) = 0
trigger4 = animelemtime(22) = 0
trigger5 = animelemtime(26) = 0
trigger6 = animelemtime(35) = 0
value = S3000,1
persistent = 1

;Loops
[STATE 3011, targetbind  04]
type = targetbind
trigger1 = animelemtime(10) >= 0 && animelemtime(11) < 0
trigger2 = animelemtime(14) >= 0 && animelemtime(15) < 0
trigger3 = animelemtime(18) >= 0 && animelemtime(19) < 0
trigger4 = animelemtime(22) >= 0 && animelemtime(23) < 0
trigger5 = animelemtime(26) >= 0 && animelemtime(27) < 0
id = 3000
pos = 55, -250

[STATE 3011, targetbind  05]
type = targetbind
trigger1 = animelemtime(11) >= 0 && animelemtime(12) < 0
trigger2 = animelemtime(15) >= 0 && animelemtime(16) < 0
trigger3 = animelemtime(19) >= 0 && animelemtime(20) < 0
trigger4 = animelemtime(23) >= 0 && animelemtime(24) < 0
trigger5 = animelemtime(27) >= 0 && animelemtime(28) < 0
id = 3000
pos = -105, -245

[STATE 3011, targetbind  06]
type = targetbind
trigger1 = animelemtime(12) >= 0 && animelemtime(13) < 0
trigger2 = animelemtime(16) >= 0 && animelemtime(17) < 0
trigger3 = animelemtime(20) >= 0 && animelemtime(21) < 0
trigger4 = animelemtime(24) >= 0 && animelemtime(25) < 0
trigger5 = animelemtime(28) >= 0 && animelemtime(29) < 0
id = 3000
pos = -40, -70

[STATE 3011, targetbind  07]
type = targetbind
trigger1 = animelemtime(13) >= 0 && animelemtime(14) < 0
trigger2 = animelemtime(17) >= 0 && animelemtime(18) < 0
trigger3 = animelemtime(21) >= 0 && animelemtime(22) < 0
trigger4 = animelemtime(25) >= 0 && animelemtime(26) < 0
id = 3000
pos = -70, -125

[STATE 3011, targetbind  03]
type = targetbind
trigger1 = animelemtime(29) >= 0 && animelemtime(30) < 0
id = 3000
pos = 110, -285

[STATE 3011, targetbind  03]
type = targetbind
trigger1 = animelemtime(30) >= 0 && animelemtime(31) < 0
id = 3000
pos = 185, -360

[STATE 3011, targetbind  03]
type = targetbind
trigger1 = animelemtime(31) >= 0 && animelemtime(33) < 0
id = 3000
pos = 125, -440

[state 3011, playsnd]
type = playsnd
trigger1 = animelem = 33
value = 3000,2

[state 3011, playsnd]
type = playsnd
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
value = S1050,1
persistent = 0

[state 3009, targetlifeadd]
type = targetlifeadd
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
value = ceil(fvar(10)*-150)
id = 3000
persistent = 0
kill = 0

[state 3009, targetpoweradd]
type = targetpoweradd
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
value = 250
persistent = 0
id = 3000

[state 3003, hitcount]
type = hitadd
trigger1 = numtarget(3000)
trigger1 = target,stateno = 3025
value = 1
persistent = 0

[state 3009, Huge screenshake]
type = envshake
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
trigger1 = target,name = "Jumbo Elephant" || target,name = "Jumba Elephant" || target,name = "Bertha Hippo" || target,name = "Julian Hippo" || target,name = "Makuyama" 
ampl = -24
time = 24

[state 3009, Medium screenshake]
type = envshake
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
trigger1 = target,name = "Lardo Rat" || target,name = "Katrina Crocodile" || target,name = "Enorma Pig" || target,name = "Pastilla Skunk" || target,name = "Zafta Giraffe" 
ampl = -18
time = 24

[state 3009, Slight screenshake]
type = envshake
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
trigger1 = target,name = "Ana 'Jiggly' Bunny" || target,name = "Violet 'Tyla' Bunny" || target,name = "Aroma Skunk" || target,name = "Noah Sharker" || target,name = "Zafta Giraffe" 
ampl = -15
time = 24

[state 3009, Slight screenshake]
type = envshake
triggerall = numtarget(3000)
trigger1 = target,stateno = 3025
trigger1 = target,name = "Twiggi Bunny" 
ampl = 0
time = 1

[state 3009, average screenshake]
type = envshake
type = envshake
triggerall = numtarget(3000)
triggerall = target,stateno = 3025
trigger1 = target,name != "Jumbo Elephant" || target,name != "Jumba Elephant" || target,name != "Bertha Hippo" || target,name != "Julian Hippo" || target,name != "Makuyama" 
trigger1 = target,name != "Lardo Rat" || target,name != "Katrina Crocodile" || target,name != "Enorma Pig" || target,name != "Pastilla Skunk" || target,name != "Zafta Giraffe" 
trigger1 = target,name != "Ana 'Jiggly' Bunny" || target,name != "Violet 'Tyla' Bunny" || target,name != "Aroma Skunk" || target,name != "Noah Sharker" || target,name != "Zafta Giraffe" 
trigger1 = target,name != "Twiggi Bunny"
ampl = -12
time = 24

[state 3011, targetstate]
type = targetstate
trigger1 = animelem = 33
value = 3024

[state 3010, bounce]
type = veladd
trigger1 = animelemtime(34) = 0
y = -6
x = 0.5

[state 3010, slow descend]
type = veladd
trigger1 = animelemtime(34) > 0 && animelemtime(35) < 0
y = 0.22

[state 3010, gravity]
type = gravity
trigger1 = animelemtime(35) >= 0

[state 3011, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos Y > -vel y
value = 3012

;-------------------------------------------------------------
 [statedef 3012]
type = C
movetype = A
physics = N
anim = 3012

[state 3012, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,1

[state 3012, turn]
type = turn
trigger1 = time = 0

[state 3012, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3012, stop movement]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 3012, movement]
type = velset
trigger1 = time = 1
x = -1.25

[state 3012, speed dust]
type = explod
trigger1 = time > 0
anim = 2020
postype = p1
pos = -160,0
ownpal = 1
scale = const(size.xscale)*1.5,const(size.yscale) * 1.5
persistent = 6

[state 3002, after image]
type = afterimage
trigger1 = time = 0
time = -1
length = 8
timegap = 1
framegap = 1
palcolor = 256
paladd = 256,0,0
palbright = 192,192,192
palcontrast = 256,256,256
trans = "none"

[state 3012, playsnd]
type = playsnd
trigger1 = time > 0
value = S3012,0
channel = 2
persistent = 4

[state 3012, envshake]
type = envshake
trigger1 = time = 0
ampl = -8
time = 12

[state 3012, Peel Out]
type = changestate
trigger1 = time = 36
value = 3013

;-------------------------------------------------------------
;Spin Dash out
[statedef 3013]
type = S
movetype = A
physics = N
anim = 3013
sprpriority = 2

[state 3013, MOVE]
type = velset
trigger1 = time = 0
x = Ceil(frontedgebodydist / 12) ;const(velocity.run.fwd.x)*1.5

[state 3013, Sonic Boom Snd]
type = playsnd
trigger1 = time = 0
value = 1100,0

[state 3012, speed dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = -140,0
ownpal = 1
scale = const(size.xscale)*3,const(size.yscale)*3

[state 3012, speed Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 300,-150
ownpal = 1
bindtime = 0
scale = const(size.xscale)*8,const(size.yscale)*8
sprpriority = 3

[state 3012, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3012, CRASH]
type = changestate
trigger1 = frontedgebodydist < 300
value = 3014

;-------------------------------------------------------------
;Butt Crash
[statedef 3014]
movetype = A
type = S
physics = N
anim = 3014
sprpriority = 3

[state 3014, afterimages]
type = afterimage
trigger1 = 1
time = 0

[state 3014, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3014, velset]
type = velset
trigger1 = time = 0
x = 0

[State 1027, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, -200
postype = p1
scale = -2,2
sprpriority = 4

[state 3042, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))

[state 3014, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,1

[state 3014, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,1

[state 3014, playsnd]
type = playsnd
trigger1 = time = 0
value = S1050,1



[state 3014, quake]
type = envshake
trigger1 = time = 0
ampl = -24
time = 30

[state 3014, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = ceil(fvar(10) * -230)
id = 3000
persistent = 0
kill = 1

[state 3014, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 500
id = 3000
persistent = 0

[state 3003, hitcount]
type = hitadd
trigger1 = time = 0
value = 1

[state 3014, Targetstate]
type = targetstate
trigger1 = time = 0
value = 3026
id = 3000

[state 3014, turn]
type = turn
trigger1 = anim = 3014
trigger1 = animtime = 0

[state 3014, change anim]
type = changeanim
trigger1 = anim = 3014
trigger1 = animtime = 0
value = 42

[state 3014, Bounce]
type = velset
trigger1 = anim = 42
x = 18
y = -36
persistent = 0

[state 3014, gravity]
type = gravity
trigger1 = pos y < 0


[state 3014, end!!!]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[state 3014, nothitby]
type = nothitby
trigger1 = 1
value = SCA








;-------------------------------------------------------------
[statedef 3020]
type = A
movetype = H
sprpriority = 1

[state 3010, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 3020

[state 3010, selfstate]
type = selfstate
trigger1 = !gethitvar(isbound)
value = 5050

;-------------------------------------------------------------
[statedef 3021]
type = L
movetype = H
sprpriority = 1

[state 3021, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 3021

[state 3021, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = 1.05, 0.8

[state 3021, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3021, notbound]
type = selfstate
trigger1 = !gethitvar(isbound)
value = 5050

;-------------------------------------------------------------
[statedef 3022]
type = L
movetype = H
sprpriority = 1

[state 3022, launch away]
type = changeanim 
trigger1 = time = 0
value = 5061

[state 3022, launch]
type = velset
trigger1 = time = 0
x = frontedgebodydist / 12
y = (-200 + (pos y)) / 12

[state 3022, gravity]
type = gravity
trigger1 = time > 12

[state 3022, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3022, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;-------------------------------------------------------------
[statedef 3023]
type = A
movetype = H
sprpriority = 1

[state 3023, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 3023

[state 3023, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0
;-----------------------------------------------------------------------------------------'
;Fly into wall
[statedef 3024]
type = A
movetype = H
;velset = 80,40

[state 3022, launch]
type = velset
trigger1 = time = 0
x = frontedgebodydist / 12
y = (-250 - (pos y)) / 12

[state 3024, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3024, displaytocliboard]
type = displaytoclipboard
trigger1 = 1
text = "front edge:  %d  Back edge : %d  Pos y: %d"
params = frontedgebodydist, backedgebodydist, pos y 

[state 3024, Crash]
type = changestate
trigger1 = frontedgebodydist < 30
trigger2 = time = 20
value = 3025

;-------------------------------------------------------------------------------------------

;On wall
[statedef 3025]
type = A
movetype = H
physics = N
velset = 0,0

[State 1027, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = front
scale = 2,2
sprpriority = 3


[state 3051, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))
y = -250

[state 3025, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 3025

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3051, angledraw]
type = angledraw
trigger1 = 1
value = 90
scale = 1,1


[state 3051, fall off]
type = velset
trigger1 = time = 180 ;Time
y = -2
x = 0.5
[state 3025, gravity]
type = gravity
trigger1 = time > 180

[state 3025, turn]
type = turn
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
persistent = 0

[state 3025, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100


;------------------------------------------------------------------------------------------
;Crushed on wall 
[statedef 3026]
type = A
movetype = H
physics = N
velset = 0,0

[state 3051, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))
y = -250

[state 3025, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 3026

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3051, angledraw]
type = angledraw
trigger1 = 1
value = 90
scale = 1.5,0.2

[state 3051, fall off]
type = velset
trigger1 = time = 55 ;Time
y = -4
x = -2

[state 3026, nothitby]
type = nothitby
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = SCA
time = 12

[state 3025, gravity]
type = gravity
trigger1 = time > 55

[state 3025, turn]
type = turn
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
persistent = 0

[state 3025, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100





;------------------------------------------------------------------------------------------
; Super Anti Air
[statedef 3040]
type = A
movetype = A
physics = N
anim = 3040
ctrl = 0
velset = 0,0

[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 70
v = 18
value = 70
ignorehitpause = 1

[state 3040, no bg]
type = assertspecial
trigger1 = animelemtime(2) >= 0 && animelemtime(2) < 60
flag = nobg
ignorehitpause = 1
persistent = 1

[State 3040, Super Pause]
type = SuperPause
trigger1 = animelemtime(2) = 0
sound = S3000, 0
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60

[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(2) =[0, 14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(2) = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3040, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3040, Jump]
type = velset
trigger1 = animelemtime(3) = 0
x = ifelse(command = "holdfwd",24, ifelse(command = "holdback", 0, 12))
y = -55

[state 3040, fx]
type = explod
trigger1 = animelemtime(3) = 0
anim = F61
postype = p1
pos = 0,0
scale = 2,1
ownpal = 1

[state 3040, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 1050,0

[State 3040, Hitdef]
type = HitDef
trigger1 = time = 0
trigger1 = p2stateno != [150,155]
attr = A, HT
animtype  = Up
damage    = 0
guardflag = 
getpower = 0
hitflag = AF
priority = 1, miss
id = 3040
pausetime = 0,0
sparkno = 0
hitonce = 1
hitsound   = 0,0
guardsound = 6,0
air.velocity = 0,0
guard.hittime = 12
guard.velocity = -16
guard.slidetime = 14
guard.dist = 0
p2facing = 1
p1stateno = 3042
p2stateno = 3050
kill = 0

[state 3040, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 1050,2

[state 3040, gravity]
type = gravity
trigger1 = pos y < 0

[state 3040, nothitby]
type = Hitby
trigger1 = time < 92
value = SC,AA, AT,AP
ignorehitpause = 1


[state 3040, Miss land]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3041



;-------------------------------------------------------------------------------------------


;---------------------------------------------------------------------------
;Miss Landing
[statedef 3041]
type = C
movetype = I
physics = C
anim = 3041

[state 3041, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 12

[state 3041, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 3041, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3041, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------
;Hit Air
[statedef 3042]
type = A
movetype = A
physics = N
anim = 3042
sprpriority = -2
movehitpersist = 1

[state 3042, playsnd]
type = playsnd
trigger1 = time = 0
value = 1,1

[state 1102, varadd]
type = varadd
trigger1 = time = 0
var(23) = 2
ignorehitpause = 1
persistent = 0

[state 3042, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(3042)
anim = 3046
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 3042

[state 3042, bounce up]
type = velmul
trigger1 = time = 1
x = 0

[state 3042, bounce up]
type = velset
trigger1 = time = 1
y = -8


[state 3042, posset]
type = posadd
trigger1 = time = 0
y = -100

[state 3042, spin]
type = playsnd
trigger1 = time = 1
value = 1120,0


[state 3042, gravity]
type = veladd
trigger1 = animelemtime(3) > 0 && animelemtime(7) < 0
y = 0.22
persistent = 1
;======================================================
;                   Binds
;=====================================================
[state 3042, targetbind rotations 1]
type = targetbind
trigger1 = animelem = 1
trigger2 = animelem = 5
trigger3 = animelem = 9
trigger4 = animelem = 13
trigger5 = animelem = 17
pos = 74, -68
persistent = 1

[state 3042, targetbind rotations 2]
type = targetbind
trigger1 = animelem = 2
trigger2 = animelem = 6
trigger3 = animelem = 10
trigger4 = animelem = 14
trigger5 = animelem = 18
pos = -128, -174
persistent = 1

[state 3042, targetbind rotations 3]
type = targetbind
trigger1 = animelem = 3
trigger2 = animelem = 7
trigger3 = animelem = 11
trigger4 = animelem = 15
trigger5 = animelem = 19
pos = 46, -358
persistent = 1

[state 3042, targetbind rotations 4]
type = targetbind
trigger1 = animelem = 4
trigger2 = animelem = 8
trigger3 = animelem = 12
trigger4 = animelem = 16
trigger5 = animelem = 20
pos = 110, -152
persistent = 1


[state 3042, targetbind]
type = targetbind
trigger1 = animelem = 21
pos = 298, -377
persistent = 1


[state 3042, targetbind]
type = targetbind
trigger1 = animelem = 22
pos = 294, -300
persistent = 1


[state 3042, targetbind]
type = targetbind
trigger1 = animelem = 23
pos = 290, -222
persistent = 1


[state 3042, targetbind]
type = targetbind
trigger1 = animelem = 24
pos = 166, -204
persistent = 1


[state 3042, targetbind]
type = targetbind
trigger1 = animelem = 25
pos = 142, -148
persistent = 1

[state 3042, targetbind]
type = targetbind
trigger1 = animelem = 26
pos = 50, -100
persistent = 1

[state 3042, veladd]
type = velset
trigger1 = animelemtime(26) = 0
y = 10
x = 0
persistent = 0

[state 3042, gravity]
type = gravity
trigger1 = animelemtime(27) > 0 

[state 3042, gravity]
type = gravity
trigger1 = animelemtime(27) > 0 

[state 3042, gravity]
type = gravity
trigger1 = animelemtime(27) > 0 

[state 3042, targetbind]
type = targetbind
trigger1 = animelemtime(27) >= 0
pos = 56, -122
persistent = 1

[state 3042, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3043


;----------------------------------------------------------------------------
;Hit Landing1
[statedef 3043]
type = C
movetype = A
physics = C
anim = 3043
sprpriority = -2
movehitpersist = 1

[state 3043, width]
type = width
trigger1 = 1
edge = 200,200

[state 3043, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(3043)
anim = 3047
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removetime = -1
removeongethit = 1
id = 3043

[state 3043, removeexplod]
type = removeexplod
trigger1 = numexplod(3042)
id = 3042

[state 3043, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 6,3
ownpal = 1
sprpriority = -3

[state 3043, targetstate]
type = targetstate
trigger1 = time = 0
id = 3040
value = 3051

[state 3043, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 3043, targetdamage]
type = targetlifeadd
trigger1 = time = 0
id = 3040
value = floor(fvar(10) * -170)
persistent = 0

[state 3043, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
id = 3040
value = 200
persistent = 0

[state 3043, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3043, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3043, quakes]
type = envshake
trigger1 = time = 0
ampl = 21
time = 24


[state 3043, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 3043, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3043, Bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -36

[state 3043, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A

[state 3043, gravity]
type = gravity
trigger1 = animelemtime(3) > 0

[state 3043, Miss land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3044

;----------------------------------------------------------------------------
;Hit Landing2
[statedef 3044]
type = C
movetype = A
physics = C
anim = 3044
sprpriority = -2
movehitpersist = 1

[state 3044, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 3044, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = floor(fvar(10) * -65)
id = 3040
persistent = 1
kill = 0

[state 3043, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
id = 3040
value = 80
persistent = 0

[state 3044, targetstate]
type = targetstate
trigger1 = time = 0
id = 3040
value = 660
persistent = 0

[state 3044, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(3044)
anim = 3048
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 3044

[state 3043, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 5,2
ownpal = 1
sprpriority = -3

[state 3044, removeexplod]
type = removeexplod
trigger1 = numexplod(3043)
id = 3043

[state 3044, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 3043, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3043, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1

[state 3043, quakes]
type = envshake
trigger1 = time = 0
ampl = 21
time = 24

[state 3043, bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -30

[state 3043, gravity]
type = gravity
trigger1 = animelemtime(3) > 0


[state 3044, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3044, Miss land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3045

;----------------------------------------------------------------------------
;Hit Landing3
[statedef 3045]
type = C
movetype = A
physics = N
anim = 3045
sprpriority = -2
movehitpersist = 1

[state 3045, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 3045, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = floor(fvar(10) * -65)
id = 3040
persistent = 0

[state 3043, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
id = 3040
value = 40
persistent = 0

[state 3045, targetstate]
type = targetstate
trigger1 = time = 0
id = 3040
value = 660


[state 3045, explod]
type= explod
trigger1 = time = 0
trigger1 = !numexplod(3045)
anim = 3049
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 0
bindtime = -1
removeongethit = 1
id = 3045

[state 3045, fx]
type = explod
trigger1 = time = 0
anim = F61
postype = p1
pos = 0,0
scale = 5,2.25
ownpal = 1
sprpriority = -3

[state 3045, removeexplod]
type = removeexplod
trigger1 = numexplod(3044)
id = 3044

[state 3045, Stop]
type = velset
trigger1 = time = 0
y = 0

[state 3045, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1
volumescale = 100

[state 3045, playsnd]
type = playsnd
trigger1 = time = 0
value = 1050,1
volumescale = 100

[state 3045, quakes]
type = envshake
trigger1 = time = 0
ampl = 18
time = 24

[state 3045, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = 15
y = -32

[state 3045, gravity]
type = gravity
trigger1 = pos y < 0

[state 3045, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3045, Miss land]
type = changestate
trigger1 = animtime = 0
value = 3046

;-----------------------------------------------------------------------------
;Jump off
[statedef 3046]
type = A
movetype = I
physics = N
anim = 42

[state 3046, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3046, gravity]
type = gravity
trigger1 = pos y < 0

[state 3046, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 3047

;------------------------------------------------------------------------------
;Slow Landing
[statedef 3047]
type = S
movetype = I
physics = S
velset = 0,0
anim = 3041

[state 3047, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 15

[state 3047, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3047, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3047, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1





;-----------------------------------------------------------------------------
;Face ridden
[statedef 3050]
type = A
movetype = H
physics = N
sprpriority = -1

[state 3050, rotations]
type = angledraw
trigger1 = time < 40
value = (time * 45)
persistent = 1

[state 3050, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 3050
persistent = 0

[state 3050, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

;---------------------------------------------------------------------------
;Face ridden impact
[statedef 3051]
type = L
movetype = H
physics = C
sprpriority = -1

[state 3051, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3051, posadd]
type = posadd
trigger1 = time = 0
x = -const(size.mid.pos.y)

[state 3051, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3051, ground]
type = posset
trigger1 = time = 0
y = 0

[state 3051, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1081

[state 3051, angledraw]
type = angledraw
trigger1 = 1
value = 0
scale = 1.1, 0.4


[state 3051, end]
type = selfstate
trigger1 = alive
trigger1 = animtime = 0
value = 5120

[state 3051, end]
type = selfstate
trigger1 = !alive
trigger1 = animtime = 0
value = 5150
;---------------------------------------------------------------------------
;Face ridden impact 2
[statedef 1082]
type = L
movetype = H
physics = C
sprpriority = -1

[state 1080, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1082

[state 1080, pos set]
type = posset
trigger1 = animelemtime(4) = 0
y = 0

[state 1082, end]
type = selfstate
trigger1 = animtime = 0
value = 5120
;-----------------------------------------------------------------------------
;Running Attack Counter
[statedef 4900]
type = A
physics = N
movetype = I
anim = 9999

[state 4900, Running Icon Hud]
type = explod
trigger1 = 1
anim = 4920
id = 4920
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1,10, 1270),180+var(0);ifelse(teamside =1, (gamewidth*0.01),(gamewidth*0.99)),floor((gameheight*0.25))
ontop = 1
ownpal = 1
bindtime = -1


[State 0, VarSet]
type = VarSet
trigger1 = numpartner
trigger1 = p3name = "Enorma Pig"
var(0) = 150

[state 4900, Times Hud]
type = explod
trigger1 = 1
anim = 4900
id = 4900
postype = left
facing = ifelse(teamside = 1,1,1)
pos = ifelse(teamside = 1,110, 1140),190+var(0);ifelse(teamside =1, (gamewidth*0.01),(gamewidth*0.99)),floor((gameheight*0.25))
ontop = 1
ownpal = 1
bindtime = -1

[state 4900, Running Attack Counter]
type = explod
trigger1 = 1
anim = ifelse(root,var(23) < 1, 4901,4900+(root,var(23)))
id = 4901
postype = left
facing = ifelse(teamside = 1,1,1)
pos = ifelse(teamside = 1,140, 1100),190+var(0);ifelse(teamside =1, (gamewidth*0.05),(gamewidth*0.94)),floor((gameheight*0.25))
ontop = 1
ownpal = 1
bindtime = -1



;-----------------------------------------------------------------------------------------------------
;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy's projectile (helper). For use with AI.
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy's projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy's projectile helper's distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy's projectile helper's velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
 
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
;==========================================================================
;                Detect Enemy's Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = cond(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = cond(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = cond(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = cond(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = cond(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = cond(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = cond(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = cond(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = cond(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = cond(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 
;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------
[statedef -2]

[state -2, Displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
params = p2bodydist x, p2bodydist y, Pos y, Frontedgebodydist, Backedgebodydist
text = "Dist from Opp: X: %d  Y: %d Pos Y: %d   Distance to wall: Front: %d  Back %d"

;====================================================
;combo Scaling
;====================================================

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar(10)
ignorehitpause = 1

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger2 = !numenemy
ignorehitpause = 1
v = 18
value = 100

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05
ignorehitpause = 1

;==============================================================================
;                           Win Quotes
;==============================================================================
[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%7)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumbo Elephant"
value = 8+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ana 'Jiggly' Bunny"
value = 11+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Katrina Crocodile"
value = 14+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Bertha Hippo"
value = 17+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Aroma Skunk"
value = 20+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Enorma Pig"
value = 23+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Lardo Rat"
value = 26+(random%3)
ignorehitpause
persistent = 1


[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Zafta Giraffe"
value = 29+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Makuyama"
value = 32+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Pastilla Skunk"
value = 35+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumba Elephant"
value = 38+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Rapid Bunny"
value = 41+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Twiggi Bunny"
value = 44+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Violet 'Tyla' Bunny"
value = 47+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Julian Hippo"
value = 50+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Akai R. Panda"
value = 53+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Noah Sharker"
value = 56+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ra Lord"
value = 59+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Texas Stanton"
value = 62+(random%3)
ignorehitpause
persistent = 1

;--------------------------------------------

[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(8) = 2
ignorehitpause = 1

[state -2, Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(11) = 2
ignorehitpause = 1

[state -2. Chain Sit enemy check]
type = varset
triggerall = numenemy
trigger1 = enemynear, movetype != H
var(24) = 0
ignorehitpause = 1

[state -2, Bounce counters]
type = varset
trigger1 = var(23) < 1
var(23) = 1
ignorehitpause = 1

[state -2, bounce inhibitor]
type = varset
trigger1 = var(23) > 10
var(23) = 10
ignorehitpause = 1

;---------------------------------------------------------------------------
;Running Attack Counter
;Ammo Hud
[state -2, helper]
type = helper
triggerall = !numhelper(4900)
trigger1 = roundstate = 2
name = "Running Attack Hud"
helpertype = normal
stateno = 4900
postype = p1
pos = 0,0
id = 4900
persistent = 300
ignorehitpause = 1


;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

;=======================AI Detect Projectile System==========================
[state -3, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1

[state -3, afterimage]
type = afterimage
trigger1 = gethitvar(damage)
time = 0

[state -3, meter gain]
type = poweradd
trigger1 = enemynear,authorname = "Dcat Power"
trigger1 = enemynear,stateno = [720,729]
value = 5
persistent = 30
ignorehitpause = 0


;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.
[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
value = 40, 0
