; KFM's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 1100
power = 5000
;attack power (more is stronger)
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 45
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1.8     ;1.8     ;Horizontal scaling factor.
yscale = 1.8      ;1.8     ;Vertical scaling factor.
ground.back =150    ;Player width (back, ground)
ground.front = 130    ;Player width (front, ground)
air.back = 130        ;Player width (back, air)
air.front = 140       ;Player width (front, air)
height = 240         ;Height of player (for opponent to jump over)
attack.dist = 640    ;Default attack distance
proj.attack.dist = 360 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = 6, -402 ;Approximate position of head
mid.pos = 14, -158  ;Approximate position of midsection
shadowoffset = -12     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 7.5      ;Walk forward
walk.back = -6.0     ;Walk backward
run.fwd  = 22.0, 0   ;Run forward (x, y)
run.back = -14,-15.2 ;Hop backward (x, y)
jump.neu = 0,-37   ;Neutral jumping velocity (x, y)
jump.back = -13,-35 ;Jump back Speed (x, y)
jump.fwd = 13,-35     ;Jump forward Speed (x, y)
runjump.back = -10.2,-18.5 ;Running jump speeds (opt)
runjump.fwd = 18,-18.5    ;.
airjump.neu = 0,-18.5     ;.
airjump.back = -10.2      ;Air jump speeds (opt)
airjump.fwd = 10          ;.
air.gethit.groundrecover = -.6,-14    ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-18     ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -4       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -8         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 6        ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 0      ;Number of air jumps allowed (opt)
airjump.height = 140 ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.7        ;Vertical acceleration
stand.friction = .83  ;Friction coefficient when standing
crouch.friction = .8 ;Friction coefficient when crouching
stand.friction.threshold = 8          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .2        ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 100          ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -80 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 40   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -4  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.7    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 60      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 80            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.7              ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 48          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .2          ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes **MUGEN 1.0**
;The default language victory quotes must be implemented in English.
[Quotes]
; Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory1 = "Hard to stare when you're flat on your ass, huh?"
victory2 = "Nothing wrong with smiling at me, I'm just gonna smile back."
victory3 = "You know, you could stare longer if you're conscious."
victory4 = "Mess with the breast and drop like the rest!"
victory5 = "When you're carrying girls like mine, you're damn well gonna be strong."

;vs Bertha

victory6 = "You just got outplayed, hippo. You might have more weight, but you sure don't know how to throw it."
victory7 = "Glad you've got so much of a cushion to fall back on when I knock you out!"
victory8 = "Sit down, Bertha; try not to take up five seats while you're at it."

;Vs Jiggly

victory9 = "Damn, girl! You even drop fast too!"
victory10 = "Aren't you supposed to be good at dodging?"
victory11 = "For a wrestling bunny, you sure don't know how to grab."

;Vs Jumbo
victory12 ="I don't think you're up to the tusk."
victory13 ="You did more damage to the ground falling over than you ever did to me!"
victory14 ="Don't talk to me about weight management until it's all packed in front of you, tubby."

;Vs TMNT Leonardo
Victory15 ="A croc's bite beats a turtles shell any day."
victory16 ="Your techniques are about as outdated as you are!"
Victory17 ="You're looking mighty shell shocked, Leo!"

;Vs TMNT Raphael
Victory18 ="That ought to help you simmer down, hothead!"
Victory19 ="Try to bring something other than forks for weapons, and you might pose a threat."
Victory20 ="That turtle part of you is showing, slowpoke."

;vs TMNT Michealangelo
Victory21 ="You're pretty chill, but you ought to take this more seriously."
victory22 ="When you get back up, maybe we can grab a bite of pizza together."
victory23 ="Why is the goofball the one with the complicated weapons?"

;Vs TMNT Donatello
Victory24 = "You brought a stick to fight a heavyweight crocodile? I thought you were supposed to be the smart one."
Victory25 = "Back to the drawing board, genius!"
Victory26 = "Think you ought to stick to your machines, Donny."

;Vs Armgon
Victory27 = "Wow, you are old school; you're really behind."
Victory28 = "All bites and no brains, huh?"
Victory29 = "You're just a fish out of water, tin fins."

;Vs Ms Fanservice
Victory30 = "Since I won do I get your title."
Victory31 = "Ms. Fanservice is a tiny waife that does chip damage on normals!?  What a rip!!"
Victory32 = "Is Sniping a good job mate?"

;Vs Power Girl
Victory33 = "You may be thick, but your not as powerful as your name implies."
victory34 = "We should form a team.  We'll be far too distracting for anyone to focus."
victory35 = "You should try my sandwich technique.  I'm sure you could do great damage with it too."

;Vs Herself
Victory36 = "Ha, apparently I'm not my own worst enemy."
Victory37 = "Oh wow, the way I sway really is hypnotic!"
Victory38 = "Hey I don't want any recolors running around.  Get lost!"

;Vs Renamon
Victory39 = "Come back when you have that thicker, original design of yours."
Victory40 = "Personally, I like Lucario more."
Victory41 = "You're such furry bait Rena.  Thanks for giving me an audience to beat you up to."

;vs Lucario
Victory42 = "Personally, I like Renamon more."
Victory43 = "You fight like a shoto.  Tisk tisk."
Victory44 = "Eating all those poffins must of made you fat."

;vs Lardo
victory45 = "Well you tried to bite me, and you're obviously gonna be outclassed when I bite back."
victory46 = "Didn't think rats got that big, and seeing as how they aren't a threat I guess I don't care."
victory47 = "I think you have more ass than Bertha which fits cuz your fighting is also more ass than Bertha's."

;vs Zafta
victory48 = "How's the change in weather down there?"
victory49 = "You're like a giant drumstick with thighs like that."
victory50 = "You got nice kicks.  Not nice enough to win but still nice."

;Vs Makuyama
victory51 = "Wow!  You panda's are cute, fluffy and entirely harmless."
victory52 = "I've already shown I can bust through one sumo whats the point of another?"
victory53 = "You're techniques feel more sumo than the elephant but you both sure love throwing your weight around."

;vs Pastilla
victory54 = "You rely on magic and poison too much.  What are you gonna do when someone  doesn't give you time to think about how to react?"
victory55 = "You zoning types...  Don't you get bored by the spam?"
victory56 = "You thought you would keep me out easy, but I have back up."

;vs Jumba, Ninja Elephant
victory57 = "Wow, you took the term 'bum rush' literally."
victory58 = "How do you do stealth when I'm pretty sure all my senses alert me to your presence."
victory59 = "ASSQUAKE!  Its unfortunate for you that the name Earthquake is taken.  Since you would live up to the Japanese pronunciation of it."

;vs Aroma, Entrepenur Skunk chemist
victory60 = "Damn girl!  You really stink."
victory61 = "I'm aware that you could easily contaiminate a whole lake with that ability.  That's really gross."
victory62 = "Wait.  So you actually make perfume too?"

;vs Twiggi, Ultra Skinny Lesbian
victory63 = "I've got more weight on my chest than your entire body, string bean!"
victory64 = "Looks like I've got the better partner!"
victory65 = "Unlike you, I don't need someone to take hits for me."

;vs Ra, Snake doodle
victory66 = "BEHOLD!!  I've knocked you on your ass."
Victory67 = "My bite is better than yours, damn right its better than yours."
Victory68 = "You're quite a challenge danger-noodle-man but you were no match for us."

;vs Ryu, The World Warrior
victory69 = "Looks like beating me is a No-can-do-ken!"

;vs Violet, no affiliation
Victory70 = "Next time, use those thighs of yours to run from me."
victory71 = "Damn girl!  You really put ass in assassin."
victory72 = "Don't need to fear being ambushed by ninjas if I have back up."

;vs Battu
Victory73 = "Damn girl! Those hips are out of this world."
victory74 = "Three eyes and you didn't see that beating coming?  Come on girl."
victory75 = "Enormous bust crocodile beats ampled hipped space rodent. I love Mugen for this sort of thing."

;vs Julian
victory76 = "You remind me of a lot of Bertha with the way you fall flat on your fat ass."
victory77 = "Think those cameras got a good view of me kicking your tail?"
victory78 = "You even pose when you're knocked out!."

;vs Enorma
victory79 = "I was gonna compliment you on the impossible feat of getting in those jeans.  But then you started shooting and I had to put you down for it."
victory80 = "Did you just pull a rocket launcher out of your cleavage?!  If I had thought about that I would of pulled a tank."
victory81 = "Even munitions fails against my chest."

;Vs Rapid
Victory82 = "All you have is speed!  Maybe if your strikes actually hurt I would be worried."
victory83 = "You're a good guy Rapid, but don't get your cute ass in fights with someone like me though."
Victory84 = "I don't see how someone like you is with that hippo."  

;Vs Noah
Victory85 = "Bringing Back up is smart, But your demon dogs are no match for my fellow crocs."
Victory86 = "All those arrows are annoying.  I'm really suprised that as a shark you didn't try to bite me."
Victory87 = "Forming weapons like that must be pretty cool.  I'd love to be able to do that."

;vs Katrina
Victory88 = "Make sure you stay in shape, or at least have a strong back workout.  Develop habbits to improve your posture.  Get a chiropractor that you can trust.  And if those moobs get attention that benefits you just roll with it."
Victory89 = "I know what its like to have an excessive chest.  If you ever need help let me know."
victory90 = "I don't know what it feels like to be a guy with an excessive chest but I can help you with what I know." 

;Vs Andy
victory91 = "Thanks for looking out for my spine, but I have a very strong back."
victory92 = "Normally I would think a few moonsault would keep someone down but considering the size of that cow you brought I think you'd be used to it."
victory93 = "You found out the hard way I could bite through armor."

;Vs Montana
victory94 = "Good luck taking a bite out of my outfit."
victory95 = "You're entourage doesn't seem to help you in battle at all."
victory96 = "Look at your flying around all over the place like that's gonna prevent me from snatching you."

;vs Texas
victory97 = "Wow, my backup actually helps me.  Your's seems to have a grudge against you."
victory98 = "You're that Sheriff from Gold Springs aren't you!?  I'd be worried if I didn't know you're often squashed flat in your job."
victory99 = "So you got tired of being sat on and wanted to be crushed by modest crocodilian boobs instead.  A change of pace is pretty nice."

;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
; var(7)  - Wall Bounce limiter
; var(8)  - ground bounce limiter
; var(9)  - Bite grab limiter
; var (14) - Moonsault damage
; var(13) - boobryureppa counter
;var(29) - Rachelle available
;var(30) - ai
;var(31) - counter
;var(33) - counter
;var(32) - Rachelle Health
;var(33) - Rachelle Win check
;var(35) - Vengence check
;var(36) - max Rachelle health
;var(38) - Jump distance for win
;var(31) - player distance to opponent
;var(39) - Jump infinite fix
;var(41) - X axis charge AI
;var(42) - X Axis charge confirm
;var(43) - Y axis charge AI
;var(44) - y axis charge confirm


;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = var(36) != 1
value = 181

[state 180, 1]
type = changestate
trigger1 = var(36) =1
trigger2 = numhelper(4000) > 0
value = 18200
;---------------------------------------------------------------------------
; Win pose 1 - Shake shake
; CNS difficulty: basic
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[state 182, width]
type = width
trigger1 = 1
edge = 100,100

[state 181, spr priority]
type = sprpriority
trigger1 = 1
value = -2
persistent = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
value = S180,1
channel = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
value = S180,1
channel = 1

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 1,1
postype = Back
pos = ifelse(facing =1, 20, 157),360 ; Nice!
ontop = 1

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[state 191, shirt]
type = explod
trigger1 = anim = 190
trigger1 = animelemtime(2) = 0
postype = p1
pos = 0,0
anim = 19000
scale = const(size.xscale),const(size.yscale)
removetime = -2
bindtime = -1
sprpriority = 2
persistent = 0

[state 191, playsnd2]
type = playsnd
trigger1 = animelemtime(4) = 0
trigger2 = animelemtime(8) = 0
value = S190,0

[state 191, playsnd2]
type = playsnd
trigger1 = animelemtime(13) = 0
value = S190,1

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;--------------------------------------------------------------------------
; Rachelle KO
[statedef 18200]
type = A
movetype = I
ctrl = 0
anim = 41
velset = 0,0
physics = N

[state 18200, posset]
type = posset
trigger1 = time = 0
y = 0

[state 18200, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,1
persistent = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
trigger1 = !numhelper(4700)
value = S180,3
channel = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
trigger1 = !numhelper(4700)
value = S180,3
channel = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
trigger1 = numhelper(4700)
value = S180,5
channel = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
trigger1 = numhelper(4700)
value = S180,5
channel = 1

[state 18200, assertspecial]
type = assertspecial
trigger1 = 1
flag = roundnotover

[state 18200, varset]
type = varset
trigger1 = time = 0
trigger1 = helper(4000),pos x 
var(37) = 0

[state 18200, jump back]
type = velset
triggerall = anim = 41
trigger1 = animelemtime(2) = 0
x = -32 
y = -14

[state 18200, change animation again]
type = changeanim
trigger1 = anim = 41
trigger1 = animelemtime(2) > 4
value = 46

[state 18200, gravity]
type = gravity
trigger1 = pos y < -1

[state 18200, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 182

;----------------------------------------------------------------------
; Point to Rachelle
[statedef 182]
type = S
movetype = I
ctrl = 0
anim = 182
velset = 0,0
sprpriority = -3

[state 18200, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,1
persistent = 1

[state 182, pos y]
type = posset
trigger1 = time = 0
y = 0

[State 52, 4]
type = EnvShake
trigger1 = time = 0
time = 15
ampl = 8

[state 18100, assertspecial]
type = assertspecial
trigger1 = time < 180
flag = roundnotover





;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
movetype = A
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = HitDef
trigger1 = animelem = 8 
trigger2 = animelem = 13 
trigger3 = animelem = 19 
attr = S, NA
animtype  = heavy
damage    = 40
guardflag = MA
pausetime = 4,4
sparkno = 1
getpower = 167
sparkxy = -40,-280
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 20
ground.hittime  = 24
guard.hittime = 8
ground.velocity = -8
guard.velocity = -4
air.velocity = -8,-2
forcenofall = 1

[state 195, 1]
type = poweradd
trigger1 = time = 1
value = 100

[state 195, 1]
type = poweradd
trigger1 = time = 60
value = 400

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 200                       ;Change animation (Def: no change)
poweradd = 15                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)


[State 200, 1]
type = PlaySnd
trigger1 = Time = 3
value = 0, 9

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA                    
damage = 22, 0                   
animtype = Light               
guardflag = MA                  
hitflag = MAF                   
priority = 3, Hit                
pausetime = 8, 8                
sparkno = 0                      
sparkxy = -40, -304             
hitsound = S0, 4                  
guardsound = 6, 0               
ground.type = High             
ground.slidetime = 14           
ground.hittime  = 14           
ground.velocity = -14           
guard.velocity = -18              
guard.hittime = 15
guard.slidetime = 15
airguard.velocity = -7.6,-3.2   
air.type = High                
air.velocity = -5.6,-12         
air.hittime = 15 
guard.dist = 280
fall.recovertime = 20           

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 200,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; 2nd hit of jab
[Statedef 201]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 40
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -1

[State 201, Width]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (7) < 0)
value = 15,0

[State 201, 1]
type = PlaySnd
trigger1 = animTime = 6
value = 3, 0

[state 201, veladd]
type = velset
trigger1 = animelemtime(3) = 0
x = 20

[State 201, 2]
type = HitDef
trigger1 = time = 0
attr = S, NA
animtype  = Medium
damage    = 40
guardflag = MA
pausetime = 8,8
sparkno = 1
sparkxy = -40,-280
hitsound   = S0,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -12
guard.velocity = -18            
guard.hittime = 16
guard.slidetime = 16
air.velocity = -10,-16
forcenofall = 1
guard.dist = 280
fall.recovertime = 20  

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[state 1200,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[State 201, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Standing Hard Punch (Bite)
[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 40
ctrl = 0
velset = 0,0
anim = 220
sprpriority = 2


[State 210, 2]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA
animtype  = hard
damage    = 100,20
guardflag = MA
pausetime = 12,12
sparkno = 2
id = 210
sparkxy = -40,-280
hitsound   = S200,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
guard.velocity = -28             
guard.hittime = 18
guard.slidetime = 18
air.hittime = 26
ground.velocity = -22
air.velocity = -10,-16
forcenofall = 1
guard.kill = 0
guard.dist = 480
fall.recovertime = 30  

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 210,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 210, sfx]
type = playsnd
trigger1 = animelem = 4
value = 0,6
persistent = 0

[state 210, bitegrab]
type = changestate
triggerall = command != "holdfwd"
trigger1 = command = "y"
trigger1 = movecontact
trigger1 = time < 18
ignorehitpause = 1
value = 215

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Bite Grab standing
[statedef 215]
type = S
movetype = A
physics = S
anim = 225
ctrl = 0

[State 210, 2]
type = HitDef
trigger1 = var(9) > 0
Trigger1 = Time = 0
attr = S, ST  
chainid = 210        
hitflag = MA
guardflag = MA          
priority = 1, Miss    
sparkno = -1          
p2sprpriority = 2                           
p1facing = 1
p2facing = 1                         
p1stateno = 830
p2stateno = 840
guard.dist = 480   

[state 210, limiter]
trigger1 = time = 0
type = varadd
v = 9
value = -1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 215,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[state 215, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 20
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 2
value = 0, 9

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 25
guardflag = MA
pausetime = 8,8
sparkno = 0
sparkxy = -40,-148
hitsound   = S5000,1
guardsound = S120, 0
ground.type = Low
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -13
guard.velocity = -18              
guard.hittime = 14
guard.slidetime = 14
air.velocity = -10,-14
guard.dist = 480 
fall.recovertime = 30 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 230,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
juggle  = 5
poweradd= 60
ctrl = 0
anim = 240
sprpriority = 2

[state 240, velset]
type = velset
trigger1 = time = 0
trigger1 = prevstateno != 100
x = 0
y = 0

[State 240, 1]
type = PlaySnd
trigger1 = Time = 12
value = 240, 0

[State 240, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = back
damage    = 85
guardflag = MA
pausetime = 12,12
sparkno = 2
sparkxy = -40,-240
hitsound   = S5000,2
guardsound = S120, 0
ground.type = Low
ground.slidetime = 26
ground.hittime  = 26
air.hittime = 28
ground.velocity = ifelse(prevstateno = 100,-60,-30), ifelse(prevstateno = 100,-20,-15)
air.velocity = ifelse(prevstateno = 100,-60,-30), ifelse(prevstateno = 100,-20,-15)
airguard.velocity = -10, -1
guard.velocity = -28              
guard.hittime = 8
guard.slidetime = 8
fall = ifelse(prevstateno = 100 && var(7)< 1,0,1)
fall.recover = ifelse(prevstateno = 100, 0, 1)
guard.dist = 640 
fall.recovertime = 18 

[state x, wall bounce limiter]
type = varadd
trigger1 = prevstateno = 100
trigger1 = movehit
trigger1 = hitpausetime = 11
var(7) = -1
ignorehitpause =1 
persistent = 0

[state 240, wall bounce]
type = targetstate
trigger1 = prevstateno = 100
trigger1 = movehit
trigger1 = hitpausetime = 11
ignorehitpause = 1
value = 675


[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 240,  Not active]
trigger1 = animelemtime(7) = 0
type = statetypeset
movetype = I

[State 240, 3]
type = velAdd
trigger1 = AnimElem = 1
x = 45

[State 240, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light punch
; CNS difficulty: easy
; Description: Simple crouching attack. The HitDef's guardflag parameter
;     is set to "L", meaning that the move can only be guarded low
;     (crouching), and not by standing or jumping opponents.
;     Like for all light attacks, it's a good idea to keep the slidetime
;     and hittime parameters at a smaller number, so the opponent isn't
;     stunned for too long. For all crouching attacks you have to
;     remember to set the attr parameter to indicate that it is crouching
;     attack. In this case, "C, NA" stands for "crouching, normal attack".
;     The HitDef's priority is set at 3, instead of the default of 4,
;     so this attack has a lower priority than most others, meaning
;     KFM will get hit instead of trading hits with his opponent if
;     their attack collision boxes (Clsn1) intersect each other's Clsn2
;     boxes at the same time.
[Statedef 400]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 15
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 9

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 22
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = M
pausetime = 8,8
sparkno = 0
sparkxy = -40,-168
hitsound   = S5000,0
guardsound = S120, 0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -10
air.velocity = -6,-12
guard.velocity = -14              
guard.hittime = 14
guard.slidetime = 14
guard.dist = 480
fall.recovertime = 20 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 400,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I



[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching strong punch
; CNS difficulty: easy
; Description: This is a 2-hit move. It is done by having two HitDefs
;     triggered, one for each frame of animation that hits.
;     Notice how the first hit cannot be guarded by an opponent in the
;     air, because of the "M" in the guardflag, meaning it can only
;     be guarded "middle". The second hit has an "MA" guardflag, so
;     it can be guarded both on the ground and in the air.
[Statedef 410]
type    = C
movetype= A
physics = C
juggle  = 6
poweradd= 80
ctrl = 0
anim = 410
sprpriority = 2

[State 410, 1]
type = PlaySnd
trigger1 = Time = 7
value = 0, 9

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = AnimElem = 5 || animelem = 7
persistent = 0
attr = C, NA
damage    = 20
animtype  = up
hitflag = MAF
guardflag = M
id = 410
pausetime = 4,4
sparkno = 2
sparkxy = -40,-280
hitsound   = 0,5
guardsound = S120, 0
ground.type = high
ground.slidetime = 14
ground.hittime  = 18
ground.velocity = 4,-25
air.velocity = 4,-20
guard.velocity = -8             
guard.hittime = 16
guard.slidetime = 14
guard.dist = 480
fall.recover = 0
fall.recovertime = 60
fall.recovertime = 20 

;This is the second hit, triggered on the 4th element of animation.
[State 410, 3]
type = HitDef
trigger1 = AnimElem = 10
attr = C, NA
damage    = 80,8
animtype  = Medium
hitflag = MAF
guardflag = MA
priority = 6,hit
pausetime = 18,18
sparkno = 2
id = 411
sparkxy = -40,-520
hitsound   = S200,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 14
ground.hittime  = 24
air.hittime = 22
ground.velocity = -5,-10
air.velocity = -5,-10
guard.velocity = -18              
guard.hittime = 11
guard.slidetime = 11
guard.kill = 0
guard.dist = 480
fall.recovertime = 45 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = 3
persistent = 0
ignorehitpause = 1

[state 210, sfx]
type = playsnd
trigger1 = animelem = 10
value = 0,6
persistent = 0

[state 410, bitegrab]
type = changestate
trigger1 = command = "y"
trigger1 = movecontact
trigger1 = time <= 28 && time > 24
ignorehitpause = 1
value = 415

[state 240,  Not active]
trigger1 = animelemtime(11) = 0
type = statetypeset
movetype = I

[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Bite Grab standing
[statedef 415]
type = S
movetype = A
physics = S
anim = 415
ctrl = 0
poweradd = 20

[State 415, 2]
type = HitDef
trigger1 = var(9) > 0
Trigger1 = Time = 0
attr = S, ST          
hitflag = MAF
chainid = 411
guardflag = MA          
priority = 1, Miss    
sparkno = -1          
p2sprpriority = 2                           
p1facing = 1
p2facing = 1                         
p1stateno = 835
p2stateno = 845
guard.dist = 360   

[state 410, limiter]
trigger1 = time = 0
type = varadd
v = 9
value = -1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 415,  Not active]
trigger1 = animelemtime(2) = 0
type = statetypeset
movetype = I

[state 415, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 20
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 9

[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 24
animtype  = Light
hitflag = MAFD
guardflag = L
nochainid = 1400
pausetime = 8,8
sparkno = 0
sparkxy = -40,-32
hitsound   = S5000,1
guardsound = S120, 0
ground.type = Low
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -14
air.velocity = -8,-12
down.velocity = -20,0
down.hittime = 22
guard.velocity = -18              
guard.hittime = 13
guard.slidetime = 13
guard.dist = 480
fall.recovertime = 20 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 430,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = C
juggle  = 7
poweradd= 80
ctrl = 0
anim = 440
sprpriority = 2

[State 440, 2]
type = PlaySnd
trigger1 = Time =12
value = 240, 0

[state 210, width]
type = width
trigger1 = animelemtime(3) >= 0 && animelemtime(8) < 0
value = 100,0
ignorehitpause = 1

[state 410, spripriority]
type = sprpriority
trigger1 = animelemtime(6) = 0
value = -2

[State 440, 3]
type = HitDef
trigger1 = animelem = 4 || animelem = 5
trigger1 = !movecontact
attr = C, NA
damage    = ifelse(enemy,statetype = L, 45,ifelse(enemy,statetype = A, 40, 80))
hitflag = MAFD
guardflag = L
pausetime = 12,12
sparkno = 2
sparkxy = -20,-40
nochainid = 1400
hitsound   = S5000,2
guardsound = S120, 0
ground.type = Trip
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -5,-15
air.velocity = -5,-15
down.velocity = -2,0
guard.velocity = -26              
guard.hittime = 8
guard.slidetime = 8
fall = 1
fall.recover = 0
guard.dist = 720
fall.recovertime = 40 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 240,  Not active]
trigger1 = animelemtime(6) = 0
type = statetypeset
movetype = I

[State 440, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
juggle  = 2
poweradd= 15
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 3
value = 0, 9

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 15
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 0
sparkxy = -40,-232
hitsound   = S5000,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -12
air.velocity = -10,-8
air.hittime = 16
guard.velocity = -14            
guard.hittime = 10
guard.slidetime = 10
airguard.velocity = -12,-4
airguard.hittime = 13
guard.dist = 640
fall.recovertime = 20 


[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 600,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[State 600, 3]
type = changestate
trigger1 = animtime = 0
value = 50

;---------------------------------------------------------------------------
;Jumping Bite

[Statedef 610]
type    = A
movetype= A
physics = A
juggle  = 2
poweradd= 80
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[state 610, jump combo infinite check]
type = varadd
trigger1 = movehit = 1
trigger1 = enemy,statetype != A
v = 39
value = 1
ignorehitpause = 1
persistent = 0

[State 610, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, NA
damage    = 80,16
guardflag = HA
priority = 3
pausetime = 18,18
envshake.ampl = 6
envshake.time = 18
sparkno = 2
id = 610
sparkxy = -80,-250
hitsound   = S200,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 24
ground.hittime  = floor(24/var(39))
ground.velocity = -8
air.velocity = -8,-10
air.hittime = 26
guard.velocity = -10            
guard.hittime = 17
guard.slidetime = 17
airguard.velocity = -8,-6
airguard.hittime = 19
guard.kill = 0
guard.dist = 640
fall.recovertime = 30 

[state 610, latch on option]
type = changestate
trigger1 = movecontact
trigger1 = animelemtime(4) >= 0 && animelemtime(6) < 0
trigger1 = command = "y"
value = 615
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 430,  Not active]
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 210, sfx]
type = playsnd
trigger1 = animelem = 4
value = 0,6
persistent = 0

[State 610, 3]
type = changestate
trigger1 = animtime = 0
value = 50

;---------------------------------------------------------------------------
;Bite Grab Jumping
[statedef 615]
type = A
movetype = A
physics = A
anim = 615
ctrl = 0

[State 615, 2]
type = HitDef
Trigger1 = Time = 0
attr = S, ST  
chainid = 610        
hitflag = AF
guardflag = MA          
priority = 1, Miss    
sparkno = -1          
p2sprpriority = 2                           
p1facing = 1
p2facing = 1                         
p1stateno = 620
p2stateno = 625
guard.dist = 480   

[state 615,  Not active]
trigger1 = animelemtime(3) = 0
type = statetypeset
movetype = I

[state 615, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1


;---------------------------------------------------------------------------
;Deathroll
[statedef 620]
type = A
movetype = A
physics = N
anim = 620
velset = 0,0
sprpriority = 3

[state 620, gravity]
type = gravity
trigger1 = animelemtime(3) >= 0

[state 620, veladd]
type = veladd
trigger1 = animelemtime(2) = 0
x = ifelse(frontedgebodydist < 320, -12,2)
y = -16


;=============================
;Positioning
;=============================
[state 620, bind 1]
type = targetbind
trigger1 = animelem = 1
pos = 374, -288
persistent = 1

[state 620, bind 2]
type = targetbind
trigger1 = animelem = 2
pos = 372, -314
persistent = 1

[state 620, bind 3]
type = targetbind
trigger1 = animelem = 3
pos = 360, -234
persistent = 1

[state 620, bind 4]
type = targetbind
trigger1 = animelem = 4
pos = 386, -216
persistent = 1

[state 620, bind 5]
type = targetbind
trigger1 = animelem = 5
pos = 356, -238
persistent = 1

[state 620, bind 6]
type = targetbind
trigger1 = animelem = 6
pos = 378, -222
persistent = 1

;================================
;  Damage
;================================
[state 620, damage]
type = targetlifeadd
trigger1 = animelemtime(3) > 0
value = floor(fvar(10)*-2)
persistent = 4
kill = 0

;------------------------------------
[state 620, playsnd]
type = playsnd
trigger1 = animelemtime(2) = 8
value = S1200,0






[state 620, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -40
value = 621


;---------------------------------------------------------------------------
;Landing
[statedef 621]
type = S
movetype = A
physics = N
anim = 1203

[state x, combo damage score]
type = varadd
trigger1 = time = 0
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 621, posset]
trigger1 = time = 0
type = posset
y = 0



[state 621, snd]
type = playsnd
trigger1 = time = 0
value = S0,10


[state 621, posset]
trigger1 = time = 0
type = velset
y = 0
x = 0

[state 621, quake]
type = envshake
trigger1 = time = 0
persistent = 0
time = 30
ampl = 20

[State 621, slam]
type = TargetBind
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(1) < 8
pos = 270, -45

[State 621, Hurt 11]
type = TargetLifeAdd
trigger1 = time = 0
value = floor(fvar(10)*-20)

[state 621, hurt 11]
type = targetpoweradd
trigger1 = time = 0
value = 200

[state 621, bounce limiter]
type = varadd
trigger1 = animelemtime(1) = 9
v = 8
value = -1
persistent = 0

[state 621,targetstate]
type = targetstate
trigger1 = animelemtime(1) = 9
value = ifelse(var(8) > 0, 1226, 1216)

[state 621, change anim]
type = changestate
trigger1 = animtime = 0
value = 622

;--------------------------------------------------------------------------
; Jump back
[statedef 622]
type = A
movetype = I
physics = N
anim = 45 

[state 622, velset]
type = velset
trigger1 = time = 0
x = -8
y = -12

[state 622, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[state 622, gravity]
type = gravity
trigger1 = time > 2

[state 622, landing]
type = changestate
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;victim thrown
;--------------------------------------------------------------------------
[statedef 625]
type = A
movetype = H
physics = N

[state 1205, thrown animation]
type = changeanim2
trigger1 = time = 0 
value = 625



;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = A
juggle  = 3
poweradd= 15
ctrl = 0
anim = 630
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 2
value = 0, 9

[State 630, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 25
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 0
sparkxy = -20,-280
hitsound   = S5000,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 22
ground.hittime  = 22
ground.velocity = -10
air.velocity = -10,-14
air.hittime = 26
guard.velocity = -12            
guard.hittime = 11
guard.slidetime = 11
airguard.velocity = -10,-6
airguard.hittime = 12
guard.dist = 640
fall.recovertime = 20 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 630,  Not active]
trigger1 = animelemtime(4) = 0
type = statetypeset
movetype = I

[State 630, 3]
type = changestate
trigger1 = animtime = 0
value = 50

;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
juggle  = 4
poweradd= 60
ctrl = 0
sprpriority = 2

[state 640, anim]
type = changeanim
trigger1 = time = 0
value = 640
persistent = 0

[state 640, anim]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 640, jump combo infinite check]
type = varadd
trigger1 = movehit = 1
trigger1 = enemy,statetype != A
v = 39
value = 1
ignorehitpause = 1
persistent = 0

[State 600, 1]
type = PlaySnd
trigger1 = Time = 3
value = 0, 91

[State 640, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 80
guardflag = HA
priority = 4
pausetime = 12,12
sparkno = 2
sparkxy = -40,-270
hitsound   = 5,4
guardsound = S120, 0
animtype = Med
ground.type = High
ground.slidetime = 28
ground.hittime  = floor(28/var(39))
ground.velocity = -20
air.velocity = -26,-8
fall = 0
fall.recover = 0
air.fall = 1
guard.velocity = -22            
guard.hittime = 16
guard.slidetime = 16
airguard.velocity = -20,-4
airguard.hittime = 24
guard.dist = 720
fall.recovertime = 40 

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 640,  Not active]
trigger1 = animelemtime(6) = 0
type = statetypeset
movetype = I

;---------------------------------------------------------------------------



;===========================================================================
;---------------------------Crushed State-----------------------------------
;===========================================================================
; Moderate Crushed State
[statedef 660]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.1,0.4

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 660, invunerable]
type = nothitby
trigger1 = 1
value = SCA


[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 660, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 660, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
triggerall = life >= 1
trigger1 = time > 60 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150

;--------------------------------------------------------------------------
;dogpile Crush state
; Moderate Crushed State
[statedef 661]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.1,0.75

[state 661, invunerable]
type = nothitby
trigger1 = time < 4
value = SCA

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 660, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 660, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 660, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
triggerall = life >= 1
trigger1 = time > 80 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150



;---------------------------------------------------------------------------
;Gustine 
; Super Crushed State
[statedef 662]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 662, 1]
type = changeanim
trigger1 = time = 0
value = 5080

[State 662, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.1,0.4

[state 662, on ground]
type = posset
trigger1 = 1
y = 0

[state 662, passthrough]
type = playerpush
trigger1 = 1
value = 0


[State 662, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 662, invunerable]
type = nothitby
trigger1 = 1
value = SCA


[State 662, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 660, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 660, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 660, get up]
type = selfstate
triggerall = life >= 1
trigger1 = time > 210 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150




;---------------------------------------------------------------------------
;===========================================================================
;------------------------------Wall Bounce State
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[state 670, anim]
type = changeanim
trigger1 = 1
value = 5030
ignorehitpause = 1

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

;[State 670, Velocity]
;type = HitVelSet
;trigger1 = Time = 0
;x = 1
;y = 1

[state 670, anim]
type = changeanim
trigger1 = time = 0
value = 5030

[State 670, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[state 671, replacement gravity]
type = veladd
trigger1 = 1
y = 1.05
;[State 670, Gravity]
;type = gravity
;trigger1 = 1

[State 670, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 25
trigger2 = FrontEdgeBodyDist < 25
value = 1
movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3

[State 671, Anim]
type = ChangeAnim
trigger1 = Time = 0
value = 5030

[State 671, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 671, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 672, 1]
type = NotHitBy
trigger1 = 1
value = , NP

[State 672, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -25

[State 672, Vel X]
type = VelSet
trigger1 = Time = 0
x = ceil(abs(p2dist x*0.02))

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

[State 672, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 672, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 672, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 672, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 672, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100


;------------------------------------------------------------
;Wall Splat version
[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 675]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 675, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[state 676, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 676, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 676, Gravity]
type = veladd
trigger1 = 1
y = 1.05

;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 676, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = back
sprpriority = 3
ownpal = 1

[state 677, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -14

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 4

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 678, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

;[state 678, gravity]
;type = gravity
;trigger1 = 1

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 678, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100




;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
poweradd = 50
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

[State 800, 1]
type = HitDef
triggerall = p2movetype != A
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-          
priority = 1, Miss    
sparkno = -1         
p1sprpriority = 1             
p1facing = 1
p2facing = 1 
id = 800		         
p1stateno = 810       
p2stateno = 820       
guard.dist = 0   

[State 800, 1]
type = HitDef
triggerall = p2movetype = A
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-          
priority = 1, Miss    
sparkno = -1         
p1sprpriority = 1             
p1facing = 1
p2facing = 1 
id = 800		         
p1stateno = 810       
p2stateno = 824       
guard.dist = 0      
	            
[state 800, throw-moonsault damage check]
type = varset
trigger1 = time = 0
var(16) = 1

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape p2
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
sprpriority = 4

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -32

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1
;--------------------------------------------------------------------------
;Grab Escape - p1
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 130

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 130

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -32

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 0

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 805
value = 806
persistent = 1

[State 810, Holding Direction?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdback"

[state 810, width]
type = width
trigger1 = 1
value = 120,50

[State 810, turn target] 
type = TargetFacing
trigger1 = AnimElem = 1
value = 0

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 11
value = 800, 0

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 180, 0

;[State 810, Width 2-11]
;type = Width
;trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(12) < 0
;edge = 130,0

[State 810, Bind 2-4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(5) < 0
pos = 170, 0

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = 170, 0

;[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
;type = Turn
;trigger1 = var(2)
;trigger1 = AnimElem = 6

;[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
;type = PosAdd
;trigger1 = var(2)
;trigger1 = AnimElem = 6
;x = -148

;[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
;type = TargetFacing
;trigger1 = var(2)
;trigger1 = AnimElem = 6
;value = -1

[State 810, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = 220, -200

[State 810, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = 170, -300

[State 810, Bind 8]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = 20, -490


[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 8

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElemtime(8) = 6
x = -37

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 8
value = -1

[State 810, Bind 9]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
pos = 0, -470

[State 810, Bind 10]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
pos = 160, -325

[State 810, Bind 11]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(11) < 3
pos = 220, -50

[state 810, jump]
type = velset
trigger1 = time = 54
x = 2
y = -20

[state 810, gravit]
type = gravity
trigger1 = time > 55



;[State 810, Bind 11]
;type = TargetBind
;trigger1 = AnimElem = 11
;pos = -200, -200

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 10
value = -130

[State 810, Throw 11]
type = TargetState
trigger1 = Animelemtime(11) = 6
value = 821

[state 810, playerpush]
type = playerpush
trigger1 = 1
value = 0


;[State 810, Turn 12]
;type = Turn
;trigger1 = AnimElem = 12

;[State 810, Pos 15]
;type = PosAdd
;trigger1 = AnimElem = 15
;x = -40

[state 810, combo damage]
type = varadd
trigger1 = time = 0
v = 18
value = -21

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 811
ctrl = 1

;--------------------------------------------------------------------------
;jumping recovery
[statedef 811]
type = A
movetype = I
physics = A

[state 811, invun]
type = nothitby
trigger1 = 1
value = SCA

[state x, combo dampener]
type = varadd
trigger1 = time = 45
v = 18
value = -18
persistent = 0
ignorehitpause =1

[state 811,anim]
type = changeanim
trigger1 = time = 0
value = 46

;---------------------------------------------------------------------------
; Techable Scoop Slam
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0

[state 810, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 805

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------

; UnTechable Scoop Slam
[Statedef 824]
type    = A
movetype= H
physics = N
velset = 0,0

[state 810, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[statedef 821]
type = A
movetype = H
physics = N
poweradd = 40

[state 821, vel]
type = velset
trigger1 = time = 0
y = 30
x = -24

[state 821, anim]
type = changeanim2
trigger1 = time = 0
value = 822

[State 821, 4] ;Hit ground
type = changeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 822



;------------------------------------------------------------------------------
;Hit Ground
[Statedef 822]
type    = L
movetype= H
physics = N

[State 822, 1] ;Gravity
type = gravity
Trigger1 = time > 2

[state 821, 0]
type = turn
trigger1 = time = 0

[state 822, on ground]
type = posset
trigger1 = time = 0
y = 0
persistent = 0 

[state 822, no down force]
type = velset
trigger1 = time = 0
y = 0

[State 822, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.25

[state 822, snd]
type = playsnd
trigger1 = time = 0
value = F7,2

[state 822, thud]
type = envshake
trigger1 = 0
time = 20     
ampl = 10     
persistent = 0

[State 822, 8]
type = Explod
trigger1 = Time = 1
anim = F62 
postype = p1
pos = 0, 0
scale = 2,1
ontop = 1
ignorehitpause = 1
ownpal = 1

[state 822, bounce]
type = velset
trigger1 = time = 2
y = -20

[State 822, 1] ;Gravity
type = gravity
Trigger1 = time > 2

[state 822, change anim]
type = changeanim
trigger1 = time = 0
value = 5170

[State 822, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.25

[State 822, 4] ;Hit ground
type = selfState
trigger1 = time > 5
;trigger1 = vel y > 0
;trigger1 = pos y > -vel y
value = 5100 ;Hit ground
;---------------------------------------------------------------------------
;land stay
[Statedef 823]
type    = L
movetype= H
physics = C

[state 823, on ground]
type = posset
trigger1 = time = 0
y = 0
persistent = 0 

[state 823, velset]
type = velset
trigger1 = time = 0
y = 0
persistent = 0

[state 822, snd]
type = playsnd
trigger1 = time = 0
value = F7,2

[state 822, thud]
type = envshake
trigger1 = 0
time = 20     
ampl = 10     
persistent = 0

[state 822, anim]
type = changeanim
trigger1 = time = 0
value = 5110

[State 822, 4] ;Hit ground
type = SelfState
trigger1 = time > 15
value = 5100 


;===========================================================================
;  Bite Grab
;===========================================================================
; Gameplay mechanic where Katrina's bites lead to grabs so she can do
; wall bounces, ground bounces and launches in the form of a grab.
[Statedef 830]
type    = S
movetype= A
physics = N
anim = 830
poweradd = 40
sprpriority = -2


[State 830, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 100, -165

[State 830, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = -45, -165

[State 830, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = -60, -165

[State 830, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -150, -195

[State 830, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -175, -180

[State 830, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = 20, -200

[State 830, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = 70, -330


[State 830, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = floor(fvar(10)*-10)

[State 830, Throw 11]
type = TargetState
trigger1 = Animelemtime(7) = 6
value = 841

[state 830, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 830, combo damage]
type = varadd
trigger1 = time = 0
v = 18
value = -9

[state 830, super jump out]
type = changestate
triggerall = time > 44
trigger1 = command = "holdup"
trigger2 = ailevel > 0
value = 42

[State 830, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
[Statedef 835]
type    = S
movetype= A
physics = N
anim = 835
poweradd = 40
sprpriority = -2


[State 830, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(2) < 0
pos = 65, -500

[State 830, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 100, -165

[State 830, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = -45, -165

[State 830, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -60, -165

[State 830, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -150, -195

[State 830, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = -175, -180

[State 830, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = 20, -200

[State 830, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = 70, -330


[State 830, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 6
value = floor(fvar(10)*-10)

[State 830, Throw 11]
type = TargetState
trigger1 = Animelemtime(8) = 6
value = 841

[state 830, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 830, combo damage]
type = varadd
trigger1 = time = 0
v = 18
value = -9

[state 830, super jump out]
type = changestate
triggerall = time > 48
trigger1 = command = "holdup"
trigger2 = ailevel > 0
value = 42


[State 830, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
;Victim Biten & Thrown
[statedef 840]
type    = A
movetype= H
physics = N
velset = 0,0

[state 840, anim]
type = changeanim2
trigger1 = time = 0
value = 840


[State 840, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050


;---------------------------------------------------------------------------
;Victime Thrown
[statedef 841]
type = A
movetype = H
physics = N




[state 841, vel]
type = velset
trigger1 = time = 0
x = -8
y = -40

[state 841, gravity]
type = veladd
trigger1 = time > 1
y = 1.75

[state 841, anim]
type = changeanim2
trigger1 = time = 0
value = 5051

[state 841, end]
type = selfstate
trigger1 = time > 3
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100


;---------------------------------------------------------------------------
;Crouch Victim Biten & Thrown
[statedef 845]
type    = A
movetype= H
physics = N
velset = 0,0

[state 845, anim]
type = changeanim2
trigger1 = time = 0
value = 841


[State 840, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050


;---------------------------------------------------------------------------
;Victime Thrown
[statedef 846]
type = A
movetype = H
physics = N
ctrl = 1



[state 846, vel]
type = velset
trigger1 = time = 0
x = -8
y = -30

[state 846, gravity]
type = veladd
trigger1 = time > 1
y = 1.75

[state 846, anim]
type = changeanim2
trigger1 = time = 0
value = 5051

[state 846, end]
type = selfstate
trigger1 = time > 3
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100


;---------------------------------------------------------------------------
;Breast Upper Light
[Statedef 1000]
Type = A
movetype = A
physics = N
ctrl = 0
anim = 1000
poweradd = 70
velset = 0,0

[state 1000, charge used]
type = varset
trigger1 = time = 0
var(43) = 0

[state 1000, 1]
type = nothitby
trigger1 = animelemtime(5) <= 4
trigger1 = !movehit
value = A

[state 1000, 1]
type = nothitby
trigger1 = movehit
value = SCA

[State 1000, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
animtype  = Up
damage    = 130,ifelse(enemy,statetype = A,39,13)
getpower = 30
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,8
priority = 6,hit
sparkno = 3
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = -14,-28
air.velocity = -14,-24
fall = 1
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -18,-16
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480

[state 1000, end]
type = changestate
trigger1 = vel y > 0
value = 1001

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1000, up]
type = velset
trigger1 = animelem = 5
y = -30
x = 2
persistent = 0

[state 1000, gravity]
type = gravity
trigger1 = pos y < -1

;---------------------------------------------------------------------------
;upper Recovery
[statedef 1001]
Type = A
movetype = I
physics = N
ctrl = 0
anim = 1001

[state 1001, gravity]
type = gravity
trigger1 = 1

[state 1001, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1002

;----------------------------------------------------------------------------
;Landing
[statedef 1002]
type = S
movetype = I
physics = S
anim = 1002

[State 1002, 4]
type = EnvShake
trigger1 = time = 0
time = 12
ampl = -10

[state 1002, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = 200,0
scale = 1.5, 1.5
sprpriority = 2

[state 1002, playsnd]
type = playsnd
trigger1 = time = 0
value = S0,7


[state 1002, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1002, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1002, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Breast Upper Heavy
[Statedef 1010]
Type = A
movetype = A
physics = N
ctrl = 0
anim = 1010
poweradd = 90
velset = 0,0

[state X, charge used]
type = varset
trigger1 = time = 0
var(43) = 0

[state 1010, 1]
type = nothitby
trigger1 = animelemtime(5) <= 4
TRIGGER1 = !movehit
value = A

[state 1010, 1]
type = nothitby
trigger1 = movehit
value = SCA

[State 1010, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
animtype  = Up
damage    = 160,ifelse(enemy,statetype = A,48,16)
getpower = 35
guardflag = MA
pausetime = 14,14
pausetime = 8,8
priority = 6,hit
sparkno = 3
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 24
air.hittime = 24
ground.velocity = -18,-38
air.velocity = -18,-33
fall = 1
fall.recover = 0
guard.velocity = -14          
guard.hittime = 16
guard.slidetime = 16
airguard.velocity = -18,-16
airguard.hittime = 20
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480

[state 1010, end]
type = changestate
trigger1 = vel y > 0
value = 1011

[state 1010, up]
type = velset
trigger1 = animelem = 5
y = -45
x = 5
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1010, gravity]
type = gravity
trigger1 = pos y < -1

;---------------------------------------------------------------------------
;upper Recovery
[statedef 1011]
Type = A
movetype = I
physics = N
ctrl = 0
anim = 1001

[state 1011, gravity]
type = gravity
trigger1 = 1

[state 1011, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1012

;----------------------------------------------------------------------------
;Landing
[statedef 1012]
type = S
movetype = I
physics = S
anim = 1012

[State 1002, 4]
type = EnvShake
trigger1 = time = 0
time = 12
ampl = -10

[state 1002, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = 200,0
scale = 1.5, 1.5
sprpriority = 2

[state 1002, playsnd]
type = playsnd
trigger1 = time = 0
value = S0,7

[state 1002, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1012, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1012, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Breast Upper EX
[Statedef 1020]
Type = A
movetype = A
physics = N
ctrl = 0
anim = 1020
velset = 0,0
poweradd = -500

[state X, charge used]
type = varset
trigger1 = time = 0
var(43) = 0

[state 1020, 1]
type = nothitby
trigger1 = 1
value = SCA

[State 1020, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[State 1020, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
animtype  = Up
damage    = 150,ifelse(enemy,statetype = A,45,15)
getpower = 0
guardflag = MA
pausetime = 14,14
priority = 6,hit
sparkno = 3
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 24
air.hittime = 24
ground.velocity = -18,-46
air.velocity = -18,-43
fall = 1
fall.recover = 0
guard.velocity = -16         
guard.hittime = 24
guard.slidetime = 24
airguard.velocity = -18,-16
airguard.hittime = 30
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480

[state 1020, end]
type = changestate
trigger1 = vel y > 0
value = 1021

[state 1020, up]
type = velset
trigger1 = animelem = 3
y = -55
x = 6
persistent = 0

[state 1020, combo damage]
type = varadd
trigger1 = movehit
v = 18
value = -9
ignorehitpause = 1
persistent = 0

[state 1020, gravity]
type = gravity
trigger1 = pos y < -1

;---------------------------------------------------------------------------
;upper Recovery
[statedef 1021]
Type = A
movetype = I
physics = N
ctrl = 0
anim = 1001

[state 1021, gravity]
type = gravity
trigger1 = 1

[state 1021, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1022

;----------------------------------------------------------------------------
;Landing
[statedef 1022]
type = S
movetype = I
physics = S
anim = 1002

[State 1002, 4]
type = EnvShake
trigger1 = time = 0
time = 12
ampl = -10

[state 1002, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = 200,0
scale = 1.5, 1.5
sprpriority = 2

[state 1002, playsnd]
type = playsnd
trigger1 = time = 0
value = S0,7

[state 1022, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1022, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1022, end]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Breast Dash
;---------------------------------------------------------------------------

;Bust Rush Light
[Statedef 1050]
Type = S
movetype = A
physics = N
ctrl = 0
poweradd = 50
velset = 0,0

[state X, charge used]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1050, anim]
type = changeanim
trigger1 = time = 0
value = 1050
persistent = 0

[State 1050, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = S, SA
animtype  = HEAVY
damage    = 120,12
getpower = 20
guardflag = MA
pausetime = 14,14
guard.pausetime = 8,8
priority = 5,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 40
ground.hittime  = 26
air.hittime = 26
ground.velocity = -60,0
air.velocity = -27,-10
ground.cornerpush.veloff = -30
guard.velocity = -40       
guard.hittime = 15
guard.slidetime = 15
airguard.velocity = -27,-4
airguard.hittime = 30
envshake.freq = 60
envshake.ampl = 6
envshake.time = 12
guard.dist = 480

[state 1050, Forward]
type = velset
trigger1 = anim = 1050
trigger1 = animelem = 2
x = 45

[state 1050, change animation]
type = changeanim
trigger1 = time > 10
trigger2 = p2bodydist x < 100
value = 1051
persistent = 0

[state 1050, no normal grabs]
type = nothitby
trigger1 = 1
value = ,NT

[state 1050, side]
type = velmul
trigger1 = anim = 1051
trigger1 = animelem = 2
x = 0.25

[state 1050, counter]
type = varadd
trigger1 = movehit
var(9) = -1
persistent = 0
ignorehitpause = 0

[state 1050, stop]
type = velset
trigger1 = anim = 1051
trigger1 = animelem = 3
x = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1050,  Not active]
trigger1 = anim = 1051
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 1050, end]
type = changestate
trigger1 = anim = 1051
trigger1 = animtime = 0
ctrl = 1
value = 0

;--------------------------------------------------------------------------

;Bust Rush Heavy
[Statedef 1060]
Type = S
movetype = A
physics = N
ctrl = 0
poweradd = 70
velset = 0,0

[state X, charge used]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1060, anim]
type = changeanim
trigger1 = time = 0
value = 1060
persistent = 0

[State 1060, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = S, SA
animtype  = HEAVY
damage    = 140,14
getpower = 20
guardflag = MA
pausetime = 14,14
guard.pausetime = 8,8
priority = 7,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 40
ground.hittime  = 30
air.hittime = 34
ground.velocity = -60,0
air.velocity = -28,-10
fall = ifelse (var(9) <= 0, 1,0)
fall.recover = 0
ground.cornerpush.veloff = -20
guard.velocity = -30       
guard.hittime = 14
guard.slidetime = 14
airguard.velocity = -28,-4
airguard.hittime = 30
envshake.freq = 60
envshake.ampl = 6
envshake.time = 12
guard.dist = 640

[state 1060, counter]
type = varadd
trigger1 = movehit
var(9) = -1
persistent = 0
ignorehitpause = 1

[state 1060, forward]
type = velset
triggerall = anim = 1060
trigger1 = animelem = 2
x = 45

[state 1060, stop]
type = velset
trigger1 = anim = 1061
trigger1 = animelem = 3
x = 0

[state 1060, change animation]
type = changeanim
trigger1 = time > 30
trigger2 = p2bodydist x < 100
value = 1061
persistent = 0

[state 1050, no normal grabs]
type = nothitby
trigger1 = 1
value = ,NT

[state 1060, side]
type = velmul
triggerall = anim = 1061
trigger1 = animelem = 1
x = 0.25

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1050,  Not active]
trigger1 = anim = 1061
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 1050, end]
type = changestate
trigger1 = anim = 1061
trigger1 = animtime = 0
ctrl = 1
value = 0

;---------------------------------------------------------------------------
;Bust Rush EX - Rush portion - Armored
[Statedef 1070]
Type = S
movetype = A
physics = N
ctrl = 0
velset = 0,0
;===============================
;armor
;===============================

[state X, charge used]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1070, anim]
type = changeanim
trigger1 = anim != 1070
value = 1070

;one hit of armor
[state 1070, armor counter start]
type = varset
trigger1 = time = 0
trigger1 = Var(21) = 1
V = 20
value = 1

[state 1070, meter]
type = poweradd
trigger1 = time = 0
trigger1 = var(21) = 1
value = -500

[state 1070, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 1070, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = -gethitvar(damage)
persistent = 1

[state 1070, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

;determine what frame
[state 1070, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1070, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 1070, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 1070, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.8)
persistent = 1

[state 1070, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1070
time = 1
persistent = 1

[State 1070, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1123, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1050, no normal grabs]
type = nothitby
trigger1 = 1
value = ,NT

[state 1070, forward]
type = velset
trigger1 = animelem = 2
x = 50

[state 1070, change state]
type = changestate
trigger1 = time > 18
trigger2 = p2bodydist x < 100
value = 1071
persistent = 0



;---------------------------------------------------------------------------
; EX bust rush - Hit portion - Armored
[Statedef 1071]
Type = S
movetype = A
physics = N
ctrl = 0

[state 1071, wallbounce limiter]
type = varadd
trigger1 = movehit
var(7) = -1
persistent = 0
ignorehitpause = 1

;============
;armor
;============

[state 1070, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = -gethitvar(damage)
persistent = 1

[state 1070, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

[state 1070, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1071
time = 1
persistent = 1

[State 1070, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1070, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1071, anim]
type = changeanim
trigger1 = anim != 1071
value = 1071

[state 1071, armor done]
type = varset
trigger1 = animelem = 5
v = 20
value = 0

[State 1071, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = S, SA
animtype  = HEAVY
damage    = 120,12
getpower = 0
guardflag = MA
pausetime = 12,12
priority = 7,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
air.hittime = 32
ground.velocity = -70,ifelse(var(7) > 1,-24, -8)
air.velocity = -70,ifelse(var(7)>1,-20,-4)
fall = 1
fall.recover = 0
ground.cornerpush.veloff = -20
guard.velocity = -65      
guard.hittime = 26
guard.slidetime = 26
airguard.velocity = -30,-4
airguard.hittime = 23
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 640

[state 1071, side]
type = velmul
triggerall = anim = 1071
trigger1 = animelem = 2
x = 0.25

[state 1071, wallbounce]
type = targetstate
trigger1 = movehit && hitpausetime = 11
trigger1 = var(7) > 0
value = 670
ignorehitpause = 1

[state 1071, stop]
type = velset
trigger1 = anim = 1071
trigger1 = animelem = 3
x = 0

[state 1070, combo damage]
type = varadd
trigger1 = movehit
v = 18
value = -9
ignorehitpause = 1
persistent = 0

[state 1071,  Not active]
trigger1 = anim = 1071
trigger1 = animelemtime(5) = 0
type = statetypeset
movetype = I

[state 1071, end]
type = changestate
trigger1 = anim = 1071
trigger1 = animtime = 0
ctrl = 1
value = 0

;===========================================================================
;  Moonsault
;===========================================================================

;Jump Moonsault Light
; CNS difficulty: easy
[Statedef 1100]
type    = U
movetype= A
physics = U
juggle  = 4
poweradd= 125
ctrl = 0
sprpriority = 2

[state 1100, anim]
type = changeanim
trigger1 = anim != 1100
value = 1100

;---
;Damage
;---

; Peak Super Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y < -800
trigger1 = time = 0 
var(14) = 180

; Super Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -800 && pos y < -422
trigger1 = time = 0
var(14) = 160

; Peak Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -422 && pos y < -390
trigger1 = time = 0 
var(14) = 140

;Normal Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -390 
trigger1 = time = 0
var(14) = 120



[state 50, steering]
type = veladd
triggerall = ailevel = 0
trigger1 = command = "holdfwd"
trigger1 = vel x < 20
x = 0.5

[state 50, steering]
type = veladd
triggerall = ailevel > 0
trigger1 = p2bodydist x > 0
trigger1 = vel x < 20
x = 0.5

[state 50, steering]
type = veladd
triggerall = ailevel = 0
trigger1 = command = "holdback"
trigger1 = vel x > -10
x = -0.5

[state 50, steering]
type = veladd
triggerall = ailevel > 0
trigger1 = p2bodydist x < 0
trigger1 = vel x > -10
x = -0.5

[State 1100, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 0

[state 1100, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1100, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1100, gravity]
type = gravity
trigger1 = 1

;[state 1100, velset]
;type = veladd
;trigger1 = time = 0
;trigger1 = vel Y <= 0
;y = -12
;persistent = 0

;[state 1100, velset]
;type = velset
;trigger1 = time = 0
;trigger1 = vel Y > 0
;y = -12
;persistent = 0

[state 1100, velset]
type = velset
trigger1 = time = 0
trigger1 = statetype = A
x = 11
y = -20

[state 1100, velset]
type = velset
trigger1 = time = 0
trigger1 = statetype != A
x = 10
y = -40

[state 1100, statetypeset]
type = statetypeset
trigger1 = time = 1
statetype = A
physics = N


[State 1100, 3]
type = HitDef
trigger1 = vel y > 0
persistent = 0
attr = A, SA
damage = ifelse(enemy,movetype = H,120,var(14)),floor(var(14)*0.3)
hitflag = MAF
guardflag = HA
priority = 4
pausetime = 2,2
guard.pausetime = 10,10
sparkno = -1
sparkxy = -20,-180
hitsound   = 5,4
guardsound = S120, 0
animtype = Med
id = 1100
ground.type = High
ground.slidetime = 35
ground.hittime  = 14
ground.velocity = 0,15
air.velocity = 0,0
guard.velocity = -100        
guard.hittime = 40
guard.slidetime = 50
airguard.velocity = -30,8
airguard.hittime = 40
guard.dist = 480

;Ride down mechanic
[state 1100, Ride down]
type = targetbind
triggerall = numtarget(1100)
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = -20, 60

[state 1100, state of ride down]
type = targetstate
triggerall = numtarget(1100)
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1105

[state 1100, end]
type = targetstate
triggerall = numtarget(1100)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1105
value = 660
;-----------------------------

[state 1100, squash]
type = targetstate
triggerall = numtarget(1100)
trigger1 = enemy,statetype != A
trigger1 = movehit
value = 660

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1100, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1101

;---------------------------------------------------------------------------
;Moonsault Landing
[Statedef 1101]
type    = A
movetype= A
physics = N
anim = 1101
sprpriority = 2

[state 1101, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1101, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[State 1101, 3]
type = HitDef
trigger1 = animelem = 1
attr = C, SA
getpower = 200
persistent = 0
HitFlag = FD
hitsound = S1100,0
damage    = ifelse(enemynear,stateno = 661,floor(var(14)*0.75),var(14))
guardflag = HA
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = S120, 0
p2stateno = 660
animtype = Heavy
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
fall.recover = 0

[state 1101, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 1101, x slow]
type = velmul
trigger1 = time = 0
x = 0.1

[state 1070,wall bounce counter]
type = varadd
trigger1 = movehit
var(9) = -1
persistent = 0
ignorehitpause = 0

[state 52, super jump landing]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 40,0
scale = const(size.xscale)*2.5,const(size.yscale)*2
sprpriority = 4
ownpal = 1

[state 52, super jump landing]
type = explod
trigger1 = time = 0
anim = 2001
postype = p1
pos = 40,0
scale = const(size.xscale)*2.5,const(size.yscale)*2
sprpriority = -4
ownpal = 1

[state 1101, snd]
type = playsnd
trigger1 = time = 0
value = 0, 10

[State 1101, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 15

[state 1101, 3]
type = ChangeState
trigger1 = animtime = 0
value = 1102


;---------------------------------------------------------------------------
;bounce
[Statedef 1102]
type    = A
movetype= I
physics = N
anim = 1102
velset = 0,0




[state 1102, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1102, bounce]
type = velset
trigger1 = time = 0
y = -9

[state 1102, gravity]
type = gravity
trigger1 = time > 1


[state 1102, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1103

;---------------------------------------------------------------------------
[Statedef 1103]
type    = C
movetype= I
physics = C
anim = 1103

[state 1113, nothitby]
type = nothitby
trigger1 = time < 12
value = ,AP

[state 1103, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1103, velset]
type = velset
trigger1 = 1
x = 0
y = 0


[state 1103, end]
type = changestate
trigger1 = time >= 8
value = 1104



;--------------------------------------------------------------------------
;Jump off
[statedef 1104]
type = A
movetype = I
physics = N
ctrl = 0
anim = 44
velset = 0,0

;[state 1104, turn]
;type = turn
;triggerall = time = 0
;trigger1 = p2dist x < -10


[state 1104, velset]
type = velset
trigger1 = time = 1
x = -24
y = -12

[state 1104, gravity]
type = gravity
trigger1 = pos y < -1

[state 1104, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;Moonsault Victim
;Rode down
[statedef 1105]
type = A
movetype = H
physics = N

[state 655, anim]
type = changeanim2
trigger1 = time = 0
value = 1105

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 660
;---------------------------------------------------------------------------
;Moonsault Victim
;Rode down
[statedef 1106]
type = A
movetype = H
physics = N

[state 655, anim]
type = changeanim2
trigger1 = time = 0
value = 1105

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 661


;---------------------------------------------------------------------------
; Moonsault Heavy
[Statedef 1110]
type    = U
movetype= A
physics = U
juggle  = 4
poweradd= 150
ctrl = 0
sprpriority = 3

[state 1110, anim]
type = changeanim
trigger1 = anim != 1100
value = 1100

[State 1110, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 0

;=========
;  Armor
;=========

[state 1110, armor counter start]
type = varset
trigger1 = time = 0
trigger1 = Var(21) = 1
V = 20
value = 0

[state 1110, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 1110, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = -gethitvar(damage)
persistent = 1

[state 1110, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

[state 1110, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1110
time = 1
persistent = 1

[State 1110, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;----
;armor end
;----
;---
;Damage
;---

; Peak Super Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y < -800
trigger1 = time = 0 
var(14) = 180

; Super Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -800 && pos y < -422
trigger1 = time = 0
var(14) = 160

; Peak Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -422 && pos y < -390
trigger1 = time = 0 
var(14) = 140

;Normal Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -390 
trigger1 = time = 0
var(14) = 120



;Ride down mechanic
[state 1100, Ride down]
type = targetbind
triggerall = numtarget(1110)
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = -20, 60

[state 1100, state of ride down]
type = targetstate
triggerall = numtarget(1110)
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1105

[state 1100, end]
type = targetstate
triggerall = numtarget(1110)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1105
value = 660
;-----------------------------

[state 50, steering]
type = veladd
triggerall = ailevel = 0
trigger1 = command = "holdfwd"
trigger1 = vel x < 30
x = 0.5

[state 50, steering]
type = veladd
triggerall = ailevel > 0
trigger1 = p2bodydist x > 0
trigger1 = vel x < 30
x = 0.5

[state 50, steering]
type = veladd
triggerall = ailevel = 0
trigger1 = command = "holdback"
trigger1 = vel x > -10
x = -0.5

[state 50, steering]
type = veladd
triggerall = ailevel > 0
trigger1 = p2bodydist x < 0
trigger1 = vel x > -10
x = -0.5

[state 1110, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1110, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1110, gravity]
type = gravity
trigger1 = 1

;[state 1110, velset]
;type = veladd
;trigger1 = time = 0
;trigger1 = vel Y <= 0
;y = -12
;persistent = 0

;[state 1110, velset]
;type = velset
;trigger1 = time = 0
;trigger1 = vel Y > 0
;y = -12
;persistent = 0

[state 1110, velset]
type = velset
trigger1 = time = 0
trigger1 = statetype = A
x = 22
y = -20

[state 1110, velset]
type = velset
trigger1 = time = 0
trigger1 = statetype != A
x = 18
y = -40

[state 1110, statetypeset]
type = statetypeset
trigger1 = time = 1
statetype = A
physics = N

[State 1110, 3]
type = HitDef
trigger1 = vel y > 0
persistent = 0
attr = A, SA
damage = ifelse(enemy,movetype = H,150,var(14)),floor(var(14)*0.3)
hitflag = MAF
guardflag = HA
priority = 4
pausetime = 2,2
guard.pausetime = 10,10
sparkno = -1
id = 1110
sparkxy = -20,-180
hitsound   = 5,4
guardsound = S120, 0
animtype = Med
ground.type = High
ground.slidetime = 35
ground.hittime  = 14
ground.velocity = 0,15
air.velocity = -2,15
fall = 1
fall.recover = 0
guard.velocity = -110       
guard.hittime = 40
guard.slidetime = 50
airguard.velocity = -36,8
airguard.hittime = 34
guard.dist = 480

[state 1110, squash]
type = targetstate
triggerall = numtarget(1110)
trigger1 = enemy,statetype != A
trigger1 = movehit
value = 660

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1110, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1111

;---------------------------------------------------------------------------
;Moonsault Landing
[Statedef 1111]
type    = A
movetype= A
physics = N
anim = 1101
sprpriority = 2

[state 1111, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1111, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[State 1111, 3]
type = HitDef
trigger1 = animelem = 1
attr = C, SA
getpower = 200
persistent = 0
HitFlag = FD
hitsound = S1100,0
damage    = ifelse(enemynear,stateno = 661,floor(var(14)*0.75),var(14))
guardflag = HA
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = S120, 0
p2stateno = 660
animtype = Heavy
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
fall.recover = 0

[state 1111, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 52, super jump landing]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 40,0
scale = const(size.xscale)*2.5,const(size.yscale)*2
ownpal = 1
sprpriority = 4

[state 52, super jump landing]
type = explod
trigger1 = time = 0
anim = 2001
postype = p1
pos = 40,0
scale = const(size.xscale)*2.5,const(size.yscale)*2
ownpal = 1
sprpriority = -4

[state 1111, x slow]
type = velmul
trigger1 = time = 0
x = 0.1

[state 1111, snd]
type = playsnd
trigger1 = time = 0
value = 0, 10

[State 1111, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 15

[state 1111, 3]
type = ChangeState
trigger1 = animtime = 0
value = 1112


;---------------------------------------------------------------------------
;bounce
[Statedef 1112]
type    = A
movetype= I
physics = N
anim = 1102


[state 1112, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1112, bounce]
type = velset
trigger1 = time = 0
y = -12

[state 1112, gravity]
type = gravity
trigger1 = time > 1


[state 1112, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1113

;---------------------------------------------------------------------------
[Statedef 1113]
type    = C
movetype= I
physics = C
anim = 1103


[state 1113, nothitby]
type = nothitby
trigger1 = time < 12
value = ,AP

[state 1113, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1113, velset]
type = velset
trigger1 = 1
x = 0
y = 0

[state 1113, end]
type = changestate
trigger1 = time >= 12
value = 1104
 

;--------------------------------------------------------------------------
; Moonsault EX
[Statedef 1120]
type    = U
movetype= A
physics = U
juggle  = 4
poweradd= -500
ctrl = 0
sprpriority = 2

[State 1120, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1120, anim]
type = changeanim
trigger1 = anim != 1100
value = 1100

[State 1120, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 0

;=========
;  Armor
;=========

[state 1120, armor counter start]
type = varset
trigger1 = time = 0
trigger1 = Var(21) = 1
V = 20
value = 1

[state 1120, armor intiator turn off]
type = varset
trigger1 = time = 1
V = 21
value = 0

[state 1120, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = -gethitvar(damage)
persistent = 1

[state 1120, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = - 1
persistent = 1

[state 1120, Unstoppable]
type = hitoverride
trigger1 = Life > 1
attr = SCA, AA, AP
stateno = 1120
time = 1
persistent = 1

[State 1120, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;----
;armor end
;----

;---
;Damage
;---

; Peak Super Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y < -800
trigger1 = time = 0 
var(14) = 180

; Super Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -800 && pos y < -422
trigger1 = time = 0
var(14) = 160

; Peak Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -422 && pos y < -390
trigger1 = time = 0 
var(14) = 140

;Normal Jump
[state 1100, damage scale]
type = varset
trigger1 = pos y >= -390 
trigger1 = time = 0
var(14) = 120

;Ride down mechanic
[state 1100, Ride down]
type = targetbind
triggerall = numtarget(1120)
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = -20, 60

[state 1100, state of ride down]
type = targetstate
triggerall = numtarget(1120)
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1105

[state 1100, end]
type = targetstate
triggerall = numtarget(1120)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1105
value = 660
;-----------------------------

[state 50, steering]
type = veladd
triggerall = ailevel = 0
trigger1 = command = "holdfwd"
trigger1 = vel x < 30
x = 0.6

[state 50, steering]
type = veladd
triggerall = ailevel > 0
trigger1 = p2bodydist x > 0
trigger1 = vel x < 30
x = 0.6

[state 50, steering]
type = veladd
triggerall = ailevel = 0
trigger1 = command = "holdback"
trigger1 = vel x > -30
x = -0.6

[state 50, steering]
type = veladd
triggerall = ailevel > 0
trigger1 = p2bodydist x < 0
trigger1 = vel x > -30
x = -0.6

[state 1120, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1120, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1120, gravity]
type = gravity
trigger1 = 1

;[state 1120, velset]
;type = veladd
;trigger1 = time = 0
;trigger1 = vel Y <= 0
;y = -8
;persistent = 0

;[state 1120, velset]
;type = velset
;trigger1 = time = 0
;trigger1 = vel Y > 0
;y = -8
;persistent = 0

[state 1120, velset]
type = velset
trigger1 = time = 0
trigger1 = statetype = A
x = 16
y = -16

[state 1120, velset]
type = velset
trigger1 = time = 0
trigger1 = statetype != A
x = 12
y = -32

[state 1120, statetypeset]
type = statetypeset
trigger1 = time = 1
statetype = A
physics = N

[State 1120, 3]
type = HitDef
trigger1 = vel y > 0
persistent = 0
attr = A, NA
damage = ifelse(enemy,movetype = H,120,var(14)),floor(var(14)*0.3)
getpower = 0
hitflag = MAF
guardflag = HA
priority = 4
pausetime = 8,6
sparkno = 3
id = 1120
sparkxy = -20,-180
hitsound   = 5,4
guardsound = S120, 0
animtype = Med
ground.type = High
ground.slidetime = 35
guard.hittime = 45
guard.slidetime = 45
guard.velocity = -90
ground.hittime  = 20
ground.velocity = 0,15
air.velocity = -2,15
fall = 1
fall.recover = 0
guard.dist = 480

[state 1120, squash]
type = targetstate
triggerall = numtarget(1120)
trigger1 = enemy,statetype != A
trigger1 = movehit
value = 660

[state 1120, combo damage]
type = varadd
trigger1 = time = 0
v = 18
value = -3

[state 1120, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1121

;---------------------------------------------------------------------------
[Statedef 1121]
type    = A
movetype= A
physics = N
anim = 1101
sprpriority = 2

[state 1121, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1121, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 52, super jump landing]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 40,0
scale = const(size.xscale)*2.5,const(size.yscale)*2
ownpal = 1
sprpriority = 4

[state 52, super jump landing]
type = explod
trigger1 = time = 0
anim = 2001
postype = p1
pos = 40,0
scale = const(size.xscale)*2.5,const(size.yscale)*2
ownpal = 1
sprpriority = -4

[State 1121, 3]
type = HitDef
trigger1 = animelem = 1
attr = C, SA
getpower = 0
persistent = 0
HitFlag = D
hitsound = S1100,0
damage    = ifelse(enemynear,stateno = 661, 120,200)
guardflag = HA
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = S120, 0
p2stateno = 660
animtype = Heavy
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
fall.recover = 0

[state 1121, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 1121, x slow]
type = velmul
trigger1 = time = 0
x = 0.1

[state 1121, snd]
type = playsnd
trigger1 = time = 0
value = 0, 10

[State 1121, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 15

[state 1121, 3]
type = ChangeState
trigger1 = animtime = 0
value = 1122


;---------------------------------------------------------------------------
;bounce
[Statedef 1122]
type    = A
movetype= I
physics = N
anim = 1102


[state 1122, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1122, bounce]
type = velset
trigger1 = time = 0
y = -12

[state 1122, gravity]
type = gravity
trigger1 = time > 1


[state 1122, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 1123

;---------------------------------------------------------------------------
[Statedef 1123]
type    = C
movetype= I
physics = C
anim = 1103


[state 1123, nothitby]
type = nothitby
trigger1 = 1
value = , AP

[state 1123, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 1123, velset]
type = velset
trigger1 = 1
x = 0
y = 0

[state 1123, end]
type = changestate
trigger1 = animtime = 0
value = 1104
 


;--------------------------------------------------------------------------
; Rachelle Summon
[statedef 1150]
type = U
movetype = I
physics = U
ctrl = 0

[state 1150, anim]
type = changeanim
trigger1 = statetype !=A
value = 1150
persistent = 0

[State 1150, 2]
type = Helper
triggerall = ailevel = 0
triggerall = var(32) > 0 ;Rachelle's Health
triggerall = var(29) >= 3
triggerall = numhelper(4000) = 0
trigger1 = time = 3
helpertype = normal
name = "Rachelle"
ID = 4000
stateno = ifelse(command = "holdfwd", 4000,ifelse(command = "holdback",4020,4030))
pos = -160,-720
postype = p1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
ignorehitpause = 1

[State 1150, 2]
type = Helper
triggerall = ailevel > 0
triggerall = var(32) > 0 ;Rachelle's Health
triggerall = var(29) >= 3
triggerall = numhelper(4000) = 0
trigger1 = time = 3
helpertype = normal
name = "Rachelle"
ID = 4000
stateno = ifelse(p2statetype = L, 4030,ifelse(p2statetype = S,4000,4020))
pos = -160,-720
postype = p1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
ignorehitpause = 1



[state 1150, end]
type = changestate
trigger1 = time > 12
value = ifelse(statetype = C, 11, ifelse(statetype = A, 50, 0))
ctrl = 1


;===========================================================================
;  Death Roll Suplex
;===========================================================================
; Light Version
[statedef 1200]
type = A
movetype = A
physics = N
anim = 1200
ctrl = 0
poweradd = 50

[state 1200, charge used]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1200, charge used]
type = varset
trigger1 = time = 0
var(43) = 0


[state 1200, grav]
type = gravity
trigger1 = time > 6

[State 1200, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, ST          
hitflag = M-          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                       
guard.dist = 0 

[state 1200, jump]
type = velset
trigger1 = time = 4
x = 16
y = -14

[state 1200, stop]
type = velset
trigger1 = p2dist x <= 20
trigger1 = p2statetype != A
x = 0

[state 1200, end]
type = changestate
triggerall = time > 6
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1201

;----------------------------------------------------------------------------
;Grab portion
[statedef 1201]
type = S
movetype = A
physics = S
anim = 1201

[state 1201, posset]
trigger1 = time = 0
type = posset
y = 0

[state 1201, posset]
trigger1 = time = 0
type = velset
y = 0

[state 1201, not throwable]
type = nothitby
trigger1 = time < 4
value = ,AT



[State 1201, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = enemynear,stateno != [150,155]
trigger2 = numtarget(4010)
attr = S, ST          
hitflag = M         
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                    
p1facing = 1
p2facing = 1         
p1stateno = 1202       
p2stateno = 1205       
guard.dist = 0        
fall = 1    
 

[state 1201, punish]
type = statetypeset
trigger1 = time > 4
movetype = I

[state 1201, miss sfx]
type = playsnd
trigger1 = time = 4
value = S0,6

[state 1201, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1   

;---------------------------------------------------------------------------
;Throw Animation
[statedef 1202]
type = S
movetype = A
physics = N
anim = 1202

[state 1202, width]
type = width
trigger1 = time < 108
edge = 250,150

[state 1202, width]
type = width
trigger1 = time > 108
edge = 400,80

[state 1202, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1202, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1212, snd]
type = playsnd
trigger1 = time = 0
value = S200,0

[state 1202, posset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 1202, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 155, 0

[State 1202, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 125, -400

[State 1202, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = -60, -510

[State 1202, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -40, -490

[State 830, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -40, -480

[State 830, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = -40, -500

[State 830, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = -40, -505

[State 830, Bind 8]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = -45, -470

[state 1202, snd]
type = playsnd
trigger1 = time = 48
value = S1200,0

[state 1202, snd]
type = playsnd
trigger1 = time = 60
value = S1200,1
channel = 2

[State 830, Bind 9,13,17,21]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
trigger3 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
trigger4 = AnimElemTime(21) >= 0 && AnimElemTime(22) < 0
pos = -15, -465

[State 830, Bind 10,14,18,22]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
trigger3 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
trigger4 = AnimElemTime(22) >= 0 && AnimElemTime(23) < 0
pos = -48, -465

[State 830, Bind 11,15,19]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
trigger3 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
pos = -56, -465

[State 830, Bind 12,16,20]
type = TargetBind
trigger1 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
trigger2 = AnimElemTime(20) >= 0 && AnimElemTime(21) < 0
pos = -46, -465

[State 830, Bind 23]
type = TargetBind
trigger1 = AnimElemTime(23) >= 0 && AnimElemTime(24) < 0
pos = 45, -470

[State 830, Bind 24]
type = TargetBind
trigger1 = AnimElemTime(24) >= 0 && AnimElemTime(25) < 0
pos = 45, -470

[State 830, Bind 24]
type = TargetBind
trigger1 = AnimElemTime(25) >= 0 
pos = 260, -300

[state 1202, stop snd]
type = stopsnd
trigger1 = time = 108
channel = 2

[state 1202, velset]
type = velset
trigger1 = time = 108
x = 20
y = -15

[state 1202, gravity]
type = gravity
trigger1 = time > 110

[state 1202, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1203

;---------------------------------------------------------------------------
;Landing
[statedef 1203]
type = S
movetype = A
physics = N
anim = 1203

[state 1201, posset]
trigger1 = time = 0
type = posset
y = 0

[state 1203, snd]
type = playsnd
trigger1 = time = 0
value = S0,10


[state 1201, posset]
trigger1 = time = 0
type = velset
y = 0
x = 0

[state 1203, quake]
type = envshake
trigger1 = time = 0
persistent = 0
time = 30
ampl = 15

[State 1203, slam]
type = TargetBind
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(1) < 8
pos = 270, -45

[State 1203, Hurt 11]
type = TargetLifeAdd
trigger1 = time = 0
value = floor(fvar(10) * -180)

[State 1213, Hurt 11]
type = Targetpoweradd
trigger1 = time = 0
value = 200

[state 1213, poweradd]
type = poweradd
trigger1 = time = 0
value = 150

[state 1203,targetstate]
type = targetstate
trigger1 = animelemtime(1) = 9
value = 1206

[state 1203, change anim]
type = changestate
trigger1 = animtime = 0
value = 1204

[state 1203, velset]
type = velset
triggerall = anim = 45
trigger1 = time = 0
x = -6
y = -12

[state 1203, gravity]
type = gravity
triggerall = anim = 45
trigger1 = time > 2

[state 1203, landing]
type = changestate
triggerall = anim = 45
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
ctrl = 1
value = 52

;[State 830, Throw 11]
;type = TargetState
;trigger1 = Animelemtime(7) = 6
;value = 841

;[state 830, playerpush]
;type = playerpush
;trigger1 = 1
;value = 0
;--------------------------------------------------------------------------
; Jump back
[statedef 1204]
type = A
movetype = I
physics = N
anim = 45 

[state 1204, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1204, velset]
type = velset
trigger1 = time = 0
x = -6
y = -12

[state 1203, gravity]
type = gravity
trigger1 = time > 2

[state 1203, landing]
type = changestate
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;victim thrown
;--------------------------------------------------------------------------
[statedef 1205]
type = A
movetype = H
physics = N

[state 1205, thrown animation]
type = changeanim2
trigger1 = time = 0 
value = 1205

[state 1205, let go error]
type = selfstate
trigger1 = time > 180
value = 5050

;---------------------------------------------------------------------------
[statedef 1206]
type = A
movetype = H
physics = N

[state 1226, changeanim]
type = changeanim
trigger1 = time = 0
value = 5100

[state 1206, vel]
type = velset
trigger1 = time = 1
x = -6
y = -18

[state 1206, gravity]
type = gravity
trigger1 = time > 2

[state 1206, end]
type = selfstate
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;---------------------------------------------------------------------------
;Hard version
[statedef 1210]
type = A
movetype = A
physics = N
anim = 1200
ctrl = 0
poweradd = 75

[state X, charge used]
type = varset
trigger1 = time = 0
var(41) = 0

[state X, charge used]
type = varset
trigger1 = time = 0
var(43) = 0

[state 1210, grav]
type = gravity
trigger1 = time > 6

[State 1210, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = enemynear,stateno != [150,155]
trigger2 = numtarget(4010)
attr = S, ST          
hitflag = M          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                       
guard.dist = 0     

[state 1210, jump]
type = velset
trigger1 = animelemtime(3) = 0
x = 28
y = -14

[state 1210, stop]
type = velset
trigger1 = p2dist x <= 20
trigger1 = p2statetype != A
x = 0

[state 1200, end]
type = changestate
triggerall = time > 6
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1211

;----------------------------------------------------------------------------
;Grab portion
[statedef 1211]
type = S
movetype = A
physics = S
anim = 1201

[state 1201, posset]
trigger1 = time = 0
type = posset
y = 0

[state 1201, not throwable]
type = nothitby
trigger1 = time < 4
value = ,AT

[state 1201, posset]
trigger1 = time = 0
type = velset
y = 0

[State 1211, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = enemynear,stateno != [150,155]
trigger2 = numtarget(4010)
attr = S, ST          
hitflag = M          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                    
p1facing = 1
p2facing = 1         
p1stateno = 1212       
p2stateno = 1215       
guard.dist = 0        
fall = 1    

[state 1211, punish]
type = statetypeset
trigger1 = time > 4
movetype = I

[state 1201, miss sfx]
type = playsnd
trigger1 = time = 4
value = S0,6

[state 1211, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1   

;---------------------------------------------------------------------------
;Throw Animation
[statedef 1212]
type = S
movetype = A
physics = N
anim = 1212

[state 1212, width]
type = width
trigger1 = time < 96
edge = 250,150

[state 1212, width]
type = width
trigger1 = time > 96
edge = 400,80

[state 1212, snd]
type = playsnd
trigger1 = time = 0
value = S200,0

[state 1212, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1202, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1202, posset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 1202, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 155, 0

[State 1202, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 145, -235

[State 1202, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = -25, -500

[State 1202, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -25, -490

[State 830, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -25, -480

[State 830, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = -25, -500

[State 830, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = -35, -500

[State 830, Bind 8]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = -35, -470

[state 1212, snd]
type = playsnd
trigger1 = time = 48
value = S1200,0

[state 1212, snd]
type = playsnd
trigger1 = time = 54
value = S1200,1
channel = 2

[State 830, Bind 9,13,17,21]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
trigger3 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
trigger4 = AnimElemTime(21) >= 0 && AnimElemTime(22) < 0
trigger5 = AnimElemTime(25) >= 0 && AnimElemTime(26) < 0
trigger6 = AnimElemTime(29) >= 0 && AnimElemTime(30) < 0
pos = -15, -465

[State 830, Bind 10,14,18,22]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
trigger3 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
trigger4 = AnimElemTime(22) >= 0 && AnimElemTime(23) < 0
trigger5 = AnimElemTime(26) >= 0 && AnimElemTime(27) < 0
trigger6 = AnimElemTime(30) >= 0 && AnimElemTime(31) < 0
pos = -45, -465

[State 830, Bind 11,15,19]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
trigger3 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
trigger4 = AnimElemTime(23) >= 0 && AnimElemTime(24) < 0
trigger5 = AnimElemTime(27) >= 0 && AnimElemTime(28) < 0
pos = -50, -465

[State 830, Bind 12,16,20]
type = TargetBind
trigger1 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
trigger3 = AnimElemTime(20) >= 0 && AnimElemTime(21) < 0
trigger4 = AnimElemTime(24) >= 0 && AnimElemTime(25) < 0
trigger5 = AnimElemTime(28) >= 0 && AnimElemTime(29) < 0
pos = -40, -465

[State 830, Bind 23]
type = TargetBind
trigger1 = AnimElemTime(31) >= 0 && AnimElemTime(32) < 0
pos = 45, -470

[State 830, Bind 24]
type = TargetBind
trigger1 = AnimElemTime(32) >= 0 && AnimElemTime(33) < 0
pos = 45, -470

[State 830, Bind 24]
type = TargetBind
trigger1 = AnimElemTime(33) >= 0 
pos = 260, -300

[state 1212, velset]
type = velset
trigger1 = time = 96
y = -20
x = 25

[state 1212, stop sound]
type = stopsnd
trigger1 = time = 96
channel = 2

[state 1212, gravity]
type = gravity
trigger1 = time > 98

[state 1212, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1213

;---------------------------------------------------------------------------
;Landing
[statedef 1213]
type = S
movetype = A
physics = N
anim = 1203

[state 1213, posset]
trigger1 = time = 0
type = posset
y = 0

[state 1213, snd]
type = playsnd
trigger1 = time = 0
value = S0,10


[state 1213, posset]
trigger1 = time = 0
type = velset
y = 0
x = 0

[state 1213, quake]
type = envshake
trigger1 = time = 0
persistent = 0
time = 30
ampl = 20

[State 1213, slam]
type = TargetBind
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(1) < 8
pos = 270, -45

[State 1213, Hurt 11]
type = TargetLifeAdd
trigger1 = time = 0
value = floor(fvar(10)*-220)

[State 1213, Hurt 11]
type = Targetpoweradd
trigger1 = time = 0
value = 200

[state 1213, poweradd]
type = poweradd
trigger1 = time = 0
value = 175

[state 1213,targetstate]
type = targetstate
trigger1 = animelemtime(1) = 9
value = 1206

[state 1213, change anim]
type = changestate
trigger1 = animtime = 0
value = 1214

;--------------------------------------------------------------------------
; Jump back
[statedef 1214]
type = A
movetype = I
physics = N
anim = 45 

[state 1204, velset]
type = velset
trigger1 = time = 0
x = -8
y = -16

[state 1214, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[state 1213, gravity]
type = gravity
trigger1 = time > 2

[state 1213, landing]
type = changestate
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;--------------------------------------------------------------------------
;victim thrown
;--------------------------------------------------------------------------
[statedef 1215]
type = A
movetype = H
physics = N

[state 1205, thrown animation]
type = changeanim2
trigger1 = time = 0 
value = 1215

;---------------------------------------------------------------------------
[statedef 1216]
type = A
movetype = H
physics = N

[state 1226, changeanim]
type = changeanim
trigger1 = time = 0
value = 5100

[state 1206, vel]
type = velset
trigger1 = time = 1
x = -6
y = -18

[state 1206, gravity]
type = gravity
trigger1 = time > 2

[state 1206, end]
type = selfstate
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;---------------------------------------------------------------------------
;EX version (projectile immune)
[statedef 1220]
type = A
movetype = A
physics = N
anim = 1200
ctrl = 0

[state X, charge used]
type = varset
trigger1 = time = 0
var(41) = 0

[state X, charge used]
type = varset
trigger1 = time = 0
var(43) = 0

[state 1220, power]
type = poweradd
trigger1 = time = 4
value = -500
persistent = 0

[State 1123, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1220, grav]
type = gravity
trigger1 = time > 6

[State 1220, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = enemynear,stateno != [150,155]
trigger2 = numtarget(4010)
attr = S, ST          
hitflag = M          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                       
guard.dist = 0        

[state 1220, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 1220, jump]
type = velset
trigger1 = animelemtime(3) = 0
x = 28
y = -16

[state 1220, stop]
type = velset
trigger1 = p2dist x <= 20
trigger1 = p2statetype != A
x = 0

[state 1220, end]
type = changestate
triggerall = time > 6
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1221

;----------------------------------------------------------------------------
;Grab portion
[statedef 1221]
type = S
movetype = A
physics = S
anim = 1201

[state 1221, posset]
trigger1 = time = 0
type = posset
y = 0

[State 1123, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1221, nothitby]
type = nothitby
trigger1 = time < 6
value = ,AP,AT

[state 1201, posset]
trigger1 = time = 0
type = velset
y = 0


[State 1221, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = (enemynear,stateno != [150,155])
attr = S, ST          
hitflag = M          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                    
p1facing = 1
p2facing = 1         
p1stateno = 1222       
p2stateno = 1225       
guard.dist = 0        
fall = 1    

[state 1221, punish]
type = statetypeset
trigger1 = time > 4
movetype = I

[state 1221, miss sfx]
type = playsnd
trigger1 = time = 4
value = S0,6

[state 1221, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1   

;---------------------------------------------------------------------------
;Throw Animation
[statedef 1222]
type = S
movetype = A
physics = N
anim = 1222



[State 1123, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1222, width]
type = width
trigger1 = time < 96
edge = 250,150

[state 1222, width]
type = width
trigger1 = time > 96
edge = 400,80

[state 1222, snd]
type = playsnd
trigger1 = time = 0
value = S200,0

[state 1222, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1222, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1222, posset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[State 1222, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 155, 0

[State 1222, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 145, -235

[State 1222, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = -25, -500

[State 1222, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = -25, -490

[State 1222, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = -25, -480

[State 1222, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = -25, -500

[State 1222, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = -35, -500

[State 1222, Bind 8]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = -35, -470

[state 1222, snd]
type = playsnd
trigger1 = time = 48
value = S1200,0

[state 1222, snd]
type = playsnd
trigger1 = time = 54
value = S1200,1
channel = 2

[State 830, Bind 9,13,17,21,33,37,41]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
trigger3 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
trigger4 = AnimElemTime(21) >= 0 && AnimElemTime(22) < 0
trigger5 = AnimElemTime(25) >= 0 && AnimElemTime(26) < 0
trigger6 = AnimElemTime(29) >= 0 && AnimElemTime(30) < 0
trigger7 = AnimElemTime(33) >= 0 && AnimElemTime(34) < 0
trigger8 = AnimElemTime(37) >= 0 && AnimElemTime(38) < 0
trigger9 = AnimElemTime(41) >= 0 && AnimElemTime(42) < 0
pos = -15, -465

[State 830, Bind 10,14,18,22]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
trigger3 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
trigger4 = AnimElemTime(22) >= 0 && AnimElemTime(23) < 0
trigger5 = AnimElemTime(26) >= 0 && AnimElemTime(27) < 0
trigger6 = AnimElemTime(30) >= 0 && AnimElemTime(31) < 0
trigger7 = AnimElemTime(34) >= 0 && AnimElemTime(35) < 0
trigger8 = AnimElemTime(38) >= 0 && AnimElemTime(39) < 0
trigger9 = AnimElemTime(42) >= 0 && AnimElemTime(43) < 0
pos = -45, -465

[State 830, Bind 11,15,19]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
trigger3 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
trigger4 = AnimElemTime(23) >= 0 && AnimElemTime(24) < 0
trigger5 = AnimElemTime(27) >= 0 && AnimElemTime(28) < 0
trigger6 = AnimElemTime(31) >= 0 && AnimElemTime(32) < 0
trigger7 = AnimElemTime(35) >= 0 && AnimElemTime(36) < 0
trigger8 = AnimElemTime(39) >= 0 && AnimElemTime(40) < 0
pos = -50, -465

[State 830, Bind 12,16,20]
type = TargetBind
trigger1 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
trigger3 = AnimElemTime(20) >= 0 && AnimElemTime(21) < 0
trigger4 = AnimElemTime(24) >= 0 && AnimElemTime(25) < 0
trigger5 = AnimElemTime(28) >= 0 && AnimElemTime(29) < 0
trigger6 = AnimElemTime(32) >= 0 && AnimElemTime(33) < 0
trigger7 = AnimElemTime(36) >= 0 && AnimElemTime(37) < 0
trigger8 = AnimElemTime(40) >= 0 && AnimElemTime(41) < 0
pos = -40, -465

[State 830, Bind 23]
type = TargetBind
trigger1 = AnimElemTime(43) >= 0 && AnimElemTime(44) < 0
pos = 45, -470

[State 830, Bind 24]
type = TargetBind
trigger1 = AnimElemTime(44) >= 0 && AnimElemTime(45) < 0
pos = 45, -470

[State 830, Bind 24]
type = TargetBind
trigger1 = AnimElemTime(45) >= 0 
pos = 260, -300

[state 1222, velset]
type = velset
trigger1 = time = 86
y = -20
x = 35

[state 1222, stop sound]
type = stopsnd
trigger1 = time = 86
channel = 2

[state 1222, gravity]
type = gravity
trigger1 = time > 88

[state 1222, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1223

;---------------------------------------------------------------------------
;Landing
[statedef 1223]
type = S
movetype = A
physics = N
anim = 1203

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1223, posset]
trigger1 = time = 0
type = posset
y = 0

[state 1223, snd]
type = playsnd
trigger1 = time = 0
value = S0,10


[state 1223, posset]
trigger1 = time = 0
type = velset
y = 0
x = 0

[state 1223, quake]
type = envshake
trigger1 = time = 0
persistent = 0
time = 30
ampl = 20

[State 1223, slam]
type = TargetBind
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(1) < 8
pos = 270, -45

[State 1223, Hurt 11]
type = TargetLifeAdd
trigger1 = time = 0
value = floor(fvar(10)*-180)

[state 1223, hurt 11]
type = targetpoweradd
trigger1 = time = 0
value = 200

[state x, combo damage score]
type = varadd
trigger1 = time = 1
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 1223,targetstate]
type = targetstate
trigger1 = animelemtime(1) = 9
value = 1226

[state 1223, change anim]
type = changestate
trigger1 = animtime = 0
value = 1224

;--------------------------------------------------------------------------
; Jump back
[statedef 1224]
type = A
movetype = I
physics = N
anim = 45 

[State 1123, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1224, velset]
type = velset
trigger1 = time = 0
x = -8
y = -12

[state 1224, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[state 1224, gravity]
type = gravity
trigger1 = time > 2

[state 1224, landing]
type = changestate
triggerall = time > 2
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;--------------------------------------------------------------------------
;victim thrown
;--------------------------------------------------------------------------
[statedef 1225]
type = A
movetype = H
physics = N

[state 1205, thrown animation]
type = changeanim2
trigger1 = time = 0 
value = 1225

;---------------------------------------------------------------------------
[statedef 1226]
type = A
movetype = H
physics = N

[state 1226, changeanim]
type = changeanim
trigger1 = time = 0
value = 5100

[state 1206, vel]
type = velset
trigger1 = time = 1
x = 0
y = 0

[State 1227, 8]
type = Explod
trigger1 = Time = 0
anim = F62 
pos = 0, 0
ontop = 1
scale = 1.7, 0.5
persistent = 0
ownpal = 1

[State 1227, 10]
type = PlaySnd
trigger1 = Time = 0
value = F7,2
persistent = 0

[state 1206, gravity]
type = gravity
trigger1 = time > 2

[state 1227, shake]
type = envshake
trigger1 = time = 0
ampl = 5
freq = 50
phase = 50
time = 10

[state 1206, end]
type = changestate
trigger1 = time = 8
value = 1227

;;-------------------------------------------------------------------------
;Bounce
[statedef 1227]
type = A
movetype = H
physics = N
anim = 5160

[state 1227, turn]
type = turn
trigger1 = time = 0
ignorehitpause = 1

[state 1227, impact]
type = velset
trigger1 = time = 0
y = 0

[state 1227, impact 2]
type = posset
trigger1 = time = 0
y = 0

[state 1227, bounce]
type = velset
trigger1 = time = 1
y = -30
x = -2

[state 1227, gravity]
type = veladd
trigger1 = time > 1
y = 1.22

[state 1227, down]
type = selfstate
trigger1 = time >= 2 
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5110



;===========================================================================
;  Chest Bump (Push Block)
;===========================================================================

[Statedef 1400]
type = S
movetype = A
physics = S
velset = 0,0
anim = 1400
facep2 = 1

[state 1400, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200


[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -500

[State 330, Spark]
type = Explod
trigger1 = AnimElem = 1
id = 1410
anim = 1410
postype = p1
pos = 270,-335
sprpriority = 3
bindtime = 1
scale = 4,4
ownpal = 1

[State 211, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = S, NA
animtype  = Heavy
damage    = 25
getpower = 0
Hitflag = MA
guardflag = 
pausetime = 0,0
sparkno = -1
ground.Velocity = -5
air.Velocity = -5,0
fall = 1
fall.recover = 0
kill = 0
guard.kill = 0

[state 1400, moveforward]
type = velset
trigger1 = time = 0
x = 5

[state 1400, snd]
type = playsnd
trigger1 = time = 1
value = 1400,0

[State 1400, Push]
type = Helper
trigger1 = Time = 5
trigger2 = time = 7
ignorehitpause = 1
ID = 1401
name = "Shove"
pos = 0,0
postype = p1
stateno = 1401
keyctrl = 0
ownpal = 1
helpertype = normal

[state 1400, HB]
Type = hitby
trigger1 = 1
value = SCA,AT

[state 1400, previous state]
type = varset
trigger1 = time = 0
v = 5
value = prevstateno


[State 1400, 3]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Pushing part
[Statedef 1401]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 1401

[State 1440, Push]
type = posset
trigger1 = time = 0
y = 0

[State 1440, Push]
type = PlayerPush
trigger1 = 1
value = 1

[State 1440, NHB]
type = NotHitBy
Trigger1 = 1
value = SCA
Time = 1

[State 1440, Vel]
type = VelSet
trigger1 = Time >= 0
x = 50

[State 345, End]
type = DestroySelf
trigger1 = Time = 15

;===========================================================================
;  Super Move - Crocodile Sandwich  ; Total Damage: 540
;===========================================================================

; Dash portion
[statedef 3000]
type = S
movetype = A
physics = N
velset = 0,0
anim = 3000
ctrl = 0

[state x, Minimum Super combo damage]
type = varset
trigger1 = var(18) < 90
v = 18
value = 90
ignorehitpause

[state 3000, no bg]
type = assertspecial
trigger1 = animelemtime(2) >= 0 && animelemtime(2) < 61
flag = nobg

[state 3000, forward]
type = velset
trigger1 = animelem = 3
x = 55

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[State 3000, Super Pause]
type = SuperPause
trigger1 = animelemtime(2) = 0
sound = S3000, 0
poweradd = -3000
pos = -10,-200
time = 60
movetime = 60

[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(2) = [0, 14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1


[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(2) = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1



[state 3000, change state]
type = changestate
trigger1 = time > 78
trigger2 = p2bodydist x < 80
trigger2 = time > 63
value = 3001
persistent = 0

;---------------------------------------------------------------------------
; Super Combo - Hit Confirm portion
[Statedef 3001]
Type = S
movetype = A
physics = S
ctrl = 0
anim = 3001

[State 3001, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = S, HA
animtype  = HEAVY
damage    = 60,20
getpower = 0
givepower = 75
guardflag = MA
pausetime = 6,18
guard.pausetime = 6,6
guard.hittime = 26
priority = 5,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 23
guard.velocity = -40
guard.hittime = 22
guard.slidetime = 30
air.hittime = 24
ground.velocity = 10,0
air.velocity = 0,-5
ground.cornerpush.veloff = 0
kill = 0
guard.dist = 1280

[state 3001, side]
type = velmul
trigger1 = animelem = 2
x = 0.25

[state 3001, stop]
type = velset
trigger1 = animelem = 6
x = 0

[state 3001, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3001, nothitby]
type = nothitby
trigger1 = time < 15
value = SCA 

[state 3001, end]
type = changestate
triggerall = movehit
trigger1 = animtime = 0
ctrl = 0
value = 3002

[state 3001, end]
type = changestate
triggerall = !movehit
trigger1 = animtime = 0
ctrl = 0
value = 3009
;---------------------------------------------------------------------------
; Super Combo - Auto Combo
[Statedef 3002]
Type = S
movetype = A
physics = S
ctrl = 0
anim = 3002

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[State 3002, 2]
type = HitDef
trigger1 = animelem = 5  || animelem = 14 || animelem = 23
persistent = 1
attr = A, HA
animtype  = HEAVY
damage    = 33,8
getpower = 0
givepower = 50
guardflag = MA
pausetime = 4,16
guard.pausetime = 6,6
guard.hittime = 26
priority = 7,hit
sparkno = 3
sparkxy = -40,-240
hitsound   = S0,2
guardsound = S120, 0
ground.type = low
ground.slidetime = 25
ground.hittime  = 23
guard.velocity = 3
guard.slidetime = 21
air.hittime = 24
ground.velocity = 5,0
air.velocity = 0,-2
ground.cornerpush.veloff = 0
kill = 0

[State 3002, 2]
type = HitDef
trigger1 = animelem = 9  || animelem = 18 
persistent = 1
attr = A, HA
animtype  = HEAVY
damage    = 35,8
getpower = 0
givepower = 50
guardflag = MA
pausetime = 4,16
guard.pausetime = 6,6
guard.hittime = 26
priority = 7,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 23
guard.velocity = 3
guard.hittime = 22
guard.slidetime = 21
air.hittime = 24
ground.velocity = 5,0
air.velocity = 0,-2
ground.cornerpush.veloff = 0
kill = 0

[State 3002, 2]
type = HitDef
trigger1 = animelem = 28
persistent = 0
attr = A, HA
animtype  = HEAVY
damage    = 61,8
getpower = 0
givepower = 50
guardflag = MA
pausetime = 4,12
guard.pausetime = 6,6
guard.hittime = 26
priority = 7,hit
sparkno = 3
sparkxy = 80,-195
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 25
ground.hittime  = 23
guard.velocity = 3
guard.hittime = 22
guard.slidetime = 21
air.hittime = 24
p2stateno = 3010
ground.velocity = -15, 0
air.velocity = -15,0
ground.cornerpush.veloff = 0
kill = 0


[state 3002, stop]
type = velset
trigger1 = animelem = 6
x = 0

[state 3002, end]
type = changestate
trigger1 = animtime = 0
value = 3003
;--------------------------------------------------------------------------
;jump back
[statedef 3003]
type = S
movetype = I
physics = N
anim = 105

;[state 3004, position]
;type = posset
;trigger1 = time = 0
;x = ifelse(facing = 1,-140,140)

[state 3003, vel]
type = velset
trigger1 = time = 0
x = -35
y = -10

[state 3003, gravity]
type = gravity
trigger1 = time > 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3003, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 3004

;-------------------------------------------------------------------------
;Lunge Sandwich start
[statedef 3004]
type = A
movetype = A
physics = N
anim = 0
sprpriority = 2

;[state 3004, position]
;type = posset
;trigger1 = time = 0
;x = ifelse(facing = 1,-450,450)

[state 3004, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3004, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3004, vel]
type = velset 
trigger1 = time = 0 
y = 0
x = 0

[state 3004, pos]
type = posset
trigger1 = time = 0 
y = 0

[State 3004, 2]
type = Helper
trigger1 = numhelper(4000) = 0
trigger1 = time = 0
helpertype = normal
name = "Rachelle"
ID = 4000
stateno = 4300
pos = p2dist x * 2,0
postype = p1
ownpal = 1
ignorehitpause = 1

[state 3004, distance set]
type = varset
trigger1 = time = 0
v = 31
value = floor(p2bodydist x)

[state 3005, explod]
type = explod
trigger1 = anim = 3003
anim = 3020
postype = p1
sprpriority = -5
bindtime = -1
id = 3020
scale = const(size.xscale),const(size.yscale)


[state 3004, anim]
type = changeanim
trigger1 = time = 24
value = 3003

[State 3004, 1]
type = HitDef
Trigger1 = 1
attr = A, HA          
hitflag = MAF          
priority = 1, Miss    
sparkno = -1         
p1sprpriority = 1                          
p1facing = 1
p2facing = 1          
p1stateno = 3005     
p2stateno = 3015       
guard.dist = 0        
fall = 1     

[state 3004, velocity]
type = velset
trigger1 = time = 24
y = -15
x = 45

[state 3004, gravity]
type = gravity
trigger1 = time > 24

[state 3004, end miss]
type = changestate
triggerall = time > 24
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;-------------------------------------------------------------------------
; sandwich
[statedef 3005]
type = A
movetype = A
physics = N
sprpriority = 2

[state 3005, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[state 3005, sfx]
type = playsnd
trigger1 = time = 0
value = S3000,1

[state 3005, sfx]
type = playsnd
trigger1 = time = 0
value = S3000,1

[State 3005, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 25
ampl = 15

[state 3005, anim]
type = changeanim
trigger1 = time = 0
value = 3004

[state 3005, pos]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3005, explod]
type = explod
trigger1 = time = 0
trigger1 = anim = 3004
postype = p1
anim = 3021
scale = const(size.xscale),const(size.yscale)
sprpriority = -4
bindtime = -1
id = 3021


[State 3004, 2]
type = Helper
;trigger1 = numhelper(4000) = 0
trigger1 = time = 0
helpertype = normal
name = "Rachelle"
ID = 4000
stateno = 4301
pos = 580,0
postype = p1
ownpal = 1
ignorehitpause = 1

[State 3005, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(2) < 0
pos = 250, -40

[state 3005, slow-mo]
type = pause
trigger1 = animtime < 36
time = 1
persistent = 1

[state 3005, target life]
type = targetlifeadd
trigger1 = time = 6
value = ceil(fvar(10)*-250)

[state 3005, target power]
type = targetpoweradd
trigger1 = time = 6
value = 375

[state 3005, KO CHECK]
type = varset
trigger1 = !enemynear,alive
var(36) = 1
persistent = 1

[State 3005, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 250, -40

[state 3005, targetstate]
type = targetstate
trigger1 = time = 36
value = 3011

[state 3005, bounce off]
type = velset
trigger1 = time = 6
x = 0.25
y = 0

[state 3005, bounce off]
type = velset
trigger1 = time = 36
x = -20
y = -15

;[state 3005, sfx]
;type = playsnd
;trigger1 = time = 36
;value = S1,4

[state 3005,gravity]
type = gravity
trigger1 = time > 37


[state 3005, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 0
ctrl = 1



;--------------------------------------------------------------------------
;Crocodile Sandwich - Miss
[statedef 3009]
type = S
movetype = I
Physics = S
anim = 3009

[state 3009, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;===========================================================================
;  Victim Spin
;===========================================================================

[statedef 3010]
type = S
movetype = H
physics = S

[state 3010, anim]
type = changeanim2
trigger1 = time = 0
persistent = 0
value = 3010

[state 3010, 1]
type = velset
trigger1 = time = 0
x = -0.5
y = 0

[state 3010, nothitby]
type = nothitby
trigger1 = time < 80
value = SCA

[state 3010, playerpush]
type = playerpush
trigger1 = 1
value = 0

;[state 3010, posset]
;type = posset
;trigger1 = time = 50
;x = 0

[state 3010, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3010, 2]
type = changeanim
trigger1 = anim = 3010
trigger1 = animtime = 0
value = 5300 

[state 3010, 3]
type = selfstate
trigger1 = anim = 5300
trigger1 = time > 300
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[statedef 3011]
type = A
movetype = H
physics = N

[state 3011, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3001, anim]
type = changeanim
trigger1 = time = 0
value = 5061

[state 3011, vel]
type = velset
trigger1 = time = 0
y = -12
x = -0.2

[state 3011, gravi]
type = gravity
trigger1 = time > 1

[state 3010, nothitby]
type = nothitby
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = SCA
time = 45

[state 3010, 3]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;--------------------------------------------------------------------------
[statedef 3015]
type = A
movetype = H
physics = N

[state 3015, anim]
type = changeanim
trigger1 = time = 0
value = 5051

;==========================================================================
;2nd Super - Boobryureppa - Damage: 250 -> 280 Invincible start up
;==========================================================================

[Statedef 3040]
Type = A
movetype = A
physics = N
ctrl = 0
anim = 3040
velset = 0,0

[state X, charge used]
type = varset
trigger1 = time = 0
var(43) = 0
var(41) = 0

[state 3040, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3040, 1]
type = nothitby
trigger1 = 1
value = SCA

[state 3040, reps]
type = varset
trigger1 = time = 0
v = 13
value = 2

[state 3000, no bg]
type = assertspecial
trigger1 = animelemtime(2) = [0,60]
flag = nobg
ignorehitpause = 1
persistent = 1

[State 3040, Super Pause]
type = SuperPause
trigger1 = animelemtime(2) = 0
sound = S3000, 0
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60

[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(2) =[0, 15]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1


[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(2) = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1


[State 3040, 2]
type = HitDef
trigger1 = animelem = 5
persistent = 0
attr = A, HA
animtype  = Heavy
damage    = 35,ifelse(enemy,statetype = A,12,4)
getpower = 0
guardflag = MA
pausetime = 6,6
priority = 6,hit
sparkno = 2
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = 2,0
air.velocity = 2,-12
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480
forcestand = 1

[State 3040, 2]
type = HitDef
trigger1 = animelem = 6
persistent = 0
attr = A, HA
animtype  = Heavy
damage    = 35,ifelse(enemy,statetype = A,12,4)
getpower = 0
guardflag = MA
pausetime = 6,12
priority = 6,hit
sparkno = 2
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = 2,0
air.velocity = 2,-12
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480
forcestand = 1

[state 3040, end]
type = changestate
trigger1 = vel y > 0
value = 3041

[state x, combo damage score]
type = varset
trigger1 = var(18) < 70
v = 18
value = 70
persistent = 0
ignorehitpause = 1

[state 3040, up]
type = velset
trigger1 = animelem = 5
y = -16
x = 14
persistent = 0

[state 3040, gravity]
type = gravity
trigger1 = pos y < -1

;---------------------------------------------------------------------------
;upper Recovery
[statedef 3041]
Type = A
movetype = I
physics = N
ctrl = 0
anim = 3041

[state 3040, 1]
type = nothitby
trigger1 = var(13) > 1
value = SCA

[state 1001, gravity]
type = gravity
trigger1 = 1

[state 1001, end]
type = changestate
triggerall = var(13) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = ifelse(var(13)>1,3042,3043)

[state 3041, end]
type = changestate
triggerall = var(13) <= 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
;--------------------------------------------------------------------------
; 2nd
[Statedef 3042]
Type = A
movetype = A
physics = N
ctrl = 0
anim = 3042

[state 3042, counter]
type = varadd
trigger1 = time = 0
var(13) = -1

[state 3042, land]
type = posset
trigger1 = time = 0
y = 0

[state 3042, stop]
type = velset
trigger1 = time = 0
y = 0

;- Weighty effects
[State 3042, 4]
type = EnvShake
trigger1 = time = 0
time = 15
ampl = 8

[state 3042, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = 200,0
scale = 1.5, 1.5
sprpriority = 2

[state 3042, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = -210,0
scale = 1.5, 1.5
sprpriority = 2

[State 3040, 2]
type = HitDef
trigger1 = animelem = 5
persistent = 0
attr = A, HA
animtype  = Heavy
damage    = 35,ifelse(enemy,statetype = A,12,4)
getpower = 0
guardflag = MA
pausetime = 6,6
priority = 6,hit
sparkno = 2
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = 2,0
air.velocity = 2,-12
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480
forcestand = 1

[State 3040, 2]
type = HitDef
trigger1 = animelem = 6
persistent = 0
attr = A, HA
animtype  = Heavy
damage    = 35,ifelse(enemy,statetype = A,12,4)
getpower = 0
guardflag = MA
pausetime = 6,12
priority = 6,hit
sparkno = 2
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = 2,0
air.velocity = 2,-12
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480
forcestand = 1

[state 3040, end]
type = changestate
trigger1 = vel y > 0
value = 3041

[state x, combo damage score]
type = varset
trigger1 = var(18) < 80
v = 18
value = 80
persistent = 0
ignorehitpause = 1

[state 3040, up]
type = velset
trigger1 = animelem = 5
y = -18
x = 12
persistent = 0

[state 3040, gravity]
type = gravity
trigger1 = pos y < -1

;--------------------------------------------------------------------------
; Final
[Statedef 3043]
Type = A
movetype = A
physics = N
ctrl = 0
anim = 3042

[state 3042, counter]
type = varadd
trigger1 = time = 0
var(13) = -1

[state 3043, land]
type = posset
trigger1 = time = 0
y = 0

[state 3043, stop]
type = velset
trigger1 = time = 0
y = 0

[state 3043, 1]
type = nothitby
trigger1 = 1
value = A, AA,AP

;- Weighty effects
[State 3042, 4]
type = EnvShake
trigger1 = time = 0
time = 15
ampl = 8

[state 3042, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = 200,0
scale = 1.5, 1.5
sprpriority = 2

[state 3042, dust]
type = explod
trigger1 = time = 0
anim = F120
postype = p1
pos = -210,0
scale = 1.5, 1.5
sprpriority = 2

[State 3040, 2]
type = HitDef
trigger1 = animelem = 5
persistent = 0
attr = A, HA
animtype  = Up
damage    = 35,ifelse(enemy,statetype = A,12,4)
getpower = 0
guardflag = MA
pausetime = 8,8
priority = 6,hit
sparkno = 3
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = -2,-52
air.velocity = -2,-48
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480

[State 3040, 2]
type = HitDef
trigger1 = animelem = 6
persistent = 0
attr = A, HA
animtype  = Up
damage    = 35,ifelse(enemy,statetype = A,12,4)
getpower = 0
guardflag = M
pausetime = 12,12
priority = 6,hit
sparkno = 3
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = -2,-52
air.velocity = -2,-48
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480

[State 3040, 2]
type = HitDef
trigger1 = animelem = 7
persistent = 0
attr = A, HA
animtype  = Up
damage    = 70,ifelse(enemy,statetype = A,21,7)
getpower = 0
guardflag = M
pausetime = 18,18
priority = 6,hit
sparkno = 3
sparkxy = -20,-260
hitsound   = S0,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 30
ground.hittime  = 30
air.hittime = 30
ground.velocity = -8,-42
air.velocity = -10,-42
fall.recover = 0
guard.velocity = -12          
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-8
airguard.hittime = 24
envshake.freq = 60
envshake.ampl = 8
envshake.time = 12
guard.dist = 480
fall = 1
fall.recover = 0

[state 3040, end]
type = changestate
trigger1 = vel y > 0
value = 3041

[state 3040, up]
type = velset
trigger1 = animelem = 5
y = -54
x = 8
persistent = 0

[state 3040, gravity]
type = gravity
trigger1 = pos y < -1


;===============================================================================
; Vicious Chair Shot
;===============================================================================

[Statedef 3080]
type = S
movetype = A
physics = S
anim = 3080
ctrl = 0

[state 3080, no bg]
type = assertspecial
trigger1 = animelemtime(1) >= 0 && animelemtime(8) < 0
flag = nobg

[State 3080, Super Pause]
type = SuperPause
trigger1 = animelemtime(1) = 0
sound = S3000, 0
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60

[state 3080, Super Portrait]
type = explod
trigger1 = animelemtime(1) >= 0 && animelemtime(4) < 3
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1


[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(4) = 3
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3080, reversal]
type = ReversalDef
trigger1 = 1
reversal.attr = SCA, AA
pausetime = 18,18 
p1stateno = 3081
p2stateno = 3095
ignorehitpause = 1

[State 3080, Blink White]
type = PalFX
trigger1 = animelemtime(9) > 0 && animelemtime(9) < 12
trigger1 = time%2
time = 1
add = 255,255,255 ;32,16,0
ignorehitpause

[state 3080, statetypeset]
type = statetypeset
trigger1 = animelemtime(9) = 0
movetype = I
ignorehitpause = 1



[state 3080, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
;Katrina OVERSELL
[statedef 3081]
type = A
movetype = A
physics = N
anim = 3081
velset = 0,0

[state 3081, gravity]
type = gravity
trigger1 = pos y < -1

[state 3081, velset]
type = velset
trigger1 = time = 0
x = -1
y = -12

[state 3081, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3082


;------------------------------------------------------------------------------
[statedef 3082]
type = L
anim = 3082
physics = C
movetype = A

[State 3082, Helper]
type = Helper
triggerall = !numhelper(4000)
trigger1 = time = 12
helpertype = normal ;player
name = "Rachelle with Chair"
ID = 4000
stateno = 3090 
pos = -2400,0
postype = p2    ;p2,front,back,left,right

[state 3082, statetypeset]
type = statetypeset
trigger1 = animelem = 4
statetype = S



[state 3082, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 3082, posset]
type = posset
trigger1 = time = 0
y = 0

[state 3082, end]
type = changestate
trigger1 = time = 300
trigger2 = numhelper(4000)
trigger2 = helper(4000),movehit = 1
value = 3083
ignorehitpause = 1


;------------------------------------------------------------------------------
;Jump Away
[statedef 3083]
type = A
movetype = I
physics = N
anim = 3083
velset = 0,0

[state 3083, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3083, Jump]
type = velset
trigger1 = animelemtime(4) = 0
x = -8
y = -24

[state 3083, gravity]
type = gravity
trigger1 = pos y < -1

[state 3083, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3084


;-----------------------------------------------------------------------------
;Katrina Taunt pose to let Gustine Smash
[statedef 3084]
type = S
movetype = I
physics = S
anim = 181
velset = 0,0
sprpriority = -2

;Gustine
[state 3084, Helper]
type = helper
triggerall = !numhelper(4700)
trigger1 = time = 4
stateno = 4700
name = "Gustine"
Helpertype = normal
postype = p2
pos = 0, -2100
id = 4700
persistent = 300
ignorehitpause = 1


[state 3084, posset]
type = posset
trigger1 = time = 0
y = 0


[state 3084, changestate]
type =  changestate
trigger1 = numhelper(4700)
trigger1 = helper(4700), movehit
trigger1 = helper(4700), time > 30
trigger2 = time = 180
value = 0
ctrl = 1

;------------------------------------------------------------------------------
;P2 babyface can't hit injured enemy
[statedef 3095]
type = S
movetype = H
physics = S
ctrl = 0
anim = 0
velset = 0,0

[state 3090, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 3090, nothitby]
type = nothitby
trigger1 = time < 60
value = SCA


[state 3090, end]
type = selfstate
trigger1 = time  = 300
value = 0
ctrl = 1

;-------------------------------------------------------------------------------
;Rachelle Lunge
[statedef 3090]
type = S
movetype = A
physics = S
anim = 3090
facep2 = 1
sprpriority = 3

[state 3090, nothitby]
type = nothitby
trigger1 = 1
value = SCA



[state 3090, velset]
type = velset
trigger1 = time > 1
x = 40

[state 3090, explod]
type = explod
trigger1 = !numexplod(3090)
trigger1 = time = 1
anim = 3095
postype = p1
pos = 0,0
sprpriority = 4
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removetime = -1
id = 3090

[state 3090, swing]
type = changestate
trigger1 = p2bodydist x < 300
value = 3091





;------------------------------------------------------------------------------------
;Rachelle Swing
[statedef 3091]
type = S
movetype = A
physics = S
anim = 3091
sprpriority = 3

[state 3091, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 3090

[state 3091, explod]
type = explod
trigger1 = time = 0
anim = 3096
id = 3091
postype = p1
pos = 0,0
sprpriority = 4
scale = const(size.xscale),const(size.yscale)
bindtime = -1
ignorehitpause = 0

[state 3091, modify explod]
type = modifyexplod
trigger1 = animelem =4
id = 3091
sprpriority = -2

[state 3091, brakes]
type = velmul
trigger1 = time = 0
x = 0.5

[State 3091, 2]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = A, HA
animtype  = HEAVY
damage    = 120,36
getpower = 0
guardflag = 
pausetime = 18,18
priority = 4,hit
sparkno = 3
id = 3090
sparkxy = -40,-300
hitsound   = S3080,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
air.hittime = 48
ground.velocity = -18,-6
air.velocity = -18,-12
ground.cornerpush.veloff = -20
guard.velocity = -40           
guard.hittime = 18
guard.slidetime = 28
airguard.velocity = -20,-2
guard.dist = 640
fall = 1
fall.recover = 0
envshake.ampl = 12
envshake.time = 18
envshake.phase = 60
envshake.freq = 60
kill = 0

[state 3091, targetstate]
type = targetstate
trigger1 = hitpausetime = 17
trigger1 = movehit
value = 3070
ignorehitpause = 1


[state 3091, varset]
type = parentvarset
trigger1 = movehit
trigger1 = !enemynear,alive
var(36) = 1

[state 3091, velset]
type = velset
trigger1 = animelemtime(11) = 0
x = -8
y = -24

[state 3091, screenbound]
type = screenbound
trigger1 = animelemtime(11) > 0
value = 1
movecamera = 0,0

[state 3091, gravity]
type = gravity
trigger1 = animelemtime(11) > 0

[state 3091, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3092

;------------------------------------------------------------------------------------------
; Wait for Gustine
[statedef 3092]
type = S
movetype = I
anim = 4180
velset = 0,0
sprpriority = -2

[state 3091, screenbound]
type = screenbound
trigger1 = animelemtime(11) > 0
value = 1
movecamera = 0,0

[state 3092, posset]
type = posset
trigger1 = time = 0
y = 0

[state 3092, changestate]
type = changestate
trigger1 = numhelper(4700)
trigger1 = helper(4700),movehit
trigger1 = helper(4700),time > 30
trigger2 = time = 180
value = 4005

;==========================================================================================

;-------------------------------------------------------
;Victim State
[statedef 3070]
movetype = H
type = U
physics = N

[state 3070, anim]
type = changeanim
trigger1 = time = 0
value = 5070

[state 3070, velset]
type = velset
trigger1 = time = 0
x = 12
y = -4
persistent = 0
ignorehitpause

[state 3071, set type]
type = statetypeset
trigger1 = time = 0
statetype = A



[state 3071,curve]
type = changeanim
trigger1 = vel y > 0
value = 5061
persistent = 0

[state 3071, gravity]
type = veladd
trigger1 = pos y < -1
y = 0.88

[state 3071, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3072

;---------------------------------------------------------------
; Lay down state
[statedef 3072]
movetype = H
type = L
physics = N
velset = 0,0

[state 3072, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 3072, nothitby]
type = nothitby
trigger1 = time < 120
value = SCA

[state 3072, anim]
type =  changeanim
trigger1 = time = 0
value = 5100

[state 3072, anim]
type =  changeanim
trigger1 = anim = 5100 && animtime = 0
value = 5110

[state 3072, end]
type = selfstate
trigger1 = time > 150
value = 5110



















;----------------------------------------------------------------------------------------

[Statedef 3200]
Type = S
movetype = A
physics = N
ctrl = 0
anim = 3200
velset = 0,0

[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(2) = [0, 14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3000, no bg]
type = assertspecial
trigger1 = animelemtime(2) = [0,60]
flag = nobg
ignorehitpause = 1
persistent = 1

[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(2) = 15
anim = 3100
postype = back
vel = -0.1,0

sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[State 3040, Super Pause]
type = SuperPause
trigger1 = animelem = 2
sound = S3000,0
poweradd = -1000
pos = 0,-232
time = 60
movetime = 60

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0

[State 1150, 2]
type = Helper
triggerall = var(32) > 0 ;Rachelle's Health
triggerall = var(29) >= 3
triggerall = numhelper(4000) = 0
trigger1 = animelem = 2
name = "Rachelle ASSist"
ID = 4000
stateno = 4400
pos = -2580,0
postype = p1
scale = const(size.xscale),const(size.yscale)
ownpal = 1
ignorehitpause = 1
supermovetime = 60

[State 0, ChangeState]
type = ChangeState
triggerall = numhelper(4000)
triggerall = animelem = 10,>=0
trigger1 = helper(4000),stateno = 4401
trigger1 = helper(4000),animelem = 3,>=0
trigger1 = helper(4000),numtarget(3200)
trigger1 = helper(4000),var(0) = 1
value = 3201

[State 0, ChangeState]
type = ChangeState
triggerall = animelem = 10,>=0
trigger1 = !animtime
trigger2 = !numhelper(4000)
trigger3 = numhelper(4000)
trigger3 = (helper(4000),stateno = [4500,4512]) || helper(4000),stateno = 4006
value = 0
ctrl = 1

;We waiting... we alll waiting
[Statedef 3201]
Type = S
movetype = A
physics = N
anim = 0
ctrl = 0
velset = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 21
trigger1 = P2bodydist X < 1250 
trigger1 = backedgedist > 5
value = 21

[State 0, PosAdd]
type = PosAdd
trigger1 = anim = 21
x = const(velocity.walk.back.x)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 21
trigger1 = p2bodydist X >= 1250 || backedgedist <= 5
value = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = numhelper(4000)
trigger1 = helper(4000),var(0) = 2
trigger1 = helper(4000),stateno = 4402
value = 3202

[State 0, ChangeState]
type = ChangeState
trigger1 = !numhelper(4000)
value = 0
ctrl = 1

;FROM...
[Statedef 3202]
Type = S
movetype = A
physics = N
ctrl = 0
anim = 3202
velset = 0,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 5
[State 0, VelSet]
type = Velmul
trigger1 = animelem = 2,>0
trigger1 = vel X < 30
x = 1.05
[State 0, VelSet]
type = VelSet
trigger1 = vel X > 30
x = 30

[State 52, 4]
type = EnvShake
trigger1 = animelemtime(5) = 1
trigger2 = animelemtime(9) = 1
trigger2 = animelemtime(13) = 1
trigger3 = animelemtime(17) = 1
trigger4 = animelemtime(21) = 1
time = 6
ampl = 6
freq = 100
phase = 100
persistent = 1

[state 100, snd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(9) = 0
trigger2 = animelemtime(13) = 0
trigger3 = animelemtime(17) = 0
trigger4 = animelemtime(21) = 0
value = S0,7
volumescale = 50

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "Speed = %f"
params = vel x

[State 0, ChangeState]
type = ChangeState
trigger1 = playerid(helper(4000),var(1)),p2bodydist X <= (Vel X*8)+200
trigger1 = animelem = 2,>=0
value = 3203

;DOWN TOWN
[Statedef 3203]
Type = A
movetype = A
physics = N
velset = vel x,enemynear,const(size.head.pos.y)*.04
ctrl = 0
anim = 3203

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 1050, 2]
type = HitDef
trigger1 = animelem = 4
attr = S,HA
animtype  = HEAVY
damage    = 180,18
getpower = 0
hitflag = MAF+
pausetime = 0,30
priority = 7,hit
sparkno = 3
sparkxy = -40,-295
hitsound   = S5000,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 40
ground.hittime  = 26
air.hittime = 26
ground.velocity = -60,-25
air.velocity = -60,-20
ground.cornerpush.veloff = -30
guard.velocity = -35       
guard.hittime = 20
guard.slidetime = 20
airguard.velocity = -27,-4
airguard.hittime = 30
envshake.freq = 60
envshake.ampl = 6
envshake.time = 12
guard.dist = 480
fall = 1
fall.recover = 0
p2stateno = 670
p2facing = 1
p1stateno = 3204
[State 0, VelAdd]
type = VelAdd
trigger1 = time
y = 1.5

[State 0, ChangeState]
type = null;ChangeState
trigger1 = animelem = 4,>=0
trigger1 = playerid(helper(4000),var(1)),p2bodydist X <= 180
value = 3204

[State 0, ChangeState]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel y > 0
value = 3204

[Statedef 3204]
Type = A
movetype = A
physics = N
velset = 0,0
ctrl = 0
anim = 3204

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 4

[State 0, VelAdd]
type = Gravity
trigger1 = animelem = 2,>0

[State 0, ChangeState]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel y > 0
value = 3205
;--------------------------------------------------------------------------
[Statedef 3205]
Type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 3205



[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 3
x = 2
y = -4
[State 0, VelAdd]
type = Gravity
trigger1 = animelem = 3,>0

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = animelem = 3
statetype = A

[State 0, ChangeState]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel y > 0
value = 3206
;-------------------------------------------------------------------
[Statedef 3206]
Type = S
movetype = I
physics = N
velset = 0,0
ctrl = 0
anim = 3206

[state 4401, super jump landing]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 40,0
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = 4
ownpal = 1

[state 4401, super jump landing]
type = explod
trigger1 = time = 0
anim = 2001
postype = p1
pos = 40,0
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = -4
ownpal = 1

[state 4401, snd]
type = playsnd
trigger1 = time = 0
value = 0, 10

[State 4401, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 15



[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[statedef 3220]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = anim != 3220
value = 3220

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, SelfState]
type = SelfState
trigger1 = time; > 200
trigger1 = !gethitvar(isbound)
value = 5050

[statedef 3221]
type = L
movetype = H
physics = N
velset = 0,0
sprpriority = 0

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = !time
value = 5110

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 660, flatten]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1.1,0.75

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, SelfState]
type = ChangeState
trigger1 = time > 130
value = 3222

[statedef 3222]
type = S
movetype = H
physics = S
velset = 0,0
sprpriority = 0

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = !time
value = 5120

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = !animtime && anim = 5120
value = 5300

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, SelfState]
type = SelfState
trigger1 = time > 500
value = 0
ctrl = 1

[statedef 3223]
type = S
movetype = H
physics = N
velset = 0,0
sprpriority = 0

[State 0, HitFallSet]
type = HitFallSet
trigger1 = 1
value = 0

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = 1
value = 5000

[State 0, NotHitBy]
type = HitBy
trigger1 = 1
value = SCA,AA,AP,AT
value2= SCA,AA,AP,AT

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, SelfState]
type = SelfState
trigger1 = time > 30
value = 0
ctrl = 1

[statedef 3224]
type = A
movetype = H
physics = N
velset = 0,0
sprpriority = 0

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = 1
value = 5030

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, SelfState]
type = ChangeState
trigger1 = time > 30
value = 670
;===========================================================================
;  Rachelle Assist - EX Bust Rush
;===========================================================================

;Rachelle Jump in
[statedef 4000]
type    = A
movetype = I
physics = N
velset = 20,80
anim = 4000
ctrl = 0
sprpriority = -1

[state 4000, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4000, gravity]
type = gravity
trigger1 = 1

[State 4000, 1]
type = posadd
trigger1 = time = 0
trigger1 = BackEdgeDist < -310
x = 80

[state 4000, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4001

;---------------------------------------------------------------------------
;Rachelle Land
[statedef 4001]
type    = S
movetype = I
physics = N
velset = 0,0
anim = 4001
ctrl = 0
sprpriority = -1

[state 4001, snd]
type = playsnd
trigger1 = time = 0
value = 0, 7

[State 4001, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 10
ampl = 10

[state 4001, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4001, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4001, end]
type = changestate
trigger1 = animtime = 0
value = 4010


;---------------------------------------------------------------------------
;Rachelle Idle (will be taunt when animated)
[statedef 4005]
type    = S
movetype = I
physics = N
velset = 0,0
anim = 4005
ctrl = 0
sprpriority = -1

[state 4005, end]
type = changestate
triggerall = time > 24
trigger1 = roundstate = 2
trigger2 = roundstate = 3 || roundstate = 4
trigger2 = !root,alive
value = 4006

[state 4005, WIN end]
type = changestate
triggerall = time > 24
trigger1 = roundstate = 3 || roundstate = 4
trigger1 = root,alive
value = 4180

[state 4005, jumpdist]
type = parentvarset
trigger1 = time = 0
v = 38
value = ceil(rootdist x)

[state 4005, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause 

[state 4005, gethit]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1


;--------------------------------------------------------------------------
;Rachelle Exit
[statedef 4006]
type    = S
movetype = A
physics = N
velset = 0,0
ctrl = 0
sprpriority = -1

[state 4006, anim]
type = changeanim
trigger1 = time = 0
value = 4000

[state 4006, invun]
type = nothitby
trigger1 = 1
value = SCA

[State 4006, 2]
type = VelSet
trigger1 = AnimElem = 1
x = -50
y = -20

[State 4006, 4]
type = DestroySelf
trigger1 = BackEdgeDist < -220
trigger2 = time > 100


;----------------------------------------------------------------------------
;Rachelle Idle off screen
[Statedef 4007]
type = U
movetype = I
physics = N

[state 4007, anim]
type = changeanim
trigger1 = time = 0
value = 9999




;---------------------------------------------------------------------------
;Rachelle Bust Lunge
[statedef 4010]
type    = S
movetype = A
physics = N
velset = 0,0
ctrl = 0
sprpriority = -1

[state 4010, anim]
type = changeanim
trigger1 = time = 0
value = 4010
persistent = 0

[state 4005, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4005, gethit]
type = hitoverride
trigger1 = 1
trigger2 = movereversed
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[State 4010, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
animtype  = HEAVY
damage    = 120,12
getpower = 0
guardflag = MA
pausetime = 14,14
priority = 4,hit
sparkno = 3
id = 4010
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 28
ground.hittime  = 28
air.hittime = 48
ground.velocity = -37,0
air.velocity = -27,-15
ground.cornerpush.veloff = -20
guard.velocity = -40           
guard.hittime = 18
guard.slidetime = 28
airguard.velocity = -20,-2
guard.dist = 640

[state 4010, varset]
type = parentvarset
trigger1 = movehit
trigger1 = !enemynear,alive
var(36) = 1

[state 4010, Forward]
type = velset
trigger1 = anim = 4010
trigger1 = animelem = 2
x = 47

[state 4010, change animation]
type = changeanim
trigger1 = time > 30
trigger2 = p2bodydist x < 120
value = 4011
persistent = 0

[state 4010, slide]
type = velmul
trigger1 = anim = 4011
trigger1 = animelem = 2
x = 0.25

[state 4010, counter]
type = varadd
trigger1 = movehit
var(9) = -1
persistent = 0
ignorehitpause = 0

[state 4010, stop]
type = velset
trigger1 = anim = 4011
trigger1 = animelem = 3
x = 0

[state 4010, combo damage]
type = parentvaradd
trigger1 = movehit
v = 18
value = -18
persistent = 0

[state 4010, end]
type = changestate
trigger1 = anim = 4011
trigger1 = animtime = 0
value = 4005

;--------------------------------------------------------------------------
;Rachelle butt Drop
;--------------------------------------------------------------------------

;Rachelle Jump in
[statedef 4020]
type    = A
movetype = I
physics = N
velset = 20,80
anim = 4000
ctrl = 0
sprpriority = -1

[state 4020, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4020, gravity]
type = gravity
trigger1 = 1

[State 4020, 1]
type = posadd
trigger1 = time = 0
trigger1 = BackEdgeDist < -310
x = 80

[state 4020, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel  y
value = 4021

;---------------------------------------------------------------------------

;Rachelle intro Land
[statedef 4021]
type    = S
movetype = I
physics = N
velset = 0,0
anim = 4001
ctrl = 0
sprpriority = -1

[state 4021, snd]
type = playsnd
trigger1 = time = 0
value = 0, 7

[State 4021, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 10
ampl = 10

[state 4021, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4021, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4021, end]
type = changestate
trigger1 = animtime = 0
value = 4022

;---------------------------------------------------------------------------
;Rachelle Butt drop
[statedef 4022]
type    = A
movetype = A
physics = N
velset = 0,0
ctrl = 0
anim = 4020
sprpriority = -1

[state 4021, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4022, gethit]
type = hitoverride
trigger1 = 1
trigger2 = movereversed
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[State 4022, 2]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
animtype  = HEAVY
damage    = 160,16
getpower = 0
guardflag = HA
hitflag = MAF
pausetime = 14,14
priority = 4,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
fall = 1
ground.type = High
ground.slidetime = 32
ground.hittime  = 32
air.hittime = 48
ground.velocity = 0,10
air.velocity = 0,10
ground.cornerpush.veloff = -20
guard.velocity = -38           
guard.hittime = 22
guard.slidetime = 22
airguard.velocity = -28,-2
guard.dist = 640

[state 4021, varset]
type = parentvarset
trigger1 = movehit
trigger1 = !enemynear,alive
var(36) = 1

;Ride down mechanic
[state 1100, Ride down]
type = targetbind
trigger1 = movehit
pos = -20, 60

[state 4021, combo damage]
type = parentvaradd
trigger1 = movehit
v = 18
value = -9
persistent = 0

[state 1100, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype = A
trigger1 = p2life > 0
value = 1106

[state 1100, end]
type = targetstate
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1105
value = 661
;-----------------------------


[state 4020, Forward]
type = velset
trigger1 = anim = 4020
trigger1 = animelem = 3
x = ifelse(p2bodydist x >= 750, 23, ifelse(p2bodydist x < 750 && p2bodydist x >= 350, 14, 4))
y = -35

[state 4020, gravity]
type = gravity
trigger1 = pos y < -2

[state 4010, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4023

;--------------------------------------------------------------------------
;butt Drop Landing
[Statedef 4023]
type    = A
movetype= A
physics = N
anim = 4021
sprpriority = 2

[state 4023, size reduction]
type = angledraw
trigger1 = 1
scale = const(size.xscale)*0.42,const(size.yscale)*0.42


[state 4023, posadd]
type = posadd
trigger1 = time = 0
x = 40

[state 4023, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 4023, nothitby]
type = nothitby
trigger1 = 1
value = ,AP,AT
ignorehitpause = 1

[state 4023, gethit]
type = hitoverride
trigger1 = 1
trigger2 = movereversed
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[State 4023, 3]
type = HitDef
trigger1 = animelem = 1
attr = A, SA
getpower = 200
persistent = 0
HitFlag = D
hitsound = S1100,0
damage    = 180
guardflag = MA
priority = 4
nochainid = 1400
pausetime = 0,0
sparkno = -1
guardsound = S120, 0
p2stateno = 661
animtype = Heavy
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
fall.recover = 0

[state 4023, varset]
type = parentvarset
trigger1 = movehit
trigger1 = !enemynear,alive
var(36) = 1

[state 4023, freeze]
type = velset
trigger1 = time = 0
y = 0

[state 4023, bounce]
type = velset
trigger1 = time = 8
y = -10

[state 4023, gravity]
type = gravity
trigger1 = pos y < -2

[state 4023, x slow]
type = velmul
trigger1 = time = 0
x = 0.1

[state 4023, super jump landing]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 40,0
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = 4
ownpal = 1

[state 4023, super jump landing]
type = explod
trigger1 = time = 0
anim = 2001
postype = p1
pos = 40,0
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = -4
ownpal = 1

[state 4023, snd]
type = playsnd
trigger1 = time = 0
value = 0, 10

[State 4023, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 15

[state 4023, 3]
type = ChangeState
trigger1 = time > 8
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4024

;----------------------------------------------------------------
;land rest
[Statedef 4024]
type    = C
movetype= I
physics = C
anim = 4022

[state 4024, size reduction]
type = angledraw
trigger1 = 1
scale = const(size.xscale)*0.42,const(size.yscale)*0.42


[state 4024, nothitby]
type = nothitby
trigger1 = 1
value = ,AT
ignorehitpause = 1

[state 4024, gethit]
type = hitoverride
trigger1 = 1
trigger2 = movereversed
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[state 4024, on floor]
type = posset
trigger1 = time = 0
y = 0

[state 4024, velset]
type = velset
trigger1 = 1
x = 0
y = 0

[state 4024, end]
type = changestate
trigger1 = animtime = 0
value = 4005

;---------------------------------------------------------------
;Rachelle Sweep
;Rachelle Jump in
[statedef 4030]
type    = A
movetype = I
physics = N
velset = 20,80
anim = 4000
ctrl = 0
sprpriority = -1

[state 4000, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4000, gravity]
type = gravity
trigger1 = 1

[State 4000, 1]
type = posadd
trigger1 = time = 0
trigger1 = BackEdgeDist < -310
x = 80

[state 4000, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4031

;---------------------------------------------------------------------------
;Rachelle Land
[statedef 4031]
type    = S
movetype = I
physics = N
velset = 0,0
anim = 4001
ctrl = 0
sprpriority = -1

[state 4001, snd]
type = playsnd
trigger1 = time = 0
value = 0, 7

[State 4001, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 10
ampl = 10

[state 4001, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 4001, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4001, end]
type = changestate
trigger1 = animtime = 0
value = 4032

;---------------------------------------------------------------------------
;Rachelle Sweep
[statedef 4032]
type = C
movetype = A
physics = C
ctrl = 0
anim = 4030

[state 4032, gethit]
type = hitoverride
trigger1 = 1
trigger2 = movereversed
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[state 4032, nothitby]
type = nothitby
trigger1 = 1
value = , AT
ignorehitpause = 1

[state 4010, velset]
type = velset
trigger1 = animelem = 1
x = 60
persistent = 1

[state 4010, playerpush]
type = playerpush
trigger1 = 1
value = 1


[State 4032, 2]
type = HitDef
trigger1 = animelem = 3
trigger2 = animelem = 10
persistent = 0
attr = A, SA
animtype  = Heavy
damage    = 80
getpower = 0
hitflag = MAFD
guardflag = LA
pausetime = 12,12
priority = 4,hit
sparkno = 3
nochainid = 1400
sparkxy = -10,-90
hitsound   = S5000,2
guardsound = S120, 0
ground.type = trip
ground.slidetime = 32
ground.hittime  = 32
air.hittime = 48
ground.velocity = -2,-34
air.velocity = -2,-34
ground.cornerpush.veloff = -20
guard.velocity = -38           
guard.hittime = 22
guard.slidetime = 22
airguard.velocity = -28,-2
guard.kill = 0
guard.dist = 640

[state 4032, varset]
type = parentvarset
trigger1 = movehit
trigger1 = !enemynear,alive
var(36) = 1

[state 4032, combo damage]
type = parentvaradd
trigger1 = movehit
v = 18
value = -18
persistent = 0

[state 4032, end]
type = changestate
trigger1 = animtime = 0
value = 4005

;--------------------------------------------------------------------------
;Rachelle get the WIN
[statedef 4180]
type = S
movetype = I
physics = S
anim = 4180

[state 4180, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 1

[state 4005, jumpdist]
type = parentvarset
trigger1 = time = 0
v = 38
value = floor(rootdist x)

[State 20, 4]
type = EnvShake
trigger1 = animelemtime(1) = 2
trigger2 = animelemtime(5) = 1
time = 15
ampl = -4

[state 4180, move slightly]
type = velset
trigger1 = backedgedist < 500
x = ifelse(backedgedist < -10, 18, ifelse(backedgedist >= -10 && backedgedist < 80,12,6))

[state 4180, move slightly]
type = velset
trigger1 = backedgedist >= 500
x = 0

[state 4180, pos y]
type = posset
trigger1 = time = 0
y = 0



;===========================================================================
;Super Rachelle Portion
;===========================================================================
;Lunge Sandwich start
[statedef 4300]
type = A
movetype = A
physics = N
anim = 4005
sprpriority = 2

[state 4301, turn]
type = turn
trigger1 = time = 0

[state 4300, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4300, vel]
type = velset 
trigger1 = time = 0 
y = 0
x = 0

[state 4300, pos]
type = posset
trigger1 = time = 0 
y = 0

[state 4300, explod]
type = explod
trigger1 = anim = 4300
anim = 4320
postype = p1
sprpriority = -5
bindtime = -1
id = 4320
scale = const(size.xscale),const(size.yscale)

[state 4300, anim]
type = changeanim
trigger1 = time = 24
value = 4300
  

[state 4300, velocity]
type = velset
trigger1 = time = 24
y = -15
x = 45

[state 4300, gravity]
type = gravity
trigger1 = time > 24

[state 4300, end miss]
type = changestate
triggerall = time > 24
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4005

[state 4300, destroyself]
type = destroyself
trigger1 = parent,stateno != 3004

;---------------------------------------------------------------------------
; sandwich
[statedef 4301]
type = A
movetype = A
physics = N
sprpriority = 2

[state 4301, turn]
type = turn
trigger1 = time = 0

[state 4301, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4301, anim]
type = changeanim
trigger1 = time = 0
value = 4301

[state 4301, pos]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 4321, explod]
type = explod
trigger1 = time = 0
postype = p1
anim = 4321
sprpriority = -5
bindtime = -1
id = 4321
scale = const(size.xscale),const(size.yscale)

[state 3005, bounce off]
type = velset
trigger1 = time = 6
x = 0.25

[state 4321, bounce off]
type = velset
trigger1 = time = 36
x = -20
y = -15

[state 4321,gravity]
type = gravity
trigger1 = time > 37

[state 4321, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4005


;--------------------------------------------------------------------------

[statedef 4400]
type = S
movetype = A
physics = N
anim = 4400
velset = 0,0
sprpriority = 2

[State 0, NotHitBy]
type = HitBy
trigger1 = 1
value = SCA,AA,AP
time = -1

[state 4005, gethit]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP, AT
stateno = 4500
time = -1
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = p2dist X >= 650+enemynear,vel x
trigger1 = animelem = 2<0
value = 4400
elem = 1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2<0
x = 50

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2
x = 0

[state 4020, Forward]
type = velset
trigger1 = animelem = 4
x = ifelse(enemynear,gethitvar(xvel)<0&&enemynear,statetype = A,15-(enemynear,gethitvar(xvel)*.5),15)
y = -35

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "p2dist x = %d"
params = p2dist X

[state 4020, gravity]
type = gravity
trigger1 = animelem = 4,>0

[State 0, ScreenBound]
type = ScreenBound
trigger1 = animelem = 3,>=0
trigger1 = backedgedist>0
value = 1
movecamera = 0,0

[State 4022, 2]
type = HitDef
trigger1 = animelem = 9
attr = A, HA
animtype  = HEAVY
damage    = 80,8
getpower = 0
guardflag = HA
hitflag = MAFD
pausetime = 11,11
priority = 4,hit
sparkno = 3
sparkxy = -40,-300
hitsound   = S0,2
guardsound = S120, 0
fall = 1
fall.recover = 0 
ground.type = High
ground.slidetime = 32
ground.hittime  = 32
air.hittime = 48
ground.velocity = 0,10
air.velocity = 0,10
ground.cornerpush.veloff = -20
guard.velocity = -38           
guard.hittime = 22
guard.slidetime = 22
airguard.velocity = -28,-2
guard.dist = 640
p2facing = 1
id = 3200
p1sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
triggerall = NumTarget
trigger1 = target(3200),movetype = H
trigger1 = target(3200),stateno = 3220
value = SCA
ignorehitpause = 1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget(3200)
trigger1 = movehit
trigger1 = target(3200),movetype = H
trigger1 = target(3200),stateno!=[150,154]
value = 3220
ID = 3200

[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget
trigger1 = target(3200),movetype = H
trigger1 = target(3200),stateno = 3220
trigger1 = movehit
id = 3200
pos = 50,-30

[State 0, VarSet]
type = VarSet
triggerall = NumTarget
trigger1 = target(3200),movetype = H
trigger1 = target(3200),stateno = 3220
trigger1 = movehit
var(0) = 1

[state 4010, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4401

;-----------------------------------------------------------------------------
[statedef 4401]
type = S
movetype = A
physics = N
anim = 4401
velset = 0,0
sprpriority = 2

[state 4401, super jump landing]
type = explod
trigger1 = time = 0
anim = 2000
postype = p1
pos = 40,0
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = 4
ownpal = 1

[state 4401, super jump landing]
type = explod
trigger1 = time = 0
anim = 2001
postype = p1
pos = 40,0
scale = const(size.xscale)*2,const(size.yscale)*2
sprpriority = -4
ownpal = 1

[state 4401, snd]
type = playsnd
trigger1 = time = 0
value = 0, 10

[State 4401, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 20
ampl = 15

[State 0, NotHitBy]
type = notHitBy
trigger1 = 1
value = SCA
time = 1

[state 4005, gethit]
type = hitoverride
trigger1 = 1
attr = SCA,AA,AP,AT
stateno = 4500
time = -1
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[state 4023, size reduction]
type = angledraw
trigger1 = animelem = 5,<0
scale = const(size.xscale)*0.42,const(size.yscale)*0.42

[State 0, TargetState]
type = TargetState
triggerall = NumTarget(3200)
trigger1 = target(3200),stateno = 3220
trigger1 = !time
value = 3221
ID = 3200

[State 0, TargetBind]
type = TargetBind
triggerall = NumTarget(3200)
trigger1 = target(3200),stateno = 3220
trigger1 = !time
id = 3220
pos = 50,0

[State 0, Killswitch]
type = ChangeState
trigger1 = animelem = 6
trigger1 = !numtarget(3200)
value = 4006

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 7
x = 22
y = -16

[State 0, Gravity]
type = Gravity
trigger1 = animelem = 7,>0

[State 0, Killswitch]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 4402

;--------------------------------------------------------------------------------------
[statedef 4402]
type = S
movetype = I
physics = N
anim = 4402
velset = 0,0
sprpriority = 2

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[state 4005, gethit]
type = hitoverride
trigger1 = 1
attr = SCA,AA,AP,AT
stateno = 4500
time = -1
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, Turn]
type = Turn
trigger1 = animelem = 3

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "var(0) = %d  var(1) = %d"
params = var(0),var(1)

[State 0, VarSet]
type = VarSet
trigger1 = numtarget(3200)
trigger1 = target(3200),stateno = 3222
trigger1 = target(3200),time = 8
var(0) = 2
[State 0, VarSet]
type = VarSet
trigger1 = numtarget(3200)
trigger1 = target(3200),stateno = 3222
trigger1 = target(3200),time = 8
var(1) = target(3200),id
[State 0, TargetState]
type = TargetState
trigger1 = numtarget(3200)
trigger1 = target(3200),stateno = 3222
trigger1 = root,stateno = 3203
trigger1 = root,animelem = 4,>0
value = 3223
ID = 3200
;ignorehitpause = 
;persistent = 


[State 0, ChangeState]
type = ChangeState
trigger1 = root,stateno != [3200,3206]
trigger2 = root,movetype = H
value = 4006



;---------------------------------------------------------------------------
;Rachelle Gethit
[statedef 4500]
type = A
movetype = H
physics = N

[state 4500, anim]
type = changeanim
trigger1 = time = 0
value = 4500

[state 4500, DAMMIT Rachelle KO]
type = playsnd
trigger1 = parent,Var(32) <= 0
value = S4500, 0
persistent = 0

[state 4500, damage]
type = parentvaradd
trigger1 = time = 0
V = 32
value = -gethitvar(damage)
persistent = 1

[state 4005, nothitby]
type = nothitby
trigger1 = 1
value = ,AT

[state 4500, gravity]
type = gravity
trigger1 = 1

[state 4005, gethit]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[state 4006, invun]
type = nothitby
trigger1 = time < 12
value = SCA

[state 4500, velocity]
type = velset
trigger1 = time = 0
y = floor(gethitvar(yvel)*0.75)-5
x = floor(gethitvar(xvel)*0.5)-5

[state 4500, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 4510

;----------------------------------------------------------------------------
;Rachelle Bounce
[statedef 4510]
type = A
movetype = H
physics = N

[state 4510, stop]
type = velset
trigger1 = time = 0
y = 0

[state 4510, slow]
type = velmul
trigger1 = time = 0 
x = 0.25

[state 4510, snd]
type = playsnd
trigger1 = time = 0
value = 0, 7

[state 4005, gethit]
type = hitoverride
trigger1 = 1
attr = SCA, AA, AP
stateno = 4500
time = -1
ignorehitpause = 1

[State 4510, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 10
ampl = 9

[state 4510, anim]
type = changeanim
trigger1 = time = 0
value = 4510

[state 4500, pos]
type = posset
trigger1 = time = 0
y = 0

[state 4500, invun]
type = nothitby
trigger1 = time < 12
value = SCA

[state 4500, end]
type = changestate
trigger1 = animtime = 0
value = 4511
;--------------------------------------------------------------------------------
;Rachelle Bounce
[statedef 4511]
type = A
movetype = H
physics = N

[state 4511, anim]
type = changeanim
trigger1 = time = 0
value = 4511

[state 4511, vel]
type = velset
trigger1 = time = 0
y = -9

[state 4511, grav]
type = gravity
trigger1 = time > 1

[state 4500, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -Vel y
value = 4512



;---------------------------------------------------------------------------------
;Rachelle down
[statedef 4512]
type = A
movetype = H
physics = S
velset = 0,0

[state 4500, anim]
type = changeanim
trigger1 = time = 0
value = 4512

[state 4500, pos]
type = posset
trigger1 = time = 0
y = 0

[state 4500, invun]
type = nothitby
trigger1 = 1
value = SCA

[state 4500, end]
type = changestate
trigger1 = time > 40
value = 4006

[state 4512, snd]
type = playsnd
trigger1 = time = 0
value = 0, 7

[State 4512, 1]
type = EnvShake
trigger1 = time = 0
persistent = 0
time = 10
ampl = 8



;--------------------------------------------------------------------------
;Gustine Splash
[statedef 4700]
type = A
movetype = A
physics = N
anim = 4700
;facep2 = -1
sprpriority = 3

[state 4700, turn]
type = turn
trigger1 = time = 1


[state 4700, playsnd]
type = playsnd
trigger1 = time = 0
value = S3080,1
channel = 2

[state 4700, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4700, destroyself]
type = destroyself
trigger1 = movereversed
ignorehitpause = 1



[state 4700, gravity]
type = gravity
trigger1 = 1

[state 4700, gravity]
type = Playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4700, 3]
type = HitDef
trigger1 = 1
persistent = 0
attr = A, SA
damage = 0
hitflag = MAF
guardflag = HA
priority = 4
pausetime = 8,8
sparkno = 3
sparkxy = -20,-180
hitsound   = 5,4
guardsound = S120, 0
animtype = Med
id = 4700
ground.type = High
ground.slidetime = 35
ground.hittime  = 14
ground.velocity = 0,15
air.velocity = 0,0
guard.velocity = -90        
guard.hittime = 40
guard.slidetime = 40
airguard.velocity = -20,8
airguard.hittime = 40
guard.dist = 480

;Ride down mechanic
[state 4700, Ride down]
type = targetbind
triggerall = numtarget(4700)
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = -20, 60

[state 4700, state of ride down]
type = targetstate
triggerall = numtarget(4700)
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 1105

[state 4700, end]
type = targetstate
triggerall = numtarget(4700)
trigger1 = pos y > -2
trigger1 = enemy,stateno = 1105
value = 662
;-----------------------------

[state 1100, squash]
type = targetstate
triggerall = numtarget(4700)
trigger1 = enemy,statetype != A
trigger1 = movehit
value = 662

[state 4700, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4701

;------------------------------------------------------------------------
;1st Landing
[statedef 4701]
type = C
movetype = A
physics = N
anim = 4701
velset = 0,0
sprpriority = 2

[state 4701, stopsnd]
type = stopsnd
trigger1 = time = 0
channel = 2


[state 4701, snd]
type = playsnd
trigger1 = time = 0
value = S3080,2

[state 4701, snd]
type = playsnd
trigger1 = time = 0
value = S3080,2

[state 4701, envshake]
type = envshake
trigger1 = time = 0
ampl = -36
time = 32
freq = 75
phase = 75

[state 4701, explod]
type = explod
trigger1 = time = 0
anim = F61
scale = 4,4
pos = 0,0
sprpriority = -3



[state 4701, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4700, gravity]
type = Playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[State 4701, 3]
type = HitDef
trigger1 = animelem = 1
attr = C, SA
getpower = 0
persistent = 0
HitFlag = FD
hitsound = S1100,0
damage    = 200
priority = 4
pausetime = 0,0
sparkno = -1
guardsound = S120, 0
p2stateno = 662
animtype = Heavy
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
fall.recover = 0

[state 4010, varset]
type = parentvarset
trigger1 = movehit
trigger1 = !enemynear,alive
var(36) = 1

[state 4700, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4700, destroyself]
type = destroyself
trigger1 = movereversed
ignorehitpause = 1


[state 4701, gravity]
type = gravity
trigger1 = animelemtime(6) > 0

[state 4701, bounce]
type = velset
trigger1 = animelemtime(6) = 0
y = -12

[state 4701, end]
type = changestate
trigger1 = animelemtime(6) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 4702

;-----------------------------------------------------------------------
;2nd Landing
[statedef 4702]
type = L
movetype = I
physics = C
velset = 0,0
anim = 4702

[state 4702, snd]
type = playsnd
trigger1 = time = 0
value = S3080,2

[state 4702, envshake]
type = envshake
trigger1 = time = 0
ampl = -12
time = 12
freq = 75
phase = 75

[state 4702, posset]
type = posset
trigger1 = time = 0
y = 0

[state 4700, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4700, destroyself]
type = destroyself
trigger1 = movereversed
ignorehitpause = 1


[state 4702, changestate]
type = changestate
trigger1 = roundstate >= 3
trigger1 = animtime = 0
value = 4710


[state 4702, changestate]
type = changestate
trigger1 = roundstate = 2
trigger1 = animtime = 0
value = 4703

;-----------------------------------------------------------------------------
;Exit
[statedef 4703]
type = A
movetype = I
physics = N
anim = 4703

[state 4703, velset]
type = velset
trigger1 = animelemtime(4) = 0
x = -12

[state 4703, snd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = S3080,3
persistent = 0

[state 4703, fly away]
type = velset
trigger1 = animelemtime(7) = 0
x = -36
y = -20

[state 4700, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 4700, destroyself]
type = destroyself
trigger1 = movereversed
ignorehitpause = 1

[state 4703, display to clipboard]
type = displaytoclipboard
trigger1 = 1
text = "back edge body dist: %d"
params = backedgebodydist


[state 4703, low gravity]
type = veladd
trigger1 = animelemtime(7) > 0
y = 0.44

[state 4703, destroyself]
type = destroyself
trigger1 = backedgebodydist < -360
trigger2 = time = 120

;----------------------------------------------------------------------------------
;Gustine Win
[statedef 4710] 
type = S
movetype = I
physics = S
anim = 4710

[state 4180, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 1

[state 4180, pos y]
type = posset
trigger1 = time = 0
y = 0




;--------------------------------------------------------------------------
;Hud display
[statedef 4900]
type = A
movetype = I
physics = N
anim = 9999
ctrl = 0

[state 4900, value]
type = varset
trigger1 = 1
fvar(32) = root,var(32)
ignorehitpause = 1
persistent = 1

[state 4900, value]
type = varset
trigger1 = 1
fvar(34) = root,var(34)
ignorehitpause = 1
persistent = 1

;Rachelle health Bar
[state 4900, Icon]
type = explod
trigger1 = !numexplod(4900)
anim = 4900
id = 4900
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1, 12, 1268),130 ;ifelse(teamside =1, (gamewidth*0.01),(gamewidth*0.99)),floor((gameheight*0.18))
sprpriority = 5
OWNPAL = 1
bindtime = -1
removetime = -1

[state 4900, HP BAR]
type = explod
trigger1 = !numexplod(4910)
anim = 4910
id = 4910
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1, 102, 1178),158 ;ifelse(teamside =1,(gamewidth*0.08),(gamewidth*0.92)),floor((gameheight*0.22))
scale = 2, 2
sprpriority = 5
ownpal = 1
removetime = -1
bindtime = -1

[state 4900, HP BAR]
type = explod
trigger1 = !numexplod(4911)
anim = 4911
id = 4911
postype = left
facing = ifelse(teamside = 1,1,-1)
pos = ifelse(teamside = 1, 102, 1178),158 ;ifelse(teamside =1,(gamewidth*0.08),(gamewidth*0.92)),floor((gameheight*0.22))
Scale = 2,2
sprpriority = 5
ownpal = 1
bindtime = -1
removetime = -1





[state 4900, modifier HP bar]
type = modifyexplod
trigger1 = numexplod(4910)
id = 4910
anim = 4910
scale = ifelse(fvar(32)>0,((fvar(32)*1.0)/(fvar(34)*1.0))*2.0,0), 2
postype = left
pos = ifelse(teamside = 1, 102, 1178),158



;Alert
[state 4900, alert]
type = explod
trigger1 = root,var(29) = 3
trigger1 = numexplod(4920) = 0
trigger1 = root,var(32) > 0
anim = 4920
id = 4920
postype = left
facing = ifelse(teamside = 1,1,1)
pos = ifelse(teamside = 1, 192, 1024),130 ;ifelse(teamside =1,(gamewidth*0.15),(gamewidth*0.80)),floor((gameheight*0.18))
scale = 1,1
ontop = 1
ownpal = 1
removetime = -1

[state 4900, remove]
type = removeexplod
trigger1 = root,var(29) < 3
id = 4920
persistent = 1

[state 4900, destroyself]
type = destroyself
trigger1 = roundstate = 4

;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy's projectile (helper). For use with AI.
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy's projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy's projectile helper's distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy's projectile helper's velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
 
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
;==========================================================================
;                Detect Enemy's Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = cond(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = cond(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = cond(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = cond(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = cond(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = cond(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = cond(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = cond(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = cond(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = cond(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 






;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------
; Use Common1.cns

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------
[statedef -2]

;=======================AI Detect Projectile System==========================
[state -2, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1



[state -2, helper]
type = helper
trigger1 = roundstate = 2
trigger1 = !numhelper(4900) 
name = "Rachelle Hud"
helpertype = normal
stateno = 4900
postype = p1
pos = 0,0
id = 4900
persistent = 300
ignorehitpause = 1

;------------------------------------------------

;===============================================================================
; Simple Counter
;===============================================================================

[state -2, counter]
type = varset
trigger1 = gethitvar(damage) != 0
v = 31
value = 0
ignorehitpause = 1

[state -2, count up]
type = varadd
trigger1 = var(31) < var(33)
v = 31
value = 1
ignorehitpause = 0

[state -2, delay conter set]
type = varset
trigger1 = 1
v = 33
value = 90

[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(8) = 2
ignorehitpause = 1

[state -2, bite grab Limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(9) = 2
ignorehitpause = 1

[state -2, throw-moonsault damage check]
type = varset
triggerall = numenemy
trigger1 = enemynear, movetype != H
var(16) = 0
ignorehitpause = 1

[state -2, Rachelle healing]
type = varadd
triggerall = numhelper(4000) =0
triggerall = roundstate = 2
triggerall = var(32) > 0
trigger1 = gametime%60 = 5
trigger1 = var(32) < var(34)
v = 32
value = 2

[state -2, Jump infinite check]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(39) = 1
ignorehitpause = 1

[state -2, rachelle wait time]
type = varset
trigger1 = roundstate = 2
trigger1 = numhelper(4000) != 0
v = 29
value = 0

[state -2, rachelle wait time]
type = varset
trigger1 = roundstate = 1
v = 29
value = 3

[state -2, count]
type = varadd
trigger1 = roundstate = 2
trigger1 = numhelper(4000) = 0
trigger1 = gametime%45 = 1
trigger1 = var(29) < 3
v = 29
value = 1

;Rage mechanic - If partner is injured point character gets upset

[state -2, Katrina calm]
type = varset
trigger1 = var(32) >=  floor(var(34)/2)
value = 1
fv = 35

[state -2, Katrina Angry]
type = varset
trigger1 = var(32) <  floor(var(34)/2)
value = 1.25
fv = 35

[state -2, Katrina Pissed]
type = varset
trigger1 = var(32) <= 0
value = 1.5
fv = 35

;===========================================================================
;AI Charge Checks
;===========================================================================

[state -2, X charge counter]
type = varadd
trigger1 = var(41) < 60
var(41) = 1
ignorehitpause = 0

[state -2, X charge reset]
type = varset
trigger1 = stateno = 20
trigger1 = vel x > 0
trigger2 = stateno = 100
trigger3 = stateno = [40,50]
trigger3 = vel x > 0
trigger4 = stateno = 105
trigger4 = time = 0
var(41) = 0

[state -2, X confirm]
type = varset
trigger1 = var(41) = 60
var(42) = 1

[state -2, X deny]
type = varset
trigger1 = var(41) != 60
var(42) = 0

[state -2, Y charge counter]
type = varadd
trigger1 = var(43) < 60
var(43) = 1
ignorehitpause = 0

[state -2, Y charge reset]
type = varset

trigger1 = stateno = 100
trigger2 = stateno = [40,42] 
trigger2 = time = 0
trigger3 = stateno = 105  && time = 0
;trigger4 = stateno = 130 && time = 0
;trigger5 = stateno = 20
var(43) = 0

[state -2, y confirm]
type = varset
trigger1 = var(43) = 60
var(44) = 1

[state -2, y deny]
type = varset
trigger1 = var(43) != 60
var(44) = 0


;===========================================================================

;Combo Damage Dampener

;===========================================================================

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar(10) * fvar(35)
ignorehitpause = 1

[state -2, removexplod]
type = removeexplod
trigger1 = stateno != 3004
id = 3020

[state -2, removexplod]
type = removeexplod
trigger1 = stateno != 3005
id = 3021

[state -2, removexplod]
type = removeexplod
trigger1 = stateno != 3004
id = 4320

[state -2, removexplod]
type = removeexplod
trigger1 = stateno != 3005
id = 4321

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger2 = !numenemy
ignorehitpause = 1
v = 18
value = 100

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05

[state -2, distance check]
type = displaytoclipboard
trigger1 = 1
text = "Distance X: %d , Y: %d  Position x: %d Front edge: %d, Combo Scaling: %d Rachelle health: %d ";, R. timer %d"
params = p2bodydist x, p2bodydist y, pos x, frontedgebodydist , var(18), var(34); , var(29)

;===================================================
;--------------|Win Quotes|-------------------------
;===================================================
[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%5)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Jumbo Elephant"
value = 12+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ana 'Jiggly' Bunny"
value = 9+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Bertha Hippo"
value = 6+(random%3)
ignorehitpause
persistent = 1


[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Leonardo M/TF" || enemy,name = "DCatLeonardo"
value = 15+(random%3)
ignorehitpause
persistent = 1


[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Raphael M/TF" || enemy,name = "DCatRaphael"
value = 18+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Michealangelo M/TF" || enemy,name = "DCatMichealangelo"
value = 21+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Donatello M/TF" || enemy,name = "DCatDonatello"
value = 24+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Armgon M/TF"
value = 27+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "A Pair Of Jiggling Tits"
value = 30+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Power Girl"
value = 33+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Katrina Crocodile"
value = 36+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "RenamonDv2"
value = 39+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Lucario"
trigger1 = enemy, authorname = "Moku"
value = 42+(random%2)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Lardo Rat"
value = 45+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Zafta Giraffe"
value = 48+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Makuyama"
value = 51+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Pastilla Skunk"
value = 54+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Jumba Elephant"
value = 57+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Aroma Skunk"
value = 60+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Twiggi Bunny"
value = 63+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ra Lord"
value = 66+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,Name = "Ryu"
trigger2 = enemy,name = "Evil Ryu"
value = 69
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Violet 'Tyla' Bunny"
value = 70+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Battu Tri-red"
value = 73+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Julian Hippo"
value = 76+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Enorma Pig"
value = 79+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Rapid Bunny"
value = 82+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Noah Sharker"
value = 85+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Akai R. Panda"
value = 88+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Andy Armadillo"
value = 91+(random%3)
ignorehitpause = 1
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Montana Moth"
value = 94+(random%3)
ignorehitpause = 1
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy,name = "Texas Stanton"
value = 97+(random%3)
ignorehitpause = 1
persistent = 1



;------
;Skip


;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.
[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
trigger3 = stateno = 182
value = S0, 7

[State -3, quakes]
type = envshake
triggerall = time = 1
trigger1 = stateno = 5100
time = 10
ampl = 8

[State -3, sfx]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 5100
value = S0,7 

[state -3, gravity]
type = gravity
trigger1 = stateno = 5620
trigger1 = time > 0

[state -3, land]
type = changestate
triggerall = stateno = 5620
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


[Statedef 3050]
Type = S
movetype = A
physics = N
velset = 0,0
ctrl = 0
anim = 3050

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, force center]
Type = PosAdd
trigger1 = facing = 1
trigger1 = Pos X != -360
x = ifelse(pos X > -360,-34,34)
IgnoreHitPause = 1
[State 0, force center]
Type = PosAdd
trigger1 = facing = -1
trigger1 = Pos X != 360
x = ifelse(pos X < 360,-34,34)
IgnoreHitPause = 1
[State 0, force center]
Type = PosSet
trigger1 = facing = 1
trigger1 = Pos X = [-394,-326]
x = -360
IgnoreHitPause = 1
[State 0, force center]
Type = PosSet
trigger1 = facing = -1
trigger1 = Pos X = [326,394]
x = 360
IgnoreHitPause = 1

[State 0, DisplayToClipboard]
type = DisplayToClipboard
trigger1 = 1
text = "backedgedist = %f frontedgedist = %f Pos X = %d"
params = backedgedist,frontedgedist, pos X
ignorehitpause = 1

[State 0, TargetBind]
type = TargetBind
trigger1 = numtarget
pos = 250,0
[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = !time
value = 3070

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,0

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1

[Statedef 3070]
Type = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time <= 11
value = 5002
[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !animtime && anim = 5002
value = 5007
[State 0, ChangeAnim]
type = ChangeAnim
triggerall = selfanimexist(5300)
trigger1 = !animtime && anim = 5007
trigger2 = time > 42 && anim != 5300
value = 5300

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 0, ChangeState]
type = SelfState
trigger1 = Time > 350
value = 0
ctrl = 1

























