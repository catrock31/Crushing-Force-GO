; KFM's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 1200
power = 5000
;attack power (more is stronger)
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 85
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 0.72           ;Horizontal scaling factor.
yscale = 0.72           ;Vertical scaling factor.
ground.back = 80     ;Player width (back, ground)
ground.front = 80    ;Player width (front, ground)
air.back = 12        ;Player width (back, air)
air.front = 12       ;Player width (front, air)
height = 294         ;Height of player (for opponent to jump over)
attack.dist = 160    ;Default attack distance
proj.attack.dist = 90 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = 8, -268   ;Approximate position of head
mid.pos = -5, -130    ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 3.5   ;Walk forward
walk.back = -4    ;Walk backward
run.fwd  = 8, 0    ;Run forward (x, y)
run.back = -10,-7 ;Hop backward (x, y)
jump.neu = 0,-18   ;Neutral jumping velocity (x, y)
jump.back = -5.5   ;Jump back Speed (x, y)
jump.fwd = 5.5      ;Jump forward Speed (x, y)
runjump.back = -2.55,-8.1 ;Running jump speeds (opt)
runjump.fwd = 9,-9      ;.
airjump.neu = 0,-8.1      ;.
airjump.back = -2.55      ;Air jump speeds (opt)
airjump.fwd = 2.5         ;.
air.gethit.groundrecover = -.15,-3.5  ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-4.5    ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -1       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -2         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 1.5      ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 0       ;Number of air jumps allowed (opt)
airjump.height = 35   ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.0          ;Vertical acceleration
stand.friction = .775  ;Friction coefficient when standing
crouch.friction = .770 ;Friction coefficient when crouching
stand.friction.threshold = 2          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .05       ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 25           ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -20 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 10   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -1  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.0    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 15      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 20            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.2               ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 12          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .05         ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes (optional).  **MUGEN 1.0**
;If this section is included, the default language victory quotes must be in English.
[Quotes]
victory1 = "I may not be much of a fighter, but it's not like a multiton hippo isn't dangerous."
victory2 = "I don't sweat baby, I glisten."
victory3 = "You didn't really put up a struggle. Did you just wanna get close to me?"
victory4 = "This tattoo is for everyone. It tells haters to 'kiss my ass', and spreads love to my allies."
victory5 = "I have no bad sides, but if you mess with me, you'll probably end up on my underside."
victory6 = "You're gonna smother this ass with affection, or it's gonna smother you."
victory7 = "If I am a joke character, then sitting on your face must be my punch line."

; Vs Jumbo, Julian's boss
victory8 = "The way you fill out that spandex is incredible, boss!"
victory9 = "Your strength is terrifying, but that ass is quite nice to look at."
victory10 = "I don't think I wanna work for you anymore."

; Vs Jiggly, no association
victory11 = "Wow, you're pretty fast for a bunny!"
victory12 = "Your butt attacks seem so fun! I may have to practice doing that."
victory13 = "Your agility at that size is inspiring. I didn't think wide frames like ours could be so swift!"

; Vs Katrina, no association, Julian doesn't know who Bertha is
victory14 = "Whoa now! What have you got against me? I don't even know Bertha personally, but I do know her brother."
victory15 = "Your outfit is so cool, how does it even stay on you?"
victory16 = "An assist character sounds fun! Shame a friend of mine ran late for this."

;vs Bertha, fellow hippo
Victory17 = "How is your ass so unstoppable?! We're both nearly the same size, and I can't do that!"
victory18 = "If you're willing, it would be great to trade some techniques with you."
Victory19 = "Your figure is amazing! It's a good thing you have a brother."

;vs Aroma, Stinky girl
Victory20 = "I'm gonna need to take multiple showers after fighting you."
victory21 = "I see how your techniques work, but they're still gross."
victory22 = "How do you live with yourself using such techniques? I feel the need to shower before I even think about sitting on anyone, much less fart in their face."

;vs Enorma, Gun-toting girl
victory23 = "Naw girl, the only things I'll tolerate being shot with are cameras."
victory24 = "Shoot me again, and you're gonna end up in a butt-shaped crater."
victory25 = "I'm so used to being shot with insults; I don't think I wanna be literally shot at ever again."

;vs Lardo, Obese rat, co-worker
Victory26 = "You're cute Lardo, but you should definitely shower more often."
Victory27 = "You have a cute face, but you're such a slob. Could you, ya know, fart a little less at least?"
Victory28 = "Try to eat me again, and you're gonna end up under mountains of ass... That's not a reward either, it's a threat, but that probably doesn't work on you."

;Vs Zafta, Super Tall Giraffe
victory29 = "Is there any way you can take a photo of me? I already have so many images of me being looked up to, it would be nice to see a different perspective."
victory30 = "Your kicks really hurt! That range must be nice to have."
victory31 = "You may have more range and damage, but you're not more durable than me."

;vs Makuyama, Julian's boyfriend
victory32 = "Oh wow, I didn't expect to beat you! We're still together, right?"
victory33 = "I didn't mean to drop it all on you like that! You've handled a lot in the past, I figured you could take it."
victory34 = "Let me help you up Maku, I think you know I can defend myself quite well now."

;vs Pastilla, A Witch Julian has no knowledge of
victory35 = "A centaur skunk-hippo poison witch? You must be easy to spot in a crowd."
victory36 = "Yeesh, you're even more gross than another skunk girl I ran into."
victory37 = "Don't you dare change my size! It's infuriating you can do that to others!"

;vs Jumba, Elephant ninja
victory38 = "I'm impressed with your skills Jumba! And I'm not saying that just 'cause I work for your brother."
victory39 = "If Jumbo could do what you do, or at least have a visual upgrade, that would be something."
victory40 = "A five ton ninja loses to a three ton model in a fight. Seems I take more care of my body than you thought."

;vs Twiggi, Skinny witch with an elephant girlfriend
Victory41 = "You two are such a great couple! I love the contrast in size you two provide."
victory42 = "You may try to zone me, but I can take a whole lot more hits than you can."
Victory43 = "I was worried that I'd crush you too hard, apparently I did."

;vs Violet, Attractive ninja that wants to be seen.
victory44 = "What type of ninja wants to be in front of a camera?"
victory45 = "I would love to wear your outfits!"
victory46 = "That butt bounce of yours seems really fun to do!"

;Vs Ra, Snake man that he doesn't know much about.
victory47 = "You remind me of some anime-type fighters."
victory48 = "I don't know who or what you are, but you're still not resistant to being crushed."
victory49 = "Your range and speed is hard to handle, it's a good thing I have a thick hide!"

;Vs Battu, Thick alien space rodent with a fine ass
victory50 = "All the planets in the universe, and you came all the way here to get sat on... I'm flattered."
victory51 = "You're suprisingly dangerous for someone so small! I shouldn't underestimate you anymore."
victory52 = "I'm pretty sure you'll not be able to take even one of your eyes off me if we meet again."

;Vs Himself, Julian Hippo
victory53 = "I already love looking at myself, guess fighting myself is the next best thing."
victory54 = "I won a battle against myself?  I don't know how I should feel about that..."
victory55 = "There can't be two Julian Hippos in this world."

;vs Rapid, speedster Bunny that has a gay brother he recognizes.
victory56 = "Bertha is fortunate to have such a cute boyfriend like you.  The size contrast is beautiful to see."
victory57 = "I have thick skin a few tons more mass than you do bun, so you're fast and puny strikes may not work for ya." 
victory58 = "I don't think you stand a chance fighting a hippo, but you are cute."

;Vs Noah, demon shark boi
victory59 = "You're cute and all but I already knew I was gonna squash you once you started shooting at me."
victory60 = "I consider myself nice but if you shoot at me like that again you're gonna find yourself under the fattest part of my ass."
victory61 = "Thick skin, some oils and a sexy frame are all it takes to beat a demon shark and his entourage."

;vs Andy
victory62 = "That fancy armor of yours couldn't handle all this ass coming down on you."
Victory63 = "I wish I could see more of you with out the armor.  You're pretty cute outside of it."
victory64 = "For such a durable man, my ass did still run you over all the same."

;vs Montana
Victory65 = "You're a beautiful looking moth, I love sharing the runway with you."
victory66 = "You can eat these shorts if you like but you'll have to face dive for them."
victory67 = "You have fun looking squashing techniques its a treat to see them in action and learn from them."

;vs Texas
Victory68 = "Being confident in ones own skin is extremely important.  I'll never see my attire as a bad thing regardless of what a silly law says."
Victory69 = "Welcome to the city country girl, don't mess with the big body hippos unless you wanna end up smothered."
Victory70 = "I hope they have good medics in Gold Springs.  Since I came down on you pretty rough."
;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
; var(12) - Camera Flash Charges

;var(41) - X axis charge counter
;var(42) - X axis approval
;var(43) - y Axis charge counter
;var(44) - y axis approval
;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = Time = 0
value = 182

;---------------------------------------------------------------------------
; Win pose 1 - Bow
; CNS difficulty: basic
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[state 181, width]
type = width
trigger1 = 1
edge = 150,150

 


[state 1200, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = -10

[state 1200, velset]
type = velset
trigger1 = animelemtime(5) = 0
x = 0

[state 52, dust]
type = explod
trigger1 = animelemtime(6) = 0
anim = F120
pos = 120,0
scale = 2, 2
sprpriority = 2

[state 44, fx]
type = explod
trigger1 = animelemtime(6) = 0
anim = F61
pos = 0,0
scale = 3,1.5

[state 52, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 20,0

[state 52, dust]
type = explod
trigger1 = animelemtime(6) = 0
anim = F120
pos = -110,0
scale = 2, 2
sprpriority = 2

[state 20, earthquakes]
type = envshake
trigger1 = animelemtime(6) = 0
time = 12
ampl = -8
freq = 100
phase = 100

[state 1200, slap sound]
type = playsnd
trigger1 = animelemtime(14) = 0
value = 20,1

[state 1200, slap sound]
type = playsnd
trigger1 = animelemtime(14) = 0
value = 20,1

[state 1200, slap sound]
type = playsnd
trigger1 = animelemtime(14) = 0
value = 20,1
;---------------------------------------------------------------------------
;Stand and wait
[statedef 182]
type = S
ctrl = 0
velset = 0,0

[state 182, width]
type = width
trigger1 = 1
value = 120,120

[state 182, assertspecial]
type = assertspecial
trigger1 = 1
flag = roundnotover

[state 182, helper]
type = Helper
trigger1 = !numhelper(185)
stateno = 185
id = 185
name = "Bunny assist"
postype = p1
pos = -1200,0
scale = const(size.xscale),const(size.yscale)

[state 182, changestate]
type = changestate
trigger1 = numhelper(185)
trigger1 = helper(185),stateno = 186
trigger1 = helper(185),animelemtime(4) = 1
value = 183 

;---------------------------------------------------------------------------
;get slapped
[statedef 183]
type = S
ctrl = 0
anim = 182

[state 182, width]
type = width
trigger1 = 1
value = 120,120

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
value = S180,2
channel = 1

[state 18x, Win snd announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
value = S180,2
channel = 1

[state 183, explod]
type = explod
trigger1 = time = 0
anim = 183
id = 183
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removetime = -1
removeongethit = 1
sprpriority = 5

[state 183, groundshake]
type = envshake
trigger1 = animelem = 10
time = 12
ampl = -8

[state 52, playsnd]
type = playsnd
trigger1 = animelem = 10
value = S20,0

[state 183, end]
type = assertspecial
trigger1 = time < 210
flag = roundnotover
ignorehitpause = 1



;---------------------------------------------------------
[statedef 185]
type = S
anim = 185
physics = N

[state 185, velset]
type = velset
trigger1 = time = 0
x = 24

[state 185, screendbound]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 185, changestate]
type = changestate
trigger1 = parentdist x < 190
value = 186

[state 185, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance from Julian: %f"
params = parentdist x


;---------------------------------------------
[statedef 186]
type = S
anim  = 186
velset = 0,0

[state 185, screendbound]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 186, leaves]
type = velset
trigger1 = animelemtime(7) = 0
x = -24

[state 183, slap snd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S180,0

[state 183, slap snd]
type = playsnd
trigger1 = animelemtime(5) = 1
value = S180,0

[state 185, displaytoclipboard]
type = displaytoclipboard
trigger1 = 1
text = "Distance from Julian: %f"
params = parentdist x

[state 186, destroystate]
type = destroyself
trigger1 = backedgebodydist < -30
trigger1 = animelemtime(7) > 0


;---------------------------------------------------------------------------
; Introduction
;Butt rub
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0
sprpriority = 1

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 0.5,0.5
postype = Back
pos = ifelse(facing =1, 20, 157),180 ; Nice!
ontop = 1

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[state 191, helper 1]
type = helper
trigger1 = numhelper(191) < 2
trigger1 = Roundstate = 0
postype = p1
pos = 97,2
stateno = 193
sprpriority = 3
id = 191
scale = const(size.xscale),const(size.yscale)

[state 191, helper 2]
type = helper
trigger1 = numhelper(191) < 2
trigger1 = Roundstate = 0
postype = p1
stateno = 193
pos = -3,12
sprpriority = 3
id = 191
scale = const(size.xscale),const(size.yscale)

[state 191, explod]
type = explod
trigger1 = !numexplod(196)
trigger1 = roundstate = 0
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
anim = 196
id = 196
removetime = 188

[state 191, explod]
type = explod
trigger1 = !numexplod(197)
trigger1 = roundstate = 0
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 3
anim = 197
id = 197
removetime = 188




[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = time = 180
value = 192



;------------------------------------------------------------------
;go to stance
[statedef 192]
type = S
ctrl = 0
anim = 193
velset = 0,0

[state 192, removeexplod]
type = removeexplod
trigger1 = animelemtime(2) = 0
id = 196

[state 192, removeexplod]
type = removeexplod
trigger1 = animelemtime(2) = 0
id = 197

[state 192, end]
type = changestate
trigger1 = animtime = 0
value = 0

;--------------------------------------------------------------------
;HelperBunnies
[statedef 193]
type = S
ctrl = 0
anim = 191
sprpriority = 3

[state 193, end]
type = changestate
trigger1 = time > 180+(random%48)
value = 194

;---------
;Exit
[statedef 194]
type = S
ctrl = 0
physics = N
anim = 192
sprpriority = 3

[state 194, turn]
type = turn
trigger1 = time = 0

[state 194, velset]
type = velset
trigger1 = time = 0
x = 18
y = -6

[state 194, veladd]
type = veladd
trigger1 = time > 0
y = 0.33

[state 194, end]
type = destroyself
trigger1 = time > 120
trigger2 = frontedgebodydist < -30



;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Stand Light Punch
; CNS difficulty: easy
[Statedef 200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes
;Commonly-used controllers:
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 200                       ;Change animation (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 25, 0                   ;Damage that move inflicts, guard damage
animtype = med                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8, 8                 ;Time attacker pauses, time opponent shakes
sparkno = 0                      ;Spark anim no (Def: set above)
sparkxy = -10, -160              ;X-offset for the "hit spark" rel. to p2,
;Y-offset for the spark rel. to p1
hitsound = S5000, 0                  ;Sound to play on hit
guardsound = S120, 0                ;Sound to play on guard
ground.type = High              
ground.slidetime = 12           
ground.hittime  = 12             
ground.velocity = -5            
airguard.velocity = -6,-1    
air.type = High                 
air.velocity = -1.4,-3           
air.hittime = 16
fall.recovertime = 30
guard.hittime = 13
guard.slidetime = 13
guard.velocity = -8  
guard.dist = 640     

[State 200, 2]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------

[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 30
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -2

[state 210, Not Active]
type = statetypeset
trigger1 = animelemtime(8) = 0
movetype = I

[State 210, Width]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (7) < 0)
value = 15,0

[State 210, 1]
type = PlaySnd
trigger1 = Time = 10
value = S210, 0

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA
animtype  = Medium
damage    = 70,7
guardflag = MA
pausetime = 14,14
sparkno = 2
id = 210
sparkxy = -10,-210
hitsound   = S5000,2
guardsound = S120,0
ground.type = High
ground.slidetime = 33
ground.hittime  = 33
ground.velocity = -16
air.velocity = -8,-2
envshake.ampl = -8
envshake.time = 14
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -18
airguard.hittime = 20
airguard.velocity = -6,0
guard.dist = 640
guard.kill = 0

[state 210, earthquakes]
type = envshake
trigger1 = animelemtime(7) = 0
ampl = -8
phase = 100
freq = 100
time = 10
persistent = 1
ignorehitpause = 1

[state 20, Footsteps]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 20,0
channel = 2
ignorehitpause = 1
persistent = 1

[state 52, dust]
type = explod
trigger1 = animelemtime(7) = 0
anim = F120
pos = 133,0
scale = 2, 2
sprpriority = 4

[state 52, dust]
type = explod
trigger1 = animelemtime(7) = 0
anim = F120
pos = 60,0
scale = 2, 2
sprpriority = 4


;====================
;Movement
;====================

[state 210, moveforward]
type = posadd
triggerall = p2bodydist x > 60
trigger1 = animelemtime(4) = 0
x = 60

[state 210, moveforward]
type = posadd
triggerall = p2bodydist x > 100
trigger1 = animelemtime(5) = 0
x = 100

[state 210, moveforward]
type = posadd
triggerall = p2bodydist x > 45
trigger1 = animelemtime(6) = 0
x = 45

[state 210, moveforward]
type = posadd
trigger1 = animelemtime(7) = 0
x = -10

[state 210, moveback]
type = posadd
trigger1 = animelemtime(10) = 0
x = -85

[state 210, moveback]
type = posadd
trigger1 = animelemtime(11) = 0
x = 0

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 11
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 2
value = S200, 0

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 30
guardflag = MA
pausetime = 8,8
sparkno = 0
sparkxy = -10,-105
hitsound   = S5000,1
guardsound = S120,0
ground.type = Low
fall.recovertime = 30
ground.slidetime = 15
ground.hittime  = 15
ground.velocity = -8
air.velocity = -2,-8
guard.velocity = -12
guard.slidetime = 14
guard.hittime = 14
guard.dist = 360

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
juggle  = 5
poweradd= 30
ctrl = 0
velset = 0,0
sprpriority = -2

[State 240, 1]
type = PlaySnd
trigger1 = animelem = 5
trigger1 = anim = 240
trigger2 = anim = 241
trigger2 = animelem = 2
value = S240, 0
persistent = 0

[state 240, anim]
type = changeanim
triggerall = prevstateno != 240
trigger1 = prevstateno != 210
trigger1 = anim != 240
value = 240

[state 240, anim]
type = changeanim
triggerall = prevstateno != 240
trigger1 = prevstateno = 210
trigger1 = anim != 241
value = 241

;===========
;Armor start
;==========
[state 240, armor counter]
type = varset
triggerall = prevstateno != 240
trigger1 = time = 0
trigger1 = anim = 240
V = 20
value = 2

[state 240, excess armor check]
type = varset
trigger1 = var(20) > 2
var(20) = 2
persistent = 1
ignorehitpause = 1

[state x, armor over]
type = varset
trigger1 = anim = 240
trigger1 = animelem = 9
trigger2 = anim = 241
trigger2 = animelem = 6
v = 20
value = 0
ignorehitpause 

;determine what frame
[state 240, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.75)
value = anim
elem = var(22)

[state 240, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.75)
value = 1
;--------------------------

[state 240, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 240, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

[state 240, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 240
time = 1
persistent = 1

[State 240, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 240, armor end]
type = varset
trigger1 = animelemtime(8) = 0
var(20) = 0
ignorehitpause = 1

;----------------------------------------------------------------


[State 240, 2]
type = HitDef
trigger1 = !movecontact
attr = S, NA
animtype  = back
damage    = 100,10
guardflag = MA
id = 240
nochainid = 240
pausetime = 18,18
guard.pausetime = 12,12
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
p1sprpriority = -2
ground.type = high
ground.slidetime = 26
ground.hittime  = 26
ground.velocity = -24,8
air.velocity = -24,8
guard.velocity = -25
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -16,-2
airguard.hittime = 20
fall = 1
fall.recover = 1
fall.recovertime = 24
guard.kill = 0
guard.dist = 480
envshake.ampl = -8
envshake.time = 18


[state 240, butt cheek]
type = explod
triggerall = numexplod(240) = 0
trigger1 = anim = 240
trigger1 = animelemtime(7) = 0
trigger2 = anim = 241
trigger2 = animelemtime(4) = 0
anim = 242
id = 240
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
bindtime = -1
ignorehitpause = 0
sprpriority = 4

[State 240, 3]
type = veladd
trigger1 = anim = 240
trigger1 = AnimElemtime(1) > 0 && animelemtime(4) < 0
x = 2

[State 240, 3]
type = velAdd
trigger1 = anim = 240
trigger1 = AnimElemtime(7) = 0
trigger2 = anim = 241
trigger2 = animelemtime(4) = 0
x = 24

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 240, Not Active]
type = statetypeset
trigger1 = animelemtime(8) = 0
trigger1 = anim = 240
trigger2 = anim = 241
trigger2 = animelemtime(5) = 0
movetype = I

[State 240, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light punch
; CNS difficulty: easy
; Description: Simple crouching attack. The HitDef's guardflag parameter
;     is set to "L", meaning that the move can only be guarded low
;     (crouching), and not by standing or jumping opponents.
;     Like for all light attacks, it's a good idea to keep the slidetime
;     and hittime parameters at a smaller number, so the opponent isn't
;     stunned for too long. For all crouching attacks you have to
;     remember to set the attr parameter to indicate that it is crouching
;     attack. In this case, "C, NA" stands for "crouching, normal attack".
;     The HitDef's priority is set at 3, instead of the default of 4,
;     so this attack has a lower priority than most others, meaning
;     KFM will get hit instead of trading hits with his opponent if
;     their attack collision boxes (Clsn1) intersect each other's Clsn2
;     boxes at the same time.
[Statedef 400]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 8
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 25
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = MA
pausetime = 6,6
sparkno = 0
sparkxy = -10,-42
hitsound   = S5000,0
guardsound = S120,0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 12
air.hittime = 18
fall.recovertime = 18
guard.hittime = 12
airguard.hittime = 14
guard.slidetime = 12
guard.velocity = -10
ground.velocity = -8
air.velocity = -4,-6
guard.dist = 480

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1


[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 410]
type    = C
movetype= A
physics = C
juggle  = 6
poweradd= 25
ctrl = 0
anim = 410
sprpriority = 2

[State 410, 1]
type = PlaySnd
trigger1 = time = 4
value = S210, 0

[State 410, 1]
type = PlaySnd
trigger1 = animelemTime(6) = 0
value = 20, 0

[state 410, width]
type = width
trigger1 = animelemtime(6) < 0
value = 80,80

[state 410, posadd 2]
type = posadd
triggerall = p2bodydist x > 60
trigger1 = animelemtime(2) = 0
x = 60

[state 410, posadd 3]
type = posadd
triggerall = p2bodydist x > 50
trigger1 = animelemtime(3) = 0
x = 50

[state 410, posadd 4]
type = posadd
triggerall = p2bodydist x > 20
trigger1 = animelemtime(4) = 0
x = 20

[state 410, posadd 5]
type = posadd
triggerall = p2bodydist x > 30
trigger1 = animelemtime(5) = 0
x = 30

[state 410, posadd 6]
type = posadd
triggerall = p2bodydist x > 10
trigger1 = animelemtime(6) = 0
x = 10

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = !movecontact
attr = C, NA
damage    = 80,ifelse(p2statetype = A, 24,0)
animtype  = up
hitflag = MAF
guardflag = MA
pausetime = 18,18
guard.pausetime = 12,12
sparkno = 3
sparkxy = -10,-197
hitsound   = S410,0
guardsound = S120,0
ground.type = high
ground.slidetime = 45
ground.hittime  = 45
air.hittime = 45
ground.velocity = -4,ifelse(var(11)>0,-22,-4)
air.velocity = -4,ifelse(var(11)>0,-18,-2)
guard.dist = 480
envshake.ampl = 12
envshake.time = 18
fall = ifelse(var(11)>0,0,1)
guard.hittime = 24
guard.slidetime = 24
guard.velocity = -18
airguard.hittime = 22
airguard.velocity = -4,-6
guard.kill = 0


[state 410, Launcher Limiter]
type = varadd
trigger1 = movehit
v = 11
value = -1
persistent = 0
ignorehitpause = 1


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 410, envshake]
type = envshake
trigger1 = animelemtime(6) = 0
ampl = -12
time = 12


[state 410, SJ Follow]
type = changestate
triggerall = movehit
triggerall = hitshakeover
trigger1 = command = "holdup"
trigger1 = !ailevel 
trigger2 = ailevel
trigger2 = 1
value = 42

[state 410, Not Active]
type = statetypeset
trigger1 = animelemtime(10) = 0
movetype = I

[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
poweradd= 11
Juggle = 15
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 30
animtype  = Light
hitflag = MAFD
guardflag = L
pausetime = 8,8
sparkno = 0
nochainid = 1400,800
sparkxy = -10,-8
hitsound   = S5000,1
guardsound = S120,0
ground.type = Low
ground.slidetime = 17
ground.hittime  = 17
ground.velocity = -8
air.velocity = -6,-8
down.velocity = -8,0
down.hittime = 10
guard.hittime = 13
guard.slidetime = 13
guard.velocity = -10
guard.dist = 480

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = ifelse(enemynear,hitfall = 1,-18,-9)
persistent = 0
ignorehitpause = 1

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = C
juggle  = 15
poweradd= 35
ctrl = 0
anim = 440
sprpriority = -2
velset

[state 440, slide forward]
type = velset
trigger1 = animelemtime(3) = [0,1]
x = 32

[state 440, sprpriority]
type = sprpriority
trigger1 = animelemtime(5) =0
value = 2

[State 440, 3]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = ifelse(p2statetype = L, 40,ifelse(p2statetype = A, 40,80))
hitflag = MAFD
guardflag = L
pausetime = 12,12
sparkno = 3
sparkxy = -5,-10
hitsound   = S5000,2
guardsound = S120,0
p1sprpriority = -2
p2sprpriority = 1
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -4,-10
air.velocity = -4,-10
guard.velocity = -32
fall = 1
fall.recover = 0
guard.hittime = 13
airguard.velocity = -12,-4
guard.slidetime = 13
down.velocity = -90,0
down.hittime = 36
guard.dist = 420

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 440, Not Active]
type = statetypeset
trigger1 = animelemtime(5) = 0
movetype = I

[State 440, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
juggle  = 2
poweradd= 15
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = S200, 0

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 20
guardflag = HA
priority = 3
pausetime = 6,6
sparkno = 0
sparkxy = -10,-58
hitsound   = S5000,0
guardsound = S120,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4
guard.hittime = 10
air.velocity = -6,-2
air.hittime = 18
guard.dist = 480

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 600, 3]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Strong Punch
; CNS difficulty: easy
[Statedef 610]
type    = A
movetype= A
physics = A
juggle  = 4
poweradd= 40
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 2]
type = PlaySnd
trigger1 = Time = 2
value = S210, 0

[State 610, 3]
type = HitDef
trigger1 = !movecontact
attr = A, NA
damage = 70
guardflag = HA
hitflag = MAF
priority = 4
getpower = 65
pausetime = ifelse(p2statetype = A,18,14),ifelse(p2statetype = A,18,14)
sparkno = ifelse(p2statetype = A, 3,2)
sparkxy = -10,-55
hitsound   = 5,ifelse(p2statetype = A,3,2)
guardsound = S120,0
animtype = heavy
fall.animtype = back
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -16
guard.hittime = 14
guard.velocity = -17
airguard.velocity = -4,12
air.velocity = -1,32
down.bounce = 1
air.fall = 1
fall = 0
fall.recover = 1
fall.recovertime = 30
fall.xvelocity = -1
fall.yvelocity = -14
envshake.ampl = ifelse(p2statetype = A, -8,0)
envshake.time = ifelse(p2statetype = A, 12,0)
guard.dist = 320

[state 610, bounce]
type = veladd
trigger1 = movehit
trigger1 = command = "holdup"
y = -4
ignorehitpause = 1
persistent = 0

[state 610, combo score]
type = varadd
trigger1 = movehit
v = 18
value = ifelse(p2statetype = A, -9,-3)
ignorehitpause = 1
persistent = 0

[state 610, Not Active]
type = statetypeset
trigger1 = animelemtime(7) = 0
movetype = I

[state 610, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = A
juggle  = 3
poweradd= 20
ctrl = 0
anim = 630
sprpriority = 2

[State 630, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 30
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 1
sparkxy = -5,-35
hitsound   = S5000,0
guardsound = S120,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -6
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -7
airguard.velocity = -4,-4
air.velocity = -4,-6
air.hittime = 22
guard.dist = 480

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 600, 3]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
poweradd= 50
ctrl = 0
anim = 640
sprpriority = 2


[State 640, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 70
guardflag = HA
priority = 4
pausetime = 14,14
sparkno = ifelse(p2statetype = A, 3,2)
sparkxy = -10,-40
hitsound   = 5,ifelse(p2statetype = A,4,3)
guardsound = S120,0
animtype = heavy
air.animtype = back
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -18
air.velocity = -24,12
air.fall = 1
fall.recovertime = 60
fall.recover = 0
guard.hittime = 14
guard.velocity = -16
guard.slidetime = 14
airguard.velocity = -8, 2
guard.dist = 320

[state 640, screenshake]
type = envshake
trigger1 = movehit
trigger1 = p2statetype = A
ampl = -8
time = 14
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = ifelse(p2statetype = A, -9, -3)
persistent = 0
ignorehitpause = 1

[state 640, Not Active]
type = statetypeset
trigger1 = animelemtime(7) = 0
movetype = I

[state 640, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Canonball
[Statedef 650]
type    = A
movetype= A
physics = N
poweradd= 30
ctrl = 0
sprpriority = -3

[state 650, special]
type = assertspecial
trigger1 = 1
flag = noautoturn
ignorehitpause = 1

;=================================
;-      Damage Set
;=================================

;Out of Range even more, Max damage
[state 650, damage set]
type = varset
triggerall = prevstateno != 650
trigger1 = ceil(pos y) <= -450 
trigger1 = time = 0
var(14) = 1300


;Out of Range
[state 650, damage set]
type = varset
triggerall = prevstateno != 650
trigger1 = ceil(pos y) <= -390 && ceil(pos y) > -450
trigger1 = time = 0
var(14) = 480

; Peak Super Jump
[state 650, damage set]
type = varset
triggerall = prevstateno != 650
trigger1 = ceil(pos y) <= -255 && ceil(pos y) > -390
trigger1 = time = 0
var(14) = 240

; Super Jump
[state 650, damage set]
type = varset
triggerall = prevstateno != 650
trigger1 = ceil(pos y) <= -175 && ceil(pos y) > -255
trigger1 = time = 0
var(14) = 220

; Peak Normal Jump
[state 650, damage set]
type = varset
triggerall = prevstateno != 650
trigger1 = ceil(pos y) <= -150&& ceil(pos y) > -175
trigger1 = time = 0
var(14) = 200


; small Normal Jump
[state 650, damage set]
type = varset
triggerall = prevstateno != 650
trigger1 = ceil(pos y) <= 0 && ceil(pos y) > -150
trigger1 = time = 0
var(14) = 180

;-----------------------


;===========
;Armor start
;==========

[state 650, anim]
type = changeanim
trigger1 = anim != 650
value = 650

[state 650, explod]
type = explod
trigger1 = time = 0
anim = 645
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
id = 650
removeongethit = 1
ignorehitpause = 0
sprpriority = 2
bindtime = -1

[state 650, armor counter]
type = varset
triggerall = prevstateno != 650
trigger1 = time = 0
V = 20
value = 1

[state 650, excess armor check]
type = varset
trigger1 = var(20) > 1
var(20) = 1
persistent = 1
ignorehitpause = 1

;determine what frame
[state 650, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 240, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.25)
value = anim
elem = var(22)

[state 240, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.25)
value = 1
;--------------------------

[state 240, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 240, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -1
persistent = 1

[state 240, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 650
time = 1
persistent = 1

[State 240, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;----------------------------------------------------------------


[state 650, gravity]
type = gravity
trigger1 = time > 0

[state 650, veladd]
type = veladd
trigger1 = animelemtime(1) = 2
trigger1 = vel y < 0
y = -8
ignorehitpause = 0

[state 650, veladd]
type = velset
trigger1 = animelemtime(1) = 2
trigger1 = vel y > 0
y = -12
ignorehitpause = 0

[state 650, velset]
type = velmul
trigger1 = movecontact
x = 0.5
ignorehitpause = 1


[state 650, steering]
type = veladd
triggerall = !movecontact
triggerall = vel y < const(velocity.jump.fwd.x)*1.25
triggerall = time > 0
trigger1 = command = "holdfwd"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x > 80
x = 0.25
persistent = 1
ignorehitpause = 1

[state 650, steering]
type = veladd
triggerall = !movecontact
triggerall = vel y > const(velocity.jump.back.x)*1.25
triggerall = time > 0
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = p2bodydist x < -20
x = -0.5
persistent = 1
ignorehitpause = 1

;--------------------------

[state 650, enemy state]
type = targetstate
triggerall = vel y > 0
trigger1 = movehit
trigger1 = enemy,statetype != A
value = 660

;Ride down mechanic
[state 650, Ride down]
type = targetbind
trigger1 = movehit
trigger1 = enemy,statetype = A
pos = 48, -72

[state 650, state of ride down]
type = targetstate
trigger1 = movehit
trigger1 = enemy,statetype = A
value = 655
;----------------------------------------------

[State 640, 3]
type = HitDef
trigger1 = !movecontact
trigger1 = vel y > 2
attr = A, SA
damage    = ifelse(p2movetype=H,floor(var(14)*0.7),var(14)),floor(var(14)*0.3)
guardflag = HA
hitflag = MAFD
priority = 4
pausetime = 0,0
sparkno = 0
getpower = floor(var(14) * 0.75)
givepower = floor(var(14))
id = 650
getpower = 170
nochainid = 650,800
sparkxy = -10,-40
hitsound   = S1000,1
guardsound = S120,0
animtype = Med
p1sprpriority = -3
p2sprpriority = 1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
guard.velocity = -45
guard.slidetime = 42
guard.hittime = 42
airguard.velocity = -20,4
airguard.hittime = 22


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[state 650, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 651

;------------------------------------------------------------------------
; 1st Landing
[statedef 651]
type    = C
movetype= A
physics = N
poweradd= 30
sprpriority = -2

[state 651, anim]
type = changeanim
trigger1 = time = 0
value = 651

[state 651, removexplod]
type = removeexplod
trigger1 = time = 0
id = 650

[state 650, explod]
type = explod
trigger1 = time = 0
anim = 646
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
id = 651
removeongethit = 1
ignorehitpause = 0
sprpriority = 3
bindtime = -1

;Custom Dust
[state 651, explod]
type = explod
trigger1 = time = 0
anim = 2000
pos = 30,0
scale = const(size.xscale)*3,const(size.yscale)*2
ontop = 1
ownpal = 1

[state 651, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 6,3
ownpal = 1


[state 651, explod]
type = explod
trigger1 = time = 0
anim = 2001
pos = 30,0
scale =  const(size.xscale)*3,const(size.yscale)*2
sprpriority = -4
ownpal = 1
; -------------------

[state 651, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 651, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 651, pos]
type = posset
trigger1 = time = 0
y = 0

[state 651, playerpush]
type = playerpush
trigger1 = 1
value = 0

[State 651, 3]
type = HitDef
trigger1 = Time = 0
attr = A, SA
damage    = var(14)
guardflag = 
hitflag = FD
priority = 4
getpower = 270
givepower =230
nochainid = 1400
pausetime = 12,12
sparkno = 1
sparkxy = -10,-40
hitsound   = 5,3
guardsound = 6,0
animtype = Med
p2stateno = 660
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state 651, vel]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 651, vel]
type = velset
trigger1 = time = 8
y = -8
x = 0

[state 651, statetypeset]
type = statetypeset
trigger1 = time = 4
statetype = A

[state 651, gravity]
type = gravity
trigger1 = pos y < -1

[state 651, earthquakes]
type = envshake
trigger1 = time = 0
time = 24
ampl = -24
freq = 60
phase = 60

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -6
persistent = 0
ignorehitpause = 1



[state 651, end]
type = changestate
triggerall = time > 4
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 652

;--------------------------------------------------------------------------
;Bounce
[statedef 652]
type    = C
movetype= I
physics = C
velset = 0,0
sprpriority = -3

[state 652, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 651

[state 652, explod]
type = explod
trigger1 = time = 0
anim = 647
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
id = 652
removeongethit = 1
ignorehitpause = 0
sprpriority = 3
bindtime = -1
removetime = -2

[state 652, anim]
type = changeanim
trigger1 = time = 0
value = 652

[state 652, playerpush]
type = playerpush
trigger1 = 1
value = 0


[state 652, velset]
type = posset
trigger1 = time = 0
y = 0

[state 652, end]
type = changestate
trigger1 = animtime = 0
value = 653

;---------------------------------------------------------------------------
;Roll back
[statedef 653]
type = C
movetype = I
physics = C
velset = 0,0

[state 653, spriprority]
type = sprpriority
trigger1 = time = 0
trigger1 = p2stateno = [660,669]
value = 3

[state 653, nothitby]
type = nothitby
trigger1 = prevstateno = 1154
trigger2 = prevstateno = 1164
trigger3 = prevstateno = 1174
value = SCA


[state 653, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 652

[state 652, anim]
type = changeanim
trigger1 = time = 0
value = 653

[state 653, playerpush]
type = playerpush
trigger1 = animelemtime(4) < 0
value = 0

[state 652, posadd 4]
type = posadd
trigger1 = animelemtime(4) = 0
x = -20

[state 652, posadd 5]
type = posadd
trigger1 = animelemtime(5) = 0
x = -120

[state 652, posadd 6]
type = posadd
trigger1 = animelemtime(6) = 0
x = -20

[state 652, posadd 7]
type = posadd
trigger1 = animelemtime(7) = 0
x = -30

[state 652, posadd 8]
type = posadd
trigger1 = animelemtime(8) = 0
x = -80

[state 652, posadd 8]
type = posadd
trigger1 = animelemtime(9) = 0
x = -20

[state 653, sound]
type = playsnd
trigger1 = animelemtime(8) = 0
value = 20,0

[state 653, envshake]
type = envshake
trigger1 = animelemtime(8) =0
ampl = -6
time = 12


[state 653, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Rode down
[statedef 655]
type = A
movetype = H
physics = N
sprpriority = 1

[state 655, anim]
type = changeanim2
trigger1 = time = 0
trigger1 = anim != 655
value = 655

[State 655, 2]
type = changeState
trigger1 = !gethitvar(isbound)
value = 660

;===========================================================================
;---------------------------Crushed State-----------------------------------
;===========================================================================
; Moderate Crushed State
[statedef 660]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 660, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 660, flatten]
type = AngleDraw
trigger1 = time > 0
value = 0
scale = 1.3,0.1

[state 660, on ground]
type = posset
trigger1 = 1
y = 0

[state 660, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 660, Width]
type = Width
trigger1 = time > 0
value = 0,0

[state 660, invunerable]
type = nothitby
trigger1 = 1
value = SCA


[State 660, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 660, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 660, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 660, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 660, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 660, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 660, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 660, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 660, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0 
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 660, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 660, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 660, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 660, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 1108, nothitby]
type = nothitby
trigger1 = time = 80
value = SCA
time = 4

[State 660, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 90 ;95
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150

;---------------------------------------------------------------------------
;Brief Crushed State
[statedef 661]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 661, flatten]
type = AngleDraw
trigger1 = time >= 0 && time < 90
value = 0
scale = 1.25,0.2

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 661, Width]
type = Width
trigger1 = time > 0
value = 0,0


[State 661, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 661, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 661, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 661, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 661, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 661, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 661, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[State 661, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 110
value = 5110

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150

;---------------------------------------------------------------------------
;Super Crushed State
[statedef 662]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 662, posadd]
type= posadd
trigger1 = time = 0
x = 20

[state 661, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[State 661, flatten]
type = AngleDraw
trigger1 = 1
value = 0
scale = 1.25,0.2

[state 661, on ground]
type = posset
trigger1 = 1
y = 0

[state 661, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 661, Width]
type = Width
trigger1 = time > 0
value = 0,0


[State 661, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 661, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 661, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)


[State 661, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 661, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 661, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 661, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 661, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 661, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 661, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 661, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 662, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 662, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 662, hitby]
type = hitby
trigger1 = time > 0
value = SCA, AA
ignorehitpause = 1

[State 662, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 180
value = 5110

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 180
value = 5150


;---------------------------------------------------------------------------
;Winning Crushed State
[statedef 665]
type    = L
movetype= H
physics = N
ctrl = 0
velset = 0,0

[state 665, 1]
type = changeanim
trigger1 = time = 0
value = 5110

[state 665, scream]
type = playsnd
trigger1 = 1
value = 11,0
persistent = 0


[State 665, flatten]
type = AngleDraw
trigger1 = time > 0  && time <25
value = 0
scale = 1.3,0.1

[state 665, on ground]
type = posset
trigger1 = 1
y = 0

[state 665, passthrough]
type = playerpush
trigger1 = 1
value = 0
time = 600

[State 665, Width]
type = Width
trigger1 = time > 0
value = 0,0

[State 665, 5]
type = PosSet
trigger1 = Time = 0
y = 0

;[State 661, Var] ;Get fall velocity
;type = VarSet
;trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) != 0
;sysvar(1) = floor(vel y)

;[State 665, 6]
;type = PlaySnd
;trigger1 = Time = 0
;trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;persistent = 0

[State 665, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 665, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 665, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 665, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 665, 11] ;If just died
type = ChangeState
triggerall = !alive && p2stateno = 0 && roundstate = 3
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

;[State 661, 12]
;type = VarSet
;trigger1 = SysVar(0)
;trigger1 = Time = 0
;sysvar(0) = 0

[State 665, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 665, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 665, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

[state 665, hitby]
type = hitby
trigger1 = time > 0
value = SCA, AA
ignorehitpause = 1

[State 665, get up]
type = selfstate
trigger1 = life >= 1
trigger1 = time > 600
value = 5120

[state 660, flat death]
type = changestate
trigger1 = !alive
trigger1 = time > 40
value = 5150




;---------------------------------------------------------------------------
;===========================================================================
;------------------------------Wall Bounce State
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

[state 671, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 670, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 670, Gravity]
type = veladd
trigger1 = 1
y = 0.44

;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 672, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 672, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 672, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 673, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -14

[State 673, Vel X]
type = VelSet
trigger1 = Time = 0
x = ceil(p2dist x*0.02)

[State 673, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 672, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

;[state 673, gravity]
;type = gravity
;trigger1 = 1

[State 673, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 673, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 673, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 673, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100
;----------------------------------------------------------------------------

;Wall Bounce Splat
[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 675]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[state 676, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 676, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 676, Gravity]
type = veladd
trigger1 = 1
y = 0.44

;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1

[state 677, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -14

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 4

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[State 678, Gravity]
type = VelAdd
trigger1 = 1
y = 1.05

;[state 673, gravity]
;type = gravity
;trigger1 = 1

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100







;---------------------------------------------------------------------------
;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
poweradd = 30
sprpriority = 2


[State 800, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = p2movetype != A
attr = S, NT         
hitflag = M-          
id = 800
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 1                     
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 820      
guard.dist = 0       
fall = 1

;attacking
[State 800, 1]
type = HitDef
Trigger1 = Time = 0
trigger1 = p2movetype = A
attr = S, NT         
hitflag = M-          
id = 800
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 1                     
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 822      
guard.dist = 0       
fall = 1          

;Stunned
[State 800, 1]
type = HitDef
trigger1 = enemynear,anim = 5300
attr = S, NT         
hitflag = M          
id = 800
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 1                     
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 822      
guard.dist = 0       
fall = 1  
[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p2
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
facep2 = 1
sprpriority = 4

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120

;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -32

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p1
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(130)
value = 130

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 130

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, turn]
type = turn
trigger1 = prevstateno = 820
trigger1 = time = 0
persistent = 0
ignorehitpause

[state 805, velset]
type = velset
trigger1 = time = 10
x= -32

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Belly Flop Throw
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
sprpriority = -2

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 805
value = 806
persistent = 1

[state 810, movement]
type = velset
trigger1 = animelemtime(4) = 0
x = 5
y = -12

[state 810, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
statetype = A
physics = N

[state 810, statetypeset]
type = gravity
trigger1 = pos y < -1

[state 810, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(810) 
anim = 815
id = 810
postype = p1
pos = 0,0
bindtime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 3



[State 810, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdback"

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

[State 810, Width 2-11]
type = Width
trigger1 = 1
edge = 160,160
;---------------------------------------------------------
;binds
;---------------------------------------------------------

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0 
pos = 184, -157

[State 810, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 146, -190

[State 810, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 160, -162

[State 810, Bind 4]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = 158, -122

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 
pos = 42, -57

;-----------------------------------------------------------------------

[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 3

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElem = 3
x = -37

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 3
value = -1

[state 810, modifyexplod]
type = modifyexplod
trigger1 = var(2)
trigger1 = animelem = 3
id = 810
scale = -const(size.xscale),const(size.yscale)

[State 810, Throw 11]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 811


;---------------------------------------------------------------------------
[statedef 811]
type = L
movetype = A
physics = C
anim = 811
ctrl = 0
velset = 0,0
sprpriority = 3

[state 811, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 810
ignorehitpause = 1

[state 811, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 811, targetstate]
type = targetstate
trigger1 = time = 0
value = 661

[state 44, Large Dust]
type = explod
trigger1 = time = 2
anim = 2000
pos = 28,0
scale = 2,2
sprpriority = 4

[state 44, Large Dust]
type = explod
trigger1 = time = 2
anim = 2001
pos = 28,0
scale = 2,2
sprpriority = -3

[state 44, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 3,1.5

[state 52, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0

[state 52, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0

[state 20, earthquakes]
type = envshake
trigger1 = time = 0
time = 18
ampl = -18
freq = 100
phase = 100

[state 811, Bounce]
type = velset
trigger1 = animelemtime(3) = 0
y = -7

[state 811, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = A
physics = N

[state 811, gravity]
type = gravity
trigger1 = pos y < -1

[state 811, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -140

[state 811, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 160

[state 811, poweradd]
type = poweradd
trigger1 = time = 0
value = 120



[state 811, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 812

;---------------------------------------------------------------------------
[statedef 812]
type = L
movetype = A
physics = C
anim = 812
ctrl = 0
velset = 0,0

[state 811, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 52, playsnd]
type = playsnd
trigger1 = time = 0
value = 20,0

[state 20, earthquakes]
type = envshake
trigger1 = time = 0
time = 12
ampl = -6
freq = 100
phase = 100

[state x, combo damage score]
type = varadd
trigger1 = animtime = 0
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 811, changestate]
type = changestate
trigger1 = animtime = 0
value = 813

;---------------------------------------------------------------------------
;Bounce Off
[statedef 813]
type = L
movetype = I
physics = C
anim = 813
velset = 0,0


[state 813, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 813, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = -12
y = -9

[state 813, physics]
type = statetypeset
trigger1 = animelemtime(3) = 0
physics = A
statetype = A




;---------------------------------------------------------------------------
;Belly flop throw

[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0

[state 820, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel >6 ,3,1))
value = 805

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Belly flop throw

[Statedef 822]
type    = A
movetype= H
physics = N
velset = 0,0

[state 820, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = 12,-4
poweradd = 40

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = .8

[State 821, 2] ; Recover near ground (use ChangeState)
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 821, 3] ; Recover in mid air (use SelfState)
type = SelfState
triggerall = Vel Y > 0
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;---------------------------------------------------------------------------
;Butt Bump Charge LK
[statedef 1000]
type = S
movetype = A
physics = N
anim = 1000
poweradd = 60
ctrl = 0

[state X, charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1000, velset]
type = velset
trigger1 = time = 0
x = 18
persistent = 0

[state 1000, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,0

[state 1000, changestate]
type = changestate
trigger1 = p2bodydist x < 100
trigger1 = time > 2
trigger2 = time > 4
value = 1001

;----------------------------------------------------------------------------
; Butt Bump Attack portion LK
[statedef 1001]
type = S
movetype = A
physics = S
anim = 1001

[state 1001, Not Active]
type = statetypeset
trigger1 = animelemtime(4) = 0
movetype = I




[State 1001, 2]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = S, SA
animtype  = back
damage    = 150,15
guardflag = MA
id = 1000
nochainid = 1000
pausetime = 16,16
guard.pausetime = 12,12
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
ground.type = high
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -18, -10
air.velocity = -18,-10
guard.velocity = -56
guard.hittime = 28
guard.slidetime = 28
airguard.velocity = -8,-4
airguard.hittime = 34
fall = 1
fall.recover = 0
fall.recovertime = 120
ground.cornerpush.veloff = -20
guard.dist = 480
envshake.ampl = 8
envshake.time = 16

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1000, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Butt Bump Charge HK
[statedef 1010]
type = S
movetype = A
physics = N
anim = 1010
poweradd = 100
ctrl = 0

[state X, X axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1010, velset]
type = velset
trigger1 = time = 0
x = 22
persistent = 0

[state 1000, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,0

[state 1010, changestate]
type = changestate
trigger1 = p2bodydist x < 100
trigger1 = time > 2
trigger2 = time > 24
value = 1011

;----------------------------------------------------------------------------
; Butt Bump Attack portion LK
[statedef 1011]
type = S
movetype = A
physics = S
anim = 1011

[state 1011, Not Active]
type = statetypeset
trigger1 = animelemtime(4) = 0
movetype = I

[State 1001, 2]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = S, SA
animtype  = back
damage    = 180,18
guardflag = MA
id = 1010
nochainid = 1010
pausetime = 16,16
guard.pausetime = 12,10
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
ground.type = high
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -18, -10
air.velocity = -18,-10
guard.velocity = -45
guard.hittime = 22
guard.slidetime = 22
airguard.velocity = -4,-4
airguard.hittime = 28
envshake.ampl = 8
envshake.time = 16
fall = 1
fall.recover = 0
fall.recovertime = 120
ground.cornerpush.veloff = -20
guard.dist = 320

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1000, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Butt Bump Charge EX
[statedef 1020]
type = S
movetype = A
physics = N
ctrl = 0

[state X, X axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[State 1020, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1000, no autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn

[state 1020, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1020
value = -500

[state 1010, velset]
type = velset
trigger1 = time = 0
x = 26
persistent = 0

[state 1000, playsnd]
type = playsnd
trigger1 = time = 0
value = 1000,0

;===========
;Armor start
;===========
[state 1020, animation]
type = changeanim
trigger1 = anim != 1020
value = 1020

[state 1020, armor counter]
type = varset
trigger1 = time = 0
trigger1 = var(21) = 1
V = 20
value = 1

[state 1020, armor intiation end]
type = varset
trigger1 = time = 1
v = 21
value = 0

;determine what frame
[state 1020, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1020, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 1020, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 1020, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 1020, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -1
persistent = 1

[state 1020, Unstoppable]
type = hitoverride
trigger1 = Life > 1
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1020
time = 1
persistent = 1

[State 1020, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;Spawning rainbow helpers

[State 1020, Helper]
type = Helper
trigger1 = gametime%24=0
name = "FUCKING RAINBOWS"
ID = 2080
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1020, Helper]
type = Helper
trigger1 = gametime%24=2
name = "FUCKING RAINBOWS"
ID = 2081
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=4
name = "FUCKING RAINBOWS"
ID = 2082
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=6
name = "FUCKING RAINBOWS"
ID = 2083
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=8
name = "FUCKING RAINBOWS"
ID = 2084
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1020, Helper]
type = Helper
trigger1 = gametime%24=10
name = "FUCKING RAINBOWS"
ID = 2085
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=12
name = "FUCKING RAINBOWS"
ID = 2086
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=14
name = "FUCKING RAINBOWS"
ID = 2087
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=16
name = "FUCKING RAINBOWS"
ID = 2088
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1020, Helper]
type = Helper
trigger1 = gametime%24=18
name = "FUCKING RAINBOWS"
ID = 2089
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=20
name = "FUCKING RAINBOWS"
ID = 2090
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=22
name = "FUCKING RAINBOWS"
ID = 2091
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[state 1010, changestate]
type = changestate
trigger1 = p2bodydist x < 100
trigger1 = time > 2
trigger2 = time > 27
value = 1021

;----------------------------------------------------------------------------
; Butt Bump Attack portion LK
[statedef 1021]
type = S
movetype = A
physics = S

[state 1021, Not Active]
type = statetypeset
trigger1 = anim = 1021
trigger1 = animelemtime(5) = 0
movetype = I

;===========
;Armor start
;===========
[state 1021, animation]
type = changeanim
trigger1 = anim != 1021
value = 1021

;determine what frame
[state 1021, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1021, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 1021, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 1021, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 1021, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -1
persistent = 1

[state 1021, Unstoppable]
type = hitoverride
trigger1 = Alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1021
time = 1
persistent = 1

[State 1021, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[state 1021, armor end]
type = varset
trigger1 = animelemtime(4) = 0
var(20) = 0
ignorehitpause = 1
;-----------------------------------------------------------

[State 1020, Blink Yellow]
type = PalFX
triggerall = animelemtime(4) < 0
trigger1 = time%2
trigger1 = gethitvar(damage) = 0
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1021, no autoturn]
type = assertspecial
trigger1 = 1
flag = noautoturn

[State 1021, 2]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = S, SA
animtype  = back
damage    = 150,30
guardflag = MA
id = 1020
getpower = 0
givepower = 130
pausetime = 16,16
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
ground.type = high
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -32,ifelse(var(7)>1,-20,-2)
air.velocity = -28,ifelse(var(7) > 1, -20, -2)
guard.velocity = -45
guard.hittime = 30
guard.slidetime = 30
airguard.velocity = -12,-4
airguard.hittime = 26
envshake.ampl = 8
envshake.time = 16
fall = 1
fall.recover = 0
ground.cornerpush.veloff = -20

[state 1021, ctrl]
type = ctrlset
trigger1 = movehit
trigger1 = animelemtime(5) = 0
value = 1

[state 1021, wall bounce limiter]
type = varadd
trigger1 = movehit
trigger1 = numtarget(1020)
v = 7
value = -1 
ignorehitpause = 1
persistent = 0

[state 1021, targetstate]
type = targetstate
trigger1 = hitpausetime = 15
trigger1 = movehit
trigger1 = var(7) > 0
id = 1020
value = 670
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 1021, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Butt Up LK
[statedef 1050]
type = A
movetype = A
physics = S
ctrl = 0
velset = 0,0
poweradd = 60

[state X, Y axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

;===========
;Armor start
;==========
[state 1050, armor counter]
type = varset
triggerall = prevstateno != 1050
trigger1 = time = 0
V = 20
value = 2

[state 1050, changeanim]
type = changeanim
trigger1 = anim != 1050
value = 1050

[state 1050, excess armor check]
type = varset
trigger1 = var(20) > 2
var(20) = 2
persistent = 1
ignorehitpause = 1 

;determine what frame
[state 1050, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1050, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 1050, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 1050, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 1050, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

[state 1050, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1050
time = 1
persistent = 1

[State 1050, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;----------------------------------------------------------------

[state 1050, posadd]
type = posadd
trigger1 = animelemtime(1) = 0
trigger1 = prevstateno != 1050
x = 20
persistent = 0

[state 1050, playsnd]
type = playsnd
trigger1 = animelem = 2
value = 1050,0

[state 1050, nothitby]
type = null
trigger1 = !movehit
trigger1 = animelemtime(4) < 0
value = A

[state 1050, nothitby]
type = nothitby
trigger1 = movehit
value = SCA

[state 1050, velset]
type = velset
trigger1 = animelemtime(5) = 0
x = 8
y = -20
persistent = 0
ignorehitpause = 1

[state 1050, statetypeset]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = N
movetype = A
statetype = A
ignorehitpause = 1

[state 1050, gravity]
type = gravity
trigger1 = pos y < -1

[State 1050, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = 150, ifelse(p2statetype = A,45,15) 
guardflag = MA
id = 1050
nochainid = 1050
pausetime = 18,18
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
p1sprpriority = 2
ground.type = high
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4,-20
air.velocity = -4,-16
guard.velocity = -27
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-16
airguard.hittime = 26
fall = 1
fall.recover = 0
guard.kill = 1
envshake.ampl = 12
envshake.time = 18
guard.dist = 320

[state 1050, changestate]
type = changestate
trigger1 = vel y > 0
value = 1051
ctrl = 0

;---------------------------------------------------------------------------
;Recovery
[statedef 1051]
type = A
movetype = I
physics = N
anim = 1051

[state 1051, velset]
type = velmul
trigger1 = time = 0
x = 0.5
persistent = 0

[state 1051, velset]
type = velmul
trigger1 = vel y > 20
x = 0.1
persistent = 0

[state 1051, gravity]
type = gravity
trigger1 = 1

[state 1051, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1052

;----------------------------------------------------------------------------
;Landing
[statedef 1052]
type = S
movetype = I
physics = S
anim = 1052

[state 1052, vel stop]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1052, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1052, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 4,1.75

[state 1052, playsnd]
type = playsnd
trigger1 = time = 0
value = 20,0

[state 20, earthquakes]
type = envshake
trigger1 = time = 0
time = 18
ampl = -16
freq = 100
phase = 100

[state 1052, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
;BUTT UP HK
[statedef 1060]
type = A
movetype = A
physics = S
ctrl = 0
velset = 0,0
poweradd = 100

[state X, Y axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

;===========
;Armor start
;==========
[state 1060, armor counter]
type = varset
triggerall = prevstateno != 1060
trigger1 = time = 0
V = 20
value = 3

[state 1060, changeanim]
type = changeanim
trigger1 = anim != 1060
value = 1060

[state 1060, excess armor check]
type = varset
trigger1 = var(20) > 3
var(20) = 3
persistent = 1
ignorehitpause = 1 

;determine what frame
[state 1060, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1060, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = anim
elem = var(22)

[state 1060, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.1)
value = 1
;--------------------------

[state 1060, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) != 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 1060, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

[state 1060, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 1060
time = 1
persistent = 1

[State 1060, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

;----------------------------------------------------------------

[state 1060, posadd]
type = posadd
trigger1 = animelemtime(1) = 0
trigger1 = prevstateno != 1060
x = 20
persistent = 0

[state 1060, nothitby]
type = null;nothitby
trigger1 = !movehit
trigger1 = animelemtime(4) < 0
value = A

[state 1060, nothitby]
type = nothitby
trigger1 = movehit
value = SCA

[state 1060, playsnd]
type = playsnd
trigger1 = animelem = 2
value = 1050,0

[state 1060, velset]
type = velset
trigger1 = animelemtime(5) = 0
x = 10
y = -26
persistent = 0
ignorehitpause = 1

[state 1060, statetypeset]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = N
movetype = A
statetype = A
ignorehitpause = 1

[state 1060, gravity]
type = gravity
trigger1 = pos y < -1

[State 1060, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = 180, ifelse(p2statetype = A,54,18) 
guardflag = MA
id = 1060
nochainid = 1060
pausetime = 18,18
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
p1sprpriority = 2
ground.type = high
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4,-26
air.velocity = -4,-22
guard.velocity = -27
guard.hittime = 18
guard.slidetime = 18
airguard.velocity = -12,-16
airguard.hittime = 26
fall = 1
fall.recover = 0
guard.kill = 1
envshake.ampl = 12
envshake.time = 18
guard.dist = 320

[state 1050, changestate]
type = changestate
trigger1 = vel y > 0
value = 1051
ctrl = 0


;------------------------------------------------------------------------

;BUTT UP EX
[statedef 1070]
type = A
movetype = A
physics = S
anim = 1070
ctrl = 0
velset = 0,0
poweradd = -500

[state X, Y axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1070, posadd]
type = posadd
trigger1 = animelemtime(1) = 0
x = 20
persistent = 0

[State 1070, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1070, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1070, velset]
type = velset
trigger1 = animelemtime(5) = 0
x = 12
y = -32
persistent = 0
ignorehitpause = 1

[state 1070, playsnd]
type = playsnd
trigger1 = animelem = 2
value = 1050,0

[state 1070, statetypeset]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = N
movetype = A
statetype = A
ignorehitpause = 1

[state 1070, gravity]
type = gravity
trigger1 = pos y < -1

[State 1070, 2]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = 150, ifelse(p2statetype = A,45,15) 
guardflag = MA
id = 1070
nochainid = 1070
getpower = 0
givepower = 70
pausetime = 18,18
sparkno = 3
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
p1sprpriority = 2
ground.type = high
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4,-32
air.velocity = -4,-29
guard.velocity = -26
guard.hittime = 22
guard.slidetime = 22
airguard.velocity = -14,-16
airguard.hittime = 26
fall = 1
fall.recover = 0
guard.kill = 1
envshake.ampl = 18
envshake.time = 24
guard.dist = 320

;Spawning rainbow helpers

[State 1070, Helper]
type = Helper
trigger1 = gametime%24=0
name = "FUCKING RAINBOWS"
ID = 2080
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1070, Helper]
type = Helper
trigger1 = gametime%24=2
name = "FUCKING RAINBOWS"
ID = 2081
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=4
name = "FUCKING RAINBOWS"
ID = 2082
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=6
name = "FUCKING RAINBOWS"
ID = 2083
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=8
name = "FUCKING RAINBOWS"
ID = 2084
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1070, Helper]
type = Helper
trigger1 = gametime%24=10
name = "FUCKING RAINBOWS"
ID = 2085
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=12
name = "FUCKING RAINBOWS"
ID = 2086
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=14
name = "FUCKING RAINBOWS"
ID = 2087
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=16
name = "FUCKING RAINBOWS"
ID = 2088
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1070, Helper]
type = Helper
trigger1 = gametime%24=18
name = "FUCKING RAINBOWS"
ID = 2089
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=20
name = "FUCKING RAINBOWS"
ID = 2090
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1070, Helper]
type = Helper
trigger1 = gametime%24=22
name = "FUCKING RAINBOWS"
ID = 2091
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[state 1070, changestate]
type = changestate
trigger1 = vel y > 0
value = 1051
ctrl = 0

;---------------------------------------------------------------------------
;Giant Swing
[statedef 1100]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0

[state X, X&Y axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0
var(43) = 0

[state 1100, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1100
value = 50

[state 1100, grab invunerability]
type = nothitby
trigger1 = animelemtime(6) < 0
value = ,AT

;===========
;Armor start
;===========

[state 1100, changeanim]
type = changeanim
trigger1 = anim != 1100
value = 1100

[state 1100, armor counter]
type = varset
trigger1 = time = 0
trigger1 = var(21) = 1
V = 20
value = 7
persistent = 0
ignorehitpause = 0

[state 1100, armor int cancel]
type = varset
trigger1 = time = 1
v = 21
value = 0


[state 1100, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

;determine what frame
[state 1100, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1100, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 1100, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 1100, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = floor(-gethitvar(damage)*0.1)
persistent = 1



[state 1100, Unstoppable]
type = hitoverride
triggerall = var(20) > 0
triggerall = alive
trigger1 = animelemtime(6) < 0
attr = SC, NA,SA,NP,SP
stateno = 1100
time = 1
persistent = 1

[state 1100, notgrabable]
type = null;nothitby
trigger1 = animelemtime(6) < 0
value = ,AT
ignorehitpause = 1

[State 1100, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1100, 1]
type = HitDef
Trigger1 = !movecontact
trigger1 = enemynear,stateno != [150,159]
trigger1 = enemynear,movetype != H
persistent = 0
attr = S, ST         
hitflag = M-          
id = 1100
nochainid = 210
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 2                     
p1facing = 1
p2facing = 1          
p1stateno = 1101      
p2stateno = 1130      
guard.dist = 0       
fall = 1

[State 1100, 1]
type = HitDef
Trigger1 = enemynear,anim = 5300
persistent = 0
attr = S, ST         
hitflag = M         
id = 1100
nochainid = 210
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 2                     
p1facing = 1
p2facing = 1          
p1stateno = 1101      
p2stateno = 1130      
guard.dist = 0       
fall = 1

[state 1100, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Giant Swing Animation Light
;---------------------------------------------------------------------------
[statedef 1101]
type = S
movetype = A
physics = N
anim = 1101
ctrl = 0
velset = 0,0


[State 810, Grab Sound]
type = PlaySnd
trigger1 = time = 0
value = 1, 1

[State 810, Width 2-11]
type = Width
trigger1 = 1
edge = 120,120
;---------------------------------------------------------
;binds
;---------------------------------------------------------

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0 
pos = 198, -136

[State 810, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 146, -190

[State 810, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 160, -162

[state 1101, snd]
type = playsnd
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(14) = 0
value = 1100,1

[state 651, fx]
type = explod
trigger1 = animelemtime(5) > 0 && animelemtime(20) < 0
anim = F61
pos = 0,0
scale = 2,2
ownpal = 1
persistent = 16


[State 810, Giant Swing Bind 1]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
trigger2 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
pos = 81, -182

[State 810, Giant Swing Bind 2]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
pos = 64, -208

[State 810, Giant Swing Bind 3]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
pos = 53, -210

[State 810, Giant Swing Bind 4]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
pos = -76, -208

[State 810, Giant Swing Bind 5]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
pos = -77, -182

[State 810, Giant Swing Bind 6]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
pos = -48, -190

[State 810, Giant Swing Bind 7]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
pos = 1, -180

[State 810, Giant Swing Bind 8]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
pos = 57, -198

[state 810, giant Swing Throw]
type = targetstate
trigger1 = animelemtime(20) = 0
value = 1131

[state 1101, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0


[state 810, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(20) = 0
value = -floor(fvar(10)*20)
kill = 0

[state 1121, targetpoweradd]
type = targetpoweradd
trigger1 = animelemtime(20) = 0
value = 20

[state 810, velset]
type = velset
trigger1 = animelemtime(20) = 0
x = -8

[state 1101, dust]
type = explod
trigger1 = animelem = 20
anim = F120
pos = -70,0
scale = 2, 2
sprpriority = 4

[state 1101, dust]
type = explod
trigger1 = animelem = 21
anim = F120
pos = -28,0
scale = 2, 2
sprpriority = 4

[state 1101, dust]
type = explod
trigger1 = animelem = 22
anim = F120
pos = -25,0
scale = 2, 2
sprpriority = 4

[state 1101, playsnd]
type = playsnd
trigger1 = p2stateno = 1132
value = 650,0
persistent = 0

[state 1101, end]
type = changestate
trigger1 = animtime = 0
value = 1102


;---------------------------------------------------------------------------
;Butt Rush to wall
[statedef 1102]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1102
sprpriority = 3

[state 1102, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1102, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1000,0

[state 1102, velset]
type = velset
trigger1 = animelemtime(4) = 0
persistent = 0
x = 24

[state 1101, dust]
type = explod
trigger1 = animelemtime(4) > 0
anim = F120
pos = 0,0
scale = 2, 2
sprpriority = 4
persistent = 2


[state 1102, stop]
type = changestate
trigger1 = frontedgebodydist < 60
value = 1103

;-------------------------------------------------------
;Wall Crash
[statedef 1103]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1103
sprpriority = 4
poweradd = 40

[state 1103, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1103, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))

[state 1103, playsnd]
type = playsnd
trigger1 = time = 0
value = 1130,0

[state 1103, targetstate]
type = targetstate
trigger1 = time = 0
value = 1134

[state 1103, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -floor(fvar(10)*160)

[state 1123, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 180

[state 1121, poweradd]
type = poweradd
trigger1 = time = 0
value = 150

[state 1102, width]
type = width
trigger1 = 1
edge = 0,0

[state 1102, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 1103, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
postype = p1
pos = 0,-158
sprpriority = 5
ownpal = 1
scale = -1.2,2.25

[state 1103, envshake]
type = envshake
trigger1 = time = 0
ampl = 18
time = 30

[state 1101, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0
persistent = 0

[state 1101, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0
persistent = 0

[state 1123, posadd]
type = posadd
trigger1 = animelemtime(13) = 0
x = -192

[state 1103, step back]
type = velset
trigger1 = animelemtime(13) > 0
x = const(velocity.walk.back.x)*1.0
persistent = 1

[state 1103, physics]
type = statetypeset
trigger1 = animelemtime(13) = 0
physics = S

[state 1103, Footsteps]
type = playsnd
trigger1 = animelemtime(17) = 0
value = 20,0
channel = 2
ignorehitpause = 1
persistent = 1

[state 1103, Slaps]
type = playsnd
trigger1 = animelemtime(18) = 0

value = 20,1
channel = 1
ignorehitpause = 1
persistent = 1
volume = 25

[state X, Combo Scaling]
type = varadd
trigger1 = time = 2
v = 18
value = -18
persistent = 0
ignorehitpause = 1


[state 1103, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Giant Swing Heavy
;---------------------------------------------------------------------------
[statedef 1110]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0

[state X, X&Y axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0
var(43) = 0

[state 1100, poweradd]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1100
value = 70

[state 1110, grab invunerability]
type = nothitby
trigger1 = animelemtime(6) < 0
value = ,AT

;===========
;Armor start
;===========

[state 1110, changeanim]
type = changeanim
trigger1 = anim != 1110
value = 1110

[state 1110, armor counter]
type = varset
trigger1 = var(21) = 1
V = 20
value = 13
persistent = 0
ignorehitpause = 0

[state 1110, armor int cancel]
type = varset
trigger1 = time = 1
v = 21
value = 0

[state 1110, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

;determine what frame
[state 1110, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1110, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.8);1.1
value = anim
elem = var(22)

[state 1110, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 1110, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = floor(-gethitvar(damage)*0.1)
persistent = 1

[state 1110, Unstoppable]
type = hitoverride
triggerall = var(20) > 0
triggerall = alive
trigger1 = animelemtime(6) < 0
attr = SC, NA,SA,NP,SP
stateno = 1110
time = 1
persistent = 1

[State 1110, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1110, 1]
type = HitDef
Trigger1 = !movecontact
trigger1 = enemynear,stateno != [150,155]
attr = S, ST         
hitflag = M-          
id = 1110
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 2                     
p1facing = 1
p2facing = 1          
p1stateno = 1111      
p2stateno = 1135      
guard.dist = 0       
fall = 1

[State 1110, 1]
type = HitDef
Trigger1 = enemynear,anim = 5300
attr = S, ST         
hitflag = M          
id = 1110
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 2                     
p1facing = 1
p2facing = 1          
p1stateno = 1111      
p2stateno = 1135      
guard.dist = 0       
fall = 1

[state 1110, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Giant Swing Animation Light
;---------------------------------------------------------------------------
[statedef 1111]
type = S
movetype = A
physics = N
anim = 1111
ctrl = 0
velset = 0,0


[State 1111, Grab Sound]
type = PlaySnd
trigger1 = time = 0
value = 1, 1

[State 1111, Width 2-11]
type = Width
trigger1 = 1
edge = 120,120
;---------------------------------------------------------
;binds
;---------------------------------------------------------

[State 1111, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0 
pos = 198, -136

[State 1111, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 146, -190

[State 1111, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 160, -162

[state 1111, snd]
type = playsnd
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(14) = 0
trigger3 = animelemtime(22) = 0
trigger4 = animelemtime(30) = 0
value = 1100,1

[state 1111, fx]
type = explod
trigger1 = animelemtime(5) > 0 && animelemtime(36) < 0
anim = F61
pos = 0,0
scale = 2,2
ownpal = 1
persistent = 16


[State 1111, Giant Swing Bind 1]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
trigger2 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
trigger3 = AnimElemTime(20) >= 0 && AnimElemTime(21) < 0
trigger4 = AnimElemTime(28) >= 0 && AnimElemTime(29) < 0
pos = 81, -182

[State 1111, Giant Swing Bind 2]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
trigger3 = AnimElemTime(21) >= 0 && AnimElemTime(22) < 0
trigger4 = AnimElemTime(29) >= 0 && AnimElemTime(30) < 0
pos = 64, -208

[State 1111, Giant Swing Bind 3]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
trigger3 = AnimElemTime(22) >= 0 && AnimElemTime(23) < 0
trigger4 = AnimElemTime(30) >= 0 && AnimElemTime(31) < 0
pos = 53, -210

[State 1111, Giant Swing Bind 4]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
trigger3 = AnimElemTime(23) >= 0 && AnimElemTime(24) < 0
trigger4 = AnimElemTime(31) >= 0 && AnimElemTime(32) < 0
pos = -76, -208

[State 1111, Giant Swing Bind 5]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
trigger3 = AnimElemTime(24) >= 0 && AnimElemTime(25) < 0
trigger4 = AnimElemTime(32) >= 0 && AnimElemTime(33) < 0
pos = -77, -182

[State 1111, Giant Swing Bind 6]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
trigger3 = AnimElemTime(25) >= 0 && AnimElemTime(26) < 0
trigger4 = AnimElemTime(33) >= 0 && AnimElemTime(34) < 0
pos = -48, -190

[State 1111, Giant Swing Bind 7]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
trigger3 = AnimElemTime(26) >= 0 && AnimElemTime(27) < 0
trigger4 = AnimElemTime(34) >= 0 && AnimElemTime(35) < 0
pos = 1, -180

[State 1111, Giant Swing Bind 8]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
trigger3 = AnimElemTime(27) >= 0 && AnimElemTime(28) < 0
trigger4 = AnimElemTime(35) >= 0 && AnimElemTime(36) < 0
pos = 57, -198

[state 1111, giant Swing Throw]
type = targetstate
trigger1 = animelemtime(36) = 0
value = 1131

[state 1111, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(36) = 0
value = -floor(fvar(10)*20)
kill = 0

[state 1121, targetpoweradd]
type = targetpoweradd
trigger1 = animelemtime(36) = 0
value = 20



[state 1111, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 1111, velset]
type = velset
trigger1 = animelemtime(36) = 0
x = -16

[state 1111, dust]
type = explod
trigger1 = animelem = 36
anim = F120
pos = -70,0
scale = 2, 2
sprpriority = 4

[state 1111, dust]
type = explod
trigger1 = animelem = 37
anim = F120
pos = -28,0
scale = 2, 2
sprpriority = 4

[state 1111, dust]
type = explod
trigger1 = animelem = 38
anim = F120
pos = -25,0
scale = 2, 2
sprpriority = 4

[state 1111, playsnd]
type = playsnd
trigger1 = p2stateno = 1136
value = 650,0
persistent = 0

[state 1111, end]
type = changestate
trigger1 = animtime = 0
value = 1112


;---------------------------------------------------------------------------
;Butt Rush to wall
[statedef 1112]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1112
sprpriority = 3

[state 1112, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1112, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1000,0

[state 1112, velset]
type = velset
trigger1 = animelemtime(4) = 0
persistent = 0
x = 32

[state 1112, dust]
type = explod
trigger1 = animelemtime(4) > 0
anim = F120
pos = 0,0
scale = 2, 2
sprpriority = 4
persistent = 2


[state 1112, stop]
type = changestate
trigger1 = frontedgebodydist < 60
value = 1113

;-------------------------------------------------------
;Wall Crash
[statedef 1113]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1113
sprpriority = 4
poweradd = 50

[state 1113, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1113, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))

[State 1113, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
postype = p1
pos = 0,-158
sprpriority = 5
ownpal = 1
scale = -1.2,2.25

[state 1113, playsnd]
type = playsnd
trigger1 = time = 0
value = 1130,0

[state 1113, targetstate]
type = targetstate
trigger1 = time = 0
value = 1134

[state 1113, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -floor(fvar(10)*220)

[state 1123, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value =260

[state 1111, poweradd]
type = poweradd
trigger1 = time = 0
value = 180

[state 1113, width]
type = width
trigger1 = 1
edge = 0,0

[state 1113, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 1113, envshake]
type = envshake
trigger1 = time = 0
ampl = 18
time = 30

[state 1113, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0
persistent = 0

[state 1113, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0
persistent = 0

[state 1123, posadd]
type = posadd
trigger1 = animelemtime(13) = 0
x = -192

[state 1113, step back]
type = velset
trigger1 = animelemtime(13) > 0
x = const(velocity.walk.back.x)*0.4
persistent = 1

[state 1113, physics]
type = statetypeset
trigger1 = animelemtime(13) = 0
physics = S

[state 1113, Footsteps]
type = playsnd
trigger1 = animelemtime(17) = 0
trigger2 = animelemtime(23) = 0
value = 20,0
channel = 2
ignorehitpause = 1
persistent = 1

[state 1113, envshake]
type = envshake
trigger1 = animelemtime(17) = 0
trigger2 = animelemtime(23) = 0
ampl = -8
time = 10

[state 1113, Slaps]
type = playsnd
trigger1 = animelemtime(18) = 0
trigger2 = animelemtime(24) = 0
value = 20,1
channel = 1
ignorehitpause = 1
persistent = 1
volume = 25

[state X, Combo Scaling]
type = varadd
trigger1 = time = 2
v = 18
value = -18
persistent = 0
ignorehitpause = 1


[state 1113, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Giant Swing EX
;---------------------------------------------------------------------------
[statedef 1120]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0

[state X, X&Y axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0
var(43) = 0

[State 1020, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = animelemtime(6) < 0
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1120, grab invunerability]
type = nothitby
trigger1 = animelemtime(6) < 0
value = ,AT

[state 1120, movement]
type = velset
triggerall = animelemtime(6) < 0
trigger1 = command = "holdfwd"
trigger2 = ailevel
x = 2.8
persistent = 1

[state 1120, movement]
type = velset
triggerall = animelemtime(6) < 0
trigger1 = command = "holdback"
x = -2.8
persistent = 1

[state 1120, movement]
type = velset
triggerall = animelemtime(6) < 0
trigger1 = command != "holdback" && command != "holdfwd"
trigger2 = ailevel
trigger2 = 0
x = 0
persistent = 1

[state 1120, helper poweradd]
type = helper
trigger1 = !numhelper(1120)
trigger1 = time = 0
stateno = 1129
postype = p1
pos = 0,0


;[state 1120, poweradd]
;type = poweradd
;trigger1 = time = 0
;trigger1 = var(21) = 1
;value = -500
;persistent = 0
;===========
;Armor start
;===========

[state 1120, changeanim]
type = changeanim
trigger1 = anim != 1120
value = 1120


[state 1120, armor counter]
type = varset
trigger1 = time = 0
trigger1 = var(21) = 1
V = 20
value = 7
persistent = 0

[state 1100, armor int cancel]
type = varset
trigger1 = time = 1
v = 21
value = 0

[state 1120, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

;determine what frame
[state 1120, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 1120, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = anim
elem = var(22)

[state 1120, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*0.8)
value = 1
;--------------------------

[state 1120, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
value = floor(-gethitvar(damage)*0)
persistent = 1

[state 1120, Unstoppable]
type = hitoverride
triggerall = var(20) > 0
triggerall = alive
trigger1 = animelemtime(6) < 0
attr = SCA, AA,AP
stateno = 1120
time = 1
persistent = 1

[state 1120, notgrabable]
type = null;nothitby
trigger1 = animelemtime(6) < 0
value = ,AT
ignorehitpause = 1

[State 1120, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1

[State 1120, 1]
type = HitDef
Trigger1 = !movecontact
trigger1 = enemynear,stateno != [150,155]
attr = S, ST         
hitflag = M-          
id = 1120
getpower = 0
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 2                     
p1facing = 1
p2facing = 1          
p1stateno = 1121      
p2stateno = 1135      
guard.dist = 0       
fall = 1

[State 1120, 1]
type = HitDef
Trigger1 = enemynear,anim = 5300
attr = S, ST         
hitflag = M          
id = 1120
getpower = 0
priority = 1, Miss  
sparkno = -1          
p1sprpriority = 2                     
p1facing = 1
p2facing = 1          
p1stateno = 1121      
p2stateno = 1135      
guard.dist = 0       
fall = 1

[state 1120, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Giant Swing Animation Light
;---------------------------------------------------------------------------
[statedef 1121]
type = S
movetype = A
physics = N
anim = 1111
ctrl = 0
velset = 0,0

[State 1020, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = animelemtime(18) < 0
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause


[State 1121, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

[State 1121, Width 2-11]
type = Width
trigger1 = 1
edge = 120,120
;---------------------------------------------------------
;binds
;---------------------------------------------------------

[State 1121, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0 
pos = 198, -136

[State 1121, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 146, -190

[State 1121, Bind 3]
type = TargetBind
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 160, -162

[state 1121, snd]
type = playsnd
trigger1 = animelemtime(6) = 0
trigger2 = animelemtime(14) = 0
trigger3 = animelemtime(22) = 0
trigger4 = animelemtime(30) = 0
value = 1100,1

[state 1121, fx]
type = explod
trigger1 = animelemtime(5) > 0 && animelemtime(36) < 0
anim = F61
pos = 0,0
scale = 2,2
ownpal = 1
persistent = 16


[State 1121, Giant Swing Bind 1]
type = TargetBind
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
trigger2 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
trigger3 = AnimElemTime(20) >= 0 && AnimElemTime(21) < 0
trigger4 = AnimElemTime(28) >= 0 && AnimElemTime(29) < 0
pos = 81, -182

[State 1121, Giant Swing Bind 2]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
trigger3 = AnimElemTime(21) >= 0 && AnimElemTime(22) < 0
trigger4 = AnimElemTime(29) >= 0 && AnimElemTime(30) < 0
pos = 64, -208

[State 1121, Giant Swing Bind 3]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
trigger3 = AnimElemTime(22) >= 0 && AnimElemTime(23) < 0
trigger4 = AnimElemTime(30) >= 0 && AnimElemTime(31) < 0
pos = 53, -210

[State 1121, Giant Swing Bind 4]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
trigger3 = AnimElemTime(23) >= 0 && AnimElemTime(24) < 0
trigger4 = AnimElemTime(31) >= 0 && AnimElemTime(32) < 0
pos = -76, -208

[State 1121, Giant Swing Bind 5]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
trigger3 = AnimElemTime(24) >= 0 && AnimElemTime(25) < 0
trigger4 = AnimElemTime(32) >= 0 && AnimElemTime(33) < 0
pos = -77, -182

[State 1121, Giant Swing Bind 6]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
trigger3 = AnimElemTime(25) >= 0 && AnimElemTime(26) < 0
trigger4 = AnimElemTime(33) >= 0 && AnimElemTime(34) < 0
pos = -48, -190

[State 1121, Giant Swing Bind 7]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
trigger3 = AnimElemTime(26) >= 0 && AnimElemTime(27) < 0
trigger4 = AnimElemTime(34) >= 0 && AnimElemTime(35) < 0
pos = 1, -180

[State 1121, Giant Swing Bind 8]
type = TargetBind
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
trigger3 = AnimElemTime(27) >= 0 && AnimElemTime(28) < 0
trigger4 = AnimElemTime(35) >= 0 && AnimElemTime(36) < 0
pos = 57, -198

[state 1121, giant Swing Throw]
type = targetstate
trigger1 = animelemtime(36) = 0
value = 1131

[state 1121, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(36) = 0
value = -floor(fvar(10)*20)
kill = 0

[state 1121, targetpoweradd]
type = targetpoweradd
trigger1 = animelemtime(36) = 0
value = 20

[state 1121, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 1121, velset]
type = velset
trigger1 = animelemtime(36) = 0
x = -24

[state 1121, dust]
type = explod
trigger1 = animelem = 36
anim = F120
pos = -70,0
scale = 2, 2
sprpriority = 4

[state 1121, dust]
type = explod
trigger1 = animelem = 37
anim = F120
pos = -28,0
scale = 2, 2
sprpriority = 4

[state 1121, dust]
type = explod
trigger1 = animelem = 38
anim = F120
pos = -25,0
scale = 2, 2
sprpriority = 4

[state 1121, playsnd]
type = playsnd
trigger1 = p2stateno = 1136
value = 650,0
persistent = 0

[state 1121, end]
type = changestate
trigger1 = animtime = 0
value = 1122


;---------------------------------------------------------------------------
;Butt Rush to wall
[statedef 1122]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1112
sprpriority = 3

[state 1122, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1122, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 1000, playsnd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 1000,0

[state 1122, velset]
type = velset
trigger1 = animelemtime(4) = 0
persistent = 0
x = 40

[state 1122, dust]
type = explod
trigger1 = animelemtime(4) > 0
anim = F120
pos = 0,0
scale = 2, 2
sprpriority = 4
persistent = 2


[state 1122, stop]
type = changestate
trigger1 = frontedgebodydist < 60
value = 1123

;-------------------------------------------------------
;Wall Crash
[statedef 1123]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1123
sprpriority = 4

[state 1123, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1123, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))

[State 1123, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
postype = p1
pos = 0,-158
sprpriority = 5
ownpal = 1
scale = -1.2,2.25

[state 1123, playsnd]
type = playsnd
trigger1 = time = 0
value = 1130,0

[state 1123, targetstate]
type = targetstate
trigger1 = time = 0
value = 1134

[state 1123, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -floor(fvar(10)*240)

[state 1123, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 280

[state 1123, width]
type = width
trigger1 = 1
edge = 0,0

[state 1123, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 1123, envshake]
type = envshake
trigger1 = time = 0
ampl = 18
time = 30

[state 1123, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0
persistent = 0

[state 1123, playsnd]
type = playsnd
trigger1 = time = 0
value = 650,0
persistent = 0

[state 1123, posadd]
type = posadd
trigger1 = animelemtime(13) = 0
x = -192

[state 1123, step back]
type = velset
trigger1 = animelemtime(13) > 0
x = const(velocity.walk.back.x)*0.6
persistent = 1

[state 1103, Footsteps]
type = playsnd
trigger1 = animelemtime(17) = 0
trigger2 = animelemtime(23) = 0
trigger3 = animelemtime(29) = 0
value = 20,0
channel = 2
ignorehitpause = 1
persistent = 1

[state 1123, envshake]
type = envshake
trigger1 = animelemtime(17) = 0
trigger2 = animelemtime(23) = 0
trigger3 = animelemtime(29) = 0
ampl = -8
time = 10

[state 1103, Slaps]
type = playsnd
trigger1 = animelemtime(18) = 0
trigger2 = animelemtime(24) =0
trigger3 = animelemtime(31) = 0
value = 20,1
channel = 1
ignorehitpause = 1
persistent = 1
volume = 25

[state 1123, physics]
type = statetypeset
trigger1 = animelemtime(13) = 0
physics = S

[state X, Combo Scaling]
type = varadd
trigger1 = time = 2
v = 18
value = -18
persistent = 0
ignorehitpause = 1


[state 1123, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
;Meter Management EX Command Grab
[statedef 1129]
type = U
movetype = U
physics = N
anim = 9999

[state 1129, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1129, poweradd]
type = poweradd
trigger1 = time = 0
value = -500
ignorehitpause = 1
persistent = 0

[state 1129, destroyself]
type = destroyself
trigger1 = time = 24
ignorehitpause = 1


;---------------------------------------------------------------------------
[Statedef 1130]
type    = A
movetype= H
physics = N
velset = 0,0

[state 1130, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 1130, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1130

[State 810, Giant Swing Bind 1]
type = angledraw
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
trigger2 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
value = 90 

[State 810, Giant Swing Bind 2]
type = angledraw
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
value = 45
scale = 1,0.75

[State 810, Giant Swing Bind 3]
type = angledraw
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
value = 0
scale = 1,0.5

[State 810, Giant Swing Bind 4]
type = angledraw
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
value = 315
scale = 1,0.75

[State 810, Giant Swing Bind 5]
type = angledraw
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
value = 270 

[State 810, Giant Swing Bind 6]
type = angledraw
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
value = 225
scale = 1,0.8 

[State 810, Giant Swing Bind 7]
type = angledraw
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
value = 180
scale = 1,0.6 

[State 810, Giant Swing Bind 8]
type = angledraw
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
value = 135
scale = 1,0.8 

[state 1130, sprpriority]
type = sprpriority
trigger1 = animelem = 5
trigger2 = animelem = 13
value = -2

[state 1130, sprpriority]
type = sprpriority
trigger1 = animelem = 9
trigger2 = animelem = 16
value = 3

[State 1130, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------

[Statedef 1131]
type    = A
movetype= H
physics = N
velset = -36,0
poweradd = 40

[state 1131, posadd]
type = posadd
trigger1 = time = 0
y = 40

[state 1131, anim]
type = changeanim
trigger1 = time = 0
value = 5030

[state 1131, screenbound]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,0

[state 1131, changestate]
type = changestate
trigger1 = frontedgebodydist  < 1 || backedgebodydist < 1
value = 1132

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;---------------------------------------------------------------------------
;Wall splat
[statedef 1132]
type    = A
movetype= H
physics = N

[state 1132, anim]
type = changeanim2
trigger1 = time = 0
value = 1131

[state 1132, angledraw]
type = angledraw
trigger1 = 1
value = -90

[state 1132, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 1132, envshake]
type = envshake
trigger1 = time = 0
ampl = 8
time = 12


[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[state 672, posset]
type = posset
trigger1 = time = 0
x = -(facing*(gamewidth/2))

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,0;const(size.mid.pos.y)
postype = p1
sprpriority = 3
ownpal = 1
scale = 1,1.5

[State 672, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 672, State]
type = ChangeState
trigger1 = time = 80
value = 1133

;----------------------------------------------------------------------------
;Flattened on wall
[statedef 1134]
type =A
movetype = H
velset = 0,0

[state 1132, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 1132, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.2,0.2

[state 1135, anim]
type = changeanim2
trigger1 = time =  0
value = 1132

[state 1135, end]
type = changestate
trigger1 = time >= 64
value = 1133




;----------------------------------------------------------------------------
;fall off wall
[statedef 1133]
type = A
movetype = H
physics = N
velset = 0.5,4

[state 1133, anim]
type = changeanim
trigger1 = time = 0
value = 5051

[state 1133, anim]
type = changeanim
trigger1 = vel y > 0
trigger1 = anim != 5061
value = 5061

[state 1132, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1132, angledraw]
type = angledraw
trigger1 = 1
scale = 0.6,1.1
value = 0

[state 1133, veladd]
type = veladd
trigger1 = time > 0
y = 0.4

[state 1133, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1133, nothitby]
type = nothitby
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = SCA
time = 36

[state 1133, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 5100

;----------------------------------------------------
;Victim Hard version
;----------------------------------------------------
[Statedef 1135]
type    = A
movetype= H
physics = N
velset = 0,0

[state 1130, screenbound]
type = screenbound
trigger1 = 1
movecamera = 1,0
value = 0

[State 1130, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 1135

[State 810, Giant Swing Bind 1]
type = angledraw
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
trigger2 = AnimElemTime(12) >= 0 && AnimElemTime(13) < 0
trigger3 = AnimElemTime(20) >= 0 && AnimElemTime(21) < 0
trigger4 = AnimElemTime(28) >= 0 && AnimElemTime(29) < 0
value = 90 

[State 810, Giant Swing Bind 2]
type = angledraw
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
trigger2 = AnimElemTime(13) >= 0 && AnimElemTime(14) < 0
trigger3 = AnimElemTime(21) >= 0 && AnimElemTime(22) < 0
trigger4 = AnimElemTime(29) >= 0 && AnimElemTime(30) < 0
value = 45
scale = 1,0.75

[State 810, Giant Swing Bind 3]
type = angledraw
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
trigger2 = AnimElemTime(14) >= 0 && AnimElemTime(15) < 0
trigger3 = AnimElemTime(22) >= 0 && AnimElemTime(23) < 0
trigger4 = AnimElemTime(30) >= 0 && AnimElemTime(31) < 0
value = 0
scale = 1,0.5

[State 810, Giant Swing Bind 4]
type = angledraw
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
trigger2 = AnimElemTime(15) >= 0 && AnimElemTime(16) < 0
trigger3 = AnimElemTime(23) >= 0 && AnimElemTime(24) < 0
trigger4 = AnimElemTime(31) >= 0 && AnimElemTime(32) < 0
value = 315
scale = 1,0.75

[State 810, Giant Swing Bind 5]
type = angledraw
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
trigger2 = AnimElemTime(16) >= 0 && AnimElemTime(17) < 0
trigger3 = AnimElemTime(24) >= 0 && AnimElemTime(25) < 0
trigger4 = AnimElemTime(32) >= 0 && AnimElemTime(33) < 0
value = 270 

[State 810, Giant Swing Bind 6]
type = angledraw
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
trigger2 = AnimElemTime(17) >= 0 && AnimElemTime(18) < 0
trigger3 = AnimElemTime(25) >= 0 && AnimElemTime(26) < 0
trigger4 = AnimElemTime(33) >= 0 && AnimElemTime(34) < 0
value = 225
scale = 1,0.8 

[State 810, Giant Swing Bind 7]
type = angledraw
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
trigger2 = AnimElemTime(18) >= 0 && AnimElemTime(19) < 0
trigger3 = AnimElemTime(26) >= 0 && AnimElemTime(27) < 0
trigger4 = AnimElemTime(34) >= 0 && AnimElemTime(35) < 0
value = 180
scale = 1,0.6 

[State 810, Giant Swing Bind 8]
type = angledraw
trigger1 = AnimElemTime(11) >= 0 && AnimElemTime(12) < 0
trigger2 = AnimElemTime(19) >= 0 && AnimElemTime(20) < 0
trigger3 = AnimElemTime(27) >= 0 && AnimElemTime(28) < 0
trigger4 = AnimElemTime(35) >= 0 && AnimElemTime(36) < 0
value = 135
scale = 1,0.8 

[state 1130, sprpriority]
type = sprpriority
trigger1 = animelem = 5
trigger2 = animelem = 13
trigger3 = animelem = 21
trigger4 = animelem = 29
value = -2

[state 1130, sprpriority]
type = sprpriority
trigger1 = animelem = 9
trigger2 = animelem = 16
trigger3 = animelem = 24
trigger4 = animelem = 32
value = 3

[State 1130, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050


;===========================================================================
;Sexy Slide
;===========================================================================
; Light version
[statedef 1150]
type = C
movetype = A
physics = N
anim = 1150
velset = 0,0
ctrl = 0

[state X, X axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1150, velset]
type= velset
trigger1 = animelemtime(5) = 0
x = 16

[state 1150, nothitby]
type = nothitby
trigger1 = !movehit
trigger1 = animelemtime(5) > 0
value = ,AP

[state 1150, nothitby]
type = nothitby
trigger1 = movehit
value = ,AP

[state 1150, snd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 1150,0

[State 1150, 2]
type = HitDef
trigger1 = animelemtime(8) < 0
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = ifelse(p2statetype =  L,40,40),4
hitflag = MAFD
guardflag = L
id = 1150
pausetime = 6,6
sparkno = 3
sparkxy = -10,-105
hitsound   = S5000,2
guardsound = S120,0
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 8,-6
air.velocity = 8,-2
down.velocity = -64,0
guard.velocity = -12
guard.slidetime = 24
guard.hittime = 24
guard.dist = 360
guard.kill = 0
kill = 0

[State 1150, 2]
type = HitDef
trigger1 = animelemtime(8) >= 0
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = 40,4
guardflag = LA
hitflag = MAFD
pausetime = 6,6
sparkno = 3
id = 1150
sparkxy = -10,-105
hitsound   = S5000,2
guardsound = S120,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 8,-6
down.velocity = -64,0
air.velocity = 8,-2
guard.velocity = -12
guard.slidetime = 24
guard.hittime = 24
guard.dist = 360
guard.kill = 0
kill = 0

[state 1150, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 5
trigger1 = numtarget(1150)
Trigger1 = p2statetype != L
value = 1180
ignorehitpause = 1

[state 1150, playerpush]
type = playerpush
trigger1 = movehit
value = 0
ignorehitpause = 1

[state 1101, dust]
type = explod
trigger1 = animelemtime(6) > 0
anim = F120
pos = 124,0
scale = 1, 1
sprpriority = 4
persistent = 3

[state 1101, dust]
type = explod
trigger1 = animelemtime(6) > 0
anim = F120
pos = -209,0
scale = 1, 1
sprpriority = 4
persistent = 3

[state 1150, changestate]
type = changestate
triggerall = animelemtime(5) > 0
triggerall = movehit
triggerall = numtarget(1150)
triggerall = !target(1150),ishelper
triggerall = target(1150),stateno = [1180,1181]
trigger1 = command = "a" || command = "b" 
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = time > 23
value = 1152

[state 1150, velslow]
type = null
trigger1 = movehit
x = 0.9
ignorehitpause = 1
persistent = 0

[state 1150, end]
type = changestate
trigger1 = time > 32
value= 1151

;-----------------------------------------------------------------------------
;slide to stop
[statedef 1151]
type = C
movetype = I
physics = C
anim = 1151
ctrl = 0
movehitpersist = 1

[state 1151, changestate]
type = changestate
triggerall =  time < 16
trigger1 = command = "a" || command = "b" 
trigger1 = movehit
value = 1152

[state 1101, dust]
type = explod
trigger1 = time < 16
anim = F120
pos = 124,0
scale = 1, 1
sprpriority = 4
persistent = 6

[state 1101, dust]
type = explod
trigger1 = time < 16
anim = F120
pos = -209,0
scale = 1, 1
sprpriority = 4
persistent = 6

[state 1151, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;----------------------------------------------------------------------------
;Follow up butt drop
[statedef 1152]
type = A
movetype = A
physics = C
anim = 1152

[state 1152, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1152, playerpush]
type = playerpush
trigger1 =1 
value = 0

[state 1152, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = p2bodydist x * 0.03
y = -12

[state 1152, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
physics = N
statetype = A

[state 1152, gravity]
type = gravity
trigger1 = animelemtime(3) > 1

[state 1172, faster fall]
type = veladd
trigger1 = vel y > 2
y = 0.8
persistent = 1

[State 1152, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage    = 80
guardflag = 
hitflag = FD
priority = 4
pausetime = 0,0
sparkno = 0
id = 1152
nochainid = 650
sparkxy = -10,-40
hitsound   = 0,-1
guardsound = S120,0
animtype = Med
p1sprpriority = -3
p2sprpriority = 1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
guard.velocity = -40
guard.slidetime = 35
guard.hittime = 35
airguard.velocity = -20,4
airguard.hittime = 22

[state 1152, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = p2statetype != A
value = 660

[state 1152, nothitby]
type = nothitby
trigger1 = 1
value = SCA



[state 1152, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1153

;----------------------------------------------------------------------------
;Landing 1
[statedef 1153]
type    = C
movetype= A
physics = N
poweradd= 30
sprpriority = 3
velset = 0,0

[state 1153, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1153, anim]
type = changeanim
trigger1 = time = 0
value = 1153

[state 1153, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1153, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1153, earthquakes]
type = envshake
trigger1 = time = 0
time = 24
ampl = -24
freq = 60
phase = 60

[State 1153, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage    = 80
guardflag = 
givepower = 140
hitflag = FD
priority = 4
pausetime = 0,0
sparkno = 1
sparkxy = -10,-40
hitsound   = S1130,0
guardsound = 6,0
animtype = Med
p2stateno = 660
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state X, Combo Scaling]
type = varadd
trigger1 = time = 2
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1153, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1153, velset]
type = posset
trigger1 = time = 0
y = 0

[state 1153, velset]
type = velset
trigger1 = time = 8
y = -8

[state 1153, gravity]
type = gravity
trigger1 = time > 8

[state 1153, end]
type = changestate
triggerall = time > 8
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1154
;---------------------------------------------------------------------------
;Landing 2
[statedef 1154]
type = C
movetype = I
physics = C
anim = 1154

[state 1154, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1154, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1154, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1153, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1153, earthquakes]
type = envshake
trigger1 = time = 0
time = 12
ampl = -8
freq = 60
phase = 60

[state 1153, end]
type = changestate
trigger1 = animtime = 0
value = 653

;===========================================================================
;Sexy Slide
;===========================================================================
;Hard Version
[statedef 1160]
type = C
movetype = A
physics = N
anim = 1160
velset = 0,0
ctrl = 0

[state X, X axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1160, velset]
type= velset
trigger1 = animelemtime(5) = 0
x = 24

[state 1160, snd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 1150,0

[state 1160, nothitby]
type = nothitby
trigger1 = !movehit
trigger1 = animelemtime(5) > 0
value = ,AP


[state 1150, nothitby]
type = nothitby
trigger1 = movehit
value = ,AP

[State 1160, 2]
type = HitDef
trigger1 = animelemtime(8) < 0
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = ifelse(p2statetype =  L,40,40),4
hitflag = MAFD
guardflag = L
id = 1160
pausetime = 6,6
sparkno = 3
sparkxy = -10,-105
hitsound   = S5000,1
guardsound = S120,0
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 6,-7
air.velocity = 6,-2.2
down.velocity =  -72,0
guard.velocity = -12
guard.slidetime = 18
guard.hittime = 18
guard.dist = 360
guard.kill = 0
kill = 0

[State 1160, 2]
type = HitDef
trigger1 = animelemtime(8) >= 0
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = ifelse(p2statetype =  L,40,40),4
hitflag= MAFD
guardflag = LA
pausetime = 6,6
sparkno = 3
id = 1160
sparkxy = -10,-105
hitsound   = S5000,1
guardsound = S120,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 6,-7
down.velocity = -72,0
air.velocity = 6,-2.2
guard.velocity = -12
guard.slidetime = 16
guard.hittime = 16
guard.dist = 360
guard.kill = 0
kill = 0

[state 1160, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 5
trigger1 = numtarget(1160)
trigger1 = p2statetype != L
value = 1180
ignorehitpause = 1

[state 1160, playerpush]
type = playerpush
trigger1 = movehit
value = 0
ignorehitpause = 1

[state 1160, dust]
type = explod
trigger1 = animelemtime(6) > 0
anim = F120
pos = 124,0
scale = 1, 1
sprpriority = 4
persistent = 3

[state 1160, dust]
type = explod
trigger1 = animelemtime(6) > 0
anim = F120
pos = -209,0
scale = 1, 1
sprpriority = 4
persistent = 3

[state 1160, changestate]
type = changestate
triggerall = animelemtime(5) > 0
triggerall = movehit
triggerall = numtarget(1160)
triggerall = !target(1160),ishelper
triggerall = target(1160),stateno = [1180,1181]
triggerall = p2statetype != L
trigger1 = command = "a" || command = "b" 
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = time > 23
value = 1162

[state 1160, velslow]
type = null
trigger1 = movehit
x = 0.9
ignorehitpause = 1
persistent = 0

[state 1160, end]
type = changestate
trigger1 = time > 32
value= 1161

;-----------------------------------------------------------------------------
;slide to stop
[statedef 1161]
type = C
movetype = I
physics = C
anim = 1161
ctrl = 0
movehitpersist = 1

[state 1161, changestate]
type = changestate
triggerall = time < 16
trigger1 = command = "a" || command = "b" 
trigger1 = movehit
value = 1162

[state 1161, dust]
type = explod
trigger1 = time < 16
anim = F120
pos = 124,0
scale = 1, 1
sprpriority = 4
persistent = 6

[state 1161, dust]
type = explod
trigger1 = time < 16
anim = F120
pos = -209,0
scale = 1, 1
sprpriority = 4
persistent = 6

[state 1161, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;----------------------------------------------------------------------------
;Follow up butt drop
[statedef 1162]
type = A
movetype = A
physics = C
anim = 1152

[state 1162, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1162, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1162, playerpush]
type = playerpush
trigger1 =1 
value = 0

[state 1162, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = p2bodydist x * 0.032
y = -16

[state 1162, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
physics = N
statetype = A

[state 1162, gravity]
type = gravity
trigger1 = animelemtime(3) > 1

[state 1162, veladd]
type = veladd
trigger1 = vel y > 2
y = 0.8
persistent = 1

[State 1162, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage    = 120
guardflag = 
hitflag = FD
priority = 4
givepower = 180
pausetime = 0,0
sparkno = 0
id = 1152
nochainid = 650
sparkxy = -10,-40
hitsound   = 1,-1
guardsound = S120,0
animtype = Med
p1sprpriority = -3
p2sprpriority = 1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
guard.velocity = -40
guard.slidetime = 35
guard.hittime = 35
airguard.velocity = -20,4
airguard.hittime = 22

[state 1162, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = p2statetype != A
value = 660



[state 1162, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1163

;----------------------------------------------------------------------------
;Landing 1
[statedef 1163]
type    = C
movetype= A
physics = N
poweradd= 30
sprpriority = 3
velset = 0,0

[state 1163, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1163, anim]
type = changeanim
trigger1 = time = 0
value = 1153

[state 1163, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1163, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1163, earthquakes]
type = envshake
trigger1 = time = 0
time = 24
ampl = -24
freq = 60
phase = 60

[State 1163, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage    = 120
guardflag = 
hitflag = FD
priority = 4
pausetime = 0,0
sparkno = 1
sparkxy = -10,-40
hitsound   = S1130,0
guardsound = S120,0
animtype = Med
p2stateno = 660
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state X, Combo Scaling]
type = varadd
trigger1 = time = 2
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1163, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1163, velset]
type = posset
trigger1 = time = 0
y = 0

[state 1163, velset]
type = velset
trigger1 = time = 8
y = -8

[state 1163, gravity]
type = gravity
trigger1 = time > 8

[state 1163, end]
type = changestate
triggerall = time > 8
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1164
;---------------------------------------------------------------------------
;Landing 2
[statedef 1164]
type = C
movetype = I
physics = C
anim = 1154

[state 1164, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1154, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1164, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1164, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1164, earthquakes]
type = envshake
trigger1 = time = 0
time = 12
ampl = -8
freq = 60
phase = 60

[state 1164, end]
type = changestate
trigger1 = animtime = 0
value = 653

;===========================================================================
;Sexy Slide
;===========================================================================
;EX
[statedef 1170]
type = C
movetype = A
physics = N
anim = 1170
velset = 0,0
ctrl = 0
poweradd = -500

[state X, X axis charge reset]
type = varset
trigger1 = time = 0
var(41) = 0

[state 1170, velset]
type= velset
trigger1 = animelemtime(5) = 0
x = 32

[State 1020, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1170, nothitby]
type = nothitby
trigger1 = 1
value = ,AP
ignorehitpause = 1

[state 1170, snd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 1150,0

[State 1170, 2]
type = HitDef
trigger1 = animelemtime(8) < 0
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = ifelse(p2statetype = L, 50,80),8
hitflag = MAFD
getpower = 0
guardflag = L
id = 1170
pausetime = 6,6
sparkno = 3
sparkxy = -10,-105
hitsound   = S5000,1
guardsound = S120,0
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 4,-8
down.velocity = ifelse(var(6) > 1, 0, -72),ifelse(var(6) > 1, -26, 0)
air.velocity = 4,-2.5
guard.velocity = -12
guard.slidetime = 18
guard.hittime = 18
guard.dist = 360
guard.kill = 0
kill = 0

[State 1170, 2]
type = HitDef
trigger1 = animelemtime(8) >= 0
trigger1 = !movecontact
attr = S, SA
animtype  = up
damage    = ifelse(p2statetype = L, 50,80),8
hitflag  = MAFD
guardflag = LA
getpower = 0
pausetime = 6,6
sparkno = 3
id = 1170
sparkxy = -10,-105
hitsound   = S5000,1
guardsound = S120,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 4,-8
air.velocity = 4,-2.5
down.velocity = ifelse(var(6) > 1, 0, -72),ifelse(var(6) > 1, -26, 0)
guard.velocity = -12
guard.slidetime = 16
guard.hittime = 16
guard.dist = 360
guard.kill = 0
kill = 0

[state 1170, varadd]
type = varadd
trigger1 = movehit
trigger1 = p2statetype = L
v = 6
value  = -1  

[state 1170, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 5
trigger1 = numtarget(1170)
trigger1 = p2statetype != L
value = 1180
ignorehitpause = 1

[state 1170, playerpush]
type = playerpush
trigger1 = movehit
value = 0
ignorehitpause = 1

[state 1170, dust]
type = explod
trigger1 = animelemtime(6) > 0
anim = F120
pos = 124,0
scale = 1, 1
sprpriority = 4
persistent = 3

[state 1170, dust]
type = explod
trigger1 = animelemtime(6) > 0
anim = F120
pos = -209,0
scale = 1, 1
sprpriority = 4
persistent = 3

[state 1170, changestate]
type = changestate
triggerall = time > 16
triggerall = movehit
triggerall = numtarget(1170)
triggerall = !target(1170),ishelper
triggerall = target(1170),stateno = [1180,1181]
triggerall = p2statetype != L
trigger1 = command = "a" || command = "b" 
trigger1 = !ailevel
trigger2 = ailevel
trigger2 = time = 23
value = 1172

[state 1170, velslow]
type = null
trigger1 = movehit
x = 0.9
ignorehitpause = 1
persistent = 0

[state 1170, end]
type = changestate
trigger1 = time > 32
value= 1171

;-----------------------------------------------------------------------------
;slide to stop
[statedef 1171]
type = C
movetype = I
physics = C
anim = 1171
ctrl = 0
movehitpersist = 1

[State 1171, Blink Yellow]
type = PalFX
trigger1 = time < 12
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1171, changestate]
type = changestate
triggerall = time < 16
trigger1 = command = "a" || command = "b" 
trigger1 = movehit
value = 1172

[state 1171, dust]
type = explod
trigger1 = time < 16
anim = F120
pos = 124,0
scale = 1, 1
sprpriority = 4
persistent = 6

[state 1171, dust]
type = explod
trigger1 = time < 16
anim = F120
pos = -209,0
scale = 1, 1
sprpriority = 4
persistent = 6

[state 1171, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1

;----------------------------------------------------------------------------
;Follow up butt drop
[statedef 1172]
type = A
movetype = A
physics = C
anim = 1152

[state 1172, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1172, nothitby]
type = nothitby
trigger1 = 1
value = SCA


[state 1172, playerpush]
type = playerpush
trigger1 =1 
value = 0

[state 1172, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = p2bodydist x * 0.032
y = -14

[state 1172, statetypeset]
type = statetypeset
trigger1 = animelemtime(3) = 0
physics = N
statetype = A

[state 1172, gravity]
type = gravity
trigger1 = animelemtime(3) > 1

[state 1172, faster fall]
type = veladd
trigger1 = vel y > 2
y = 0.8
persistent = 1

[State 1172, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage    = 80
guardflag = 
hitflag = FD
getpower = 0
givepower = 180
priority = 4
pausetime = 0,0
sparkno = 0
id = 1152
nochainid = 650
sparkxy = -10,-40
hitsound   = S1130,0
guardsound = 6,0
animtype = Med
p1sprpriority = -3
p2sprpriority = 1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0
guard.velocity = -40
guard.slidetime = 35
guard.hittime = 35
airguard.velocity = -20,4
airguard.hittime = 22

[state 1172, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = p2statetype != A
value = 660

[state 1172, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1173

;----------------------------------------------------------------------------
;Landing 1
[statedef 1173]
type    = C
movetype= A
physics = N
sprpriority = 3
velset = 0,0

[state 1173, anim]
type = changeanim
trigger1 = time = 0
value = 1153

[state 1173, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1173, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1173, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1173, earthquakes]
type = envshake
trigger1 = time = 0
time = 24
ampl = -24
freq = 60
phase = 60

[State 1173, 3]
type = HitDef
trigger1 = time = 0
attr = A, SA
damage    = 80
guardflag = 
hitflag = FD
priority = 4
pausetime = 0,0
sparkno = 1
sparkxy = -10,-40
hitsound   = S1130,0
guardsound = 6,0
animtype = Med
p2stateno = 660
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = 0
air.velocity = 0,0

[state X, Combo Scaling]
type = varadd
trigger1 = time = 2
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1173, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1173, velset]
type = posset
trigger1 = time = 0
y = 0

[state 1173, velset]
type = velset
trigger1 = time = 8
y = -8

[state 1173, gravity]
type = gravity
trigger1 = time > 8

[state 1173, end]
type = changestate
triggerall = time > 8
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1174
;---------------------------------------------------------------------------
;Landing 2
[statedef 1174]
type = C
movetype = I
physics = C
anim = 1154

[state 1174, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1174, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1174, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1174, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 1174, earthquakes]
type = envshake
trigger1 = time = 0
time = 12
ampl = -8
freq = 60
phase = 60

[state 1174, end]
type = changestate
trigger1 = animtime = 0
value = 653



;--------------------------------------------------------------------------
;Victim Hit
[statedef 1180]
type = A
movetype = H
physics = N
ctrl = 0
facep2 = 1

[state 1180, nothitb]
type = nothitby
trigger1 = 1
value = ,AP


[state 1180, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1180, changeanim2]
type = changeanim2
trigger1 = time = 0
value = 1180

[state 1180, velset]
type = velset
trigger1 = time = 0
x = facing *gethitvar(xvel)
y = gethitvar(yvel)

[state 1180, gravity]
type = veladd
trigger1 = time > 0
y = 0.4

[state 1180, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1181

;-------------------------------------------------------------------------

[statedef 1181]
type = L
movetype = H
physics = C
velset = 0,0

[state 1181, changeanim]
type = changeanim
trigger1 = time = 0
value = 5100

[state 1181, changeanim]
type = changeanim
trigger1 = anim = 5100
trigger1 = animtime = 0
value = 5110

[state 1181, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1181, get up]
type = selfstate
trigger1 = time > 60
value = 5120


;---------------------------------------------------------------------------
;Poses
[statedef 1200]
type = S
movetype = A
physics = S
ctrl = 0
sprpriority = 5
poweradd = 40

[state 1200, anim]
type = changeanim
trigger1 = anim != 1200
value = 1200

[state 1200, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = -10

[state 1200, velset]
type = velset
trigger1 = animelemtime(5) = 0
x = 0

[state 52, dust]
type = explod
trigger1 = animelemtime(6) = 0
anim = F120
pos = 120,0
scale = 2, 2
sprpriority = 2

[state 44, fx]
type = explod
trigger1 = animelemtime(6) = 0
anim = F61
pos = 0,0
scale = 3,1.5

[state 52, playsnd]
type = playsnd
trigger1 = animelemtime(6) = 0
value = 20,0

[state 52, dust]
type = explod
trigger1 = animelemtime(6) = 0
anim = F120
pos = -110,0
scale = 2, 2
sprpriority = 2

[state 20, earthquakes]
type = envshake
trigger1 = animelemtime(6) = 0
time = 12
ampl = -8
freq = 100
phase = 100

[state 1200, slap sound]
type = playsnd
trigger1 = animelemtime(14) = 0
value = 20,1

[state 1200, meter]
type = poweradd
trigger1 = animelemtime(14) = 0
value = 150

[state 1200, meter]
type = poweradd
trigger1 = animelemtime(1) > 2 && animelemtime(14) <= 0
value = 8
persistent = 5

[state 1200, meter]
type = poweradd
trigger1 = animelemtime(14) > 0
value = 24
persistent = 5

;================================
;Life add if power is maxed out
;================================
[state 1200, Life]
type = lifeadd
triggerall = power = powermax
trigger1 = animelemtime(14) = 0
value = 25

[state 1200, Life]
type = lifeadd
triggerall = power = powermax
trigger1 = animelemtime(1) > 2 && animelemtime(14) <= 0
value = 2
persistent = 5

[state 1200, Life]
type = lifeadd
triggerall = power = powermax
trigger1 = animelemtime(14) > 0
value = 4
persistent = 5


[State 0, Helper]
type = Helper
trigger1 = animelemtime(3) = 0
trigger1 = !numhelper(1210)
helpertype = normal ;player
name = "Photo Op"
ID = 1210
stateno = 1210
pos = 0,0
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[state 1200, dodge]
type = nothitby
trigger1 = animelemtime(2) > 0 && animelemtime(6) < 0
value = ,AA,AP

[state 1200, dodge]
type = nothitby
trigger1 = animelemtime(6) >= 0
value = ,AP

[state 1200, leavestate]
type = changestate
triggerall = animelemtime(6) > 0 
triggerall = roundstate <= 3
triggerall = !ailevel
trigger1 = command != "Hold Pose"
value = 1201

[state 1200, Leavestate AI]
type = changestate
triggerall = ailevel
triggerall = animelemtime(6) > 0
triggerall = !PlayerIdExist(helper(33333333),var(3)) && enemynear,numproj = 0
trigger1 = p2stateno = [1215,1216]
trigger2 = numhelper(1210)
trigger2 = helper(1210),movecontact
trigger3 = time > 80  
value = 1201


;-------------------------------------------------------------------------------
;Leave Pose
[statedef 1201]
type = S
movetype = I
physics = S
anim = 1201
ctrl = 0
sprpriority = 5

[state 1201, leave state early]
type = changestate
triggerall = time > 8
trigger1 = command = "chargeBFc"
trigger1 = power > 499
value = 1020

[state 1201, leave state early]
type = changestate
triggerall = time > 8
trigger1 = command = "chargeBFb"
value = 1010

[state 1201, leave state early]
type = changestate
triggerall = time > 8
trigger1 = command = "chargeBFa"
value = 1000

[state 1200, velset]
type = velset
trigger1 = animelemtime(2) = 0
x = -20

[state 1201, dodge]
type = nothitby
trigger1 = 1
value = ,AP

[state 1200, end]
type = changestate
trigger1 = animtime = 0
ctrl = 1
value = 0
;-------------------------------------------------------------------------
;Camera Flash
[statedef 1210]
type = S
movetype = A
physics = N
ctrl = 0
anim = 1210

[state 1210, anim]
type = changeanim
trigger1 = time = 0
value = (1213-parent,var(12))+ifelse(facing = 1,0,5)

[state 1210, facing]
type = turn
trigger1 = parent,facing != 1
trigger1 = time = 0
persistent = 0

[state 1210, Camera Sound]
type = bgpalfx
trigger1 = animelemtime(2) = 0
trigger1 = parent,var(12) > 0
time = 8
add = 120,120,120

[state 1210, camera sound]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger1 = parent,var(12) > 0
value = 1210,0



[State 1210, 2]
type = HitDef
trigger1 = AnimElem = 2
persistent = 0
attr = S, SP
animtype  = light
damage    = 10,10
guardflag = MA
hitflag = MA-
pausetime = 8,8
guard.pausetime = 4,4
sparkno = -1
id = 1210
sparkxy = -10,-197
hitsound   = -0,0
guardsound = 6,0
ground.type = High
ground.slidetime = 8
ground.hittime  = 8
ground.velocity = 0
air.velocity = 0,0
forcenofall = 1
guard.hittime = 16
guard.slidetime = 16
guard.velocity = 0
guard.dist = 640
guard.kill = 0
kill = 0

[state 1210, countdown]
type = parentvaradd
trigger1 = animelemtime(2) = 0
trigger1 = parent,var(12) > 0
value = -1
v = 12
ignorehitpause = 1

[state 1210, timer reset]
type = parentvarset
trigger1 = animelemtime(2) = 0
trigger1 = var(12) > 0 
value = 0
v = 13
ignorehitpause = 1

[state 1210, parentvaradd]
type = parentvaradd
trigger1 = movehit
v = 18
value = -18
persistent = 0

[state 1210, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = !target,ishelper
value = 1215
id = 1210
ignorehitpause = 1

[state 1210, destroyself]
type = destroyself
trigger1 = animtime = 0
trigger2 = movereversed
trigger3 = parent,stateno != 1200
ignorehitpause = 1

;---------------------------------------------------------------------------
;Knock back Stunned
[statedef 1215]
type = A
physics = U
ctrl = 0
movetype = H

[state 1215, hitback animtion]
type = changeanim
trigger1 = statetype = A
trigger1 = time = 0
value = 5030

[state 1215, knockback]
type = velset
trigger1 = statetype = A
trigger1 = time = 0
x = -4
y = -4

[state 1215, statetype set]
type = statetypeset
trigger1 = statetype = A
trigger1 = time = 0
physics = N

[state 1215, gravity]
type = gravity
trigger1 = statetype = A
trigger1 = pos y < -1

[state 1215, knockback]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger2 = statetype != A
value = 1216

;--------------------------------------------------------------------------------
;Stunned
[statedef 1216]
type = S
movetype = H
physics = S
velset = 0,0
anim = 5300

[state 1216, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1216, selfstate]
type = selfstate
trigger1 = time > 120
value = 0
ctrl = 1

;===========================================================================
;  Hip Bump (Push Block)
;===========================================================================

[Statedef 1400]
type = S
movetype = A
physics = S
velset = 0,0
anim = 1400

[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -500

[state 1400, awareness pause]
type = pause
trigger1 = time = 0
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[State 330, Spark]
type = Explod
trigger1 = AnimElem = 7
id = 1410
anim = 1410
postype = p1
pos = 250,-130
sprpriority = 4
bindtime = 1
scale = 2.5,2.5
ownpal = 1

[State 1400, 2]
type = null
trigger1 = animelem = 7
persistent = 0
attr = S, NA
animtype  = Heavy
damage    = 60,12
Hitflag = MAF
id = 1400
guardflag = MA
pausetime = 12,12
sparkno = -1
ground.Velocity = -16,4
guard.velocity = -24
air.Velocity = -12,8
fall = 1
fall.recover = 0
kill = 0
guard.kill = 0

[state 1400, moveforward]
type = velset
trigger1 = time = 0
x = 0

[state 1400, snd]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 1400,0

[State 1400, Push]
type = Helper
trigger1 = animelemTime(7) = 0
trigger2 = animelemtime(7) = 2
ignorehitpause = 1
ID = 1401
name = "Shove"
pos = -20,0
postype = p1
stateno = 1401
keyctrl = 0
ownpal = 1
helpertype = normal

[state 1400, moveforward]
type = velset
trigger1 = animelemtime(7) = 0
x = 5

[state 1400, HB]
Type = hitby
trigger1 = 1
value = SCA,AT

[state 1400, HB]
Type = null
trigger1 = animelemtime(8) >= 0
value = SCA,AA,AP,AT

[state 1400, previous state]
type = varset
trigger1 = time = 0
v = 5
value = prevstateno


[State 1400, 3]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
; Pushing part
[Statedef 1401]
type    = A
movetype= I
physics = N
velset = 0,0
anim = 1401

[State 1440, Push]
type = posset
trigger1 = time = 0
y = 0

[State 1440, Push]
type = PlayerPush
trigger1 = 1
value = 1

[State 1440, NHB]
type = NotHitBy
Trigger1 = 1
value = SCA
Time = 1

[State 1440, Vel]
type = VelSet
trigger1 = Time >= 0
x = 30

[State 345, End]
type = DestroySelf
trigger1 = Time = 15

;-------------------------------------------------------------------------
;Rainbow Aura
;----The helper itself-----
[Statedef 2280]
Type = A
Physics = N
SprPriority = -10

[State 2280,x]
Type = NotHitBy
Trigger1 = 1
Value = SAC, NT, ST, HT ,NA, SA, HA ,NP, SP, HP
Time = 1
ignorehitpause = 1

[State 2280,x, Bind for Optional Rising]
Type = BindToParent
Trigger1 = !time
Pos = 0,-.5

[State 2280,x]
Type = VarAdd
Trigger1 = Time
V = 7
Value = 15

[State 2280,x, PosAdd Optional Rising]
Type = PosAdd
Trigger1 = 1
Y = -.5

;----an option for different uses----
[State 2280,x, VarSet]
type = VarSet
trigger1 = !time
Trigger1 = !parent,ishelper
v = 6
value = 1

[State 2280,x, VarSet]
type = VarSet
trigger1 = !time
Trigger1 = parent,ishelper(2000)
v = 6
value = 2

[State 2280,x]
Type = Trans
Trigger1 = var(6)=1
Trans = AddAlpha
Alpha = 256-Var(7),ceil(128+(Var(7)/2))


[State 2280,x]
Type = Trans
Trigger1 = var(6)=2
Trans = AddAlpha
Alpha = 256-Var(7),256

[State 2280,x, PalFXWiz]
type = PalFX
trigger1 = ishelper(2080)
time = -1
add = 0,0,0
mul = 256,0,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2081)
time = -1
add =  0,0,0
mul = 256,123,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2082)
time = -1
add = 0,0,0
mul = 256,256,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2083)
time = -1
add = 0,0,0
mul = 123,256,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2084)
time = -1
add = 0,0,0
mul = 0,256,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2085)
time = -1
add = 0,0,0
mul = 0,256,123
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2086)
time = -1
add = 0,0,0
mul = 0,256,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2087)
time = -1
add = 0,0,0
mul = 0,123,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2088)
time = -1
add = 0,0,0
mul = 0,0,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2089)
time = -1
add = 0,0,0
mul = 123,0,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2090)
time = -1
add =  0,0,0
mul = 256,0,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2091)
time = -1
add = 0,0,0
mul = 256,0,123
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2280)
time = -1
add = 100,0,0
mul = 256,0,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2281)
time = -1
add = 100,100,0
mul = 256,123,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2282)
time = -1
add = 100,100,0
mul = 256,256,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2283)
time = -1
add = 0,100,0
mul = 123,256,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2284)
time = -1
add = 0,100,0
mul = 0,256,0
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2285)
time = -1
add = 0,100,100
mul = 0,256,123
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2286)
time = -1
add = 0,100,100
mul = 0,256,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2287)
time = -1
add = 0,100,100
mul = 0,123,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2288)
time = -1
add = 0,0,100
mul = 0,0,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2289)
time = -1
add = 100,0,100
mul = 123,0,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2290)
time = -1
add = 100,0,100
mul = 256,0,256
color = 0

[State 2280, PalFXWiz]
type = PalFX
trigger1 = ishelper(2291)
time = -1
add = 100,0,100
mul = 256,0,123
color = 0

[State 2280, Varset]
Type = Varset
Trigger1 = !time
trigger1 = var(6)=1
V = 1
Value = Parent,Anim

[State 2280, Varset]
Type = Varset
Trigger1 = !time
trigger1 = var(6)=2
V = 1
Value = 2001

[State 2280, Varset]
Type = Varset
Trigger1 = !time
V = 2
Value = Parent,AnimElemNo(0)

[State 2280,]
Type = ChangeAnim
Trigger1 = 1
Value = Var(1)
Elem  = Var(2)

[State 2280, shadow]
Type = AssertSpecial
Trigger1 = 1
Flag = Noshadow

[State -1]
Type = DestroySelf
Trigger1 = var(7)>=256;Time = 4
;=======================================================================================


;==========================================================================
;SUPER: Taste the Rainbow - Anti Air grab that stays on ground
;==========================================================================
[statedef 3000]
Type = C
movetype = A
physics = S
ctrl = 0
velset = 0,0
anim = 3000

[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 90
v = 18
value = 90
ignorehitpause = 1

[state 3000, no bg]
type = assertspecial
trigger1 = animelemtime(3) >= 0 && animelemtime(8) < 0
flag = nobg
ignorehitpause = 1

[state 3000, i-frames]
type = nothitby
trigger1 = time < 84
value = SCA

[state 3000, i-frames]
type = nothitby
trigger1 = time >= 84 && time < 162
value = A,AA

[state 3000, splash snd]
type = playsnd
trigger1 = animelemtime(3) = 2
value = 3000,4
ignorehitpause = 1

[state 3000, explod]
type = explod
trigger1 = !numexplod(2300) 
trigger1 = animelemtime(2) = 0
anim = 2300
pos = 0,0
id = 2300
scale = const(size.xscale),const(size.yscale)
removetime = -2
sprpriority = 5
ignorehitpause = 1
bindtime = -1
supermovetime = 60
removeongethit = 1

[state 3000, explod]
type = explod
trigger1 = !numexplod(2301)
trigger1 = animelemtime(2) = 0
anim = 2301
id = 2301
pos = 0,0
scale = const(size.xscale),const(size.yscale)
removetime = -2
sprpriority = 4
bindtime = -1
supermovetime = 60
removeongethit = 1


[State 3000, Super Pause]
type = SuperPause
trigger1 = animelemtime(3) = 0
sound = S3000, 0
pos = 94,-126
time = 60
movetime = 60
persistent = 0
ignorehitpause = 1

[state 3000, meter loss]
type = poweradd
trigger1 = animelemtime(3) = 0
value = -3000
persistent = 0
ignorehitpause = 1

[State 1020, Blink White]
type = PalFX
trigger1 = animelemtime(12) >= 0 && animelemtime(12) < 12
trigger1 = time%2
time = 1
add = 255,255,255 ;32,16,0
ignorehitpause

[state 3000, width]
type = width
trigger1 = animelemtime(3) < 0
edge = 60,40
player = 0,0

[state 3000, width]
type = width
trigger1 = animelemtime(3) >= 0
edge = 60,40
player = 0,20

[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(3) =[0, 14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3000, Super Portrait]
type = explod
trigger1 = animelemtime(3) = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[State 3000, 1]
type = HitDef
Trigger1 = animelemtime(9) = 0
trigger1 = p2stateno != [150,155]
attr = S, HT         
hitflag = AF          
id = 3000
priority = 1, Miss  
sparkno = -1   
givepower = 120 
p1sprpriority = 1                     
p1facing = 1
p2facing = 1          
p1stateno = 3001       
p2stateno = 3020     
guard.dist = 0       
fall = 1
kill = 0

[state 3000, end]
type = changestate
trigger1 = animtime = 0
value = 12
ctrl = 1

;--------------------------------------------------------------------------
;Slip
[statedef 3001]
type = L
movetype = A
physics = S
ctrl = 0
anim = 3001
sprpriority = -3

[state 3001, width]
type = width
trigger1 = 1
edge = 240,240

[state 3001, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 2300

[state 3001, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 2301


[state 3000, explod]
type = explod
trigger1 = !numexplod(2302)
anim = 2302
pos = 0,0
id = 2302
scale = const(size.xscale),const(size.yscale)
sprpriority = -1
bindtime = -1

[state 3000, explod]
type = explod
trigger1 = !numexplod(2303)
anim = 2303
id = 2303
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = -2
bindtime = -1

[state 3000, explod]
type = explod
trigger1 = !numexplod(23002)
anim = 23002
pos = 0,0
id = 23002
scale = const(size.xscale),const(size.yscale)
sprpriority = 5
bindtime = -1

[state 3000, explod]
type = explod
trigger1 = !numexplod(23003)
anim = 23003
id = 23003
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 5
bindtime = -1

[state 3001, playsnd]
type = playsnd
trigger1 = time = 0
value = 3000,1

[state 3001, explod]
type = explod
trigger1 = time = 0
anim = 3011
id = 3011
pos = 0,0
removeongethit = 1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4

[state 3001, bind1]
type = targetbind
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0
pos = 144,-124

[state 3001, bind2]
type = targetbind
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0
pos = 144,-114

[state 3001, bind3]
type = targetbind
trigger1 = animelemtime(8) >= 0 && animelemtime(9) < 0
pos = 144,-124

[state 3001, bind4]
type = targetbind
trigger1 = animelemtime(9) >= 0 && animelemtime(10) < 0
pos = 144,-134

[state 3001, bind5]
type = targetbind
trigger1 = animelemtime(10) >= 0 && animelemtime(11) < 0
pos = 144,-144

[state 3001, bind6]
type = targetbind
trigger1 = animelemtime(11) >= 0 && animelemtime(12) < 0
pos = 144,-134

[state 3001, bind7]
type = targetbind
trigger1 = animelemtime(12) >= 0 && animelemtime(13) < 0
pos = 144,-124

[state 3001, bind7]
type = targetbind
trigger1 = animelemtime(13) >= 0 && animelemtime(14) < 0
pos = 144,-134


[state 3001, bind8]
type = targetbind
trigger1 = animelemtime(14) >= 0 && animelemtime(15) < 0
pos = 144,-144

[state 3001, bind9]
type = targetbind
trigger1 = animelemtime(15) >= 0 
pos = 144,-134


[state 3001, snd]
type = playsnd
trigger1 = animelemtime(6) = 0
value = S3000,2

[state 3001, targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(6) = 0
value = floor(fvar(10)*-10)
kill = 0

[state 3001, targetstate]
type = changestate
trigger1 = animtime = 0
value = 3002


;--------------------------------------------------------------------------
;Claps
[statedef 3002]
type = L
movetype = A
physics = C
anim = 3002
sprpriority = -3

[state 3002, width]
type = width
trigger1 = 1
edge = 180,180

[state 3002, targetstate]
type = targetstate
trigger1 = time = 0
value = 3021

[state 3002, removeexplod]
type = removeExplod
trigger1 = time = 0
id = 3011

[state 3000, explod]
type = explod
trigger1 = !numexplod(2304) 
trigger1 = time = 0
anim = 2304
pos = 0,0
id = 2304
scale = const(size.xscale),const(size.yscale)
removetime = -2
sprpriority = -1
bindtime = -1

[state 3000, explod]
type = explod
trigger1 = !numexplod(2305) 
trigger1 = time = 0
anim = 2305
pos = 0,0
id = 2305
scale = const(size.xscale),const(size.yscale)
removetime = -2
sprpriority = -2
bindtime = -1

[state 3001, Butt Cheek]
type = explod
trigger1 = time = 0
anim = 3012
pos = 0,0
removeongethit = 1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4

[state 3000, explod]
type = explod
trigger1 = !numexplod(2306) 
trigger1 = time = 0
anim = 2306
pos = 0,0
id = 2306
scale = const(size.xscale),const(size.yscale)
removetime = -2
sprpriority = 5
bindtime = -1

[state 3000, explod]
type = explod
trigger1 = !numexplod(2307) 
trigger1 = time = 0
anim = 2307
pos = 0,0
id = 2307
scale = const(size.xscale),const(size.yscale)
removetime = -2
sprpriority = 5
bindtime = -1


[state 3002, camera]
type = playsnd
trigger1 = animelemtime(3) > 0 && animelemtime(30) < 0
trigger1 = random%10 > 8
value = 1210,0
persistent = 12

[state 1210, Camera Sound]
type = bgpalfx
trigger1 = animelemtime(3) > 0 && animelemtime(30) < 0
trigger1 = random%10 > 8
time = 4
add = 120,120,120
persistent = 12


[state 3002, slap snd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(30) = 0
value = 3000,2
persistent = 1

[state 3002, slap snd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(30) = 0
value = 3000,2
persistent = 1

[state 3002, slap snd]
type = hitadd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(30) = 0
value = 1
persistent = 1

[state 3002, slap snd]
type = targetlifeadd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(30) = 0
value =floor(fvar(10)*-60)
persistent = 1
kill = 0

[state 3002, slap snd]
type = targetpoweradd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(18) = 0
trigger3 = animelemtime(30) = 0
value = 120
persistent = 1

[state 3001, bind1]
type = targetbind
trigger1 = animelemtime(1) >= 0 && animelemtime(2) < 0
pos = 148,-134

[state 3001, bind2]
type = targetbind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
trigger2 = animelemtime(14) >= 0 && animelemtime(15) < 0
trigger3 = animelemtime(26) >= 0 && animelemtime(27) < 0
pos = 100,-120

[state 3001, bind3]
type = targetbind
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
trigger2 = animelemtime(15) >= 0 && animelemtime(16) < 0
trigger3 = animelemtime(27) >= 0 && animelemtime(28) < 0
pos = 100,-120

[state 3001, bind4]
type = targetbind
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
trigger2 = animelemtime(16) >= 0 && animelemtime(17) < 0
trigger3 = animelemtime(28) >= 0 && animelemtime(29) < 0
pos = 100,-60

[state 3001, bind5]
type = targetbind
trigger1 = animelemtime(5) >= 0 && animelemtime(6) < 0
trigger2 = animelemtime(17) >= 0 && animelemtime(18) < 0
trigger3 = animelemtime(29) >= 0 && animelemtime(30) < 24
pos = 100,-60

[state 3001, bind6]
type = targetbind
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0
trigger2 = animelemtime(18) >= 0 && animelemtime(19) < 0
trigger3 = animelemtime(30) >= 0 && animelemtime(31) < 24
pos = 100, -55

[state 3001, bind7]
type = targetbind
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0
trigger2 = animelemtime(19) >= 0 && animelemtime(20) < 0
trigger3 = animelemtime(31) >= 0 && animelemtime(32) < 24
pos = 100, -55

[state 3001, bind8]
type = targetbind
trigger1 = animelemtime(8) >= 0 && animelemtime(9) < 0
trigger2 = animelemtime(20) >= 0 && animelemtime(21) < 0
trigger3 = animelemtime(32) >= 0 && animelemtime(33) < 24
pos = 100, -60

[state 3001, bind9]
type = targetbind
trigger1 = animelemtime(9) >= 0 && animelemtime(10) < 0
trigger2 = animelemtime(21) >= 0 && animelemtime(22) < 0
trigger3 = animelemtime(33) >= 0 && animelemtime(34) < 24
pos = 100, -70

[state 3001, bind10]
type = targetbind
trigger1 = animelemtime(10) >= 0 && animelemtime(11) < 0
trigger2 = animelemtime(22) >= 0 && animelemtime(23) < 0
trigger3 = animelemtime(34) >= 0 && animelemtime(35) < 24
pos = 100, -65

[state 3001, bind11]
type = targetbind
trigger1 = animelemtime(11) >= 0 && animelemtime(12) < 0
trigger2 = animelemtime(23) >= 0 && animelemtime(24) < 0
trigger3 = animelemtime(35) >= 0 && animelemtime(36) < 24
pos = 100, -70

[state 3001, bind12]
type = targetbind
trigger1 = animelemtime(12) >= 0 && animelemtime(13) < 0
trigger2 = animelemtime(24) >= 0 && animelemtime(25) < 0
trigger3 = animelemtime(36) >= 0 && animelemtime(37) < 24
pos = 100, -60

[state 3001, bind12]
type = targetbind
trigger1 = animelemtime(13) >= 0 && animelemtime(14) < 0
trigger2 = animelemtime(25) >= 0 && animelemtime(26) < 0
trigger3 = animelemtime(37) >= 0 
pos = 100, -60


[state 3002, end]
type = changestate
trigger1 = animtime = 0
value = 3003

;--------------------------------------------------------------------------
;Butt Drop
[statedef 3003]
type = L
movetype = A
physics = C
anim = 3003
velset = 0,0
sprpriority = -3

[state 3003, screenbound]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 1

[state 3003, width]
type = width
trigger1 = 1
edge = 180,180


[state 3002, camera]
type = playsnd
trigger1 = animelemtime(1) > 0 && animelemtime(8) < 0
trigger1 = random%10 > 8
value = 1210,0
persistent = 16

[state 1210, Camera Sound]
type = bgpalfx
trigger1 = animelemtime(1) > 0 && animelemtime(8) < 0
trigger1 = random%10 > 8
time = 4
add = 120,120,120
persistent = 16

[state 3002, camera]
type = playsnd
trigger1 = animelemtime(8) >= 0
trigger1 = random%10 > 8
value = 1210,0
persistent = 2

[state 1210, Camera Sound]
type = bgpalfx
trigger1 = animelemtime(8) >= 0 
trigger1 = random%10 > 8
time = 4
add = 120,120,120
persistent = 2

[state 3003, sprpriority]
type = sprpriority
trigger1 = animelemtime(3) = 0
value = 3

[state 3003, sprpriority]
type = sprpriority
trigger1 = animelemtime(6) = 0
value = -3

[state 3003, explod]
type = explod
trigger1 = time = 0
anim = 3013
id = 3013
bindtime = -1
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
;=====================
;binds
;=====================

[state 3003, bind1]
type = targetbind
trigger1 = animelemtime(1) >= 0 && animelemtime(2) < 0
pos = 130, -148

[state 3003, bind2]
type = targetbind
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
pos = 145, -118

[state 3003, bind3]
type = targetbind
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
pos = -29, -214

[state 3003, bind4]
type = targetbind
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
pos = -58, -268

[state 3003, bind5]
type = targetbind
trigger1 = animelemtime(5) >= 0 && animelemtime(6) < 0
pos = -12, -309

[state 3003, bind6]
type = targetbind
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0
pos = -72, -320

[state 3003, bind7]
type = targetbind
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0
pos = -14, -309

[state 3003, bind8]
type = targetbind
trigger1 = animelemtime(8) >= 0 && animelemtime(9) < 0
pos = -12, -300

[state 3003, bind9]
type = targetbind
trigger1 = animelemtime(9) >= 0 
pos = 5, -90

[state 3003, physics]
type = statetypeset
trigger1 = animelemtime(5) = 0
physics = N
statetype = A

[state 3003, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
value = 1050,0

[state 3003, launch]
type = velset
trigger1 = animelemtime(5) = 0
y = -25 ;-20

[state 3003, launch horizontal]
type = velset
trigger1 = animelemtime(5) = 0
x = 0.5;ifelse (frontedgedist < 80,-4,ifelse(frontedgebodydist > 520,4,8)) 

[state 3003, veladd]
type = veladd
triggerall = animelemtime(5) > 0
trigger1 = vel y > 0
y = 1.24
persistent = 1

[state 3003, gravity]
type = gravity
trigger1 = pos y < -1

[state 3003, bounce offwall]
type = velmul
triggerall = animelemtime(5) > 0
trigger1 = frontedgebodydist < 30
trigger2 = backedgebodydist < 30
x = -0.5
persistent = 60

[state 3003, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3004

[state 3002, targetstate]
type = targetstate
trigger1 = time = 0
value = 3022
;----------------------------------------------------------------------------
;Landing 1
[statedef 3004]
type    = C
movetype= A
physics = N
sprpriority = -3
velset = 0,0

[state 3004, removeexplod]
type = removeexplod
trigger1 = time = 0
id = 3013

[state 3002, camera]
type = playsnd
trigger1 = random%10 > 8
value = 1210,0
persistent = 4

[state 1210, Camera Sound]
type = bgpalfx
trigger1 = random%10 > 8
time = 4
add = 120,120,120
persistent = 4

[state 3004, hitadd]
type = hitadd
trigger1 = time = 0
value = 1

[state 3004, targetstate]
type = targetstate
trigger1 = time = 0
value = 662

[state 3004, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -floor(fvar(10)*370)

[state 3004, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 520

[state 3004, explod]
type = explod
trigger1 = time = 0
anim = 2010
sprpriority = 4
pos = -40,0
postype = p1
scale = const(size.xscale)*2.25,const(size.yscale)*2.25

[state 3004, explod]
type = explod
trigger1 = time = 0
anim = 2011
sprpriority = -3
pos = -40,0
postype = p1
scale = const(size.xscale)*2.25,const(size.yscale)*2.25

[state 3004, anim]
type = changeanim
trigger1 = time = 0
value = 3004

[state 3004, explod]
type = explod
trigger1 = time = 0
trigger1 = numexplod(3014) < 1
anim = 3014
id = 3014
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit =1
sprpriority = 4

[state 3004, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 3004, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 3004, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 3004, bone snd]
type = playsnd
trigger1 = time = 2
value = 1130,0

[state 3004, earthquakes]
type = envshake
trigger1 = time = 0
time = 60
ampl = -40
freq = 75
phase = 75

[state 3004, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3004, velset]
type = posset
trigger1 = time = 0
y = 0

[state 3004, velset]
type = velset
trigger1 = time = 8
y = -12

[state 3004, gravity]
type = gravity
trigger1 = time > 8

[state 3004, end]
type = changestate
triggerall = time > 8
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3005
;---------------------------------------------------------------------------
;Landing 2
[statedef 3005]
type = C
movetype = I
physics = C
anim = 3005
sprpriority = -3

[state 3004, removexplod]
type = removeexplod
trigger1 = time = 0
id = 3014

[state 3004, explod]
type = explod
trigger1 = time = 0
anim = 3015
id = 3015
scale = const(size.xscale),const(size.yscale)
postype = p1
pos = 0,0
bindtime = -1
removeongethit =1
sprpriority = 4

[state 3005, camera]
type = playsnd
trigger1 = animelemtime(8) > 0
trigger1 = random%10 > 4
value = 1210,0
persistent = 12

[state 3005, Camera Sound]
type = bgpalfx
trigger1 = animelemtime(8) > 0
trigger1 = random%10 > 4
time = 4
add = 120,120,120
persistent = 12

[state 3005, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3005, posset]
type = posset
trigger1 = time = 0
y = 0

[state 3005, snd]
type = playsnd
trigger1 = time = 0
value =S650,0

[state 3005, earthquakes]
type = envshake
trigger1 = time = 0
time = 12
ampl = -8
freq = 60
phase = 60

[state 3005, turn]
type = turn
trigger1 = animtime = 0

[state 3005, end]
type = changestate
trigger1 = animtime = 0
value = 653




;--------------------------------------------------------------------------

;Victim Slips
[statedef 3020]
type = A
movetype = H
physics = N
ctrl = 0
velset = 0,0

[state 3020, posset]
type = posset
trigger1 = time = 0
y = -130

[state 3020, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3020, changeanim]
type = changeanim2
trigger1 = time = 0
value = 3020

[state 3020, up]
type = velset
trigger1 = animelemtime(2) = 0
y = -8
x= (p2bodydist x-80)*0.025

[state 3020, gravity]
type = veladd
trigger1 = animelemtime(2) > 0 && animelemtime(12) < 0
y = 0.44

[state 3020, gravity]
type = velset
trigger1 = animelemtime(12) = 0
y = 0
x = 0

;==================================
;Rotation
;==================================

[state 3020, rotate 1]
type = angledraw
trigger1 = animelemtime(2) >= 0 && animelemtime(3) < 0
value = 27
persistent = 1

[state 3020, rotate 2]
type = angledraw
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 0
value = 81
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(4) >= 0 && animelemtime(5) < 0
value = 108
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(5) >= 0 && animelemtime(6) < 0
value = 135
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(6) >= 0 && animelemtime(7) < 0
value = 162
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(7) >= 0 && animelemtime(8) < 0
value = 189
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(8) >= 0 && animelemtime(9) < 0
value = 216
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(9) >= 0 && animelemtime(10) < 0
value = 243
persistent = 1

[state 3020, rotate 3]
type = angledraw
trigger1 = animelemtime(10) >= 0 && animelemtime(11) < 0
value = 270
persistent = 1


;---------------------------------------------------------
[statedef 3021]
type = A
movetype = H
physics = N
ctrl = 0

[state 3003, screenbound]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 3021, changeanim]
type = changeanim2
trigger1 = time = 0
value = 3021

;--------------------------------------------------------
[statedef 3022]
type = A
movetype = H
physics = N
sprpriority = 1

[state 3003, screenbound]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0

[state 3022, change anim]
type = changeanim2
trigger1 = time = 0
value = 3022
;---------------------------------------------------------
[statedef 3025]
type = A
movetype = H
physics = N
ctrl = 0
velset = -18,-24

[state 3025, changeanim2]
type = changeanim
trigger1 = time = 0
value = 5030

[state 3025, gravity]
type = veladd
trigger1 = time > 0
y = 0.88

[state 3025, selfstate]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos Y > -vel y 
value = 5100

;--------------------------------------------------------------------------
;Power Bottom
[statedef 3040]
type = S
movetype = A
physics  = S
ctrl = 0
velset = 0,0


[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 70
v = 18
value = 70
ignorehitpause = 1

;===========
;Armor start
;==========
[state  3040,changeanim]
type = changeanim
trigger1 = anim != 3040
value = 3040

[state 3040, armor counter]
type = varset
triggerall = prevstateno != 3040
trigger1 = time = 0
V = 20
value = 3

[state 3040, excess armor check]
type = varset
trigger1 = var(20) > 1
var(20) = 1
persistent = 1
ignorehitpause = 1

;determine what frame
[state 3040, remember frame]
type = varset
trigger1 = time <= 0
v = 22
value = animelemno(0)
ignorehitpause = 1

;delay effect
[state 3040, delay]
type = changeanim 
trigger1 = var(31) < floor(gethitvar(hittime)*1.3)
value = anim
elem = var(22)

[state 3040, freeze location]
type = posfreeze
trigger1 = var(31) < floor(gethitvar(hittime)*1.3)
value = 1
;--------------------------

[state 3040, still take damage]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = floor(-gethitvar(damage)*0.5)
persistent = 1

[state 3040, armor count down]
type = varadd
trigger1 = gethitvar(damage) != 0
V = 20
value = -1
persistent = 1
ignorehitpause = 1

[state 3040, Unstoppable]
type = hitoverride
trigger1 = alive
trigger1 = Var(20) > 0
attr = SCA, AA, AP
stateno = 3040
time = 1
persistent = 1

[State 3040, flash red]
type = PalFX
trigger1 = Time = 0
trigger1 = gethitvar(damage) != 0
time = 7
add = 100,0,0
IgnoreHitPause = 1
;----------------------------------

[state 3040, no bg]
type = assertspecial
trigger1 = animelemtime(1) =[2, 62]
flag = nobg
ignorehitpause = 1

[state 3040,combo  scaling]
type= varset
trigger1=time= 2
trigger1= var(18)< 80
v = 18
value= 81
ignorehitpause  =  1

[State 3040, Super Pause]
type = SuperPause
trigger1 = animelemtime(1) =2
sound = S3000, 0
pos = 94,-126
time = 60
movetime = 60
persistent = 0
ignorehitpause = 1

[state 3040, meter loss]
type = poweradd
triggerall = prevstateno != 3040
trigger1 = animelemtime(1) = 0
value = -1000
persistent = 0
ignorehitpause = 1

[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(1) =[2, 16]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(1) = 17
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3040, snd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = S1000,0
ignorehitpause 

[state 3040,  velset]
type = velset
trigger1 = animelemtime(3) >= 0 
x = 24

[state 1101, dust]
type = explod
trigger1 = animelemtime(3) >= 0
anim = F120
pos = 0,0
scale = 2, 2
sprpriority = 4
persistent = 4

[State 3040, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HA
animtype  = back
damage    = 44,15
hitflag = MAF
guardflag = MA
id = 3040
nochainid = 3040
pausetime = 0,0
guard.pausetime = 14,14
sparkno = 3
getpower = 0
givepower = 33
sparkxy = -10,-60
hitsound   = S1000,1
guardsound = S120,0
ground.type = high
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 0, 0
air.velocity = 0,0
guard.velocity = -18
guard.hittime = 24
guard.slidetime = 24
airguard.velocity = -12,-4
airguard.hittime = 28
p1stateno = 3041
p2stateno = 3050
p2facing = 1
ground.cornerpush.veloff = -20
guard.dist = 320
envshake.ampl = 8
envshake.time = 12
kill= 0
guard.kill = 1

;Spawning rainbow helpers

[State 3040, Helper]
type = Helper
trigger1 = gametime%24=0
name = "FUCKING RAINBOWS"
ID = 2080
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 3040, Helper]
type = Helper
trigger1 = gametime%24=2
name = "FUCKING RAINBOWS"
ID = 2081
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=4
name = "FUCKING RAINBOWS"
ID = 2082
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=6
name = "FUCKING RAINBOWS"
ID = 2083
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=8
name = "FUCKING RAINBOWS"
ID = 2084
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 3040, Helper]
type = Helper
trigger1 = gametime%24=10
name = "FUCKING RAINBOWS"
ID = 2085
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=12
name = "FUCKING RAINBOWS"
ID = 2086
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=14
name = "FUCKING RAINBOWS"
ID = 2087
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=16
name = "FUCKING RAINBOWS"
ID = 2088
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 3040, Helper]
type = Helper
trigger1 = gametime%24=18
name = "FUCKING RAINBOWS"
ID = 2089
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=20
name = "FUCKING RAINBOWS"
ID = 2090
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3040, Helper]
type = Helper
trigger1 = gametime%24=22
name = "FUCKING RAINBOWS"
ID = 2091
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[state 3040, pass  through]
type = playerpush
trigger1 = p2statetype = L
value = 0

[state  3040,  Block end]
type = changestate
trigger1 = moveguarded
trigger2 = movereversed
value = 3045
ignorehitpause =1

[state  3040,  Empty Hit end]
type = changestate
trigger1 = time > 125
value = 3049
ignorehitpause =  0

[state  3040,  end]
type = changestate
trigger1 = frontedgebodydist < 10
value = 3048

;--------------------------------------------------------------------------
;Ride to wall
[statedef 3041]
type = S
movetype = A
physics = S
anim= 3041

[state 3041,  move toward wall]
type = velset
trigger1 = 1
x = 24

[state 1101, dust]
type = explod
trigger1 = animelemtime(3) >= 0
anim = F120
pos = 0,0
scale = 2, 2
sprpriority = 4
persistent = 4

[state 3041,bind]
type = targetbind
trigger1 = 1
pos = 178,-170

;Spawning rainbow helpers

[State 3041, Helper]
type = Helper
trigger1 = gametime%24=0
name = "FUCKING RAINBOWS"
ID = 2080
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 3041, Helper]
type = Helper
trigger1 = gametime%24=2
name = "FUCKING RAINBOWS"
ID = 2081
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3041, Helper]
type = Helper
trigger1 = gametime%24=4
name = "FUCKING RAINBOWS"
ID = 2082
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3041, Helper]
type = Helper
trigger1 = gametime%24=6
name = "FUCKING RAINBOWS"
ID = 2083
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3041, Helper]
type = Helper
trigger1 = gametime%24=8
name = "FUCKING RAINBOWS"
ID = 2084
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 1020, Helper]
type = Helper
trigger1 = gametime%24=10
name = "FUCKING RAINBOWS"
ID = 2085
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=12
name = "FUCKING RAINBOWS"
ID = 2086
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 1020, Helper]
type = Helper
trigger1 = gametime%24=14
name = "FUCKING RAINBOWS"
ID = 2087
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3041, Helper]
type = Helper
trigger1 = gametime%24=16
name = "FUCKING RAINBOWS"
ID = 2088
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[State 3041, Helper]
type = Helper
trigger1 = gametime%24=18
name = "FUCKING RAINBOWS"
ID = 2089
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3041, Helper]
type = Helper
trigger1 = gametime%24=20
name = "FUCKING RAINBOWS"
ID = 2090
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1


[State 3041, Helper]
type = Helper
trigger1 = gametime%24=22
name = "FUCKING RAINBOWS"
ID = 2091
stateno = 2280
pos = 0,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
ignorehitpause = 1

[state 3041, Crash]
type = changestate
trigger1 = frontedgebodydist < 20
trigger2 = time > 300
value = 3042

;----------------------------------------------------------------------------
;Crash
[statedef 3042]
type =  S
movetype = A
physics = S
anim = 3042

[state 3043, playsnd]
type = envshake
trigger1 = time  =  0 
ampl = 18
time = 24

[State 1103, Spark]
type = Explod
trigger1 = time  =0
anim = F72
postype = p1
pos = 0,-158
sprpriority = 5
ownpal = 1
scale = -1.2,2.25

[state 3042,  playsnd]
type = playsnd
trigger1 = time = 0
value = S650,0

[state 3042,  playsnd]
type = playsnd
trigger1 = time = 0
value = S650,0


[state 3042, stop]
type = velset
trigger1 = time = 0
x = 0

[state 3042, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))

[state 3042, playsnd]
type = playsnd
trigger1 = time = 0
value = 1130,0

[state 3042, targetstate]
type = targetstate
trigger1 = time = 0
value = 3051

[state 3042, targetlifeadd]
type = targetlifeadd
trigger1 = time = 0
value = -floor(fvar(10)*44)
kill = 0

[state 3042, targetpoweradd]
type = targetpoweradd
trigger1 = time = 0
value = 180

[state 3042, width]
type = width
trigger1 = 1
edge = 0,0

[state 3042, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3042, end]
type = changestate
trigger1 = animtime = 0
value = 3043

;--------------------------------------------------------------------------
;Crush on wall
[statedef 3043]
type = S
movetype = A
physics = S
velset = 0,0
anim = 3043
sprpriority = 4

[state 3043, explod]
type = explod
trigger1 = time = 0
anim = 3063
scale = const(size.xscale),const(size.yscale)
sprpriority = 4
bindtime = -1
removeongethit = 1
postype = p1
pos = 0,0

[state 3043, sprpriority]
type = sprpriority
trigger1 = animelem = 5
trigger2 = animelem = 15
trigger3 = animelem = 25
value = -3

[state 3043, sprpriority]
type = sprpriority
trigger1 = animelem = 11
trigger2 = animelem = 21
value = 4

[state  3043,  screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3043,  hitadd]
type = hitadd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
value = 1

[state 3043,  targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
value = ceil(-54*fvar(10))
kill = 0

[state 3043,  targetlifeadd]
type = targetlifeadd
trigger1 = animelemtime(25) = 0
value = ceil(-104*fvar(10))
kill = 1

[state 3043,  poweradd]
type = targetpoweradd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
value = 100

[state 3043, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
value = 1130,0

[state 3043, playsnd]
type = envshake
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
ampl = 12
time = 16

[state 3043, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
value = S650,0

[state 3043, playsnd]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
value = S650,0

[State 1103, Spark]
type = Explod
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
trigger3 = animelemtime(25) = 0
anim = F72
postype = p1
pos = 0,-158
sprpriority = 5
ownpal = 1
scale = -1.2,2.25


[state 3043,  targetlifeadd]
type = targetstate
trigger1 = animelemtime(15) = 0
value = 3052

[state 3043,  targetlifeadd]
type = targetstate
trigger1 = animelemtime(25) = 0
value = 3053

[state 3043, end]
type = changestate
trigger1 = animtime = 0
value= 3044
ctrl = 0
;----------------------------------------------------------------------------
;Walk Away
[statedef 3044]
type =  S
movetype = I
ctrl =  0

[state 3044, anim]
type = changeanim
trigger1 = time = 0
value = 21
elem = 3

[state 3044, posadd]
type = posadd
trigger1 = time = 0
x = -192

[state 3044, velset]
type = velset
trigger1 = 1
x = const(velocity.walk.back.x)

[state 20, Footsteps]
type = playsnd
triggerall = vel x < 0
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(13) = 0
value = 20,0
channel = 2
ignorehitpause = 1
persistent = 1

[state 20, Slaps]
type = playsnd
triggerall = vel x < 0
trigger1 = animelemtime(8) = 0
trigger2 = animelemtime(13) = 0
value = 20,1
channel = 1
ignorehitpause = 1
persistent = 1
volume = 25

[state 20, earthquakes]
type = envshake
triggerall = vel x < 0
trigger1 = animelemtime(7) = 0
trigger2 = animelemtime(13) = 0
ampl = -8
phase = 100
freq = 100
time = 10
persistent = 1
ignorehitpause = 1

[state 3044, end]
type = changestate
trigger1 = time > 60
value = 0
ctrl = 1

;----------------------------------------------------------------------------
;Blocked
[statedef 3045]
type =  S
movetype = H
physics = S
anim = 3045

[state 3045,  armorset]
type =  varset
trigger1= time=0
v= 20
value= 3

[state  3045,posadd]
type = posadd
trigger1 = time = 0
x = 160

[state 3045, stop]
type = velset
trigger1 = time = 0
x = 0

[state 3045, playsnd]
type = envshake
trigger1 = time  =  0 
ampl = 8
time = 12

[state  3045,posadd]
type = posadd
trigger1 =  animelemtime(4)  = 0
x = -100

[state 3045, staeteypeset]
type = statetypeset
trigger1 = animelemtime(4) = 0
physics = N
statetype = A

[state  3042,velset]
type = velset
trigger1= animelemtime(4) = 0
x =  2
y = -12

[state 3045, gravity]
type = gravity
trigger1= animelemtime(4) > 0

[state 3042, width]
type = width
trigger1 = 1
edge = 0,0

[state 3042, screenbound]
type = screenbound
trigger1 = animelemtime(4) <  0
value = 0
movecamera = 0,0

[state 3042, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel Y
value = 3046
ignorehitpause = 1


;----------------------------------------------------------------------------
;Landing from Empty Hit
[statedef 3046]
type = C
movetype = H
physics = C
velset = 0,0
anim = 3046
sprpriority = 3

[state 3042, playsnd]
type = playsnd
trigger1 = time = 0
value = 20,0

[state 3043, playsnd]
type = envshake
trigger1 = time = 0
ampl = 8
time = 12

[state  3046, pos y]
type = posset
trigger1 = time = 0
y = 0

[STATE 3046, nothitby]
type = nothitby
trigger1 = 1
value= ,AT
ignorehitpause  = 1

[state  3046,  hitoverride]
type = hitoverride
trigger1 = alive
trigger1 = animelemtime(1) >= 0 && animelemtime(3) < 36
attr = SCA,AA,AP       
slot = 0
stateno = 3047
time = 1
forceair = 0
ignorehitpause=1

[state 3046, turn]
type = turn
trigger1 = animtime = 0

[state 3046, end]
type  =  changestate
trigger1 = animtime = 0
value = 5120
ctrl = 0

;----------------------------------------------------------------------------
;GEt hit
[statedef 3047]
type = C
movetype = H
physics = C
ctrl = 0
sprpriority = 3

[state 3047,varadd]
type = varadd
trigger1 = time = 0
v = 20
value= -1
persistent = 0

[state 3047, anim]
type = changeanim
trigger1 = time = 0
value = 3048

[STATE 3047, nothitby]
type = nothitby
trigger1 = 1
value= ,AT
ignorehitpause  = 1

[state  3047,  hitoverride]
type = hitoverride
trigger1 = alive
trigger1 = var(20) > 0
trigger1 = animelemtime(1) >= 0 && animelemtime(3) < 36
attr = SCA,AA,AP       
slot = 0
stateno = 3047
time = 1
forceair = 0

[state 3047, lifeadd]
type = lifeadd
trigger1 = gethitvar(damage) != 0
trigger1 = var(20) > 0
value = -floor(gethitvar(damage)*0.5)
persistent = 1
ignorehitpause = 1

[state 3047, poweradd]
type = poweradd
trigger1= time = 0
value = 30

[state 3047, KO]
type = changestate
trigger1 = !alive
trigger1 = hitshakeover
value = 3060

[state 3047, end]
type = changestate
trigger1 = alive
trigger1 = animtime = 0
value = 11
ctrl = 1

;----------------------------------------------------------------------------
;KO from regular bottom
[statedef 3060]
type = C
movetype = H
physics = C
ctrl = 0
anim = 3060

[state 3060, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3060, end]
type = changestate
trigger1 = animtime = 0
value = 5150 
;----------------------------------------------------------------------------
;Empty Crash Wall
[statedef 3048]
type =  S
movetype = I
physics = S
anim = 3045

[state 3042, stop]
type = velset
trigger1 = time = 0
x = 0

[state 3048, punish hit coutner]
type = varset
trigger1 = time = 0
v = 20
value = 5

[state 3042, posset]
type = posset
trigger1 = time = 0
x = (facing*(gamewidth/2))

[state 3043, playsnd]
type = envshake
trigger1 = time  =  0 
ampl = 18
time = 24

[State 1103, Spark]
type = Explod
trigger1 = time  =0
anim = F72
postype = p1
pos = 0,-158
sprpriority = 5
ownpal = 1
scale = -1.2,2.25

[state 3042,  playsnd]
type = playsnd
trigger1 = time = 0
value = S650,0

[state 3042,  playsnd]
type = playsnd
trigger1 = time = 0
value = S650,0

[state  3042,posadd]
type = posadd
trigger1 =  animelemtime(4)  = 0
x = -100

[state  3042,velset]
type = velset
trigger1= animelemtime(4) = 0 
x = -8
y = -12
[state 3048, physics]
type = statetypeset
trigger1 = animelemtime(4) = 0
physics = N
statetype = A

[state 3048, gravity]
type = gravity
trigger1 = animelemtime(4) > 0

[state 3042, width]
type = width
trigger1 = 1
edge = 0,0

[state 3042, screenbound]
type = screenbound
trigger1 = animelemtime(4) <  0
value = 0
movecamera = 0,0

[state 3042, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel Y
value = 3046
ctrl =  0
ignorehitpause = 1

;--------------------------------------------------------------------------
;End empty hit,  no wall
[statedef 3049]
type = S
movetype = A
physics = S
anim = 3049
ctrl = 0

[state 3049, end]
type = changestate
trigger1  = animtime  = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
[Statedef 3050]
type    = A
movetype= H
physics = N
velset = 0,0

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[State 3050, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 3050

[state  3050,  angledraw]
type = angledraw
trigger1 = 1
value = 270

[State 820, 2]
type = SelfState
triggerall = time > 30
trigger1 = !gethitvar(isbound)
value = 5050


;--------------------------------------------------------------------------
;Flattened on wall FLAT  1
[statedef 3051]
type =A
movetype = H
physics = N
velset = 0,0

[state 3051, posset]
type = posset
trigger1 = time = 0
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3051, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.05,0.8

[state 3051, anim]
type = changeanim2
trigger1 = time =  0
value = 3051

[state 3051, end]
type = changestate
trigger1 = time >= 300
value = 1133

;--------------------------------------------------------------------------
;Flattened on wall FLAT  2
[statedef 3052]
type =A
movetype = H
physics = N
velset = 0,0

[state 3051, posset]
type = posset
trigger1 = time = 0
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3051, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.1,0.4

[state 3051, anim]
type = changeanim2
trigger1 = time =  0
value = 3051

[state 3051, end]
type = changestate
trigger1 = time >= 60
value = 1133

;--------------------------------------------------------------------------
;Flattened on wall FLAT  3
[statedef 3053]
type =A
movetype = H
physics = N
velset = 0,0

[state 3051, posset]
type = posset
trigger1 = time = 0
x = -(facing*(gamewidth/2))

[state 3051, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,0

[state 3051, angledraw]
type = angledraw
trigger1 = 1
value = -90
scale = 1.3,0.1

[state 3051, anim]
type = changeanim2
trigger1 = time =  0
value = 3051

[state 3051, end]
type = changestate
trigger1 = time >= 60
value = 1133






;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy projectile (helper). For use with AI. ( M.U.G.E.N | IKEMEN )
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy projectile helper distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy projectile helper velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
 
;==========================================================================
;                Detect Enemy Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = IfElse(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = IfElse(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = IfElse(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = IfElse(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = IfElse(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = IfElse(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = IfElse(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = IfElse(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = IfElse(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = IfElse(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 


;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------
[statedef -2]

;============================================================================
; Win Quotes
;============================================================================
[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%7)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Jumbo Elephant"
value = 8+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ana 'Jiggly' Bunny"
value = 11+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Katrina Crocodile"
value = 14+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Bertha Hippo"
value = 17+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Aroma Skunk"
value = 20+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Enorma Pig"
value = 23+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Lardo Rat"
value = 26+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Zafta Giraffe"
value = 29+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Makuyama"
value = 32+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Pastilla Skunk"
value = 35+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Jumba Elephant"
value = 38+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Twiggi Bunny"
value = 41+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Violet 'Tyla' Bunny"
value = 44+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Ra Lord"
value = 47+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Battu Tri-red"
value = 50+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Julian Hippo"
value = 53+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Rapid Bunny"
value = 56+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Noah Sharker"
value = 59+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Andy Armadillo"
value = 62+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, Name = "Montana Moth"
value = 65+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Texas Stanton"
value = 68+(random%3)
ignorehitpause
persistent = 1

;Bertha Hippo is © Kazecat 2017
[state -2, distance check]
type = displaytoclipboard
trigger1 = 1
text = "distance Opp X: %d Y: %d, Position Y: %f, Camera Flashes: %d, timer: %d"
params = p2bodydist x, p2bodydist y, pos y, var(12), var(13)
;text = "Julian Hippo is (c) Kazecat 2020



;===================================================
;Combo Limiters
;===================================================

[state -2, Slide Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(6) = 2
ignorehitpause = 1

[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(8) = 2
ignorehitpause = 1

[state -2, Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(11) = 2
ignorehitpause = 1

;====================================================
;combo Scaling
;====================================================

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar (10)
ignorehitpause = 1

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger1 = (enemynear,statetype != A)
trigger2 = !numenemy
trigger3 = enemynear,stateno = 5120
ignorehitpause = 1
v = 18
value = 100

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05
ignorehitpause = 1

;--------------------------------------------------------------------------------------
;Weight Detection
;If needed add or remove from this list those that have great strength to move him.
;All Grapplers/Power Archetypes should be allowed to Throw him and nothing else IMO.
;--------------------------------------------------------------------------------------- 
[state -2, Those strong enough to throw him]
type = varset
triggerall = numenemy
trigger1 = enemy,name = "Savage Hulk"
Trigger2 = enemy,name = "Superman"
Trigger3 = enemy,name = "Juggernaut"
trigger4 = enemy,name = "ZangiefHD"
trigger5 = enemy,name = "Kimala"
trigger6 = enemy,name = "Bertha Hippo"
trigger7 = enemy,name = "Goku Z2"
trigger8 = enemy,name = "Vegeta Z2"
trigger9 = enemy,name = "Gohan Z2"
trigger10 = enemy,name = "SSJ Goku Z2"
Trigger11 = enemy,name = "Hulk"
Trigger12 = enemy,name = "Colossus"
trigger13 = enemy,name = "Jumbo Elephant" || enemy,name = "Makuyama" || enemy,name = "Jumba Elephant"
trigger14 = enemy,name = "John Cena"
trigger15 = enemy,name = "Yokozuna"
trigger16 = enemy,name = "Zangief"
trigger17 = enemy,name = "Bowser"
trigger18 = enemy,name = "Wonder Woman"
trigger19 = enemy,name = "She Hulk"
trigger20 = enemy,name = "Blubberman"
trigger21 = enemy,name = "The-Mountain"
Trigger22 = enemy,name = "Shaq"
Trigger23 = enemy,name = "2DFM95 Kinnikuman"
trigger24 = enemy,name = "Haggar"
trigger25 = enemy,name = "Katrina Crocodile"
trigger26 = enemy,name = "Kazecat" || enemy,name = "Kaze Cat" || enemy,name = "Julian Hippo"
trigger27 = enemy,name = "Power Girl"
trigger28 = enemy,name = "Freeza Z2"
trigger29 = enemy,name = "Buu Z2"
trigger30 = enemy,name = "Majin Vegeta Z2"
trigger31 = enemy,name = "Thor" || enemy,name = "The Mighty Thor"
trigger32 = enemy,name = "Pastilla Skunk"
trigger33 = enemy,name = "Thanos"
trigger34 = enemy,name = "Lilly Star"
V = 10
value = 1

;===============================================================================
; Simple Counter
;===============================================================================

[state -2, counter]
type = varset
trigger1 = gethitvar(damage) != 0
v = 31
value = 0
ignorehitpause = 1

[state -2, count up]
type = varadd
trigger1 = var(31) < var(33)
v = 31
value = 1
ignorehitpause = 0

[state -2, delay conter set]
type = varset
trigger1 = 1
v = 33
value = 300

;Camera Counter
;Camera Battery Recharge
[state -2, varadd]
type = varadd
triggerall = roundstate = 2
trigger1 = var(13) = 420
v = 12
value = 1
persistent = 1
ignorehitpause = 1


[state -2, varadd]
type = varadd
triggerall = roundstate = 2
trigger1 = var(12) < 3
trigger1 = var(13) <= 420
v = 13
value = 1
persistent = 1
ignorehitpause = 1

[state -2, varset]
type = varset
triggerall = roundstate = 2
triggerall = var(12) < 3
trigger1 = var(13) > 420
v = 13
value = 0
persistent = 1
ignorehitpause = 1

[state -2, varset]
type = varset
triggerall = roundstate = 2
trigger1 = var(12) = 3
v = 13
value = 0
persistent = 1
ignorehitpause = 1


;===========================================================================
;AI Charge checks
;===========================================================================
;Universal charge
[state -2, X charge counter]
type = varadd
trigger1 = var(41) < 60
var(41) = 1
ignorehitpause = 0

[state -2, X charge reset]
type = varset
trigger1 = stateno = 20
trigger1 = vel x > 0
trigger2 = stateno = 100
trigger3 = stateno = [40,50]
trigger3 = vel x > 0
trigger4 = stateno = 105
trigger4 = time = 0
var(41) = 0

[state -2, X confirm]
type = varset
trigger1 = var(41) = 60
var(42) = 1

[state -2, X deny]
type = varset
trigger1 = var(41) != 60
var(42) = 0

[state -2, Y charge counter]
type = varadd
trigger1 = var(43) < 60
var(43) = 1
ignorehitpause = 0

[state -2, Y charge reset]
type = varset

trigger1 = stateno = 100
trigger2 = stateno = 40
trigger3 = stateno = 105  && time = 0
;trigger4 = stateno = 130 && time = 0
;trigger5 = stateno = 20
var(43) = 0

[state -2, y confirm]
type = varset
trigger1 = var(43) = 60
var(44) = 1

[state -2, y deny]
type = varset
trigger1 = var(43) != 60
var(44) = 0


;--------------------------------------------------------------------------------
;Cursed States
;================================================================================

;Earthquakes
[State -2, quakes]
type = envshake
triggerall = time = 1
trigger1 = stateno = 1521
trigger1 = prevstateno != 1523  
trigger2 = stateno = 1527 && time = 1
time = 15
ampl = -10

;Thuds
[State -2, sfx]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 1521
trigger1 = prevstateno != 1523   
trigger2 = stateno = 1527 && time = 1 
value = S20,0 

;Huge target, Defense buff
[state -2, Defense Up]
type = defencemulset
trigger1 = stateno = [1521,1549]
trigger1 = anim = [19030, 19040]
value = 1.25



;================================================================================
; Removeexplod
;================================================================================

[state -2, removeexplod]
type = removeexplod
trigger1 = stateno != 240
id = 240
ignorehitpause = 1

[state -2, removeexplod]
type = removeexplod
trigger1 = stateno != 810
id = 810
ignorehitpause = 1

;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

[State -3, quakes]
type = envshake
triggerall = time = 1
trigger1 = stateno = 5100
time = 25
ampl = -16
freq = 60
phase = 60

[state -3, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
;trigger1 = var(59) = 1 ;M.U.G.E.N below 1.0 that uses Winane's AI Activation Method.
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1

;Weight Detection
[state -2, Can't be thrown]
type = null ;nothitby
triggerall = time > 0
triggerall = numenemy
triggerall = enemynear,authorname != "Kazecat"
trigger1 = Var(10) = 0
value = ,NT
ignorehitpause = 1
time = 1
;-----------------------------------------------

[State -3, quakes]
type = envshake
triggerall = time = 1
trigger1 = stateno = 5100
time = 18
ampl = -12
freq = 100
phase = 100

[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 5100
value = S650, 0

[state -3, gravity]
type = gravity
trigger1 = stateno = 5620
trigger1 = time > 0

[state -3, land]
type = changestate
triggerall = stateno = 5620
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.
[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
value = 40, 0
