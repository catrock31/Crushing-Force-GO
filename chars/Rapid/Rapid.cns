; KFM's constants and state file.
; There are comments scattered through this file, so you may like to
; take a look if would like to learn more about the cns.

[Data]
;Amount of life to start with
life = 900
power = 5000
;attack power (more is stronger)
attack = 100
;defensive power (more is stronger)
defence = 100
;Percentage to increase defense everytime player is knocked down
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 30
;Number of points for juggling
airjuggle = 30
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
;Variables with this index and above will not have their values
;reset to 0 between rounds or matches. There are 60 int variables,
;indexed from 0 to 59, and 40 float variables, indexed from 0 to 39.
;If omitted, then it defaults to 60 and 40 for integer and float
;variables repectively, meaning that none are persistent, i.e. all
;are reset. If you want your variables to persist between matches,
;you need to override state 5900 from common1.cns.
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1.2          ;Horizontal scaling factor.
yscale = 1.2           ;Vertical scaling factor.
ground.back = 40     ;Player width (back, ground)
ground.front = 40    ;Player width (front, ground)
air.back = 50        ;Player width (back, air)
air.front = 50       ;Player width (front, air)
height = 175          ;Height of player (for opponent to jump over)
attack.dist = 240    ;Default attack distance
proj.attack.dist = 90 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = 0, -310   ;Approximate position of head
mid.pos = 0, -180    ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y). Recommended 0,0

[Velocity]
walk.fwd  = 18.0     ;Walk forward
walk.back = -12     ;Walk backward
run.fwd  = 50, 0    ;Run forward (x, y)
run.back = -30,-10 ;Hop backward (x, y)
jump.neu = 0,-40    ;Neutral jumping velocity (x, y)
jump.back = -12.55    ;Jump back Speed (x, y)
jump.fwd = 12.5       ;Jump forward Speed (x, y)
runjump.back = -2.55,-8.1 ;Running jump speeds (opt)
runjump.fwd = 26,-25      ;.
airjump.neu = 0,-40      ;.
airjump.back = -12.55      ;Air jump speeds (opt)
airjump.fwd = 12.5         ;.
air.gethit.groundrecover = -.15,-3.5  ;Velocity for ground recovery state (x, y) **MUGEN 1.0**
air.gethit.airrecover.mul = .5,.2     ;Multiplier for air recovery velocity (x, y) **MUGEN 1.0**
air.gethit.airrecover.add = 0,-4.5    ;Velocity offset for air recovery (x, y) **MUGEN 1.0**
air.gethit.airrecover.back = -1       ;Extra x-velocity for holding back during air recovery **MUGEN 1.0**
air.gethit.airrecover.fwd = 0         ;Extra x-velocity for holding forward during air recovery **MUGEN 1.0**
air.gethit.airrecover.up = -2         ;Extra y-velocity for holding up during air recovery **MUGEN 1.0**
air.gethit.airrecover.down = 1.5      ;Extra y-velocity for holding down during air recovery **MUGEN 1.0**

[Movement]
airjump.num = 1       ;Number of air jumps allowed (opt)
airjump.height = 35   ;Minimum distance from ground before you can air jump (opt)
yaccel = 1.76          ;Vertical acceleration
stand.friction = .89  ;Friction coefficient when standing
crouch.friction = .86 ;Friction coefficient when crouching
stand.friction.threshold = 2          ;If player's speed drops below this threshold while standing, stop his movement **MUGEN 1.0**
crouch.friction.threshold = .05       ;If player's speed drops below this threshold while crouching, stop his movement **MUGEN 1.0**
air.gethit.groundlevel = 25           ;Y-position at which a falling player is considered to hit the ground **MUGEN 1.0**
air.gethit.groundrecover.ground.threshold = -20 ;Y-position below which falling player can use the recovery command **MUGEN 1.0**
air.gethit.groundrecover.groundlevel = 10   ;Y-position at which player in the ground recovery state touches the ground **MUGEN 1.0**
air.gethit.airrecover.threshold = -1  ;Y-velocity above which player may use the air recovery command **MUGEN 1.0**
air.gethit.airrecover.yaccel = 1.76    ;Vertical acceleration for player in the air recovery state **MUGEN 1.0**
air.gethit.trip.groundlevel = 15      ;Y-position at which player in the tripped state touches the ground **MUGEN 1.0**
down.bounce.offset = 0, 20            ;Offset for player bouncing off the ground (x, y) **MUGEN 1.0**
down.bounce.yaccel = 1.76               ;Vertical acceleration for player bouncing off the ground **MUGEN 1.0**
down.bounce.groundlevel = 12          ;Y-position at which player bouncing off the ground touches the ground again **MUGEN 1.0**
down.friction.threshold = .05         ;If the player's speed drops below this threshold while lying down, stop his movement **MUGEN 1.0**

;Default language victory quotes (optional).  **MUGEN 1.0**
;If this section is included, the default language victory quotes must be in English.
[Quotes]
;Up to 100 victory quotes can be specified per language (victory0 - victory99)
victory1 = "Wow! I didn't think I'd win! I didn't expect to lose either, It's just that most give up trying to catch me."
victory2 = "Next time, I'll just outrun you... Fighting is far too stressful for me."
victory3 = "Good luck hitting a rabbit as fast as me! Maybe next time, you ought to fight something slower, like a cheetah or hawk or something."
victory4 = "I'm not used to this fighting thing, but going fast and copying moves is working well for me so far."
victory5 = "I didn't know punching was going to hurt my hands this badly! Why didn't I add gloves to my outfit?!"
victory6 = "Jogging isn't a fighting style, but I guess it worked on you."
victory7 = "Ugh! There's not enough space in these fighting arenas for me to go at my top speed."

;Vs Jumbo, Crime boss; wants to recreate city to cater to big bodies only.
victory8 = "You're like a mountain with legs!"
victory9 = "Your strength is terrifying, but it's no use if you can't hit me."
victory10 = "I care about big bodies as much as you do, but you take things too far!"

;Vs Jiggly, Ex-girlfriend; cheated on by Rapid.
Victory11 = "I know you're still mad at me, but eventually, I hope you can forgive me."
Victory12 = "I recognize some of those techniques... You're not learning from her, are you?"
victory13 = "It probably doesn't mean much now, but I'm sorry for what I put you through."

;Vs Bertha, Current girlfriend; trains Jiggly.
victory14 = "I'm not a fan of fighting, but I love sparring with you, Bertha! You always threaten me with a good time." 
victory15 = "I didn't want this result, but I'm thankful I got to experience this with you, Bertha."
Victory16 = "Are you letting me win to build up my confidence? That's so sweet of you!"

;Vs Katrina, Rescued once; respect is mutual with Rapid.
victory17 = "With those girls on your chest, I bet you'd never see me if I was less than two feet in front of you!"
Victory18 = "Your style of fighting is fun to see, Katrina. Maybe I can be a bridge to patch things up with you and Bertha."
victory19 = "You may act mean, but I know that you're really sweet. Thanks for the practice, Katrina."

;Vs Enorma, Friend of Bertha; not close with Rapid.
victory20 = "Sorry miss, but this isn't rabbit season."
victory21 = "What's the point in limited ammunition if you can't hit me? I'm not even winded!"
Victory22 = "Forget where the guns are coming from, how do you fit all that ass in those jeans?"

;Vs Aroma, Poison user; Rapid is weak to poison.
victory23 = "If it weren't for these goggles, my eyes would probably be watering right now."
victory24 = "I think you can do better with your talent than sell bombs to criminals."
victory25 = "I can't say I feel bad knocking out someone who enables felons."

;Vs Lardo, Works for Jumbo; a threat and a gashole.
Victory26 = "I guess fast food doesn't agree with you!"
victory27 = "You could be doing so much better with your abilities than committing crimes, Lardo. I hope one day you realize that."
Victory28 = "You need to clean up a whole lot more than just your act, Lardo."

;Vs Zafta, Rapid is one of the shortest characters, and she's one of the tallest.
victory29 = "Not going to lie, If this weren't a fight, I wouldn't mind being crushed by those thighs."
Victory30 = "And here I thought Bertha made me feel small!"
victory31 = "Your thighs are like tree trunks! They look fantastic, but I'm not going to let you kick me again."

;Vs Makuyama
Victory32 = "I'm usually afraid of bears, but you seem different."
victory33 = "So you used to work for that one elephant boss? I'm glad you were able to separate yourself from him."
victory34 = "You come off as a lot more reserved than I expected... I'm used to bears going for intimidation."

;Vs Pastilla
Victory35 = "I don't know how you got that way, but you look lovely all the same."
victory36 = "Silly witch, I happen to be quite used to hippo ass!"
Victory37 = "I'm already hard to hit, wouldn't shrinking me only make things harder for you?"

;Vs Jumba
Victory38 = "I don't know why you and Bertha have beef, but you two should bury it. You'd be stronger as a team."
victory39 = "You're incredibly eye-catching for someone that's supposed to be a ninja!"
Victory40 = "I've got to give you credit for how fast you are with that wide of a frame, you're a treat to see in motion."

;Vs Twiggi
victory41 = "You look even frailer than I do against all these big bodies, that's certainly a first."
victory42 = "You two make a fantastic couple! I love a relationship dynamic like that!"
victory43 = "Surely you're used to being crushed beneath your partner, right?"

;Vs Violet, had a one night stand with Rapid; he thinks she's hot.
victory44 = "Damn, girl! Thick thighs save lives, not take them!"
victory45 = "Wait, were you always an assassin? Or did I do something wrong that one night?"
victory46 = "Those thighs are lethal, but that doesn't make them any less attractive to me!"

;Vs Julian
victory47 = "Being crushed under you isn't even close to the worst way I could have gone out."
victory48 = "Would you be alright sharing some of your techniques with Bertha? For... Reasons." 
Victory49 = "I'm lucky to have experience with being crushed by a hippo, you're dangerous when you throw that ass around!"

;vs Ra
victory50 = "When I said I wanted to fight someone closer to my weight class, I didn't mean this!"
victory51 = "Give me a call when you're less busted and I'll think of something else to say to ya."
victory52 = "Too many snakes!!  Even your hands are snakes!!  What nightmare fuel are you?!"

;vs Battu
victory53 = "Hold on, you're a bounty hunter? Remind me to stay off of your bad side."
victory54 = "It's enlightening to know that even aliens can have big bottoms."
victory55 = "You may be able to harness lighting and gravity, but against my speed, it's not enough!"

;vs Noah
victory56 = "I've gone up against a lady with an arsenal of guns... I think I can handle arrows."
victory57 = "Your distractingly sexy entourage isn't going to help you, fish boy."
victory58 = "Do you really think throwing big bodies my way is going to stop me? I'm in love with one!"

;vs Rapid, 
Victory59 = "I don't know if you're from an alternate timeline, clone or whatever, but I'm not sharing Bertha."
Victory60 = "I don't know who you are but you're not my brother.  He doesn't fight like me."
Victory61 = "I wonder if you being here proves I can time travel someday."

;vs Akai
Victory62 = "You may have super speed fat panda, but you still aren't in my class of speed."
victory63 = "It must be nice to have so much mass to throw around, but don't think I can't take you."
Victory64 = "Oh man!  You have super speed and mass?!  That's really unfair to me but you still got me."

;vs Andy
Victory65 = "That was a good spar, you're clunky armor will never keep up with me though."
Victory66 = "I get that you don't want me in the air but you're not gonna be fast enough to see me most of the time."
Victory67 = "Armor would only slow me down, thats not my style man."

;Vs Montana 
Victory68 = "Wow, You're a beautiful moth.  Not that I'm flirting or anything just stating the obvious."
victory69 = "Getting sat on by you isn't so bad the smells aren't my thing though."
Victory70 = "You may not be from around her but ass attacks don't worry me in the least."

;Vs Rapid
victory71 = "I would love to team up with you someday Ms. Stanton.  I know I can be helpful with my speed."
Victory72 = "You don't have to worry about the crushing force of big bodies if you're too fast to be hit."
Victory73 = "Big bodies seem to follow you and give ya trouble all the time.  But why do they have to be hot?"
;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "カンフー突き手を破らぬ限り、お前に勝ち目はない！"
victory2 = "十年早いんだぞ"
victory3 = "お前は見覚えがあるな。テレビにでも…？"
victory4 = "お前の動きは見破りやすすぎる。　なに、カンフー突き手が覚えたいんだと？　素人には無理だぞ"
victory5 = "ふー。　いい汗だった"
victory6 = "もっと強い相手に挑戦したい"
victory7 = "なんだと！彼女はここにもいないと？"

;---------------------------------------------------------------------------
; Variable usage:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).


;---------------------------------------------------------------------------
; Lose by Time Over
; CNS difficulty: basic
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
; CNS difficulty: basic
[Statedef 180]
type = S


[State 180, 1]
type = ChangeState
triggerall = numpartner 
triggerall = partner,name = "Bertha Hippo"  && partner,alive
trigger1 = matchover
value = 188

[State 180, 1]
type = ChangeState
triggerall = numenemy
triggerall = enemy,name = "Bertha Hippo"
trigger1 = matchover
value = 185

[State 180, 1]
type = ChangeState
trigger1 = enemy,name != "Bertha Hippo"
trigger1 = matchover
trigger2 = !matchover
value = 181


;---------------------------------------------------------------------------
; Win pose 1 - Fist Pump
; CNS difficulty: basic
[Statedef 181]
type = S
physics = N
ctrl = 0
anim = 181
velset = 0,0

[state 181, jump]
type = velset
trigger1 = animelemtime(4) = 0
y = -24
x = -facing*(pos x *0.02) ;2

[state 181, gravity]
type = gravity
trigger1 = pos y < -1

[state 181, Yay!]
type = playsnd
trigger1 = animelemtime(3) = 1
trigger1 = palno != 12
value = S181,(random%3)
channel = 0
persistent = 0

[state 181, YES!]
type = playsnd
trigger1 = animelemtime(3) = 1
trigger1 = palno = 12
value = S610,2
channel = 0
persistent = 0


[state 181, winpose]
type = assertspecial
trigger1 = 1
flag = roundnotover

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
value = S180,1

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
value = S180,1

[state 181, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 182


[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Landing
[statedef 182]
type = S
physics = S
anim = 182
velset = 0,0

[state 182, landing]
type = posset
trigger1 = time = 0
y = 0

[state 182, roundnotover]
type = assertspecial
trigger1 = time < 60
flag = roundnotover

;---------------------------------------------------------------------------
;Walk Over
[statedef 185]
type = S
anim = 20

[State 185, Assert: RoundNotOver]
type = AssertSpecial
trigger1 = 1
flag = RoundNotOver

;Walk FXs
[state 185, speed]
type = velset
trigger1 = anim = 20
x = const(velocity.walk.fwd.x)

[State 185, Turn to Enemy]
type = Turn
trigger1 = Enemy, Facing = Facing
trigger1 = Enemy, P2Dist X <= 465 && (Enemy, P2Dist X >= 445)
trigger2 = enemy,p2dist x = [-500,-450]
persistent = 240

[State 185, ChangeAnim]
type = ChangeAnim
trigger1 = Enemy, Facing != Facing
trigger1 = Anim = 20
trigger1 = vel x > 0
trigger1 = Enemy, P2Dist X <= 465 && (Enemy, P2Dist X >= 445)
value = 185

[state 185, sprpriority]
type = sprpriority
trigger1 = anim = 185
value = 1

[state 185, sprpriority]
type = velset
trigger1 = anim = 185
x = 0

[state 185, changeanim]
type = changestate
trigger1 = numenemy
trigger1 = enemy,name = "Bertha Hippo"
trigger1 = enemy,anim = 1860
trigger1 = enemy,animelemtime(4) > 8
value = 186

;----------------------------------------------------------------------------
; Helping up
[statedef 186]
type = S
physics = N
anim = 1851
sprpriority = 1

[state 185, explod]
type = explod
trigger1 = !numexplod(1861)
trigger1 = anim = 1851
postype = p1
anim = 1861
id = 1861
pos = 0,0
bindtime = -1
removetime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 4


[State 185, Assert: RoundNotOver]
type = AssertSpecial
trigger1 = time < 360
flag = RoundNotOver


[state 186, pulldown]
type = changeanim
trigger1 = numenemy
trigger1 = enemy,anim = 1860
trigger1 = enemy,animelemtime(10) = 0
value = 1852

[state 186, remove Explod]
type = removeexplod
trigger1 = anim = 1852
id = 1861

[state 186, Kiss Snd]
type = playsnd
trigger1 = anim = 1852
trigger1 = animelemtime(9) = 0
value = 185, (random%1)

[state 1882, Heart]
type = explod
trigger1 = anim = 1852
trigger1 = animelemtime(9) = 0
trigger1 = !numexplod(2188)
anim = 2188
scale = const(size.xscale)*2, const(size.yscale)*2
vel = 0,-1
postype = p1
pos = 154,-350
id = 2188
sprpriority = -1

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
value = S180,1

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
value = S180,1



[state 186, Pulled]
type = posadd
trigger1 = anim = 1852
trigger1 = animelemtime(2) < 0
x = 45 ; 240
persistent = 1

[state 186, Pulled]
type = posadd
trigger1 = anim = 1852
trigger1 = animelemtime(2) = 0
x = 0;290

[state 186, Pulled]
type = posset
trigger1 = anim = 1852
trigger1 = animelemtime(2) = 0
y = 0


[state 186, sprpriority]
type = sprpriority
trigger1 = anim = 1852
trigger1 = animelem = 1
value = -3

;---------------------------------------------------------------------------
;Run off screen
[statedef 188]
type = S


[State 188, Assert: RoundNotOver]
type = AssertSpecial
trigger1 = 1
flag = RoundNotOver

[State 185, Turn to Enemy]
type = Turn
trigger1 = numpartner
trigger1 = partner,Facing = Facing


[state 188, run off]
type = changeanim
trigger1 = time = 30
trigger1 = anim != 100
value = 100

[state 188, screen bound]
type = screenbound
trigger1 = time > 30
value = 0
movecamera = 0,0

[state 188, speed]
type = velset
trigger1 = anim = 100
x = const(velocity.run.fwd.x)


[state 188, changestate]
type = changestate
trigger1 = frontedgebodydist < -200
;trigger2 = time = 60
value = 1881

;------------------------------------------------------------------
;Slide back in
[statedef 1881]
type = S
physics = N
anim = 188
sprpriority = -1

[state 188, screenbound]
type = screenbound
trigger1 =  time < 60
value = 0
movecamera = 0,0

[State 188, Assert: RoundNotOver]
type = AssertSpecial
trigger1 = 1
flag = RoundNotOver

[state 188, explod]
type = explod
trigger1 = time = 0
anim = 187
id = 187
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removetime = -1
sprpriority = -3
shadow = -1

[state 188, turn]
type = turn
trigger1 = time = 0
trigger1 = numpartner
trigger1 = facing != partner,facing


[state 188, speed]
type = velset
trigger1 = time > 10
trigger1 = anim = 188
x = 25

[state 188, playsnd]
type = playsnd
trigger1 = time = 10
value = 188,3
channel = 3

[State 185, ChangeAnim]
type = ChangeAnim
triggerall = numpartner
triggerall = Anim = 188
trigger1 = facing = 1
trigger1 = pos x - partner,pos x = [-500,-400]
trigger2 = facing = -1 
trigger2 = pos x - partner,pos x = [400, 500]
value = 1881

[state 1881, stopsnd]
type = stopsnd
trigger1 = anim = 1881
channel = 3
persistent = 0

[state 185, changeexplod]
type = removeexplod
trigger1 = anim = 1881
trigger1 = animelemtime(4) > 0
trigger2 = numexplod(1870)
id = 187
ignorehitpause = 1

[state 185, changeexplod]
type = explod
trigger1 = anim = 1881
trigger1 = animelemtime(4) > 0
trigger1 = !numexplod(1870)
id = 1870
anim = 1870
scale = const(size.xscale),const(size.yscale)
bindtime = -1
removetime = -1
sprpriority = -3
shadow = -1

[state 185, velmul]
type = velmul
trigger1 = anim = 1881
x = 0.5
persistent = 0

[state 1881, playsnd]
type = playsnd
triggerall = anim = 1881
trigger1 = animelemtime(4) >= 0  & animelemtime(33) <= 0
value = 188,0
persistent = 4

[state 1881, playsnd]
type = playsnd
trigger1 = anim = 1881
trigger1 = animelemtime(35) = 0
value = 192,1
persistent = 0
volume = 100

[state 188, Voice]
type = playsnd
trigger1 = anim = 1881
trigger1 = animelemtime(38) = 0
value = 188,4
channel = 0
persistent = 0


[state 185, changestate]
type = changestate
trigger1 = numpartner
trigger1 = partner,name = "Bertha Hippo"
trigger1 = partner,stateno = 187
value = 1882

[state 185, physics]
type = statetypeset
trigger1 = anim = 1881
physics = S

;--------------------------------------------------------------------------
;Squashed Bunny
[statedef 1882]
type = S
anim = 1882
sprpriority = -1

[state 188, playsnd]
type = playsnd
trigger1 = time = 0
value = 188,1

[state 188, playsnd]
type = playsnd
trigger1 = time = 2
value = 188,2

[state 188, playsnd]
type = playsnd
trigger1 = time = 0
value = 188,5
channel = 0
persistent = 0

[state 1882, Heart]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(2188)
anim = 2188
scale = const(size.xscale), const(size.yscale)
vel = -0.5,-1
postype = p1
pos = -48,-400
id = 2188
sprpriority = -3

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life != lifemax
value = S180,1

[state 181, announce]
type = playsnd
triggerall = teammode = single
trigger1 = time = 10
trigger1 = life = lifemax
value = S180,1


[state 188, removeexplod]
type = removeexplod 
trigger1 = time = 0
trigger2 = numexplod(1871)
id = 1870

[state 188, explod]
type = explod
trigger1 = time = 0
trigger1 = !numexplod(1871)
anim = 1871
id = 1871
postype = p1
pos = 0,0
scale = const(size.xscale),const(size.yscale)
bindtime = 0
removetime = -1
sprpriority = -3
shadow = -1

[state 188, posset]
type = posset
trigger1 = time = 0
y = 0

[State 188, Assert: RoundNotOver]
type = AssertSpecial
trigger1 = time < 60
flag = RoundNotOver











;---------------------------------------------------------------------------
; Introduction
; CNS difficulty: basic
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[state 191, beginning location marker]
type = helper
trigger1 = !numhelper(190)
stateno = 19000
id = 190
name = "Start Position"
postype = p1
pos = 0,0

[state 191, Reaction to Bertha same team]
type = changestate
triggerall = Numpartner
trigger1 = partner,name = "Bertha Hippo"
trigger1 = numenemy
trigger1 = enemy,name != "Rapid Bunny"
value = 1910


[state 191, Reaction to Bertha]
type = changestate
triggerall = numenemy
trigger1 = enemy,name = "Bertha Hippo"
value = 1900



[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[state 191, version]
type = explod
trigger1 = time = 0
anim = ifelse(facing = -1,9101,9100)
scale = 1,1
postype = Back
pos = ifelse(facing =1, 20, 157),360 ; Nice!
ontop = 1

[state 191, brakes]
type = playsnd
trigger1 = animelemtime(3) = 1
trigger1 = anim = 190
value = 101,0
persistent = 0

[state 1009, dust]
type = explod
trigger1 = animelem = 3
persistent = 2
anim = F120
postype = p1
pos = 0,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1009, dust]
type = explod
trigger1 = animelem = 4
persistent = 2
anim = F120
postype = p1
pos = 56,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1009, dust]
type = explod
trigger1 = animelem = 5
persistent = 2
anim = F120
postype = p1
pos = 102,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1009, dust]
type = explod
trigger1 = animelem = 6
persistent = 2
anim = F120
postype = p1
pos = 114,0
vel = 2,-4
scale = 2,2
sprpriority = 3


[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
;Intro to Bertha
[statedef 1900]
type = S
anim = 9999
ctrl = 0
sprpriority = 2

[State 191, 2] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 191, camera]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0
ignorehitpause = 1
persistent = 1

[state 191, moveback]
type = posadd
trigger1 = time = 45
x = -1400

[state 191, changeanim]
type = changeanim
trigger1 = time = 46
value = 1101

[state 191, movement]
type = velset
trigger1 = anim = 1101
x = const(velocity.run.fwd.x)*1.375


[State 191, 3] ;Change to stand state when done
type = ChangeState
triggerall = numenemy
trigger1 = p2bodydist x < 300
value = 1901

;--------------------------------------------------------------------------
;Slap
[statedef 1901]
type = S
physics = S
anim = 191

[state 1901, posset]
type = posset
trigger1 = time = 0
x = enemy,pos x - (300 * facing)


[State 191, 2] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 191, camera]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 0
ignorehitpause = 1
persistent = 1

[state 1901, velmul]
type = velmul
trigger1 = time = 0
x = 0.01

[state 191, playsnd]
type = playsnd
trigger1 = animelemtime(3) = 0
value = S192,0

[state 191, moveback]
type = posadd
trigger1 = numhelper(190)
trigger1 = animelemtime(10) > 0
x = floor((helper(190),pos x - pos x) / 8)*facing
persistent = 1

[state 191, posset]
type = posset
trigger1 = animtime = 0
trigger1 = numhelper(190)
x = helper(190),pos x

[state 191, end]
type = changestate
trigger1 = animtime = 0
value = 0


;--------------------------------------------------------------------------
;Butt rest with Bertha
[statedef 1910]
type = C
physics = N
ctrl = 0
anim = 192
sprpriority = 1

[state 1910, playerpush]
type = playerpush
trigger1 = 1
value = 0

[State 1910, 2] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 1910, position]
type = posset
trigger1 = time = 1
trigger1 = numpartner
x = partner,pos x + ifelse(facing = 1, 200, -200)
y = -40

[state 1910, velset]
type = velset
trigger1 = animelemtime(8) = 0
y = -22
x = 2

[state 1910, playsnd]
type = playsnd
trigger1 = animelem = 7
value = S194,0

[state 1910, gravity]
type = gravity
trigger1 = animelemtime(8) > 0

[state 1910, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel Y
value = 1911



;----------------------------------------------------------------------------------
;Landing
[statedef 1911]
type = S
ANIM = 193
velset = 0,0

[State 191, 2] 
type = AssertSpecial
trigger1 = 1
flag = Intro

[state 191, playpush]
type = playerpush
trigger1 = 1
value = 0

[state 1911, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1911, dash back to origin]
type = posadd
trigger1 = numhelper(190)
trigger1 = animelemtime(3) >= 0
x = floor((helper(190),pos x - pos x)/8)*facing

[state 1911, start position]
type = posset
trigger1 = animtime = 0
trigger1 = numhelper(190)
x = helper(190),pos x


[state 1911, changestate]
type = changestate
trigger1 = animtime = 0
value = 0

;----------------------------------------------------------------------------
;Start position helper
[statedef 19000]
type = S
ctrl = 0
anim = 9999
velset = 0,0

[state 19000, display]
type = displaytoclipboard
trigger1 = 1
text = "Pos x: %d"
params = pos x 


[state 19000, end]
type = destroyself
trigger1 = roundstate = 2

;---------------------------------------------------------------------------
; Taunt
; CNS difficulty: easy
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1




;---------------------------------------------------------------------------
; Stand Light Punch
[Statedef 200]
type    = S                      
movetype= A                      
physics = S                      
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 200                       ;Change animation (Def: no change)
poweradd = 10                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 200, 1]
type = HitDef
trigger1 = !movecontact
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 15                   ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 6, 6                 ;Time attacker pauses, time opponent shakes
sparkno = 0                      ;Spark anim no (Def: set above)
sparkxy = -40, -270               ;X-offset for the "hit spark" rel. to p2,
;Y-offset for the spark rel. to p1
hitsound = S5000, 0                  ;Sound to play on hit
guardsound = S120, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 7            ;Time that the opponent slides back
ground.hittime  = 7             ;Time opponent is in hit state
ground.velocity = -8 
guard.velocity = -10
guard.slidetime = 6
guard.hittime = 6           ;Velocity at which opponent is pushed
airguard.velocity = -6,-.8     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -4,-1           ;X-velocity at which opponent is pushed,
;Y-velocity at which opponent is pushed
air.hittime = 15                ;Time before opponent regains control in air
guard.dist = 360
fall.recover = 1
fall.recovertime = 18
ground.cornerpush.veloff = -16
guard.cornerpush.veloff = -20
airguard.cornerpush.veloff = -12


[State 200, 2]
type = PlaySnd
trigger1 = Time = 0
value = 200, 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 200, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Standing Medium punch
[Statedef 205]
type    = S
movetype= A
physics = S
poweradd= 20
ctrl = 0
velset = 0,0
anim = 205
sprpriority = -1

[State 210, 1]
type = PlaySnd
trigger1 = Time = 2
value = 0, 4

[state 205, Voice]
type = playsnd
trigger1 = time = 4
trigger1 = random%11 > 5
value = 300,4
channel = 0
persistent = 0

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA
animtype  = Medium
damage    = 8
guardflag = MA
pausetime = 1,1
sparkno = 1
sparkxy = -50,-264
hitsound   = S5000,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -2
air.velocity = -2.5,-4
forcenofall = 1
guard.velocity = -6
guard.slidetime = 13
guard.hittime = 13
guard.dist = 360
fall.recover = 1
fall.recovertime = 20

[State 200, 2]
type = PlaySnd
trigger1 = animelem = 3
value = 200, 0

[State 200, 2]
type = PlaySnd
trigger1 = animelem = 4
value = 200, 0

[State 200, 2]
type = PlaySnd
trigger1 = animelem = 6
value = 200, 0

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA
animtype  = Medium
damage    = 8
guardflag = MA
pausetime = 1,1
sparkno = 1
sparkxy = -50,-186
hitsound   = S5000,0
guardsound = S120, 0
ground.type = low
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -2
air.velocity = -2.5,-4
forcenofall = 1
guard.velocity = -6
guard.slidetime = 13
guard.hittime = 13
guard.dist = 360
fall.recover = 1
fall.recovertime = 20

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 4
attr = S, NA
animtype  = Medium
damage    = 8
guardflag = MA
pausetime = 1,1
sparkno = 1
sparkxy = -50,-302
hitsound   = S5000,0
guardsound = S120, 0
ground.type = high
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -2
air.velocity = -2.5,-4
forcenofall = 1
guard.velocity = -6
guard.slidetime = 13
guard.hittime = 13
guard.dist = 360
fall.recover = 1
fall.recovertime = 20



[State 210, 2]
type = HitDef
trigger1 = AnimElem = 6
attr = S, NA
animtype  = Medium
damage    = 13
guardflag = MA
pausetime = 10,10
sparkno = 1
sparkxy = -50,-184
hitsound   = S5000,1
guardsound = S120, 0
ground.type = low
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -12
air.velocity = -8,-2
forcenofall = 1
guard.velocity = -24
guard.slidetime = 12
guard.hittime = 12
guard.dist = 360
fall.recover = 1
fall.recovertime = 20


[State 210, 4]
type = SprPriority
trigger1 = AnimElem = 5
value = 2

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 2
v = 18
value = -1
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 3
v = 18
value = -1
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 4
v = 18
value = -1
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 6
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong punch
[Statedef 210]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -1

[State 210, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 240, 0

[state 210, veladd]
type = veladd
trigger1 = animelem = 6
x = 24

[state 210, fx]
type = explod
trigger1 = animelemtime(6) > 0 && animelemtime(9) < 0
anim = F61
pos = 0,0
scale = 1,1
ownpal = 1
persistent = 4
sprpriority = -3

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 3
attr = S, NA
animtype  = Heavy
damage    = 18
guardflag = MA
pausetime = 4,4
sparkno = 1
sparkxy = -10,-278
hitsound   = S5000,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4
air.velocity = -4,-4
guard.hittime = 12
guard.velocity = -3
guard.slidetime = 12
airguard.velocity = -1,-5
guard.dist = 320
fall.recover = 1
fall.recovertime = 30


[State 210, 2]
type = HitDef
trigger1 = AnimElem = 5
attr = S, NA
animtype  = Heavy
damage    = 18
guardflag = MA
pausetime = 4,4
sparkno = 1
sparkxy = -10,-278
hitsound   = S5000,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -4
air.velocity = -4,-4
guard.dist = 320
guard.hittime = 12
guard.velocity = -3
guard.slidetime = 12
airguard.velocity = -1,-5
guard.dist = 320
fall.recover = 1
fall.recovertime = 30

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 7
attr = S, NA
animtype  = Heavy
damage    = 21
guardflag = MA
pausetime = 12,12
sparkno = 2
sparkxy = -10,-278
hitsound   = S5000,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -24
air.velocity = -24,-8
guard.hittime = 12
guard.velocity = -28
guard.slidetime = 12
airguard.hittime = 16
airguard.velocity = -12,-6
guard.dist = 320
fall.recover = 1
fall.recovertime = 30

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 3
v = 18
value = -1
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 5
v = 18
value = -1
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 7
v = 18
value = -1
persistent = 0
ignorehitpause = 1

[state 210, Not Active]
type = statetypeset
trigger1 = animelemtime(8) = 0
movetype = I



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing Overhead
[Statedef 215]
type    = S
movetype= A
physics = S
poweradd= 20
ctrl = 0
velset = 0,0
anim = 215
sprpriority = -1

[State 215, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 200, 0

[state 215, veladd]
type = velset
trigger1 = animelemtime(2) > 0 && animelemtime(8) < 0
x = 20

[state 215, velset]
type = velset
trigger1 = animelemtime(8) = 0
x = 0

[State 215, 2]
type = HitDef
trigger1 = AnimElem = 5
attr = S, NA
animtype  = Heavy
damage    = 40
guardflag = HA
pausetime = 10,10
sparkno = 2
sparkxy = -10,-278
hitsound   = S5000,1
guardsound = S120, 0
ground.type = low
ground.slidetime = 26
ground.hittime  = 26
ground.velocity = -16
air.velocity = -12,-2
guard.hittime = 11
guard.velocity = -18
guard.slidetime = 11
airguard.velocity = -14,-2
guard.dist = 640
fall.recover = 1
fall.recovertime = 24

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1


[State 215, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------

; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
poweradd= 15
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 0
value = 230, 0

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = light
damage    = 20
guardflag = MA
pausetime = 6,6
sparkno = 0
id = 230
sparkxy = -50,-258
hitsound   = S5000,0
guardsound = S120, 0
ground.type = Low
ground.slidetime = 10
ground.hittime  = 10
ground.velocity = -10
air.velocity = -2,-8
guard.velocity = -12
airguard.velocity = -4,-8
guard.hittime = 6
guard.slidetime = 6
airguard.hittime = 12
guard.dist = 320
fall.recover = 1
fall.recovertime = 16

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing Medium kick
[Statedef 235]
type    = S
movetype= A
physics = S
poweradd= 20
ctrl = 0
velset = 0,0
anim = 235
sprpriority = 2

[State 235, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 200, 0

[State 235, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 200, 0

[State 235, 1]
type = PlaySnd
trigger1 = animelem = 6
value = 200, 0

[state 235, posadd]
type = veladd
trigger1 = animelemtime(2) = 0
x = 30
ignorehitpause = 1
persistent = 0

[State 235, 2]
type = HitDef
trigger1 = animelem = 2
persistent = 0
attr = S, NA
animtype  = light
damage    = 13
guardflag = MA
pausetime = 1,1
sparkno = 0
sparkxy = -50,-100
hitsound   = S5000,1
guardsound = S120, 0
ground.type = Low
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -6
air.velocity = -2,-8
guard.velocity = -12
airguard.velocity = -4,-4
guard.hittime = 16
guard.slidetime = 16
airguard.hittime = 18
guard.dist = 550
fall.recover = 1
fall.recovertime = 20

[State 235, 2]
type = HitDef
trigger1 = animelem = 4
persistent = 0
attr = S, NA
animtype  = light
damage    = 14
guardflag = MA
pausetime = 1,1
sparkno = 0
sparkxy = -50,-290
hitsound   = S5000,1
guardsound = S120, 0
ground.type = high
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -6
air.velocity = -2,-8
guard.velocity = -12
airguard.velocity = -4,-4
guard.hittime = 16
guard.slidetime = 16
airguard.hittime = 20
guard.dist = 550
fall.recover = 1
fall.recovertime = 20

[State 235, 2]
type = HitDef
trigger1 = animelem = 6
persistent = 0
attr = S, NA
animtype  = light
damage    = 14
guardflag = MA
pausetime = 10,10
sparkno = 1
sparkxy = -50,-190
hitsound   = S5000,1
guardsound = S120, 0
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -18
air.velocity = -16,-8
guard.velocity = -32
airguard.velocity = -18,-8
guard.hittime = 15
guard.slidetime = 15
airguard.hittime = 20
guard.dist = 550
fall.recover = 1
fall.recovertime = 20

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 2
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 4
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 6
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[State 235, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
poweradd= 30
ctrl = 0
anim = 240
sprpriority = 2

[State 240, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 240, 0

[state 240, veladd]
type = veladd
trigger1 = animelem = 3
x = 6

[State 240, 2]
type = HitDef
trigger1 = animelemtime(3) >= 0 && animelemtime(5) < 0
attr = S, NA
persistent = 2
animtype  = heavy
damage    = 5
guardflag = MA
pausetime = 1,1
sparkno = 0
sparkxy = -10,-220
hitsound   = S5000,0
guardsound = S120, 0
ground.type = Low
ground.slidetime = 10
ground.hittime  = 10
ground.velocity = -4
air.velocity = -18,-6
guard.dist = 720
fall.recover = 1
fall.recovertime = 16

[State 240, 2]
type = HitDef
trigger1 = animelem = 6
attr = S, NA
animtype  = heavy
damage    = 60
guardflag = MA
pausetime = 6,12
guard.pausetime = 6,4
sparkno = 3
id = 240
sparkxy = -10,-232
hitsound   = S5000,2
guardsound = S120, 0
ground.type = high
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -42
air.velocity = -18,-6
guard.velocity = -38
guard.slidetime = 14
guard.hittime = 14
airguard.velocity = -16,-8
air.fall = 1
guard.dist = 720
ground.cornerpush.veloff = -24
air.cornerpush.veloff = -30

[state 210, fx]
type = explod
trigger1 = animelemtime(3) > 0 && animelemtime(5) < 0
anim = F61
pos = 0,0
scale = 1,1
ownpal = 1
persistent = 2
sprpriority = -3

[state 240, flip]
type = turn
triggerall = animelemtime(4)=2
trigger1= p2dist x < 0



[state 240, velmul]
type = velmul
trigger1 = animelemtime(6) >= 0
trigger1 = moveguarded
x = -0.24
ignorehitpause = 1
persistent = 0

[state 240, velmul]
type = velmul
trigger1 = animelemtime(6) >= 0
trigger1 = movehit
x =  -0.12
ignorehitpause = 1
persistent = 0

[state 240, corner pushback]
type = veladd
trigger1 = animelemtime(6) >= 0
trigger1 = movehit
trigger1 = enemynear,backedgebodydist < 30
x = -12
ignorehitpause = 1
persistent = 0

[state 240, veladd]
type = veladd
trigger1 = animelem = 6
trigger1 = moveguarded
y = -8

[state 240, statetype]
type = statetypeset
trigger1 = animelem = 3
physics = N

[state 240, statetype]
type = statetypeset
trigger1 = animelem = 5
statetype = A
physics = N

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -3
persistent = 0
ignorehitpause = 1


[State 240, 3]
type = velset
trigger1 = AnimElem = 5
y = -16

[state 240, veladd]
type = veladd
trigger1 = animelem = 5
x = 6

[State 200, 2]
type = PlaySnd
trigger1 = animelem = 6
value = 200, 0

[state 240, gravity]
type = gravity
trigger1 = animelemtime(5) > 0

[state 240, Not Active]
type = statetypeset
trigger1 = animelemtime(7) = 0
movetype = I

[State 240, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 241
ignorehitpause = 1

;--------------------------------------------------------------------------
;Landing
[statedef 241]
type = S
movetype = I
physics = S
velset = 0,0
anim = 241
movehitpersist = 1

[state 241, yset]
type = posset
trigger1 = time = 0
y = 0

[state 241, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light punch
; CNS difficulty: easy
; Description: Simple crouching attack. The HitDef's guardflag parameter
;     is set to "L", meaning that the move can only be guarded low
;     (crouching), and not by standing or jumping opponents.
;     Like for all light attacks, it's a good idea to keep the slidetime
;     and hittime parameters at a smaller number, so the opponent isn't
;     stunned for too long. For all crouching attacks you have to
;     remember to set the attr parameter to indicate that it is crouching
;     attack. In this case, "C, NA" stands for "crouching, normal attack".
;     The HitDef's priority is set at 3, instead of the default of 4,
;     so this attack has a lower priority than most others, meaning
;     KFM will get hit instead of trading hits with his opponent if
;     their attack collision boxes (Clsn1) intersect each other's Clsn2
;     boxes at the same time.
[Statedef 400]
type    = C
movetype= A
physics = C
poweradd= 5
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 1]
type = PlaySnd
trigger1 = time = 0
value = 200, 0

[State 400, 2]
type = HitDef
trigger1 = !movecontact
attr = C, NA
damage    = 10
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = MA
pausetime = 6,6
sparkno = 0
sparkxy = -10,-144
hitsound   = S5000,0
guardsound = S120,0
ground.type = Low
ground.slidetime = 9
ground.hittime  = 9
ground.velocity = -8
air.velocity = -8,-1
guard.velocity = -16
guard.hittime = 8
guard.slidetime = 8
fall.recover = 1
fall.recovertime = 16

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1



[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
;Crouching strong punch
; CNS difficulty: easy
; Description: This is a 2-hit move. It is done by having two HitDefs
;     triggered, one for each frame of animation that hits.
;     Notice how the first hit cannot be guarded by an opponent in the
;     air, because of the "M" in the guardflag, meaning it can only
;     be guarded "middle". The second hit has an "MA" guardflag, so
;     it can be guarded both on the ground and in the air.
[Statedef 410]
type    = C
movetype= A
physics = N
poweradd= 40
ctrl = 0
anim = 410
sprpriority = 2

[state 410, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = ,AT
ignorehitpause = 1

[State 410, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 230, 0

[state 410, small Jump]
type = velset
trigger1 = animelemtime(2) = 0
x = 16
y = -12

[state 410, gravity]
type = gravity
trigger1 = animelemtime(2) > 0

[state 410, statetypeset]
type = statetypeset
trigger1 = animelemtime(2) = 0
statetype = A
ignorehitpause = 1

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = !movecontact
attr = A, NA
damage    = 60
animtype  = up
hitflag = MAF
guardflag = MA
pausetime = 18,18
sparkno = 3
id = 410
sparkxy = -10,-330
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 35
ground.hittime  = 35
air.hittime = 35
envshake.ampl = 12
envshake.time = 12
ground.velocity = -6, ifelse(var(11) > 0, -52, -16)
air.velocity = -6,ifelse(var(11) > 0, -48, -12)
guard.hittime = 6
guard.velocity = -16
airguard.hittime = 18
airguard.velocity = -12,-12
fall = ifelse(var(11) > 0, 0, 1)
fall.recover = 0
fall.recover = 1
fall.recovertime = 0
yaccel = 1.76

[state 410, Launcher]
type = varadd
trigger1 = movehit
var(11) = -1
ignorehitpause
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 410, Not Active]
type = statetypeset
trigger1 = animelemtime(6) = 0
movetype = I

[State 410, 4]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 411


;------------------------------------------------------------------------------
;Landing
[statedef 411]
type = C
movetype = I
anim = 411
physics = C
movehitpersist = 1

[state 411, velset]
type = velset
trigger1 = time = 0
y = 0
x = 0

[state 411, posset]
type = posset
trigger1 = time = 0
y = 0

[state 410, Jump Cancel]
type = changestate
trigger1 = !ailevel
trigger1 = movehit
trigger1 = command = "holdup"
trigger2 = ailevel
trigger2 = movehit
value = 42

[state 411, End]
type = changestate
trigger1 = animtime = 0
ctrl = 1
value = 11
;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
poweradd= 10
juggle = 7
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 1]
type = PlaySnd
trigger1 = Time = 1
value = 230, 0

[State 430, 2]
type = HitDef
trigger1 = !movecontact
attr = C, NA
damage    = ifelse(p2statetype = L, 10,20)
animtype  = light
hitflag = MAFD
guardflag = L
pausetime = 8,8
sparkno = 0
sparkxy = -10,-8
nochainid = 1400
hitsound   = S5000,1
guardsound = S120,0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 12
ground.velocity = -10
air.velocity = -2,-8
down.velocity = -8,0
down.hittime = 22
guard.hittime = 8
guard.slidetime = 8
guard.velocity = -20
fall.recover = 1
fall.recovertime = 20
guard.dist = 360

[state x, combo damage score]
type = varadd
trigger1 = movehit = 1
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
[Statedef 440]
type    = C
movetype= A
physics = C
poweradd= 50
Juggle = 15
ctrl = 0
anim = 440
sprpriority = -2

[state 440, Not Active]
type = statetypeset
trigger1 = animelemtime(6) = 0
movetype = I

[State 440, 2]
type = PlaySnd
trigger1 = Time = 2
value = 230, 0

;======================================
;Possition Adds
;======================================
[state 440, posadd]
type = posadd
triggerall = p2bodydist x > 280
trigger1 = animelemtime(2) = 0
x = 280
ignorehitpause
persistent = 0

[state 440, posadd]
type = posadd
triggerall = p2bodydist x > 120
trigger1 = animelemtime(4) = 0
x = 140
ignorehitpause
persistent = 0


[state 440, posadd]
type = posadd
trigger1 = animelemtime(5) = 0
x = -70
ignorehitpause
persistent = 0


[state 440, posadd]
type = posadd
trigger1 = animelemtime(6) = 0
x = -30
ignorehitpause
persistent = 0


[state 440, posadd]
type = posadd
trigger1 = animelemtime(7) = 0
x = -130
ignorehitpause
persistent = 0

[State 440, 3]
type = HitDef
trigger1 = animelem = 4
attr = C, NA
persistent = 0
damage    = ifelse(p2statetype = L, 17,ifelse(p2statetype = A, 17, 35))
id = 440
hitflag = MAFD
guardflag = L
pausetime = 2,2
sparkno = 2
sparkxy = -5,-10
hitsound   = S5000,1
guardsound = S120,0
ground.type = low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 0,0
air.velocity = 0,0
guard.dist = 920
down.velocity = -2,0
down.hittime = 22
guard.velocity = -32
guard.hittime = 8
fall.recover = 0



[state 440, spripriority]
type = sprpriority
trigger1 = animelem = 5
value = 2
ignorehitpause = 1

[State 440, 3]
type = HitDef
trigger1 = animelem = 5
attr = C, NA
damage    = ifelse(p2statetype = L, 17, ifelse(p2statetype = A, 17, 35))
persistent = 0
hitflag = MAFD
guardflag = L
pausetime = 14,14
guard.pausetime = 12, 7
id = 441
sparkno = 3
sparkxy = -5,-10
hitsound   = S5000,2
guardsound = S120,0
ground.type = Trip
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -10,ifelse(p2bodydist x > 120, -12, 0)
air.velocity = -10,-12
guard.dist = 720
guard.hittime = 8
guard.velocity = -32
guard.slidetime = 8
down.velocity = -24,0
down.hittime = 16
fall = ifelse(p2bodydist x > 120, 0, 1)
fall.recover = 0



[state x, combo damage score]
type = varadd
trigger1 = animelem = 6
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[State 440, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
poweradd= 10
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = 230, 0

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 15
guardflag = HA
priority = 3
pausetime = 6,6
sparkno = 0
sparkxy = -10,-58
hitsound   = S5000,0
guardsound = S120, 0
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -6
air.velocity = -4,-8
air.hittime = 18
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -8


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 600, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Med Punch
; CNS difficulty: easy
[Statedef 605]
type    = A
movetype= A
physics = A
poweradd= 20
ctrl = 0
anim = 605
sprpriority = 2

[state 605, playsnd]
type = playsnd
trigger1 = animelem = 2
value = 230,0

[state 605, Voice]
type = playsnd
trigger1 = time = 2
trigger1 = random%11 > 4
value = 300,0
channel = 0
persistent = 0


[State 605, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 32
guardflag = HA
priority = 3
pausetime = 10,10
sparkno = 1
sparkxy = -10,-58
hitsound   = 5,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -12
air.velocity = -2,-8
air.hittime = 20
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -10
fall.recover = 0

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -6
persistent = 0
ignorehitpause = 1

[state 600, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1


;---------------------------------------------------------------------------
;Jump Strong Punch
; CNS difficulty: easy
[Statedef 610]
type    = A
movetype= A
physics = N
poweradd= 25
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 2]
type = PlaySnd
trigger1 = palno != 12
trigger1 = Time = 2
value = 610, 0

[state 610, veladd]
type = veladd
trigger1 = animelem = 3
x = ifelse(vel x >= 0, 12, 0)
ignorehitpause =1
persistent = 0

[State 610, 3]
type = HitDef
trigger1 = animelem = 4
attr = A, SA
damage = ifelse(p2movetype = H, 60, ifelse(var(4) = 1, 150,120)),ifelse(var(4) =1, 15, 12)
guardflag = HA
priority = 4
id = 610
getpower = 70
pausetime = 18,18
sparkno = 3
sparkxy = -10,-188
hitsound   = 5,4
guardsound = S120, 0
animtype = Back
Envshake.ampl = 15
envshake.time = 18
ground.type = High
ground.slidetime = ifelse(var(4) = 1, 26,20)
ground.hittime  = ifelse(var(4) = 1, 26,20)
ground.velocity = ifelse(var(4) = 1, -50,-30),0
air.velocity = ifelse(var(4) = 1, -150,-50),ifelse(var(4) = 1, -12,-10)
air.fall = 1
fall.recover = 0
guard.hittime = ifelse(var(4) = 1, 16,12)
guard.slidetime = ifelse(var(4) = 1, 24,12)
guard.velocity = ifelse(var(4) = 1, -35, -16)
airguard.hittime = 16
airguard.velocity = ifelse(var(4) = 1, -32, -16),-8
guard.kill = ifelse(var(4) = 1, 1, 0)

[state 610, Poweradd]
type = poweradd
trigger1 = movehit
trigger1 = numtarget(610)
value = ifelse(var(4) = 1, 250, 125)
ignorehitpause = 1
persistent = 0

[state 610, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = numtarget(610)
trigger1 = p2statetype = A
trigger1 = palno != 12
value = S610,1
persistent = 0
ignorehitpause = 1

[state 610, Approval]
type = explod
triggerall = !numexplod(1990)
trigger1 = movehit
trigger1 = numtarget(610)
trigger1 = !target(610),alive
anim = 1990
postype = left
pos = 0,0
bindtime = 0
id = 1990
scale = 1,1
sprpriority = -5
ignorehitpause = 1


[state 610, playsnd]
type= playsnd
trigger1 = movehit
trigger1 = numtarget(610)
trigger1 = palno != 12
trigger1 = !target(610),alive
value = S610,2
persistent = 0
ignorehitpause = 1

[state 610, playsnd]
type = playsnd
trigger1 = movehit
trigger1 = numtarget(610)
trigger1 = palno = 12
value = S610,2
persistent = 0
ignorehitpause = 1

[state 610, varset]
type = varadd
trigger1 = movehit
trigger1 = Numtarget(610)
trigger1 = hitpausetime = 2
var(4) = -1
persistent = 0
ignorehitpause = 1


[state 610, wall bounce limiter]
type = varadd
trigger1 = numtarget(610)
trigger1 = p2statetype = A
trigger1 = movehit
var(7) = -1
ignorehitpause = 1
persistent = 0

[state 610, wall bounce]
type = targetstate
trigger1 = movehit
trigger1 = numtarget(610)
trigger1 = hitpausetime = 17
trigger1 = p2statetype = A
trigger1 = var(7) > 0
value = 675
ignorehitpause =1 
persistent = 0

[State 610, 3]
type = HitDef
trigger1 = animelem = 5
attr = A, NA
damage = ifelse(var(4) = 1, 60, 45)
guardflag = HA
priority = 4
id = 611
getpower = 20
nochainid = 610
pausetime = 12,12
sparkno = 3
sparkxy = -10,-188
hitsound   = S5000,2
guardsound = S120, 0
animtype = Med
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -16
air.velocity = -35,-6
air.fall = 1
fall.recover = 1
fall.recovertime = 40
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -14
airguard.hittime = 16
airguard.velocity = -12,-6


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = ifelse(numtarget(610), -3, -9)
persistent = 0
ignorehitpause = 1



[state 610, gravity]
type = gravity
trigger1 = 1


[STATE 610, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y 
value = 52

[state 610, Not Active]
type = statetypeset
trigger1 = animelemtime(6) = 0
movetype = I

[state 610, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = N
poweradd= 10
ctrl = 0
anim = 630
sprpriority = 2

[state 630, gravity]
type = veladd
trigger1 = 1
y = 1.32

[State 630, 1]
type = PlaySnd
trigger1 = animelem = 2
trigger2 = animelem = 4
trigger3 = animelem = 6 
trigger4 = animelem = 8
value = 200, 0

[State 630, 1]
type = veladd
triggerall = movecontact
trigger1 = animelem = 2
trigger2 = animelem = 4
trigger3 = animelem = 6 
trigger4 = animelem = 8
y = ifelse(vel y < 0, 0,-2)
persistent = 2


[State 630, 2]
type = HitDef
trigger1 = animelem = 2
attr = A, NA
damage = 8
guardflag = HA
priority = 3
pausetime = 1,1
sparkno = 1
sparkxy = -5,-35
hitsound   = 5,0
guardsound = S120, 0
id = 630
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -4
air.velocity = -2,-12
air.hittime = 16
guard.hittime = 12
guard.slidetime = 12

[State 630, 2]
type = HitDef
trigger1 = animelem = 4
attr = A, NA
damage = 8
guardflag = HA
priority = 3
pausetime = 1,1
sparkno = 1
id = 630
sparkxy = -5,-35
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -4
air.velocity = -2,-12
air.hittime = 16
guard.hittime = 12
guard.slidetime = 12

[State 630, 2]
type = HitDef
trigger1 = animelem = 6
attr = A, NA
damage = 8
guardflag = HA
priority = 3
pausetime = 1,1
sparkno = 1
id = 630
sparkxy = -5,-35
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -4
air.velocity = -2,-12
air.hittime = 16
guard.hittime = 12
guard.slidetime = 12

[State 630, 2]
type = HitDef
trigger1 = animelem = 8
attr = A, NA
damage = 8
guardflag = HA
priority = 3
pausetime = 6,6
sparkno = 1
id = 630
sparkxy = -5,-35
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -10
air.velocity = -6,-14
air.hittime = 20
guard.hittime = 12
guard.slidetime = 12

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 2
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 4
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 6
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 8
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[state 630, end 2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[state 630, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;--------------------------------------------------------------------------

;---------------------------------------------------------------------------
;Jump Medium Kick
; CNS difficulty: easy
[Statedef 635]
type    = A
movetype= A
physics = N
poweradd= 25
ctrl = 0
anim = 635
sprpriority = 2

[State 630, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 240, 0

[state 605, Voice]
type = playsnd
trigger1 = time = 2
trigger1 = random%11 > 4
value = 300,5
channel = 0
persistent = 0

[state 635, veladd]
type = veladd
trigger1 = animelem = 2
x = ifelse(vel x <= 0, 12,6)
persistent = 0

[state 635, velmul]
type = velmul
trigger1 = movecontact
x = 0.5
ignorehitpause = 1
persistent = 0

[State 635, 2]
type = HitDef
trigger1 = animelemtime(2) > 0 && animelemtime(11) < 0
attr = A, NA
damage = 10
persistent = 4
guardflag = HA
priority = 3
pausetime = 1,1
sparkno = 1
sparkxy = -100,-180
hitsound   = 5,0
guardsound = S120, 0
id = 635
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -4
air.velocity = -2,-floor(p2dist y * 0.035)
air.hittime = 20
guard.hittime = 12
guard.slidetime = 12

[State 635, 1]
type = veladd
triggerall = movecontact
trigger1 = animelemtime(2) > 0 && animelemtime(11) < 0
y = ifelse(vel y < 0, -2, ifelse(p2statetype = A,-16,-8))
persistent = 4

[State 630, 2]
type = HitDef
trigger1 = animelem = 11
attr = A, NA
damage = 27
guardflag = HA
priority = 3
pausetime = 10,10
sparkno = 2
id = 636
sparkxy = -100,-180
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -16
air.velocity = -12,-10
air.hittime = 22
guard.hittime = 16
guard.slidetime = 16

[state 635, gravity]
type = veladd
trigger1 = 1
y = 1.32

[state 635, no longer active]
type = statetypeset
trigger1 = animelem = 12
movetype = I
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = numtarget(635)
v = 18
value = -2
persistent = 0
ignorehitpause = 1

[state X, Combo Scaling]
type = varadd
trigger1 = numtarget(636)
v = 18
value = -4
persistent = 0
ignorehitpause = 1

[state 630, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
ctrl = 0

[state 630, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1
;-----------------------------------------------------------------------------------------------
;Dive Butt
[Statedef 638]
type    = A
movetype= A
physics = N
juggle  = 15
ctrl = 0
anim = 632
poweradd = 25
sprpriority = 2
facep2 = 1

[state 632, slow]
type = velmul
trigger1 = time = 0
x = 0.1
y = 0.1

[state 638, powerget]
type = poweradd
trigger1 = time = 0
trigger1 = prevstateno != 1152
value = 30

[state 638, playerpush]
type = playerpush
trigger1 = !movecontact
value = 0
ignorehitpause = 1

[state 638, 3 x Gravity]
type = veladd
trigger1 = animelemtime(3) >= 0
y = 8.8;8.8

[state 638, spike]
type = veladd
trigger1 = animelemtime(3) = 0
x = 18





[state 638, after image]
type = afterimage
trigger1 = animelemtime(3) = 0
time = 18
length = 8
timegap = 1
framegap = 2
palcolor = 256
palbright = 0,0,0
palcontrast = 256,256,256
trans = "none"


[State 638, 2]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 230, 0

[State 632, 3]
type = HitDef
trigger1 = !movecontact
attr = A, SA
damage    = ifelse(enemynear,statetype = L, 60,45)
hitflag = MAFD
guardflag = HA
priority = 2
getpower = 0
pausetime = 6,8
guard.pausetime = 8,6
sparkno = 3
id = 638
nochainid = 1400
sparkxy = -10,-80
hitsound   = 5,4
guardsound = S120, 0
animtype = heavy
ground.type = high
ground.slidetime = 14
ground.hittime  = 14
ground.velocity = -16,0
air.velocity = -2,-28
persistent = 0
guard.velocity = -16         
guard.hittime = 11
guard.slidetime = 11
airguard.velocity = -12,4
airguard.hittime = 20
down.hittime = 20
down.velocity = ifelse(var(8) > 1, 0, -20),ifelse(var(8) > 1, -27, 0)
fall.animtype = up
envshake.ampl = ifelse(enemynear,statetype = L, -4, 0)
envshake.time = ifelse(enemynear,statetype = L, 6, 0)
guard.dist = 480
guard.kill = 0
fall = 0
air.hittime = 30
air.fall = 0
fall.recover = 1
fall.recovertime = 30
guard.kill = 0
guard.dist = 640
guard.kill = 0

[state 638, varadd]
type = varadd
trigger1 = p2statetype = L
trigger1 = movehit
var(8) = -1
ignorehitpause = 1
persistent = 0

[state 638, aim]
type = veladd
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdfwd"
trigger1 = ailevel = 0
trigger2 = p2bodydist x > 50
trigger2 = ailevel > 0
x = 0.75
persistent = 1

[state 638, aim]
type = veladd
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = ailevel = 0
trigger2 = p2bodydist x < -50
trigger2 = ailevel > 0
x = -1.25
persistent = 1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 632, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > 80
value = 639


;---------------------------------------------------------------------
;Landing
[statedef 639]
type = C
movetype = I
movehitpersist = 1
anim = 633

[state 633, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 210, fx]
type = explod
trigger1 = time = 0
anim = F61
pos = 0,0
scale = 1,1
ownpal = 1
persistent = 0
sprpriority = -3

[state 633, ctrlset]
type = ctrlset
trigger1 = time = 3
trigger1 = movehit
value = 1

[state 633, posset]
type = posset
trigger1 = time = 0
y = 0

[state 633, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1



;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
poweradd= 35
ctrl = 0
anim = 640
sprpriority = 2

[state 440, Not Active]
type = statetypeset
trigger1 = animelemtime(8) = 0
movetype = I

[State 640, 2]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = S240, 0

[State 640, 3]
type = HitDef
trigger1 = !movecontact
attr = A, NA
damage    = 50
guardflag = HA
priority = 3
pausetime = 12,12
guard.pausetime = 10,10
sparkno = 3
sparkxy = -10,-40
hitsound   = 5,4
guardsound = 6,0
animtype = heavy
air.animtype = back
ground.type = High
ground.slidetime = 20
ground.hittime  = 20
ground.velocity = -20
air.velocity = -10,60
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -22
airguard.hittime = 20
airguard.velocity = -12,-20
envshake.ampl = 12
envshake.time = 8
air.fall = 1
p2facing = 1
fall.yvelocity = -25
fall.xvelocity = -5
down.bounce = 1
fall.recover = 0


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 640, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1



;===========================================================================
;      Wall Bounce State - Bring to Player
;===========================================================================
[statedef 670]
type = A
movetype = H
physics = N

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 670]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 670, changestate]
type = changestate
trigger1 = hitshakeover
value = 671
;------------------------------------------------------------------------

[statedef 671]
type    = A
movetype= H
physics = N

[state 671, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 670, Velocity]
type = velset
trigger1 = Time = 0
x = facing * gethitvar(xvel)
y = gethitvar(yvel)

[State 670, Gravity]
type = veladd
trigger1 = 1
y = 0.44


;[State 670, No scroll]
;type = ScreenBound
;triggerall = Pos y < -15
;trigger1 = BackEdgeBodyDist < 65
;trigger2 = FrontEdgeBodyDist < 65
;value = 1
;movecamera = 0,1

[State 670, Hit wall]
type = ChangeState
triggerall = Pos y < 0
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 672

[State 670, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 672]
type    = A
movetype= H
physics = N

[State 672, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 672, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 672, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 672, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 672, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0,const(size.mid.pos.y)
postype = back
sprpriority = 3
ownpal = 1

[state 672, anim]
type = changeanim
trigger1 = anim != 5030
value = 5030

[State 672, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 672, State]
type = ChangeState
trigger1 = time = 10
value = 673
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 673]
type    = A
movetype= H
physics = N

[State 673, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -35

[State 673, Vel X]
type = VelSet
trigger1 = Time = 0
x = abs(p2bodydist x*0.02)

[State 673, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[state 673, gravity]
type = veladd
trigger1 = 1
y = 1.5

[State 673, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 673, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 673, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 673, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 673, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;===========================================================================
; Neutral Wall Bounce State
;===========================================================================

[statedef 675]
type = A
movetype = H
physics = N

[State 675, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 675, anim]
type = changeanim
trigger1 = time = 0
value = 5030
ignorehitpause = 1

[state 675, changestate]
type = changestate
trigger1 = hitshakeover
value = 676
;------------------------------------------------------------------------

[statedef 676]
type    = A
movetype= H
physics = N

[State 676, Velocity]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[state 676, anim]
type = changeanim
trigger1 = time = 0
value = 5030

[State 676, Gravity]
type = gravity
trigger1 = 1

[State 676, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 676, Hit wall]
type = ChangeState
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 677

[State 676, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
;Hit wall - part 2 bounce off wall
[statedef 677]
type    = A
movetype= H
physics = N

[State 677, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 677, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

;[STATE 677, nothitby]
;type = nothitby
;trigger1 = 1
;value = SCA

[State 677, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[state 677, envshake]
type = envshake
trigger1 = time =0
ampl = -12
time = 12


[State 677, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1

[State 677, Spark]
type = Explod
trigger1 = Time = 1
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3
ownpal = 1

[State 677, Anim]
type = ChangeAnim
trigger1 = Time = 0
value = 5030

[State 677, Sound]
type = PlaySnd
trigger1 = Time = 1
value = F7,0

[State 677, State]
type = ChangeState
trigger1 = time = 10
value = 678
;--------------------------------------------------------------------------
;wall bounce - part 3 fall toward ground
[Statedef 678]
type    = A
movetype= H
physics = N

;[State 678, 1]
;type = NotHitBy
;trigger1 = 1
;value = SCA

[State 678, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -28

[State 678, Vel X]
type = VelSet
trigger1 = Time = 0
x = 6

[State 678, Turn]
type = Turn
trigger1 = (Time = 0) && (BackEdgeDist < 30)

[state 673, gravity]
type = veladd
trigger1 = 1
y = 1.5

;[State 678, Gravity]
;type = VelAdd
;trigger1 = 1
;y = .35

[State 678, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 678, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 678, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 678, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 678, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100


;---------------------------------------------------------------------------
;Flip Throw

[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2
poweradd = 10

[State 800, 1]
type = HitDef
trigger1 = p2movetype != A
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                         
id = 800
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 820       
guard.dist = 0       
fall = 1
fall.recover = 0 

[State 800, 1]
type = HitDef
trigger1 = p2movetype = A
Trigger1 = Time = 0
attr = S, NT          
hitflag = M-          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                         
id = 800
p1facing = 1
p2facing = 1          
p1stateno = 810       
p2stateno = 822       
guard.dist = 0       
fall = 1
fall.recover = 0

          
[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Grab Escape - p2
[statedef 805]
type = A
movetype = H
physics = S
ctrl = 0
facep2 = 1
sprpriority = 4

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(805)
value = 805

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 120

;[state 1400, dim]
;type = bgpalfx
;trigger1 = time = 0
;time = 8
;mul = 200,200,200

;[state 805, freeze]
;type = pause
;trigger1 = time = 0
;time = 8
;endcmdbuftime = 8

;[state 805, sound]
;type = playsnd
;trigger1 = time = 0
;value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, velset]
type = velset
trigger1 = time = 10
x= -100 ;-const(velocity.run.fwd.x) * 4

[state 805, velmul]
type = velmul
trigger1 = time = 18
x = 0.125



[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Grab Escape - p1
[statedef 806]
type = A
movetype = H
physics = S
ctrl = 0

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = SelfAnimExist(130)
value = 130

[state 805, anim]
type = changeanim
trigger1 = time = 0
trigger1 = !selfanimexist(805)
value = 130

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 8
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 805, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 805, turn]
type = turn
trigger1 = prevstateno = 820
trigger1 = time = 0
persistent = 0
ignorehitpause

[state 805, velset]
type = velset
trigger1 = time = 10
x= -100;-const(velocity.run.fwd.x) * 2


[state 805, velset]
type = velmul
trigger1 = animelemtime(9) = 0
x = 0.125

[state 805, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 805, end]
type = selfstate
trigger1 = time = 35
value = 0
ctrl = 1

;---------------------------------------------------------------------------

[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 0

[state 810, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 805
value = 806
persistent = 1

[State 810, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdback"

[State 810, holdfwd - Turn 3] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 3

[State 810, holdfwd - Pos 3] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElem = 3
x = -37

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 3
value = -1

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 7
value = 800, 0

;-----------------------------------Width
[State 810, Width 2-11]
type = Width
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(12) < 0
edge = 60,0


;======================================
; TargetBindings
;======================================


[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 28, 0

[State 810, Bind 2]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 58, 0

[State 810, Bind 3]
type = bindtotarget
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 0, 0, head

[State 810, Bind 4]
type = bindtotarget
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = 0, 0,head

[State 810, Bind 5]
type = bindtotarget
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = 5, 0,head

[State 810, Bind 6]
type = bindtotarget
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = 10, 0,head

[State 810, Bind 7]
type = bindtotarget
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = 15, 0,head

[State 810, Bind 8]
type = bindtotarget
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = 20, 0,head

[State 810, Bind 8]
type = Targetbind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
pos = 50, -128

[state 810, velset]
type = veladd
trigger1 = animelemtime(9) = 1
y = -18

[state 810, gravity]
type = gravity
trigger1 = animelemtime(9) > 1

[state 810, playsnd]
type = playsnd
trigger1 = animelem = 5
value = 240,0

[state 810, reposition]
type = posadd
trigger1 = animelemtime(11) = 0
x = 61
y = 134



[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 10
value = -110

[state 810, targetpoweradd]
type = targetpoweradd
trigger1 = animelem = 10
value = 100

[state 810, Voice]
type = playsnd
trigger1 = animelemtime(8) = 1
value = 810,1+(random%2)
channel = 0
persistent = 0

[state 810, poweradd]
type = poweradd
trigger1 = animelem = 10
value = 80

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 10
value = 821

[state x, combo damage score]
type = varadd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
v = 18
value = -18
persistent = 0
ignorehitpause = 1


[State 810, State End]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;---------------------------------------------------------------------------
;Flip thrown Techable
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0

[state 820, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 805

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = -36,-4
poweradd = 60

[State 821, 1] ;Gravity
type = gravity
Trigger1 = 1

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;---------------------------------------------------------------------------
;Flip thrown UNTechable
[Statedef 822]
type    = A
movetype= H
physics = N
velset = 0,0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;===========================================================================
;  Air Flip Throw
;===========================================================================

;---------------------------------------------------------------------------
;Flip Throw Neutral

[Statedef 830]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 830
sprpriority = 2

[State 830, 1]
type = HitDef
Trigger1 = Time = 0
attr = A, NT          
hitflag = A-          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                         
id = 800
p1facing = 1
p2facing = 1          
p1stateno = 840       
p2stateno = 850  ;Allowed to Tech     
guard.dist = 0       
fall = 1
fall.recover = 0



[state 830, throw damage]
type = varset
trigger1 = time = 0
var(16) = -150

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 50
ctrl = 1

;----------------------------------------------------------------------------
;Flip Throw Combo

[Statedef 831]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 830
sprpriority = 2



[State 800, 1]
type = HitDef
Trigger1 = p2stateno != [150,155]
attr = A, ST          
hitflag = AF          
priority = 1, Miss    
sparkno = -1          
p1sprpriority = 1                         
id = 800
p1facing = 1
p2facing = 1          
p1stateno = 840  ; Less damage    
p2stateno = 852 ;Not allowed to tech       
guard.dist = 0       
fall = 1
fall.recover = 0


[state 830, throw damage]
type = varset
trigger1 = time = 0
var(16) = -90
       
[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 50
ctrl = 1

;--------------------------------------------------------------------------
;Grab Escape - p2
[statedef 835]
type = A
movetype = H
physics = N
anim = 43
ctrl = 0

[state 835, changeanim]
type = changeanim
trigger1 = vel y > 2
value = ifelse(animexist(46), 46, 43)
persistent = 0

[state 835, posset]
type = posset
trigger1 = time = 0
y = enemynear,pos y

[state 835, targetfacing]
type = targetfacing
trigger1 = time = 0
value = -1
persistent = 1

[state 835, velset]
type = velset
trigger1 = time = 0
x= -12
y= -2

[state 835, gravity]
type = veladd
trigger1 = time > 0
y = 1.25

[state 835, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 835, end1]
type = selfstate
trigger1 = time >= 30
value = 50
ctrl = 1

[state 835, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------
;Grab Escape - p1
[statedef 836]
type = A
movetype = H
physics = N
anim = 43
ctrl = 0

[state 836, anim]
type = changeanim
trigger1 = vel y > 5
trigger1 = anim != 46
value = 46


[state 836, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 836, posset]
type = posset
trigger1 = time = 0
y = enemynear,pos y 
persistent = 0
ignorehitpause = 1

[state 1400, dim]
type = bgpalfx
trigger1 = time = 0
time = 12
mul = 200,200,200

[state 805, freeze]
type = pause
trigger1 = time = 0
time = 12
endcmdbuftime = 8

[state 805, sound]
type = playsnd
trigger1 = time = 0
value = S805,0

[state 835, targetfacing]
type = targetfacing
trigger1 = time = 0
value = -1
persistent = 1

[state 835, velset]
type = velset
trigger1 = time = 0
x= -12
y= -2

[state 835, gravity]
type = veladd
trigger1 = time > 0
y = 1.25

[state 835, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 835, end1]
type = selfstate
trigger1 = time >= 29
value = 50
ctrl = 1

[state 835, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;---------------------------------------------------------------------------

[Statedef 840]
type    = S
movetype= A
physics = N
anim = 840
poweradd = 0
velset = 0,0



[state 840, tech]
type = changestate
triggerall = numtarget
trigger1 = target(800),stateno = 835
value = 836
persistent = 1

[State 840, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdback"

[State 840, holdfwd - Turn 3] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 2

[State 840, holdfwd - Pos 3] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElem = 2
x = -37

[State 840, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 2
value = -1

[State 840, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 1
value = 1, 1

[State 840, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 7
value = 800, 0

;-----------------------------------Width
[State 840, Width 2-11]
type = Width
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(12) < 0
edge = 60,0


;======================================
; TargetBindings
;======================================

[State 840, Bind 3]
type = bindtotarget
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(2) < 0
pos = 0, 0, head

[State 840, Bind 4]
type = bindtotarget
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(3) < 0
pos = 0, 0,head

[State 840, Bind 5]
type = bindtotarget
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(4) < 0
pos = 5, 0,head

[State 840, Bind 6]
type = bindtotarget
trigger1 = AnimElemTime(4) >= 0 && AnimElemTime(5) < 0
pos = 10, 0,head

[State 840, Bind 7]
type = bindtotarget
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = 15, 0,head

[State 840, Bind 8]
type = bindtotarget
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = 20, 0,head

[State 840, Bind 8]
type = Targetbind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = 50, -128

[state 840, velset]
type = veladd
trigger1 = animelemtime(8) = 1
y = -18
x = -4

[state 840, gravity]
type = gravity
trigger1 = animelemtime(8) > 1

[state 840, playsnd]
type = playsnd
trigger1 = animelem = 3
value = 240,0

[state 810, targetpoweradd]
type = targetpoweradd
trigger1 = animelem = 8
value = 125

[state 810, poweradd]
type = poweradd
trigger1 = animelem = 8
value = 100


[state 810, reposition]
type = posadd
trigger1 = animelemtime(9) = 0
x = 61
y = 134

[State 840, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 8
value = floor(fvar(10) * var(16))

[State 840, Throw 11]
type = TargetState
trigger1 = AnimElem = 8
value = 851

[state 810, Voice]
type = playsnd
trigger1 = animelemtime(6) = 1
value = 810,1+(random%2)
channel = 0
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = vel y > 0
trigger1 = pos y > -vel y
v = 18
value = -18
persistent = 0
ignorehitpause = 1


[State 840, State End]
type = ChangeState
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;---------------------------------------------------------------------------
;Flip thrown Techable
[Statedef 850]
type    = A
movetype= H
physics = N
velset = 0,0

[state 840, posadd]
type = posadd
trigger1 = time = 0
y = 160

[state 850, tech throw]
type = changestate
triggerall = time < 12
trigger1 = ailevel = 0
trigger1 = command = "holdfwd" || command = "holdback"
trigger1 = command = "y" || command = "b" || command = "z" || command = "c"
trigger2 = command = "x" && command = "a"
trigger3 = ailevel > 4 
trigger3 = random < (ailevel * ifelse(ailevel>7,1,3))
value = 835

[State 850, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 850

[State 850, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 851]
type    = A
movetype= H
physics = N
velset = -40,24
poweradd = 60

[State 851, 1] ;Gravity
type = gravity
Trigger1 = 1

[State 851, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground

;---------------------------------------------------------------------------
;Flip thrown UNTechable
[Statedef 852]
type    = A
movetype= H
physics = N
velset = 0,0

[state 840, posadd]
type = posadd
trigger1 = time = 0
y = 160

[State 850, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 850

[State 850, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050



;===========================================================================
;                            Quick Elbow
;===========================================================================
; Elbow Light
[statedef 1000]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1000
poweradd = 60
ctrl = 0

[state 1000, velocity]
type = velset
trigger1 = animelemtime(4) = 0
x = const(velocity.run.fwd.x)*2

[state 1000, sonic boom snd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S1000,0
persistent = 0

[state 1000, Voice]
type = playsnd
trigger1 = animelemtime(3)=2
value = 300,4
channel = 0
persistent = 0




[state 1000, Wind Aura]
type = explod
trigger1 = animelemtime(4) >= 0
anim = 2010;F72
postype = p1
pos = 222,-182
scale = 1.25,1.25
sprpriority = 3
id = 2010
bindtime = -1
persistent = 8
removeongethit = 1
ownpal = 1
trans = addalpha
alpha = 256,192

[state 1000, Intitial Dust]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 0
ownpal = 1

[State 1000, Hit]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = heavy
damage    = 45,11
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,8
sparkno = 3
sparkxy = -50,-206
hitsound   = 5,4
guardsound = S120, 0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 30
air.hittime = 30
ground.velocity = -2
air.velocity = -2.5,-4
forcenofall = 1
guard.velocity = -14
guard.slidetime = 14
guard.hittime = 14
guard.dist = 480
yaccel = 1.76



[state 1000, end: Block]
type = changestate
trigger1 = moveguarded
trigger2 = movereversed
value = 1007

[state 1000, end]
type = changestate
trigger1 = !movecontact
trigger1 = time = 15
value = 1009

[state 1000, Contact]
type = changestate
trigger1 = movehit
value = 1001
;-------------------------------------------------------------------------------------------------

[statedef 1001]
type = A
movetype = A
physics = N
anim = 1001

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[state 1001, velmul]
type = velmul
trigger1 = anim = 1001
trigger1 = time = 0
x = 0.25

[state 1001, velset]
type = velset
trigger1 = anim = 1001
trigger1 = animelemtime(3)=0
X = 12
Y = -40

[State 1001, Hit]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = S, SA
animtype  = up
damage    = 45
guardflag = MA
pausetime = 8,8
sparkno = 3
sparkxy = -50,-380
hitsound   = 5,3
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -10,-44
air.velocity = -10,-42
guard.velocity = -18
guard.slidetime = 14
guard.hittime = 14
fall = 1
yaccel = 1.76
fall.recover = 0

[State 1001, Hit]
type = HitDef
trigger1 = animelem = 5
trigger2 = animelem = 7
trigger3 = animelem = 9
persistent = 2
attr = S, SA
animtype  = up
damage    = 5,1
guardflag = MA
pausetime = 1,1
sparkno = 1
sparkxy = -50,-330
hitsound   = 5,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -10,-18
air.velocity = -10,-18
guard.velocity = -12
guard.slidetime = 12
guard.hittime = 12
fall = 1
yaccel = 1.76
fall.recover = 0


[State 1001, Hit]
type = HitDef
trigger1 = animelem = 11
persistent = 0
attr = S, SA
animtype  = up
damage    = 5,1
guardflag = MA
pausetime = 8,8
sparkno = 2
sparkxy = -50,-264
hitsound   = 5,3
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -24,-6
air.velocity = -24,-6
guard.velocity = -12
guard.slidetime = 12
guard.hittime = 12
fall = 1
fall.recover = 0
yaccel = 1.76

[State 630, 1]
type = PlaySnd
trigger1 = animelem = 5
trigger2 = animelem = 7
trigger3 = animelem = 9 
trigger4 = animelem = 11
value = 200, 0

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 11
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1001, gravity]
type = gravity
trigger1 = pos y < -1

[state 1001, coming down]
type = changeanim
trigger1 = animtime = 0
value = 44


[state 1001, end]
type = changestate
triggerall = animelemtime(3) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1002

;---------------------------------------------------------------------------------
;Landing Recovery
[statedef 1002]
type = C
movetype = I
physics = C
anim = 1002
ctrl = 0

[state 1002, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1002, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1002, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
;Blocked
[statedef 1007]
type = A
movetype = I
physics = N
anim = 1007

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[state 1007, bounce]
type = velmul
trigger1 = time =0
x = -0.054

[state 1007, bounce]
type = velset
trigger1 = time = 0
y = -27

[state 1007, gravity]
type = veladd
trigger1 = time > 0
y = 1.76
persistent = 1

[state 1007, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1008

;-------------------------------------------------------------
;Landing Lag
[statedef 1008]
type = S
movetype = I
physics = S
anim = 47
ctrl = 0

[state 1008, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1008, velset]
type = velset
trigger1 = time = 0
y = 0


[state 1008, end]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1



;--------------------------------------------------------------------------------------------------
;Whiff Miss
[statedef 1009]
type = S
movetype = I
physics = N
anim = 1009

[state 101, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[state 1009, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1009, velmul]
type = velmul
trigger1 = time = 0
x = 0.125
y = 0

[state 1009, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = F120
postype = p1
pos = 96,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1009, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------
; Elbow Hard
[statedef 1010]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1010
poweradd = 80
ctrl = 0

[state 1010, velocity]
type = velset
trigger1 = animelemtime(4) = 0
x = const(velocity.run.fwd.x)*2.5

[state 1010, sonic boom snd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S1000,0
persistent = 0

[state 1000, Voice]
type = playsnd
trigger1 = animelemtime(3)=2
value = 300,4
channel = 0
persistent = 0

[state 1010, explod]
type = explod
trigger1 = animelemtime(4) >= 0
anim = 2010;F40
postype = p1
pos = 222,-182
scale = 1.5,1.5
sprpriority = 3
id = 2010
bindtime = -1
persistent = 8
removeongethit = 1
trans = addalpha
alpha = 256,192

[state 1010, Intitial Dust]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
persistent = 0

[State 1010, Hit]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = heavy
damage    = 50,13
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,8
sparkno = 3
sparkxy = -50,-206
hitsound   = 5,4
guardsound = S120, 0
ground.type = low
ground.slidetime = 24
ground.hittime  = 30
air.hittime = 24
ground.velocity = -2
air.velocity = -2.5,-4
forcenofall = 1
guard.velocity = -18
guard.slidetime = 14
guard.hittime = 14
guard.dist = 480
yaccel = 1.76


[state 1010, end: Block]
type = changestate
trigger1 = moveguarded
trigger2 = movereversed
value = 1017

[state 1010, end: Whiff]
type = changestate
trigger1 = !movecontact
trigger1 = time = 18
value = 1019

[state 1010, End: Hit]
type = changestate
trigger1 = movehit
value = 1011
;-------------------------------------------------------------------------------------------------

[statedef 1011]
type = A
movetype = A
physics = N
anim = 1011

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1011, velmul]
type = velmul
trigger1 = anim = 1011
trigger1 = time = 0
x = 0.25

[state 1011, velset]
type = velset
trigger1 = anim = 1011
trigger1 = animelemtime(3)=0
X = 12
Y = -45

[State 1011, Hit]
type = HitDef
trigger1 = animelem = 3
persistent = 0
attr = S, SA
animtype  = up
damage    = 50,0
guardflag = MA
pausetime = 8,8
sparkno = 3
sparkxy = -50,-380
hitsound   = 5,3
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 30
air.hittime = 30
ground.velocity = -10,-47
air.velocity = -10,-45
guard.velocity = -18
guard.slidetime = 14
guard.hittime = 14
fall = 1
yaccel = 1.76
fall.recover = 0



[State 1001, Hit]
type = HitDef
trigger1 = animelem = 5
trigger2 = animelem = 7
trigger3 = animelem = 9
trigger4 = animelem = 11
trigger5 = animelem = 13
persistent = 2
attr = S, SA
animtype  = up
damage    = 5,1
guardflag = MA
pausetime = 1,1
sparkno = 1
sparkxy = -50,-330
hitsound   = 5,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -10,-20
air.velocity = -10,-20
guard.velocity = -12
guard.slidetime = 12
guard.hittime = 12
fall = 1
fall.recover = 0
yaccel = 1.76

[State 1001, Hit]
type = HitDef
trigger1 = animelem = 15
persistent = 0
attr = S, SA
animtype  = up
damage    = 5
guardflag = MA
pausetime = 8,8
sparkno = 2
sparkxy = -50,-264
hitsound   = 5,3
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -24,-2
air.velocity = -24,-2
guard.velocity = -12
guard.slidetime = 12
guard.hittime = 12
fall = 1
fall.recover = 0
yaccel = 1.76

[state 1001, gravity]
type = gravity
trigger1 = pos y < -1

[state 1001, coming down]
type = changeanim
trigger1 = animtime = 0
value = 44

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 15
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[State 1001, 1]
type = PlaySnd
trigger1 = animelem = 5
trigger2 = animelem = 7
trigger3 = animelem = 9 
trigger4 = animelem = 11
trigger5 = animelem = 13
trigger6 = animelem = 15
value = 200, 0


[state 1001, end]
type = changestate
triggerall = animelemtime(3) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1012

;---------------------------------------------------------------------------------
;Landing Recovery
[statedef 1012]
type = C
movetype = I
physics = C
anim = 1012
ctrl = 0

[state 1012, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1012, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1012, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;-----------------------------------------------------------------------------
;Blocked
[statedef 1017]
type = A
movetype = I
physics = N
anim = 1017

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[state 1017, bounce]
type = velmul
trigger1 = time =0
x = -0.02

[state 1017, bounce]
type = velset
trigger1 = time = 0
y = -30

[state 1017, gravity]
type = veladd
trigger1 = time > 0
y = 1.76
persistent = 1

[state 1017, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1018

;-------------------------------------------------------------
;Landing Lag
[statedef 1018]
type = S
movetype = I
physics = S
anim = 47
ctrl = 0

[state 1018, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1018, velset]
type = velset
trigger1 = time = 0
y = 0


[state 1018, end]
type = changestate
trigger1 = time = 12
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------------------
;Whiff Miss
[statedef 1019]
type = S
movetype = I
physics = N
anim = 1019

[state 101x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[state 1019, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1019, velmul]
type = velmul
trigger1 = time = 0
x = 0.125
y = 0

[state 1019, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = F120
postype = p1
pos = 96,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1019, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------------
; EX Elbow
[statedef 1020]
type = S
movetype = A
physics = N
velset = 0,0
anim = 1020
poweradd = -500
ctrl = 0

[state 1020, velocity]
type = velset
trigger1 = animelemtime(4) = 0
x = const(velocity.run.fwd.x)*2.5

[state 1020, sonic boom snd]
type = playsnd
trigger1 = animelemtime(4) = 0
value = S1000,0
persistent = 0

[state 1000, Voice]
type = playsnd
trigger1 = animelemtime(3)=1
value = 300,4
channel = 0
persistent = 0

[state 1000, explod]
type = explod
trigger1 = animelemtime(4) >= 0
anim = 2010
id = 2010
postype = p1
pos = 222,-182
scale = 1.35,1.35
sprpriority = 3
bindtime = -1
persistent = 8
removeongethit = 1
trans = addalpha
alpha = 256,192

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1000, Intitial Dust]
type = explod
trigger1 = animelemtime(4) = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*2,const(size.yscale)*2
persistent = 0

[State 1020, Hit]
type = HitDef
trigger1 = !movecontact
attr = S, SA
animtype  = heavy
damage    = 40,11
guardflag = MA
pausetime = 12,12
guard.pausetime = 8,8
getpower = 0
sparkno = 3
sparkxy = -50,-206
hitsound   = 5,4
guardsound = S120, 0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 30
ground.velocity = -2
air.velocity = -2.5,-4
forcenofall = 1
guard.velocity = -16
guard.slidetime = 16
guard.hittime = 16
guard.dist = 480
yaccel = 1.76

[state 1020, end: Block]
type = changestate
trigger1 = moveguarded
trigger2 = movereversed
value = 1027

[state 1020, end: Whiff]
type = changestate
trigger1 = !movecontact
trigger1 = time = 18
value = 1029

[state 1020, End: Hit]
type = changestate
trigger1 = movehit
value = 1021
;-------------------------------------------------------------------------------------------------
;EX Elbow 
[statedef 1021]
type = A
movetype = A
physics = N
anim = 1021
movehitpersist = 1

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
trigger1 = anim = 1021
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1021, velmul]
type = velmul
trigger1 = anim = 1021
trigger1 = time = 0
x = 0.25

[state 1021, velset]
type = velset
trigger1 = anim = 1021
trigger1 = animelemtime(6)=0
X = 12
Y = -40

[State 1021, Hit]
type = HitDef
trigger1 = animelem = 6
persistent = 0
attr = S, SA
animtype  = up
damage    = 40
getpower = 0
guardflag = MA
pausetime = 8,8
sparkno = 3
sparkxy = -50,-380
hitsound   = 5,3
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -10,-40
air.velocity = -10,-36
guard.velocity = -18
guard.slidetime = 14
guard.hittime = 14
fall = 1
yaccel = 1.76
fall.recover = 0


[State 1021, Hit]
type = HitDef
trigger1 = animelem = 8
trigger2 = animelem = 10
trigger3 = animelem = 12
trigger4 = animelem = 14
trigger5 = animelem = 16
persistent = 2
attr = S, SA
animtype  = up
damage    = 5
getpower = 0
guardflag = MA
pausetime = 1,1
sparkno = 1
sparkxy = -50,-330
hitsound   = 5,1
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -10,-18
air.velocity = -10,-18
guard.velocity = -12
guard.slidetime = 12
guard.hittime = 12
fall = 1
yaccel = 1.76
fall.recover = 0


[State 1021, Hit]
type = HitDef
trigger1 = animelem = 18
persistent = 0
attr = S, SA
animtype  = up
damage    = 5
getpower = 0
guardflag = MA
pausetime = 8,8
sparkno = 2
id = 1020
sparkxy = -50,-264
hitsound   = 5,3
guardsound = S120, 0
ground.type = High
ground.slidetime = 12
ground.hittime  = 16
ground.velocity = -12,-22
air.velocity = -12,-22
guard.velocity = -12
guard.slidetime = 12
guard.hittime = 12
fall = 1
fall.recover = 0
yaccel = 1.76

[State 630, 1]
type = PlaySnd
trigger1 = animelem = 8
trigger2 = animelem = 10
trigger3 = animelem = 12 
trigger4 = animelem = 14
trigger5 = animelem = 16
trigger6 = animelem = 18
value = 200, 0

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = animelem = 18
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 1021, gravity]
type = gravity
trigger1 = pos y < -1

[state 1021, projectile immune]
type = nothitby
trigger1 = movehit
trigger2 = animelemtime(6) < 0
value = ,AP
ignorehitpause = 1


[state 1021, coming down]
type = changeanim
trigger1 = animtime = 0
value = 44


[state 1021, end]
type = changestate
triggerall = animelemtime(3) > 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1022


;---------------------------------------------------------------------------------
;Landing Recovery
[statedef 1022]
type = C
movetype = I
physics = C
anim = 1022
ctrl = 0

[state 1022, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1022, velset]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 1022, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
;Blocked
[statedef 1027]
type = A
movetype = I
physics = N
anim = 1027

[state 100x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[state 1027, bounce]
type = velmul
trigger1 = time =0
x = -0.072

[state 1027, bounce]
type = velset
trigger1 = time = 0
y = -33

[state 1027, gravity]
type = veladd
trigger1 = time > 0
y = 1.76
persistent = 1

[state 1027, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1028

;-------------------------------------------------------------
;Landing Lag
[statedef 1028]
type = S
movetype = I
physics = S
anim = 47
ctrl = 0

[state 1028, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1028, velset]
type = velset
trigger1 = time = 0
y = 0


[state 1028, end]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1



;--------------------------------------------------------------------------------------------------
;Whiff Miss
[statedef 1029]
type = S
movetype = I
physics = N
anim = 1029

[state 102x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010
ignorehitpause = 1

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1029, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1029, velmul]
type = velmul
trigger1 = time = 0
x = 0.125
y = 0

[state 1009, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = F120
postype = p1
pos = 96,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1029, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------


;==========================================================================
; Whirlwind Kick
;==========================================================================
;Light WW Kick
[statedef 1050]
type = U
movetype = A
ctrl = 0
poweradd = 60


[state 1050, Playsnd]
type = playsnd
trigger1 = animelemtime(4) = 1
value = S1050,0
ignorehitpause = 1

[state 1050, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 1
statetype = A

[state 1050, Voice]
type = playsnd
trigger1 = animelemtime(5) = 1
value = S1050,2+(random%2)
persistent = 0
channel = 0



[state 1050, fx]
type = explod
trigger1 = statetype != A
trigger1 = animelemtime(4) = 0
anim = F61
postype = p1
pos = 0,0
scale = 1.25,1

[state 1050, changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(statetype = A, 1055, 1050)

[state 1050, velset]
type = velset
trigger1 = statetype != A
trigger1 = time = 0
x = 0
y = 0

[state 1050, nothitby]
type = nothitby
trigger1 = anim = 1050
trigger1 = animelemtime(4) >= 0  && time < 30
value = ,AP

[state 1050, Jump]
type = velset
trigger1 = statetype != A
trigger1 = animelemtime(4) = 0
x = 24
y = -16

[state 1050, Jump]
type = velset
trigger1 = anim = 1055
trigger1 = statetype = A
trigger1 = animelemtime(4) = 0
y = 2

[state 1050, Boost]
type = velset
trigger1 = anim = 1055
trigger1 = animelemtime(4) = 0
trigger1 = vel x < 16 && vel x >= 0
x = 16


[state 1050, gravity]
type = veladd
trigger1 = anim = 1050
trigger1 = pos y < -1
trigger2 = time > 33
trigger2 = anim = 1055
y = 0.88
persistent = 1

[State 210, 2]
type = HitDef
trigger1 = time < 33
trigger1 = anim = 1050
trigger2 = anim = 1055
trigger2 = time < 26
persistent = 2
attr = S, SA
animtype  = heavy
damage    = 20,2
guardflag = MA
pausetime = 2,2
sparkno = 2
sparkxy = -50,-140
hitsound   = S5000,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -12
air.velocity = -8,-8
guard.velocity = -27
guard.slidetime = 14
guard.hittime = 14
guard.dist = 480
forcestand = 1
fall.recover = 1
fall.recovertime = 60

[State 210, 2]
type = HitDef
triggerall = animelem = 6 || animelem = 8
trigger1 = time >= 33
trigger1 = anim = 1050
trigger2 = time >= 26
trigger2 = anim = 1055
persistent = 2
attr = S, SA
animtype  = back
damage    = 40,4
guardflag = MA
pausetime = 8,8
sparkno = 3
id = 1050
sparkxy = -50,-140
hitsound   = 5,4
guardsound = S120, 0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -24,-8
air.velocity = -24,4
guard.velocity = -30
guard.slidetime = 10
guard.hittime = 10
air.hittime = 45
guard.dist = 480
fall = 1
fall.recover = 1
fall.recovertime = 60
yaccel = 1.76


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = numtarget(1050)
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1050, end1]
type = changestate
trigger1 = anim = 1050
trigger1 = time > 41
trigger2 = anim = 1055
trigger2 = time > 35
value = 1051

[state 1050, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1052
;-------------------------------------------------------------------------------
;WW Kick Recovery - Air

[statedef 1051]
type = A
movetype = I
physics = N
anim = 1051

[state 1051, gravity]
type = veladd
trigger1 = 1
y = 0.22

[state 1051, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1051, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1052


;-------------------------------------------------------------------------------
;WW Kick Recovery - Ground
[statedef 1052]
type = C
movetype = I
physics = C
anim = 47

[state 1051, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1051, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1051, end]
type = changestate
trigger1 = time >= 8
value = 0
ctrl = 1

;--------------------------------------------------------------------------------
;Heavy WW Kick
[statedef 1060]
type = U
movetype = A
ctrl = 0
poweradd = 80

[state 1060, Playsnd]
type = playsnd
trigger1 = animelemtime(4) = 1
value = S1050,0
ignorehitpause = 1

[state 1050, Voice]
type = playsnd
trigger1 = animelemtime(5) = 1
value = S1050,2+(random%2)
persistent = 0
channel = 0 ;Voice = 0

[state 1060, fx]
type = explod
trigger1 = statetype != A
trigger1 = animelemtime(4) = 0
anim = F61
postype = p1
pos = 0,0
scale = 1.5,1.1

[state 1050, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 1
statetype = A

[state 1060, changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(statetype = A, 1065, 1060)

[state 1060, velset]
type = velset
trigger1 = statetype != A
trigger1 = time = 0
x = 0
y = 0

[state 1060, nothitby]
type = nothitby
trigger1 = anim = 1060
trigger1 = animelemtime(4) >= 0 && time < 32
value = ,AP

[state 1060, Jump]
type = velset
trigger1 = statetype != A
trigger1 = animelemtime(4) = 0
trigger1 = anim = 1060
x = 30
y = -18

[state 1060, Jump]
type = velset
trigger1 = statetype = A
trigger1 = animelemtime(4) = 0
trigger1 = anim = 1065
y = -2

[state 1060, Horizontal movement air]
type = velset
trigger1 = statetype = A
trigger1 = animelemtime(4) = 0
trigger1 = vel x < 20 && vel x >= 0
x = 20


[state 1060, gravity]
type = veladd
trigger1 = anim = 1060
trigger1 = pos y < -1
trigger2 = time > 35
trigger2 = anim = 1065
y = 0.88
persistent = 1

[State 210, 2]
type = HitDef
triggerall = animelem = 6 || animelem = 8
trigger1 = time < 42
trigger1 = anim = 1060
trigger2 = anim = 1065
trigger2 = time < 36
persistent = 2
attr = S, SA
animtype  = heavy
damage    = 20,2
guardflag = MA
pausetime = 2,2
sparkno = 2
sparkxy = -50,-140
hitsound   = S5000,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = -12
air.velocity = -8,-8
guard.velocity = -27
guard.slidetime = 12
guard.hittime = 12
guard.dist = 480
forcestand = 1
fall.recover = 1
fall.recovertime = 60

[State 210, 2]
type = HitDef
triggerall = animelem = 6 || animelem = 8
trigger1 = time >= 42
trigger1 = anim = 1060

trigger2 = anim = 1065
trigger2 = time >= 36
persistent = 2
attr = S, SA
animtype  = back
damage    = 40,4
guardflag = MA
pausetime = 8,8
sparkno = 3
id = 1060
sparkxy = -50,-140
hitsound   = 5,4
guardsound = S120, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -27,-9
air.velocity = -27,4
guard.velocity = -24
guard.slidetime = 8
guard.hittime = 8
air.hittime = 45
guard.dist = 480
fall = 1
fall.recover = 1
fall.recovertime = 60
yaccel = 1.76


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = numtarget(1060)
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1060, end1]
type = changestate
trigger1 = anim = 1060
trigger1 = time > 51
trigger2 = anim = 1065
trigger2 = time > 45
value = 1061

[state 1050, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1062
;-------------------------------------------------------------------------------
;WW Kick Recovery - Air

[statedef 1061]
type = A
movetype = I
physics = N
anim = 1061

[state 1061, gravity]
type = veladd
trigger1 = 1
y = 0.22

[state 1061, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1061, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1062


;-------------------------------------------------------------------------------
;WW Kick Recovery - Ground
[statedef 1062]
type = C
movetype = I
physics = C
anim = 47

[state 1062, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1062, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1062, end]
type = changestate
trigger1 = time >= 12
value = 0
ctrl = 1

;--------------------------------------------------------------------------------
;EX WW Kick
[statedef 1070]
type = U
movetype = A
ctrl = 0
poweradd = -500


[state 1070, Playsnd]
type = playsnd
trigger1 = animelemtime(4) = 1
value = S1050,0

[state 1050, Voice]
type = playsnd
trigger1 = animelemtime(5) = 1
value = S1050,1
persistent = 0
channel = 0 ; Voice = 0

[state 1070, fx]
type = explod
trigger1 = statetype != A
trigger1 = animelemtime(4) = 0
anim = F61
id = 1070
postype = p1
pos = 0,0
scale = 2,1.3
persistent = 4

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1070, statetypeset]
type = statetypeset
trigger1 = animelemtime(4) = 1
statetype = A

[state 1070, changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(statetype = A, 1075, 1070)

[state 1070, velset]
type = velset
trigger1 = statetype != A
trigger1 = time = 0
x = 0
y = 0

[state 1070, nothitby]
type = nothitby
trigger1 = time = 0
trigger1 = statetype != A
value = SCA
time = 65

[state 1070, Jump]
type = velset
trigger1 = statetype != A
trigger1 = animelemtime(4) = 0
trigger1 = anim = 1070
x = 0
y = -12

[state 1070, Jump]
type = velset
trigger1 = statetype = A
trigger1 = animelemtime(4) = 0
trigger1 = anim = 1075
y = 0

[state 1070, Jump velocity add]
type = velset
trigger1 = statetype = A
trigger1 = animelemtime(4) = 0
x = 0

[state 1070, veladd]
type = veladd
triggerall = vel x < 8
trigger1 = anim = 1075
trigger1 = movehit
persistent = 1
x = 1


[state 1070, gravity]
type = veladd
trigger1 = anim = 1070
trigger1 = pos y < -1
trigger2 = time > 65
trigger2 = anim = 1075
y = 0.44
persistent = 1

[State 210, 2]
type = HitDef
triggerall = animelem = 6 || animelem = 8
trigger1 = time < 43
trigger1 = anim = 1070
trigger2 = anim = 1075
trigger2 = time < 56; 2 more hits + 16
persistent = 2
attr = S, SA
animtype  = heavy
damage    = ifelse(anim = 1075, 15, 20),4
getpower = 0
guardflag = MA
pausetime = 2,2
sparkno = 2
sparkxy = -50,-140
hitsound   = S5000,2
guardsound = S120, 0
ground.type = High
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 6
air.velocity = 4,-6
airguard.velocity = 4,-2
guard.velocity = 8
guard.slidetime = 12
guard.hittime = 12
guard.dist = 360
fall.recover = 1
forcestand = 1
fall.recovertime = 60

[State 210, 2]
type = HitDef
triggerall = animelem = 6 || animelem = 8
trigger1 = time >= 43
trigger1 = anim = 1070
trigger2 = anim = 1075
trigger2 = time >= 56
persistent = 2
attr = S, SA
animtype  = back
damage    = ifelse(anim = 1075, 45,50), 10
getpower = 0
guardflag = MA
pausetime = 8,8
sparkno = 3
id = 1070
sparkxy = -50,-140
hitsound   = 5,4
guardsound = S120, 0
ground.type = High
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = -30,-10
air.velocity = -30,4
guard.velocity = -64
airguard.velocity = -32,-10
guard.slidetime = 18
guard.hittime = 18
air.hittime = 45
guard.dist = 360
fall = 1
fall.recover = 1
fall.recovertime = 60
yaccel = 1.76


[state X, Combo Scaling]
type = varadd
trigger1 = movehit
trigger1 = numtarget(1070)
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1070, end1]
type = changestate
trigger1 = anim = 1070
trigger1 = time > 52
trigger2 = anim = 1075
trigger2 = time > 65
value = 1071

[state 1070, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1072
;-------------------------------------------------------------------------------
;WW Kick Recovery - Air

[statedef 1071]
type = A
movetype = I
physics = N
anim = 1071

[state 1071, gravity]
type = veladd
trigger1 = 1
y = 0.22

[state 1071, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1071, end2]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1072


;-------------------------------------------------------------------------------
;WW Kick Recovery - Ground
[statedef 1072]
type = C
movetype = I
physics = C
anim = 47

[state 1072, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1072, velset]
type = velset
trigger1 = time = 0
y = 0

[state 1062, end]
type = changestate
trigger1 = time >= 14
value = 0
ctrl = 1

;===========================================================================
;                            Running Start
;===========================================================================
;Running start - Ready : Light
[statedef 1100]
type = C
movetype = A
physics = S
velset = 0,0
anim = 1100
poweradd = 20
ctrl = 0

[state 1100, Voice]
type = playsnd
trigger1 = time = 2
value = 1100,(random%3)
channel = 0

[state 1100, end - Dash]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command != "holda"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = random < ailevel * 36
value = 1101
persistent = 1



[state 1100, nothitby]
type = nothitby
trigger1 = time < 18
value = ,AP


[state 1100, end - Cancel]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = command = "holda"
trigger2 = roundstate != 2
trigger3 = time > 180
value = 1109
persistent = 1

;----------------------------------------------------------------------------
; Sprint forward
[Statedef 1101]
type    = S
physics = S
movetype = A
anim = 1101
sprpriority = 1
ctrl = 0

[state 1101, Voice]
type = playsnd
trigger1 = time = 0
value = 1101,(random%3)
channel = 0
persistent = 0

[state 1101, running set]
type = varset
trigger1 = time = 0
var(4) = 1

[state 1101, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1100, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1000,0
persistent = 0
channel = 1

[state 1000, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 240,-142
scale = const(size.xscale)*5,const(size.yscale)*5
sprpriority = 3
bindtime = 2
persistent = 0
trans = addalpha
alpha = 256,192

[state 1111, meter gain]
type = poweradd
trigger1 = time%2
value = 12
persistent = 1

[state 1000, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 0

[State 1101, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*ifelse(command = "holdfwd", 1.5, 1.375)
y = 0
persistent = 1

[state 1101, dust]
type = explod
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(1) = 1
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1,const(size.yscale)*1
persistent = 1


[state 1101, Jump]
type =changestate
trigger1 = command = "holdup"
trigger1 = !ailevel
value = 1102

[state 1101, Slide Attack]
type =changestate
trigger1 = command = "a"
trigger1 = !ailevel
value = 1110

[state 1101, Hip Check Attack]
type =changestate
trigger1 = command = "y"
trigger1 = !ailevel
value = 1103

[state 1101, Phase Kick]
type =changestate
trigger1 = command = "b"
trigger1 = !ailevel
value = 1111

[state 1101, Leap Frog]
type =changestate
trigger1 = command = "x"
trigger1 = !ailevel
value = 1112

[state 1101, Slide]
type = changestate
trigger1 = command = "holddown"
trigger1 = !ailevel
value = 1106

[State 1101, 4]
type = ChangeState
triggerall = time > 6
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = roundstate != 2
trigger3 = time > 60
value = 1108

;--------------------------------------------------------------------------------------------------
;Hurdle
[statedef 1102]
type = A
movetype = I
physics = N
anim = 1102

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1102, pass through]
type = playerpush
trigger1 = p2statetype = C
trigger2 = p2statetype = L
value = 0

[state 1102, reversal projectiles]
type = hitoverride
trigger1 = time < 16
attr = SCA, AP
time = 1
stateno = 1105
persistent = 1

[state 1102, projectile immunity]
type = nothitby
trigger1 = TIME >= 16
value = ,AP

[state 1102, veladd]
type = velset
trigger1 = time = 0
y = -27

[state 1102, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1102, gravity]
type = veladd
trigger1 = time > 1
y = 2.64

[state 1102, land]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;--------------------------------------------------------------------------------------------------
;Hip check
[statedef 1103]
type = A
movetype = A
physics = N
anim = 1103
poweradd = 60

[state 11xx, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1103, jump]
type = velset
trigger1 = time = 0
y = -14

[state 1103, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1103, gravity]
type = gravity
trigger1 = time > 1

[State 1103, 2]
type = HitDef
triggerall = anim = 1103
trigger1 = animelem = 2
persistent = 0
attr = S, SA
damage    = 40,8
animtype = Heavy
guardflag = MA
priority = 2
pausetime = 6,8
guard.pausetime = 8,8
sparkno = 3
sparkxy = -40,-152
hitsound   = 5,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -6
air.velocity = -2,-2
air.hittime = 18
guard.hittime = 23
guard.slidetime = 23
guard.velocity = -12
forcestand = 1
fall = 0
air.fall = 1
guard.dist = 720

[State 1103, 2]
type = HitDef
triggerall = anim = 1104
trigger1 = animelem = 2
trigger1 = !moveguarded
persistent = 0
attr = S, SA
damage    = 40,8
animtype = Heavy
guardflag = MA
priority = 3
pausetime = 8,8
guard.pausetime = 8,8
id = 1103
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = ifelse(var(6) > 1, -18,-30),ifelse(var(6) > 1, 0, -2)
air.velocity = ifelse(var(6) > 1, -2,-18),ifelse(var(6) > 1, -18, -2)
air.hittime = 18
envshake.ampl = 8
envshake.time = 8
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -12
fall = ifelse(var(6) > 1, 0, 1)
air.fall = 1
guard.dist = 720
fall.recover = 0
fall.recovertime = 48

[state 1103, change animation]
type = changeanim
trigger1 = movecontact
value = 1104
persistent = 0

[state 1104, count]
type = varadd
triggerall = anim = 1104
trigger1 = animelemtime(2) > 0
trigger1 = movehit
v = 6
value = -1
ignorehitpause
persistent = 0

[state 1104, velmul]
type = velmul
trigger1 = movehit
x = 0.02
ignorehitpause = 1
persistent = 0

[state 1104, velmul]
type = velmul
trigger1 = moveguarded
x = -0.25
ignorehitpause = 1
persistent = 0

[state 1104, veladd]
type = veladd
trigger1 = moveguarded
y = -20
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = numtarget(1100)
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 1104, landing]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1107

[state 1104, landing]
type = changestate
triggerall = moveguarded
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1104

[state 1104, landing]
type = changestate
triggerall = movehit
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;-------------------------------------------------------------
;Landing Lag
[statedef 1104]
type = S
movetype = I
physics = S
anim = 47
ctrl = 0

[state 1104, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1104, velset]
type = velset
trigger1 = time = 0
y = 0


[state 1104, end]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Projectile Bounce
[statedef 1105]
type = A
movetype = I
physics = A
anim = 1105
poweradd = 250

[state 1105, pause]
type = pause
trigger1 = time = 0
time = 8
movetime = 8

[state 1105, nothitby]
type = nothitby
trigger1 = 1
value = ,AP
time = 24
persistent = 1

[state 1105, playsnd]
type = playsnd
trigger1 = time = 0
value = S805,0
ignorehitpause = 1

[state 1105, velset]
type = velset
trigger1 = time = 0
x = floor(p2bodydist x * 0.0333)
y = -24
persistent = 0

[state 1105, steering]
type = veladd
trigger1 = time > 0
trigger1 = command = "holdfwd"
x = 0.4

[state 1105, steering]
type = veladd
trigger1 = time > 0
trigger1 = command = "holdback"
x = -0.4

[state 1105, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 1105
slot = 1
persistent = 1

[state 1105, ctrlset]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1105, end1]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;--------------------------------------------------------------------------------------------------
;Slide
[statedef 1106]
type = C
movetype = I
physics = N
anim = 1106
movehitpersist = 1

[state 11xx, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1106, playerpass]
type = playerpush
trigger1 = p2statetype = S
trigger2 = p2statetype = A
value = 0

[state 11x 2 or 6, poweradd]
type = poweradd
triggerall = time = 0
trigger1 = enemynear,numproj != 0
trigger2 = numhelper(33333333)
trigger2 = PlayerIdExist(helper(33333333),var(3))
value = 125

[state 1106, nothitby]
type = nothitby
trigger1 = animelemtime(3) < 0
value = S,AP
ignorehitpause = 1

[state 1106, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1106, velmul]
type = velmul
trigger1 = time = 0
x = 0.4
y = 0

[state 1106, dust]
type = explod
trigger1 = 1
persistent = 8
anim = 2025
postype = p1
pos = 196,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 1106, turn]
type = turn
trigger1 = animtime = 0
trigger1 = p2dist x < 0


[state 1106, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------------------
;Whiff
[statedef 1107]
type = S
movetype = I
physics = S
anim = 1107

[state 11xx, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1107, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1108, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[state 1107, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = F120
postype = p1
pos = 96,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1107, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Brake
[statedef 1108]
type = S
movetype = I
physics = S
anim = 1108
movehitpersist = 1

[state 101, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 11xx, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1108, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1108, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[state 1101, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = 2025
postype = p1
pos = 96,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 1108, end]
type = changestate
trigger1 = animtime = 0
trigger2 = movehit
trigger2 = time = 3
value = 0
ctrl = 1


;----------------------------------------------------------------------------------------------------
;Cancel
[statedef 1109]
type = C
movetype = I
physics = C
anim = 1109

[state 1109, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------------
;Slide Attack
[statedef 1110]
type = A
movetype = A
physics = N
anim = 1110
juggle = 15
poweradd = 80
ctrl = 0

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1110, grounded]
type = statetypeset
trigger1 = animelem = 3
statetype = C
physics = N

[state 1110, velmul]
type = velmul
trigger1 = animelemtime(3) = 0
x = 0.5

[state 1110, velmul]
type = velmul
triggerall = p2statetype = L
trigger1 = movehit
x = 0.5

[state 1110, grounded]
type = statetypeset
trigger1 = animelem = 4
physics = C
movetype = I

[state 1106, dust]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 6
persistent = 4
anim = 2025
postype = p1
pos = 116,0
vel = floor(vel x * 0.2) ,-8
scale = 1,1
sprpriority = 3


[State 1103, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = C, SA
damage    = ifelse(p2statetype = L, 40,80),8
animtype = Heavy
hitflag = MAFD
guardflag = L
priority = 2
pausetime = 2,4
guard.pausetime = 12,12
id = 1110
nochainid = 1400
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = trip
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 15,-18
air.velocity = 15,-18
air.hittime = 18
;p2facing = 1
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -12
down.hittime = 28
down.velocity = -floor(vel x * 1.25), 0
fall = 1
guard.dist = 720
fall.recover = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1110, playerpass]
type = playerpush
triggerall = !moveguarded
triggerall = p2statetype != L
trigger1 = movehit
value = 0
ignorehitpause = 1


[state 1110, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------------
;Phase Kick
[statedef 1111]
type = S
movetype = A
physics = N
ctrl = 0
anim = 1111
poweradd = 110

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1106, dust]
type = explod
trigger1 = animelemtime(2) >= 0 && animelemtime(4) < 0
persistent = 4
anim = 2025
postype = p1
pos = 82,0
vel = floor(vel x * 0.2) ,-8
scale = 1,1
sprpriority = 3

[state 1111, Phase]
type = playerpush
trigger1 = animelemtime(2) < 0
value = 0
ignorehitpause = 1

[state 1111, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = SCA
ignorehitpause = 1

[state 1111, velmul]
type = velmul
triggerall = animelemtime(2) < 0
trigger1 = p2dist x > 0
x = 2
persistent = 0

[state 1111, velmul]
type = velmul
triggerall = animelemtime(4) < 0
trigger1 = p2dist x < -180
x = 0.05
persistent = 0

[state 1111, velmul]
type = velmul
trigger1 = animelemtime(2) = 0
x = 0.2

[state 1111, physics]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = S
physics = S

[State 1111, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
damage    = ifelse(enemynear,facing != facing, 100, 120),10
animtype = Heavy
hitflag = MAF
guardflag = MA
priority = 2
pausetime = ifelse(enemynear,facing != facing,12, 18),ifelse(enemynear,facing != facing,12, 18)
guard.pausetime = 12,10
id = 1111
nochainid = 1400
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = high
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 24,-6
air.velocity = 24,-4
air.hittime = 18
guard.hittime = 9
guard.slidetime = 9
guard.velocity = 20
airguard.velocity = 18,-6
fall = 1
guard.dist = 720
fall.recover = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1


[state 1111, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------------
;Leap Frog, non knock down
[statedef 1112]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1112
poweradd = 60

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1112, Slow down]
type = velmul
trigger1 = time = 0
trigger1 = anim = 1112
x = 0.5

[state 1112, Jump]
type = velset
trigger1 = time = 0
trigger1 = anim = 1112
y = -21;-floor(enemynear,const(size.height))*0.08

[state 1112, gravity]
type = gravity
trigger1 = time > 0

[State 1112, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
damage    = 60,6
animtype = Heavy
hitflag = MAF
guardflag = HA
priority = 2
pausetime = 1,24
guard.pausetime = 8,6
id = 1112
sparkno = 2
sparkxy = -40,-294
hitsound   = 5,2
guardsound = S120,0
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
ground.velocity = 32
air.velocity = 0,32
air.hittime = 24
guard.hittime = 12
guard.slidetime = 12
guard.velocity = -6
airguard.velocity = -2,12
air.fall = 1
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -32
guard.dist = 720
fall.recover = 0

[state 1112, player pass]
type = playerpush
trigger1 = anim = 1113
value = 0
ignorehitpause = 1

[state 1112, Slow down]
type = velmul
trigger1 = movehit
x = 0.75
persistent = 0

[state 1112, ctrl]
type = null
trigger1 = movehit
trigger1 = time > 8
value = 1

[state 1112, animation change]
type = changeanim
trigger1 = moveguarded
value = 43
persistent = 0

[state 1112, blocked]
type = velmul
trigger1 = moveguarded
x = -0.25
persistent = 0

[state 1112, Jump]
type = veladd
trigger1 = moveguarded
y = -7
persistent = 0

[state 1112, Jump]
type = veladd
trigger1 = movehit
y = ifelse(command = "holdup", -30,ifelse(command = "holddown", -12,-21))
persistent = 0

[state 1112, changeanim]
type = changeanim
trigger1 = movehit
trigger1 = anim != 1113
value = 1113
persistent = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1112, Steering]
type = veladd
trigger1 = anim = 1113
trigger1 = movehit
trigger1 = command = "holdfwd"
x = 0.2
persistent = 1

[state 1112, Steering]
type = veladd
trigger1 = anim = 1113
trigger1 = movehit
trigger1 = command = "holdback"
x = -1.0
persistent = 1

[state 1112, end2]
type = changestate
trigger1 = anim = 1113
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1112, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1113

;------------------------------------------------------------------------------------------------
;Landing
[statedef 1113]
type = S
movetype = I
physics = S
anim = 47
movehitpersist = 1

[state 1113, landing]
type = velset
trigger1 = time = 0
y = 0

[state 1113, Early ctrl]
type = changestate
trigger1 = movehit
trigger1 = time = 2
value = 0
ctrl = 1

[state 1113, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1113, end]
type = changestate
trigger1 = !movehit
trigger1 = time = 6
value = 0
ctrl = 1






;-----------------------------------------------------------------------------------------------------

;Heavy Running Start - Ready
[statedef 1120]
type = C
movetype = A
physics = S
velset = 0,0
anim = 1120
ctrl = 0
poweradd = 30

[state 1120, Voice]
type = playsnd
trigger1 = time = 2
value = 1100,(random%3)
channel = 0

[state 1120, end - Dash]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command != "holdb"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = random < ailevel * 36
value = 1121
persistent = 1


[state 1120, end - Cancel]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = command = "holdb"
trigger2 = roundstate != 2
trigger3 = time > 180
value = 1129
persistent = 1

;----------------------------------------------------------------------------
; Sprint forward
[Statedef 1121]
type    = S
physics = S
movetype = A
anim = 1121
sprpriority = 1
ctrl = 0

[state 1101, Voice]
type = playsnd
trigger1 = time = 0
value = 1101,(random%3)
channel = 0
persistent = 0

[state 1121, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1121, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1000,0
persistent = 0

[state 1121, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 240,-142
scale = const(size.xscale)*5,const(size.yscale)*5
sprpriority = 3
bindtime = 2
persistent = 0
trans = addalpha
alpha = 256,192

[state 1121, meter gain]
type = poweradd
trigger1 = time%2
value = 15
persistent = 1

[state 1121, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.75,const(size.yscale)*1.75
persistent = 0

[State 1121, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*ifelse(command = "holdfwd",1.875, 1.625)
y = 0
persistent = 1

[state 1121, dust]
type = explod
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(1) = 1
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1,const(size.yscale)*1
persistent = 1


[state 1121, Hurdle]
type =changestate
trigger1 = command = "holdup"
trigger1 = !ailevel
value = 1122

[state 1121, Slide Attack]
type =changestate
trigger1 = command = "a"
trigger1 = !ailevel
value = 1130

[state 1121, Hip Check & Elbow]
type =changestate
trigger1 = command = "y"
trigger1 = !ailevel
value = 1123

[state 1121, Phase Kick]
type =changestate
trigger1 = command = "b"
trigger1 = !ailevel
value = 1131

[state 1121, Leap Frog]
type =changestate
trigger1 = command = "x"
trigger1 = !ailevel
value = 1132

[state 1121, Slide Crossup]
type = changestate
trigger1 = command = "holddown"
trigger1 = !ailevel
value = 1126

[State 1121, Brakes]
type = ChangeState
triggerall = time > 6
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = roundstate != 2
trigger3 = time > 60
value = 1128

;--------------------------------------------------------------------------------------------------
;Hurdle
[statedef 1122]
type = A
movetype = I
physics = N
anim = 1122

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1122, pass through]
type = playerpush
trigger1 = p2statetype = C
trigger2 = p2statetype = L
value = 0

[state 1122, veladd]
type = velset
trigger1 = time = 0
y = -27

[state 1122, reversal projectiles]
type = hitoverride
trigger1 = TIME < 16
attr = SCA, AP
time = 1
stateno = 1125
persistent = 1

[state 1122, projectile immunity]
type = nothitby
trigger1 = TIME >= 16
value = ,AP

[state 1122, velmul]
type = velmul
trigger1 = time = 0
x = 0.5


[state 1122, gravity]
type = veladd
trigger1 = time > 1
y = 2.64

[state 1122, land Keep Running]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Hip check
[statedef 1123]
type = A
movetype = A
physics = N
anim = 1103
poweradd = 80

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1123, jump]
type = velset
trigger1 = time = 0
y = -16

[state 1123, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1123, gravity]
type = gravity
trigger1 = time > 1

[State 1123, 2]
type = HitDef
triggerall = anim = 1103
trigger1 = animelem = 2
persistent = 0
attr = S, SA
damage    = 50,10
animtype = Heavy
guardflag = MA
priority = 2
pausetime = 6,8
sparkno = 3
sparkxy = -40,-152
hitsound   = 5,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -6
air.velocity = -2,-2
air.hittime = 18
guard.hittime = 22
guard.slidetime = 22
guard.velocity = -8
forcestand = 1
fall = 0
air.fall = 1
guard.dist = 720

[State 1123, 2]
type = HitDef
triggerall = anim = 1104
trigger1 = animelem = 2
trigger1 = !moveguarded
persistent = 2
attr = S, SA
damage    = 50,10
animtype = Heavy
guardflag = MA
priority = 3
pausetime = 12,12
id = 1123
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = ifelse(var(6) > 1, -18,-36),ifelse(var(6) > 1, 0, -2)
air.velocity = ifelse(var(6) > 1, -2,-27),ifelse(var(6) > 1, -18, -2)
air.hittime = 18
envshake.ampl = 10
envshake.time = 12
guard.hittime = 16
guard.slidetime = 16
guard.velocity = -8
fall = ifelse(var(6) > 1, 0, 1)
air.fall = 1
guard.dist = 720
fall.recover = 0
fall.recovertime = 30

[state 1123, change animation]
type = changeanim
trigger1 = movecontact
value = 1104
persistent = 0

[state 1123, count]
type = varadd
triggerall = anim = 1104
trigger1 = animelemtime(2) > 0
trigger1 = movehit
v = 6
value = -1
ignorehitpause
persistent = 0

[state 1123, velmul]
type = velmul
trigger1 = movehit
x = 0.02
ignorehitpause = 1
persistent = 0

[state 1123, velmul]
type = velmul
trigger1 = moveguarded
x = -0.25
ignorehitpause = 1
persistent = 0

[state 1123, velmul]
type = veladd
trigger1 = moveguarded
y = -20
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = numtarget(1124)
v = 18
value = -18
persistent = 0
ignorehitpause = 1

[state 1123, landing]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1127

[state 1123, landing]
type = changestate
triggerall = moveguarded
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1124

[state 1123, landing]
type = changestate
triggerall = movehit
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52
;-------------------------------------------------------------
;Landing Lag
[statedef 1124]
type = S
movetype = I
physics = S
anim = 47
ctrl = 0

[state 1124, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1124, velset]
type = velset
trigger1 = time = 0
y = 0


[state 1124, end]
type = changestate
trigger1 = time = 12
value = 0
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Projectile Bounce
[statedef 1125]
type = A
movetype = I
physics = A
anim = 1125
poweradd = 250


[state 1125, pause]
type = pause
trigger1 = time = 0
time = 8
movetime = 8

[state 1125, nothitby]
type = nothitby
trigger1 = 1
value = ,AP
time = 32

[state 1125, playsnd]
type = playsnd
trigger1 = time = 0
value = S805,0
ignorehitpause = 1

[state 1125, velset]
type = velset
trigger1 = time = 0
x = floor(p2bodydist x * 0.0333)
y = -24
persistent = 0

[state 1125, steering]
type = veladd
trigger1 = time > 0
trigger1 = command = "holdfwd"
x = 0.4

[state 1125, steering]
type = veladd
trigger1 = time > 0
trigger1 = command = "holdback"
x = -0.4


[state 1125, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 1125
slot = 1
persistent = 1


[state 1125, ctrlset]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1125, end1]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Slide
[statedef 1126]
type = C
movetype = I
physics = N
anim = 1126
movehitpersist = 1

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1126, playerpass]
type = playerpush
trigger1 = p2statetype = S
trigger2 = p2statetype = A
value = 0

[state 1126, nothitby]
type = nothitby
trigger1 = animelemtime(3) < 0
value = S,AP
ignorehitpause = 1

[state 1126, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1126, velmul]
type = velmul
trigger1 = time = 0
x = 0.4
y = 0

[state 1106, dust]
type = explod
trigger1 = 1
persistent = 8
anim = 2025
postype = p1
pos = 196,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 11x 2 or 6, poweradd]
type = poweradd
triggerall = time = 0
trigger1 = enemynear,numproj != 0
trigger2 = numhelper(33333333)
trigger2 = PlayerIdExist(helper(33333333),var(3)) ;enemy projectile exists
value = 125

[state 1126, turn]
type = turn
trigger1 = animtime = 0
trigger1 = p2dist x < 0

[state 1126, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Whiff
[statedef 1127]
type = S
movetype = I
physics = S
anim = 1127
movehitpersist = 1

[state 1127, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1127, velmul]
type = velmul
trigger1 = time = 0
x = 0.35
y = 0

[state 1127, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = F120
postype = p1
pos = 96,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1127, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Brake
[statedef 1128]
type = S
movetype = I
physics = S
anim = 1128
movehitpersist = 1

[state 101, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1128, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1128, velmul]
type = velmul
trigger1 = time = 0
x = 0.35
y = 0

[state 1128, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = 2025
postype = p1
pos = 96,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 1128, end]
type = changestate
trigger1 = animtime = 0
trigger2 = movehit
trigger2 = time = 3
value = 0
ctrl = 1


;----------------------------------------------------------------------------------------------------
;Cancel
[statedef 1129]
type = C
movetype = I
physics = C
anim = 1129

[state 1129, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------------
;Slide Attack
[statedef 1130]
type = A
movetype = A
physics = N
anim = 1130
juggle = 15
poweradd = 100
ctrl = 0

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1130, grounded]
type = statetypeset
trigger1 = animelem = 3
statetype = C
physics = N

[state 1130, velmul]
type = velmul
trigger1 = animelemtime(3) = 0
x = 0.50

[state 1130, dust]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 6
persistent = 4
anim = 2025
postype = p1
pos = 116,0
vel = floor(vel x * 0.2) ,-8
scale = 1,1
sprpriority = 3

[state 1130, velmul]
type = velmul
triggerall = p2statetype = L
trigger1 = movehit
x = 0.5

[state 1130, grounded]
type = statetypeset
trigger1 = animelem = 4
physics = C
movetype = I


[State 1130, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = C, SA
damage    = ifelse(p2statetype = L, 50,100),10
animtype = Heavy
hitflag = MAFD
guardflag = L
priority = 3
pausetime = 2,4
guard.pausetime = 12,12
id = 1130
nochainid = 1400
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = trip
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 15,-18
air.velocity = 15,-18
air.hittime = 18
;p2facing = 1
guard.hittime = 14
guard.slidetime = 14
guard.velocity = -12
down.velocity = -floor(vel x * 1.5), 0
fall = 1
guard.dist = 720
fall.recover = 0

[state 1130, playerpass]
type = playerpush
triggerall = !moveguarded
triggerall = p2statetype != L
trigger1 = movehit
value = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1


[state 1130, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------------
;Phase Kick
[statedef 1131]
type = S
movetype = A
physics = N
ctrl = 0
anim = 1131
poweradd = 130

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1106, dust]
type = explod
trigger1 = animelemtime(2) >= 0 && animelemtime(4) < 0
persistent = 4
anim = 2025
postype = p1
pos = 82,0
vel = floor(vel x * 0.2) ,-8
scale = 1,1
sprpriority = 3

[state 1111, Phase]
type = playerpush
trigger1 = animelemtime(2) < 0
value = 0
ignorehitpause = 1

[state 1111, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = SCA
ignorehitpause = 1

[state 1111, velmul]
type = velmul
triggerall = animelemtime(2) < 0
trigger1 = p2dist x > 0
x = 2
persistent = 0

[state 1111, velmul]
type = velmul
triggerall = animelemtime(4) < 0
trigger1 = p2dist x < -180
x = 0.05
persistent = 0

[state 1111, velmul]
type = velmul
trigger1 = animelemtime(2) = 0
x = 0.2

[state 1111, physics]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = S
physics = S

[State 1111, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
damage    = ifelse(facing != enemy,facing, 120, 150),12
animtype = Heavy
hitflag = MAF
guardflag = MA
priority = 2
pausetime = 12,12
guard.pausetime = 12,7
id = 1131
nochainid = 1400
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = high
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 36,-6
air.velocity = 36,-4
air.hittime = 18
guard.hittime = 7
guard.slidetime = 7
guard.velocity = 36
airguard.velocity = 24,-6
fall = 1
guard.dist = 720
fall.recover = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1


[state 1111, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;-----------------------------------------------------------------------------------------------------
;Leap Frog, non knock down
[statedef 1132]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1132
poweradd = 80

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1132, Slow down]
type = velmul
trigger1 = time = 0
trigger1 = anim = 1132
x = 0.5

[state 1132, Jump]
type = velset
trigger1 = time = 0
trigger1 = anim = 1132
y = -21;-floor(enemynear,const(size.height))*0.08

[state 1132, gravity]
type = gravity
trigger1 = time > 0

[State 1132, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
damage    = 80,80
animtype = Heavy
hitflag = MAF
guardflag = HA
priority = 2
pausetime = 1,26
guard.pausetime = 8,6
id = 1112
sparkno = 2
sparkxy = -40,-294
hitsound   = 5,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = 32
air.velocity = 0,32
air.hittime = 20
guard.hittime = 10
guard.slidetime = 10
guard.velocity = -6
airguard.velocity = -2,12
air.fall = 1
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -32
guard.dist = 720
fall.recover = 0

[state 1132, player pass]
type = playerpush
trigger1 = anim = 1113
value = 0
ignorehitpause = 1

[state 1132, Slow down]
type = velmul
trigger1 = movehit
x = 0.75
persistent = 0

[state 1112, ctrl]
type = null
trigger1 = movehit
trigger1 = time > 12
value = 1


[state 1132, animation change]
type = changeanim
trigger1 = moveguarded
value = 43
persistent = 0


[state 1132, blocked]
type = velmul
trigger1 = moveguarded
x = -0.2
persistent = 0

[state 1132, Jump]
type = veladd
trigger1 = moveguarded
y = -9
persistent = 0

[state 1132, Jump]
type = veladd
trigger1 = movehit
y = ifelse(command = "holdup", -30,ifelse(command = "holddown", -12,-21))
persistent = 0

[state 1132, changeanim]
type = changeanim
trigger1 = movehit
trigger1 = anim != 1113
value = 1113
persistent = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 1112, Steering]
type = veladd
trigger1 = anim = 1113
trigger1 = movehit
trigger1 = command = "holdfwd"
x = 0.2
persistent = 1

[state 1132, Steering]
type = veladd
trigger1 = anim = 1113
trigger1 = movehit
trigger1 = command = "holdback"
x = -1.0
persistent = 1

[state 1132, end2]
type = changestate
trigger1 = anim = 1113
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1132, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1133

;------------------------------------------------------------------------------------------------
;Landing
[statedef 1133]
type = C
movetype = I
physics = C
anim = 47
movehitpersist = 1

[state 1133, landing]
type = velset
trigger1 = time = 0
y = 0

[state 1133, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1133, end]
type = changestate
trigger1 = movehit
trigger1 = time = 2
value = 0
ctrl = 1

[state 1133, end]
type = changestate
trigger1 = !movehit
trigger1 = time = 8
value = 0
ctrl = 1




;----------------------------------------------------------------------------------------------
;Running start - Ready : EX  Emergency Exit
[statedef 1140]
type = C
movetype = A
physics = S
velset = 0,0
anim = 1140
ctrl = 0
poweradd = -500

[state 1140, Voice]
type = playsnd
trigger1 = time = 2
value = 1100,(random%3)
channel = 0

[state 1140, end - Dash]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command != "holdc"
trigger1 = !ailevel
trigger2 = ailevel 
trigger2 = random < ailevel * 36
value = 1141
persistent = 1


[state 1140, end - Cancel]
type = changestate
triggerall = animelemtime(3) >= 0
trigger1 = command = "holdback"
trigger1 = command = "holdc"
trigger2 = roundstate != 2
trigger3 = time > 180
value = 1149
persistent = 1

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

;----------------------------------------------------------------------------
; Sprint forward
[Statedef 1141]
type    = S
physics = S
movetype = A
anim = 1141
sprpriority = 1
ctrl = 0

[state 1101, Voice]
type = playsnd
trigger1 = time = 0
value = 1101,(random%3)
channel = 0
persistent = 0

[state 1141, pos y]
type = posset
trigger1 = time = 0
y = 0

[state 1141, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1000,0
persistent = 0

[state 1141, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 240,-142
scale = const(size.xscale)*5,const(size.yscale)*5
sprpriority = 3
bindtime = 2
persistent = 0
trans = addalpha
alpha = 256,192

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1141, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*2,const(size.yscale)*2
persistent = 0


[State 1141, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*ifelse(command = "holdfwd", 2.125, 1.875)
y = 0
persistent = 1

[state 1141, dust]
type = explod
trigger1 = animelemtime(3) = 0
trigger2 = animelemtime(1) = 1
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1,const(size.yscale)*1
persistent = 1


[state 1141, Hurdle]
type =changestate
trigger1 = command = "holdup"
trigger1 = !ailevel
value = 1142

[state 1141, Slide Attack]
type =changestate
trigger1 = command = "a"
trigger1 = !ailevel
value = 1150

[state 1141, Hip Check Attack]
type =changestate
trigger1 = command = "y"
trigger1 = !ailevel
value = 1143

[state 1141, Phase Kick]
type =changestate
trigger1 = command = "b"
trigger1 = !ailevel
value = 1151

[state 1141, Leap Frog]
type =changestate
trigger1 = command = "x"
trigger1 = !ailevel
value = 1152

[state 1141, Slide Passthrough]
type = changestate
trigger1 = command = "holddown"
trigger1 = !ailevel
value = 1146

[State 1141, Brake]
type = ChangeState
triggerall = time > 6
trigger1 = command = "holdback"
trigger1 = !ailevel
trigger2 = roundstate != 2
trigger3 = time > 60
value = 1148

;--------------------------------------------------------------------------------------------------
;Hurdle
[statedef 1142]
type = A
movetype = I
physics = N
anim = 1142

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1142, reversal projectiles]
type = hitoverride
trigger1 = 1
attr = SCA, AP
time = 1
stateno = 1145
persistent = 1
ignorehitpause = 1

;[state 1142, projectile immunity]
;type = nothitby
;trigger1 = TIME >= 16
;value = ,AP

[state 1142, pass through]
type = playerpush
trigger1 = p2statetype = C
trigger2 = p2statetype = L
value = 0

[state 1142, veladd]
type = velset
trigger1 = time = 0
y = -27

[state 1142, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[state 1142, gravity]
type = veladd
trigger1 = time > 1
y = 2.64

[state 1142, land Keep Running]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52


;--------------------------------------------------------------------------------------------------
;Hip check
[statedef 1143]
type = A
movetype = A
physics = N
anim = 1143
facep2 = 1

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1143, jump]
type = velset
trigger1 = time = 0
y = -14

[state 1143, velmul]
type = velmul
trigger1 = time = 0
x = 0.5

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1143, gravity]
type = gravity
trigger1 = time > 1

[State 1143, 2]
type = HitDef
triggerall = anim = 1143
trigger1 = animelem = 2
persistent = 0
attr = S, SA
damage    = 60,12
animtype = Heavy
guardflag = MA
priority = 2
pausetime = 6,8
sparkno = 3
sparkxy = -40,-152
hitsound   = 5,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -6
air.velocity = -2,-2
air.hittime = 18
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -8
forcestand = 1
fall = 0
air.fall = 1
guard.dist = 720

[State 1143, 2]
type = HitDef
triggerall = anim = 1104
trigger1 = animelem = 2
trigger1 = !moveguarded
persistent = 2
attr = S, SA
damage    = 60,12
animtype = Back
guardflag = MA
priority = 2
pausetime = 14,14
id = 1143
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = ifelse(var(6) > 1, -24, -50),ifelse(var(6) > 1, 0, -2)
air.velocity = ifelse(var(6) > 1, -2,-18),ifelse(var(6) > 1, -18, -2)
air.hittime = 24
envshake.ampl = 12
envshake.time = 14
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -8
fall = ifelse(var(6) > 1, 0, 1)
air.fall = 1
fall.recover = 0
guard.dist = 720
envshake.ampl = -4
envshake.time = 14

[state 1143, count]
type = varadd
triggerall = anim = 1104
trigger1 = animelemtime(2) > 0
trigger1 = movehit
v = 6
value = -1
ignorehitpause
persistent = 0


[state 1143, change animation]
type = changeanim
trigger1 = movecontact
value = 1104
persistent = 0

[state 1143, count]
type = varadd
triggerall = anim = 1104
trigger1 = animelemtime(2) > 0
trigger1 = movehit
v = 6
value = -1
ignorehitpause
persistent = 0

[state 1143, velmul]
type = velmul
trigger1 = movehit
x = 0.02
ignorehitpause = 1
persistent = 0

[state 1143, velmul]
type = velmul
trigger1 = moveguarded
x = -0.32
ignorehitpause = 1
persistent = 0

[state 1143, velmul]
type = veladd
trigger1 = moveguarded
y = -15
ignorehitpause = 1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = numtarget(1144)
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1143, landing]
type = changestate
triggerall = !movecontact
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1147

[state 1143, landing]
type = changestate
triggerall = moveguarded
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1144

[state 1143, landing]
type = changestate
triggerall = movehit
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;-------------------------------------------------------------
;Landing Lag
[statedef 1144]
type = S
movetype = I
physics = S
anim = 47
ctrl = 0

[state 1144, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1144, velset]
type = velset
trigger1 = time = 0
y = 0


[state 1144, end]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------------------
;Projectile Bounce
[statedef 1145]
type = A
movetype = I
physics = A
anim = 1145
poweradd = 100

[state 1145, pause]
type = pause
trigger1 = time = 0
time = 8
movetime = 8

[state 1145, nothitby]
type = nothitby
trigger1 = 1
value = ,AP
time = 40

[state 1145, playsnd]
type = playsnd
trigger1 = time = 0
value = S805,0
ignorehitpause = 1

[state 1145, velset]
type = velset
trigger1 = time = 0
x = floor(p2bodydist x * 0.0333) 
y = -24
persistent = 0

[state 1145, hitoverride]
type = hitoverride
trigger1 = 1
attr = SCA, AP
stateno = 1145
slot = 1
persistent = 1

[state 1105, steering]
type = veladd
trigger1 = time > 0
trigger1 = command = "holdfwd"
x = 0.4

[state 1105, steering]
type = veladd
trigger1 = time > 0
trigger1 = command = "holdback"
x = -0.4

[state 1145, end2]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1145, end1]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

;--------------------------------------------------------------------------------------------------
;Slide
[statedef 1146]
type = C
movetype = I
physics = N
anim = 1146
movehitpersist = 1

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1146, playerpass]
type = playerpush
trigger1 = p2statetype = S
trigger2 = p2statetype = A
value = 0

[state 1146, nothitby]
type = nothitby
trigger1 = 1
value = SA,AP
ignorehitpause = 1

[state 1146, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1146, velmul]
type = velmul
trigger1 = time = 0
x = 0.4
y = 0

[state 1106, dust]
type = explod
trigger1 = 1
persistent = 8
anim = 2025
postype = p1
pos = 196,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 1146, turn]
type = turn
trigger1 = animtime = 0
trigger1 = p2dist x < 0




[state 1146, end]
type = changestate
trigger1 = animtime = 0
value = 11
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Whiff
[statedef 1147]
type = S
movetype = I
physics = S
anim = 1147

[state 1147, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1147, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[state 1147, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = F120
postype = p1
pos = 96,0
vel = 2,-4
scale = 2,2
sprpriority = 3

[state 1147, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;--------------------------------------------------------------------------------------------------
;Brake
[statedef 1148]
type = S
movetype = I
physics = S
anim = 1148

[state 101, playsnd]
type = playsnd
trigger1 = time = 0
value = 101,0

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1148, poweradd]
type = poweradd
trigger1 = time = 0
value = 400
ignorehitpause = 1
persistent = 0

[state 1148, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1148, velmul]
type = velmul
trigger1 = time = 0
x = 0.5
y = 0

[State X, Blink Yellow]
type = PalFX
trigger1 = time%2
time = 1
add = 150,75,0 ;32,16,0
sinadd = 64,32,5,3
ignorehitpause

[state 1148, dust]
type = explod
trigger1 = animelemtime(2) > 0
persistent = 2
anim = 2025
postype = p1
pos = 96,0
vel = 2,-4
scale = 1,1
sprpriority = 3

[state 1148, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------------
;Cancel
[statedef 1149]
type = C
movetype = I
physics = C
anim = 1149

[state 1149, refund]
type = poweradd
trigger1 = time = 0
value = 500

[state 1149, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------------
;Slide Attack
[statedef 1150]
type = A
movetype = A
physics = N
anim = 1150
juggle = 7
ctrl = 0

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1150, grounded]
type = statetypeset
trigger1 = animelem = 3
statetype = C
physics = N

[state 1150, velmul]
type = velmul
trigger1 = animelemtime(3) = 0
x = 0.50

[state 1150, velmul]
type = velmul
triggerall = p2statetype = L
trigger1 = movehit
x = 0.5

[state 1150, grounded]
type = statetypeset
trigger1 = animelem = 4
physics = C
movetype = I

[state 1150, dust]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(4) < 6
persistent = 4
anim = 2025
postype = p1
pos = 116,0
vel = floor(vel x * 0.2) ,-8
scale = 1,1
sprpriority = 3

[State 1150, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = C, SA
damage    = ifelse(p2statetype = L, 60,100),10
animtype = Heavy
getpower = 0
hitflag = MAFD
guardflag = L
priority = 3
pausetime = 2,4
guard.pausetime = 12,12
getpower = 0
id = 1150
nochainid = 1400
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = trip
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -15,-33
air.velocity = -15,-33
air.hittime = 18
;p2facing = 1
guard.hittime = 14
guard.slidetime = 14
guard.velocity = -12
down.velocity = ifelse(var(8) > 1, 0,-floor(vel x * 1.4)),ifelse(var(8) > 1, -36, 0)
fall = 1
guard.dist = 720
fall.recover = 0
yaccel = 1.76


[state 1150, ground bounce limiter]
type = varadd
triggerall = p2statetype = L
trigger1 = movehit
var(8) = -1
ignorehitpause = 1
persistent = 0

[state 1150, playerpass]
type = playerpush
triggerall = !moveguarded
triggerall = p2statetype != L
trigger1 = movehit
value = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1


[state 1150, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------------
;Phase Kick
[statedef 1151]
type = S
movetype = A
physics = N
ctrl = 0
anim = 1151

[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1101, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = -12,-6
scale = 2,2

[state 1151, dust]
type = explod
trigger1 = animelemtime(2) >= 0 && animelemtime(4) < 0
persistent = 4
anim = 2025
postype = p1
pos = 82,0
vel = floor(vel x * 0.2) ,-8
scale = 1,1
sprpriority = 3

[state 1151, Phase]
type = playerpush
trigger1 = animelemtime(2) < 0
value = 0
ignorehitpause = 1

[state 1151, nothitby]
type = nothitby
trigger1 = animelemtime(2) < 0
value = SCA
ignorehitpause = 1

[state 1151, velmul]
type = velmul
triggerall = animelemtime(2) < 0
trigger1 = p2dist x > 0
x = 2
persistent = 0

[state 1151, velmul]
type = velmul
triggerall = animelemtime(4) < 0
trigger1 = p2dist x < -180
x = 0.05
persistent = 0

[state 1151, velmul]
type = velmul
trigger1 = animelemtime(2) = 0
x = 0.2

[state 1151, physics]
type = statetypeset
trigger1 = animelemtime(3) = 0
statetype = S
physics = S

[State 1151, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
damage    = 120,12
animtype = Heavy
hitflag = MAF
guardflag = MA
priority = 2
getpower = 0
pausetime = 18,18
guard.pausetime = 12,11
id = 1151
nochainid = 1400
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = high
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = 60,-21
air.velocity = 60,-21
air.hittime = 18
guard.hittime = 14
guard.slidetime = 14
guard.velocity = 40
airguard.hittime = 18
airguard.velocity = 18,-9
envshake.ampl = 12
envshake.time = 18
fall = ifelse(var(7) > 1, 0,1)
guard.dist = 720
fall.recover = 0
yaccel = 1.76

[state 1151, wall bounce]
type = targetstate
trigger1 = movehit
trigger1 = hitpausetime = 16
trigger1 = var(7) > 1
value = 670
ignorehitpause = 1

[state 1151, wall bounce limiter]
type = varadd
trigger1 = movehit
var(7) = -1
persistent = 0

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1


[state 1111, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------------
;Leap Frog, non knock down
[statedef 1152]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1152


[state 110x, remove explod]
type = removeexplod
trigger1 = time = 0
id = 2010

[state 1152, Slow down]
type = velmul
trigger1 = time = 0
trigger1 = anim = 1152
x = 0.5

[state 1152, Jump]
type = velset
trigger1 = time = 0
trigger1 = anim = 1152
y = -21;-floor(enemynear,const(size.height))*0.08

[state 1152, gravity]
type = gravity
trigger1 = time > 0

[State 1152, 2]
type = HitDef
trigger1 = !movecontact
persistent = 0
attr = S, SA
damage    = 24,6
animtype = Heavy
hitflag = MAF
getpower = 0 
guardflag = HA
priority = 2
pausetime = 1,18
guard.pausetime = 12,12
id = 1112
sparkno = 3
sparkxy = -40,-294
hitsound   = 5,4
guardsound = 6,0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = ifelse(var(6) > 1, 32, 64)
air.velocity = 0,32
air.hittime = 24
guard.hittime = 18
guard.slidetime = 18
guard.velocity = -6
airguard.velocity = -2,12
fall = ifelse(var(6) > 1, 0, 1)
air.fall = 1
down.bounce = 1
fall.xvelocity = 0
fall.yvelocity = -32
guard.dist = 720
fall.recover = 0

[state 1104, count]
type = varadd
trigger1 = movehit
v = 6
value = -1
ignorehitpause
persistent = 0

[state 1152, player pass]
type = playerpush
trigger1 = anim = 1113
value = 0
ignorehitpause = 1

[state 1152, Slow down]
type = velmul
trigger1 = movehit
x = -0.2
persistent = 0

[state 1152, ctrlset]
type = ctrlset
trigger1 = movehit
trigger1 = time > 4
value = 1


[state 1112, animation change]
type = changeanim
trigger1 = moveguarded
value = 43
persistent = 0

[state 1152, blocked]
type = velmul
trigger1 = moveguarded
x = -0.5
persistent = 0

[state 1152, blocked bounce]
type = veladd
trigger1 = moveguarded
y = -4
persistent = 0

[state 1152, Jump]
type = veladd
trigger1 = movehit
y = -24
persistent = 0

[state 1152, changeanim]
type = changeanim
trigger1 = movehit
trigger1 = anim != 1113
value = 1113
persistent = 0
ignorehitpause = 1

[state x, combo damage score]
type = varadd
trigger1 = movehit
v = 18
value = -9
persistent = 0
ignorehitpause = 1

[state 1152, end2]
type = changestate
trigger1 = anim = 1113
trigger1 = animtime = 0
value = 638

[state 1152, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1153

;------------------------------------------------------------------------------------------------
;Landing
[statedef 1153]
type = C
movetype = I
physics = C
anim = 47
movehitpersist = 1

[state 1133, landing]
type = velset
trigger1 = time = 0
y = 0

[state 1133, on ground]
type = posset
trigger1 = time = 0
y = 0

[state 1133, end]
type = changestate
trigger1 = movehit
trigger1 = time = 2
value = 0
ctrl = 1

[state 1133, end]
type = changestate
trigger1 = !movehit
trigger1 = time = 6
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------------
;                                       Projectile Dodge
;=====================================================================================================

[statedef 1200]
type = A
movetype = A
physics = N
anim = 1200
ctrl = 0
poweradd = 20

[State 700, AfterImage]
type = AfterImage
trigger1 = animelem = 3
time = 15
length = 8
;palcolor = 256
;palinvertall = 0
;palbright = 30,30,30
;palcontrast = 120,120,220
;palpostbright = 0,0,0
paladd = 10,10,25
;palmul = .65,.65,.75
timegap = 2
framegap = 2
;trans = "add" ;"none","add1","sub"
;ignorehitpause = 
persistent =0

[state 1200, voice]
type = playsnd
trigger1 = time = 2
trigger1 = (random%10) > 7
value = 1205,(random%2)
channel = 0
persistent = 0

[state 1200, jump]
type = velset
trigger1 = animelemtime(2) = 0
x = 12
y = -18

[state 1200, reversal projectiles]
type = reversalDef
trigger1 = animelemtime(3) < 0
reversal.attr = SCA, AP
pausetime = 0,0
p1stateno = 1201
ignorehitpause = 1
persistent = 0

[state 1200, sprpriority]
type = sprpriority
trigger1 = animelemtime(3) = 0
value = 3

[state 1200, poweradd]
type = poweradd
trigger1 = enemynear,numproj != 0
trigger2 = numhelper(33333333)
trigger2 = PlayerIdExist(helper(33333333),var(3)) ;enemy projectile exists
value = 250
ignorehitpause = 0
persistent = 0



[state 1200, nothitby]
type = nothitby
trigger1 = animelemtime(3) >= 0
value = ,AP
ignorehitpause = 1

[state 1200, gravity]
type = gravity
trigger1 = pos y < -1

[state 1200, end]
type = changestate
triggerall = var(13) < 5
triggerall = vel y > 0
triggerall = pos y > -vel y 
trigger1 = !ailevel
trigger1 = command = "holddodge"
trigger2 = ailevel
trigger2 = p2dist x < 0
value = 1220

[state 1220, end]
type = changestate
triggerall = vel y > 0
triggerall = pos y > -vel y 
trigger1 = var(13) >= 5
trigger2 = command != "holddodge"
trigger2 = !ailevel 
trigger3 = ailevel
value = 52

;------------------------------------------------------------------------------------------------------
;Dash through reward
[statedef 1201]
type = S
movetype = I
physics = N
anim = 1201
velset = 0,0
poweradd = 250

[State 1201, Helper]
type = Helper
trigger1 = time = 0
trigger1 = !numhelper(1200)
helpertype = normal 
name = "No Background"
ID = 1200
stateno = 1230
pos = 0,0
postype = p1   

[state 1000, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = F40
postype = p1
pos = 228,-178
scale = -2.5,2.5
sprpriority = 3
bindtime = 0
persistent = 0

[state 1000, Intitial Dust]
type = explod
trigger1 = animelemtime(4) = 0
anim = F120
postype = p1
pos = 0,0
vel = -12,-6
scale = 4,4
persistent = 0

[state 1201, sound]
type = playsnd
trigger1 = time = 0
value = 805,0
ignorehitpause = 1
persistent = 0

[state 1201, posset]
type = posset
trigger1 = time = 0
y = 0

[State 1201, SuperPause]
type = Pause
trigger1 = time = 0
time = 12
movetime = 12
ignorehitpause = 1

[state 1201, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1

[state 1201, ZOOM]
type = velset
trigger1 = animelemtime(4) = 0
x = const(velocity.run.fwd.x) * 2.5

[state 1201, playerpush]
type = playerpush
trigger1 = 1 
value = 0
ignorehitpause = 1

[state 1201, end]
type = changestate
trigger1 = p2dist x < -2
value = 1202

[state 1201, 2nd end]
type = changestate
trigger1 = time = 12
value = 1203

;-----------------------------------------------------------------------------------------------------
;stop
[statedef 1202]
type = S
movetype = I
physics = N
anim = 1202
facep2 = 1

[state 1202, Voice]
type = playsnd
trigger1 = time = 2
value = 1200,(random%4)
channel = 0
persistent = 0

[state 1000, Intitial Dust]
type = explod
trigger1 = 1
anim = F120
postype = p1
pos = -222,0
vel = -16,-4
scale = 2,2
persistent = 4



[State 1201, SuperPause]
type = Pause
trigger1 = time = 0
time = 18
movetime = 18

[state 1202, nothitby]
type = nothitby
trigger1 = 1
value = SCA
IGNOREhitpause = 1



[state 1202, velmul]
type = velmul
trigger1 = time = 0
x = 0.125


[state 1202, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;-----------------------------------------------------------------------------------------------
;stop
[statedef 1203]
type = S
movetype = I
physics = N
anim = 1203

[state 1202, Voice]
type = playsnd
trigger1 = time = 2
value = 1200,(random%4)
channel = 0
persistent = 0

[state 1000, Intitial Dust]
type = explod
trigger1 = 1
anim = F120
postype = p1
pos = 224,0
vel = 16,-4
scale = 2,2
persistent = 2


[state 1203, posset]
type = posset
trigger1 = time = 0
x = p2dist x + 100
ignorehitpause = 1

[State 1203, SuperPause]
type = Pause
trigger1 = time = 0
time = 18
movetime = 18

[state 1203, nothitby]
type = nothitby
trigger1 = 1
value = SCA
IGNOREhitpause = 1



[state 1203, velmul]
type = velmul
trigger1 = time = 0
x = 0.125

[state 1203, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;----------------------------------------------------
; Air Dodge
[statedef 1210]
type = A
movetype = I
physics = N
anim = 1210
sprpriority = 4
ctrl = 0

[state 1210, limiter]
type = varadd
trigger1 = time = 0
var(12) = -1
ignorehitpause = 1

[State 700, AfterImage]
type = AfterImage
trigger1 = 1
time = 15
length = 8
paladd = 10,10,25
timegap = 2
framegap = 2
persistent =0

[state 1210, playpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

;Velsets
;Vertical
[state 1210, velset]
type = velset
triggerall = time = 1
trigger1 = command = "holdup"
y = -15

[state 1210, velset]
type = velset
triggerall = time = 1
trigger1 = command = "holddown"
y = 15

;horizontal
[state 1210, veladd]
type = velset
triggerall = time = 1
trigger1 = command = "holdfwd"
x = 15

[state 1210, veladd]
type = velset
triggerall = time = 1
trigger1 = command = "holdback"
x = -15

[state 1210, gravity]
type = gravity
trigger1 = time > 5

[state 1210, nothitby]
type = nothitby
trigger1 = animtime < -4
value = SCA
ignorehitpause = 1


[state 1210, end]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

[state 1210, changestate]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 1211

;-----------------------------------------------------
;Landing Lag
[statedef 1211]
type = C
movetype = I
physics = C
anim = 47

[state 1211, landing]
type = posset
trigger1 = time = 0
y = 0

[state 1211, wavedash]
type = velmul
trigger1 = time = 0
x = 2.5

[state 1211, stop]
type = velset
trigger1 = time = 0
y = 0

[state 1211, end]
type = changestate
trigger1 = time >= 8
value = 0
ctrl = 1

;-----------------------------------------------------------------------------
;Additional Dodges
[statedef 1220]
type = A
movetype = I
physics = N
anim = 1220
ctrl = 0
velset = 0,0
Facep2 = 1

[state 1220, varadd]
type = varadd
trigger1 = time = 0
var(13) = 1
ignorehitpause = 1
persistent = 0

[state 1220, stateypeset]
type = statetypeset
trigger1 = gethitvar(damage) != 0
statetype = A
ignorehitpause = 1



[state 1220, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1220, snd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1220,0

[state 1220, whoop]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger1 = random%10 > 6
value = S1220,2+(random%2)
channel = 0

[state 1220, nothitby]
type = nothitby
trigger1 = var(13) <= 1
value = ,AP,AA
ignorehitpause = 1

[state 1220, nothitby]
type = nothitby
trigger1 = var(13) > 2
value = ,AP
ignorehitpause = 1

[state 1220, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 1220, velset]
type = velset
trigger1 = time = 2
x = 30
y = -18

[state 1220, gravity]
type = gravity
trigger1 = time > 2

[state 1220, end]
type = changestate
trigger1 = command = "holddodge"
trigger1 = !ailevel
triggerall = var(13) < 5
triggerall = vel y > 0
triggerall = pos y > -vel y 
trigger2 = ailevel
trigger2 = p2dist x < 0
value = 1221

[state 1220, end]
type = changestate
trigger2 = command != "holddodge"
trigger1 = var(13) >= 5
triggerall = vel y > 0
triggerall = pos y > -vel y 
value = 52

;-----------------------------------------------------------------------------
;Additional Dodges
[statedef 1221]
type = S
movetype = I
physics = N
anim = 1220
ctrl = 0
facep2 = 1
velset = 0,0

[state 1221, posset]
type = posset
trigger1 = time = 0
y = 0

[state 1221, snd]
type = playsnd
trigger1 = animelemtime(2) = 0
value = 1220,1

[state 1220, whoop]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger1 = random%10 > 6
value = S1220,2+(random%2)
channel = 0

[state 1221, varadd]
type = varadd
trigger1 = time = 0
var(13) = 1
ignorehitpause = 1
persistent = 0

[state 1220, stateypeset]
type = statetypeset
trigger1 = gethitvar(damage) != 0
statetype = A
ignorehitpause = 1



[state 1221, nothitby]
type = nothitby
trigger1 = 1
value = ,AP
ignorehitpause = 1

[state 1221, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 1221, statetypeset]
type = statetypeset
trigger1 = time = 2
statetype = A

[state 1221, velset]
type = velset
trigger1 = time = 2
x = 24
y = -16

[state 1221, gravity]
type = gravity
trigger1 = time > 2

[state 1220, end]
type = changestate
trigger1 = command = "holddodge"
trigger1 = !ailevel
triggerall = var(13) < 5
triggerall = vel y > 0
triggerall = pos y > -vel y 
trigger2 = ailevel
trigger2 = p2dist x < 0
value = 1220

[state 1220, end]
type = changestate
trigger2 = command != "holddodge"
trigger1 = var(13) >= 5
triggerall = vel y > 0
triggerall = pos y > -vel y 
value = 52




;-----------------------------------------------------
;BG helper
[statedef 1230]
type = S
movetype = I
anim = 9999

[state 1230, nobg]
type = assertspecial
trigger1 = 1
flag = nobg
ignorehitpause = 1
persistent = 1

[state 1230, end]
type = destroyself
trigger1 = root,stateno = 0
ignorehitpause = 1




;=================================================================
;                      Escape Dash
;=================================================================
;Rapid will run away from his problems by going through his problems.
[statedef 1400]
type = S
movetype = I
physics = N
anim = 1400
ctrl = 0

[state 1400, awareness pause]
type = pause
trigger1 = time = 6
time = 8
endcmdbuftime = 8

[state 1400, dim]
type = bgpalfx
trigger1 = time = 6
time = 8
mul = 200,200,200

[state 1400, poweradd]
type = poweradd
trigger1 = time = 0
value = -1000

[state 1000, explod]
type = explod
trigger1 = animelemtime(4) = 0
anim = F40
postype = p1
pos = 228,-178
scale = -2.5,2.5
sprpriority = 3
bindtime = 0
persistent = 0

[state 1400, RUN]
type = velset
trigger1 = animelemtime(4) = 0
x = const(velocity.run.fwd.x) * 4
persistent = 0

[state 1400, HB]
Type = hitby
trigger1 = 1
value = SCA,AT

[state 1400, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 1400, changestate]
type = changestate
trigger1 = time = 15
trigger2 = p2bodydist x < -250
value = 1401

;-----------------------------------------------------------------------------------------------------
;stop
[statedef 1401]
type = S
movetype = I
physics = N
anim = 1401
facep2 = 1

[state 1000, Intitial Dust]
type = explod
trigger1 = 1
anim = F120
postype = p1
pos = -222,0
vel = -16,-4
scale = 2,2
persistent = 4

[state 1401, voice]
type = playsnd
trigger1 = random%11 > 5
trigger1 = time = 2
value = 1410,(random%3)
channel = 0
persistent = 0

[state 1401, velmul]
type = velmul
trigger1 = time = 0
x = 0.125

[state 1401,  hitby]
type = hitby
trigger1 = 1
value = SCA,AT

[state 1202, end]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1


;=====================================================================================================

;                          SUPERS

;=====================================================================================================

;=====================================================================================================
;Maximum Bunny

;  Damage 520:   Refund system will give meter back if it doesn't full hit.

;=====================================================================================================
[statedef 3000]
type = U
movetype = A
physics = N
anim = 3000
ctrl = 0

[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 90
v = 18
value = 90
ignorehitpause = 1

[state 3000, Voice]
type = playsnd
trigger1 = time = 2
value = 3001,(random%2)
channel =0
persistent = 0
volume = 255

[state 3000, playerpush]
type = playerpush
trigger1 = 1
value = 0
ignorehitpause = 1

[state 3000, position variables]
type = varset
trigger1 = time = 0
fvar(6) = backedgebodydist /128
fvar(9) = (pos y- 360) / 128
persistent = 0
ignorehitpause = 1

[state 3000, Stop]
type = velmul
trigger1 = statetype = A
trigger1 = time = 0
x = 0.25
y = 0.25

[state 3000, Jump]
type = velset
trigger1 = statetype != A
trigger1 = time = 0
x = -16
y = -12

[state 3000, camera lock]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 1

[state 3000, veladd]
type = veladd
trigger1 = time > 0
x = ifelse(-fvar(6) > -1.8, -1.8, -fvar(6));ifelse(-ceil(backedgebodydist * 0.015) < 1.2, -1.8, -ceil(backedgebodydist * 0.025))
y = fvar(9) ;ifelse(pos y = 0, -2.4, -0.4) 
persistent = 2
ignorehitpause = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3000, no touch ground]
type = velset
trigger1 = pos y >= 1
y = -24
persistent = 12


[state 3000, CLING]
type = changestate
triggerall = time > 8
trigger1 = backedgebodydist <= 15
value = 3001

;----------------------------------------------------------------------------------------------------------
;Wall Cling Portion
[statedef 3001]
type = A
movetype = A
physics = N
velset = 0,0
anim = 55

[state 3001, camera lock]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 1

[state 3001, Miss Counter]
type = varset
trigger1 = time = 0
var(4) = 8
ignorehitpause = 1


[state 3001, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 90
v = 18
value = 90
ignorehitpause = 1

[state 3001, no bg]
type = assertspecial
trigger1 = time < 60
flag = nobg
ignorehitpause = 1
persistent = 1

[State 3001, Super Pause]
type = SuperPause
trigger1 = time = 0
sound = S3000, 0
poweradd = -3000
pos = -10,-200
time = 60
movetime = 60

[state 3001, varset]
type = varset
trigger1 = time = 0
v = 20
value = 7

[state 3001, varset]
type = varset
trigger1 = time = 0
v = 21
value = floor(const(velocity.run.fwd.x)*4)


[state 3001, Super Portrait]
type = explod
trigger1 = time = [0,14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1

[state 3001, Super Portrait]
type = explod
trigger1 = time = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3001, width]
type= width
trigger1 = 1
player  = 40,57 ;60 works
edge = 5,30

[state 3001, posset]
type = posset
trigger1 = time = 0
x=(pos x-screenpos x)*facing

[state 3001, posfreeze]
type = posfreeze
trigger1 = time < 60
x = 1
y = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 3001, end]
type = changestate
trigger1 = time = 61
value = 3002


;-------------------------------------------------------------------------------------------
;First Strike
[statedef 3002]
type = A
movetype = A
physics = N
anim = 3001

[state 3002, Voice]
type = playsnd
trigger1 = time = 1
value = 3002,0
channel = 0
persistent = 0
volume = 255

[state 41, after image]
type = afterimage
trigger1 = time = 0
time = -1
length = 8
timegap = 1
framegap = 1
paladd = 0, 0,256
palcolor = 256
palbright = 192,192,192
palcontrast = 256,256,256
trans = "none"

[state 3001, sound FX]
type = playsnd
trigger1 = time = 0
value = S1000,0

[state 3001, sound FX]
type = playsnd
trigger1 = time = 0
value = S1000,0

[state 1000, explod]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 228,-180
scale = 6,6
sprpriority = 3
bindtime = 0
persistent = 0
trans = addalpha
alpha = 256,192

[state 3000, animation choice]
type = changeanim
trigger1 = time = 0
trigger1 = p2dist y > (pos y + 200)
value = 3003

[state 3000, animation choice]
type = changeanim
trigger1 = time = 0
trigger1 = p2dist y <= (pos y + 200) && p2dist y >= (pos y - 200)
value = 3006

[state 3000, animation choice]
type = changeanim
trigger1 = time = 0
trigger1 = p2dist y < (pos y - 200)
value = 3009

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = SCA
ignorehitpause = 1


[state 3002, LUNGE]
type = velset
trigger1 = time = 0
x = (P2DIST X+100) / 4; var(21)
y = (P2DIST y-100) / 4 ;ifelse(pos y > (enemynear,pos y - 200) && pos y < enemynear,pos y, 0, ifelse(pos y < (enemynear,pos y - 200),floor(var(21) * 0.25),-floor(var(21) * 0.25))) 


[State 210, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HA
animtype  = up
damage    = 65,52
guardflag = MA
hitflag = MAFD
getpower = 0
givepower = 125
pausetime = 6,6
sparkno = 3
id = 3000
nochainid = 1400
sparkxy = -10,-278
hitsound   = S5000,2
guardsound = S120, 0
ground.type = HIGH
ground.slidetime = 16
ground.hittime  = 16
ground.velocity = ifelse(enemynear,backedgebodydist < 80, 18,6),-42
air.velocity = ifelse(enemynear,backedgebodydist < 80, 18,6),-42
guard.hittime = 12
guard.velocity = -3
envshake.ampl = 8
envshake.time = 8
guard.slidetime = 12
down.velocity = 0,-40
airguard.velocity = -1,-5
guard.dist = 640
fall.recover = 0
fall = 1
yaccel = 1.76

[state 3002, playerpush]
type = playerpush
trigger1 = 1
value = 0


[state 3002, Missed/Blocked]
type = changestate
triggerall = !movehit
trigger1 = movecontact  ; Blocked
trigger2 = vel y > 0
trigger2 = pos y > -vel y ; Ground
trigger3 = frontedgebodydist < 15 ; Whiff
trigger4 = screenpos y < 200
trigger4 = vel y < 0 ; Whiff
value = 3009

[state 3002, Ground]
type = changestate
triggerall = movehit
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3003

[state 3002, Wall]
type = changestate
triggerall = movehit
trigger1 = frontedgebodydist < 15
value = 3005

[state 3002, Roof]
type = changestate
triggerall = movehit
triggerall = time > 18
trigger1 = screenpos y < -100
trigger1 = vel y < 0
value = 3006


;----------------------------------------------------------------
;Ground Rebounds
[statedef 3003]
type = S
movetype = A
physics = N
anim = 47
velset = 0,0
movehitpersist = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3004, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,1

;[state 3003, Miss check]
;type = varadd
;trigger1 = !movehit
;trigger1 = prevstateno = 3007
;var(4) = -1
;ignorehitpause = 1
;persistent = 0

[state 3003, posset]
type = posset
trigger1 = time = 0

[state 3003, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3003, go to wall]
type = velset
trigger1 = time = 2
x = var(21)
y = -floor(var(21)*0.25)

[state 3003, changeanim]
type = changeanim
trigger1 = time = 2
value = 3009


[state 3002, Wall]
type = changestate
trigger1 = frontedgebodydist < 15
value = 3005

[state 3002, Wall]
type = changestate
trigger1 = backedgebodydist < 15
value = 3004

;[state 300x, Attack]
;type = changestate
;trigger1 = time = 4
;value = 3007


;---------------------------------------------------------------------------
;Wall Bounce - Back Wall
[Statedef 3004]
type    = A
physics = N
movetype = A
anim = 55
ctrl = 0
sprpriority = 1
movehitpersist = 1

[state 3000, changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(backedgebodydist < 35, 55, 56)

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3004, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,1

[state 3003, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3004, width]
type= width
trigger1 = 1
player  = 40,57 
edge = 5,30

[state 3004,dekho]
type=null
trigger1=frontedgebodydist<=35
trigger1=time=0

[state 3004, posset]
type = posset
trigger1 = time = 0
x=(pos x-screenpos x)*facing

[state 3004, posfreeze]
type = posfreeze
trigger1 = time < 4
x = 1
y = 1

[state 3003, Miss check]
type = varadd
trigger1 = !movehit
trigger1 = prevstateno = 3007
var(4) = -1
ignorehitpause = 1
persistent = 0

[State 3004, 6]
type = ChangeState
trigger1 = time = 2
value = 3007

;--------------------------------------------------------------------------------------
;Wall Bounce - Front Wall
[Statedef 3005]
type    = A
physics = N
movetype = A
anim = 55
ctrl = 0
sprpriority = 1
movehitpersist = 1

[state 3000, changeanim]
type = changeanim
trigger1 = time = 0
value = ifelse(backedgebodydist < 35, 55, 56)

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3004, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = 0,1

[state 3003, playerpush]
type = playerpush
trigger1 = 1
value = 0

[state 3004, width]
type= width
trigger1 = 1
player  = 40,57 
edge = 5,30

[state 3004,dekho]
type=null
trigger1=frontedgebodydist<=35
trigger1=time=0

[state 3004, posset]
type = posset
trigger1 = time = 0
x=(pos x-screenpos x)*-facing

[state 3004, posfreeze]
type = posfreeze
trigger1 = time < 2
x = 1
y = 1

[state 3003, Miss check]
type = varadd
trigger1 = !movehit
trigger1 = prevstateno = 3007
var(4) = -1
ignorehitpause = 1
persistent = 0


[State 3004, 6]
type = ChangeState
trigger1 = time = 2
value = 3007

;--------------------------------------------------------------------------------------
;Top of the screenBound
[statedef 3006]
type = A
movetype = A
velset = 0,0
physics = N
anim = 57
movehitpersist = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

[state 3001, camera lock]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[state 3001, screenpos]
type = posset
trigger1 = time > 2
y = pos y - (screenpos y+300)
persistent= 1
ignorehitpause = 1 

[state 3003, changeanim]
type = changeanim
trigger1 = time = 2
value = 3001

[state 3003, go to wall]
type = velset
trigger1 = time = 2
x = -var(21)
y = floor(var(21)*0.25)


[state 3002, Wall]
type = changestate
trigger1 = frontedgebodydist < 15
value = 3005

[state 3002, Wall]
type = changestate
trigger1 = backedgebodydist < 15
value = 3004


;--------------------------------------------------------------------------------------
;Repeating Launches
[statedef 3007]
type = A
movetype = A
physics = N

[state 3001, sound FX]
type = playsnd
trigger1 = time = 0
value = S1000,0

[state 1000, explod]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 228,-180
scale = 6,6
sprpriority = 3
bindtime = 0
persistent = 0
trans = addalpha
alpha = 256,192

[state 3001, camera lock]
type = screenbound
trigger1 = 1
movecamera = 0,1
value = 1

[state 3000, nothitby]
type = nothitby
trigger1 = 1
value = ,AP

;============================================
; Numpad Notation
;===========================================

[state 3007, UP  8]
type = velset
triggerall = time = 0
trigger1 = p2dist x = [-200, 200]
trigger1 = p2dist y < -200
x = P2DIST X * 0.06
y = -var(21)

[state 3007, UP-FORWARD  9]
type = velset
triggerall = time = 0
trigger1 = p2dist x >= 200
trigger1 = p2dist y < -200
x = floor(var(21)*1)
y = -floor(var(21)*0.5)

[state 3007, UP-BACK 7]
type = velset
triggerall = time = 0
trigger1 = p2dist x <= -200
trigger1 = p2dist y < -200
x = -floor(var(21)*1)
y = -floor(var(21)*0.5)

[state 3007, FORWARD  6]
type = velset
triggerall = time = 0
trigger1 = p2dist x >= 200
trigger1 = p2dist y = [-200,200]
x = floor(var(21))
y = p2dist y * 0.06

[state 3007, BACK  4]
type = velset
triggerall = time = 0
trigger1 = p2dist x <= -200
trigger1 = p2dist y = [-200,200]
x = -floor(var(21))
y = p2dist y * 0.06

[state 3007, DOWN-FORWARD  3]
type = velset
triggerall = time = 0
trigger1 = p2dist x >= 200
trigger1 = p2dist y > 200
x = floor(var(21)*1)
y = floor(var(21)*0.5)

[state 3007, DOWN-BACK  1]
type = velset
triggerall = time = 0
trigger1 = p2dist x <= -200
trigger1 = p2dist y > 200
x = -floor(var(21)*1)
y = floor(var(21)*0.5)

[state 3007, DOWN]
type = velset
triggerall = time = 0
trigger1 = p2dist x = [-150, 150]
trigger1 = p2dist y > 200
x = P2DIST X * 0.06
y = var(21)


[state 3007, Too long bug]
type = velset
trigger1 = time = 30
x = p2dist x * 0.02
y = p2dist y * 0.02


;[state 3002, Lunge Y]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist y >= -200 && p2dist y <= 200
;y = 0

;[state 3002, Lunge y]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist y < -200
;y = -floor(var(21) * 0.5)

;[state 3002, Lunge y]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist y > 200
;y = floor(var(21) * 0.5)


;Velocity X

;[state 3002, Lunge]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist x > 200
;x = var(21)

;[state 3002, Lunge]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist x <= 200  && p2dist x > 0
;x = floor(var(21)*0.25)

;[state 3002, Lunge]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist x = 0
;x = 0

;[state 3002, Lunge]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist x < 0  && p2dist x >= -200
;x = -floor(var(21)*0.25)

;[state 3002, Lunge]
;type = velset
;trigger1 = time = 0
;trigger1 = p2dist x < -200
;x = -var(21)

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x > 200
trigger1 = p2dist y < -200
value = 3009


[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x <= 200  && p2dist x >= -200 
trigger1 = p2dist y < -200
value = 3008

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x > 0
trigger1 = p2dist y >= -200 && p2dist y <= 200
value = 3006

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x > 200
trigger1 = p2dist y > 200
value = 3003

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x <= 200 && p2dist x >= -200
trigger1 = p2dist y > 200
value = 3002

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x < -200
trigger1 = p2dist y < -200
value = 3007

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x < 0
trigger1 = p2dist y >= -200 && p2dist y <= 200
value = 3004

[state 3002, animation choice]
type = changeanim
triggerall = time = 0
triggerall = p2dist x < -200
trigger1 = p2dist y > 200
value = 3001




[state 3003, playerpush]
type = playerpush
trigger1 = 1
value = 0

;To even be in this state means it hit.  So all following hits are unblockable.
[State 3003, 2]
type = HitDef
trigger1 = !movecontact
attr = S, HA
animtype  = up
damage    = 65
guardflag = 
hitflag = MAF
getpower = 0
givepower = 125
pausetime = ifelse(var(20) > 1, 10, 18),ifelse(var(20) > 1, 10, 18)
sparkno = 2
sparkxy = -10,-278
hitsound   = ifelse(var(20) > 1, 5, 5),ifelse(var(20) > 1, 3, 4)
guardsound = S120, 0
ground.type = HIGH
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = ifelse(var(20) > 1, 2,-30),ifelse(var(20) > 1, -18, -30)
air.velocity = ifelse(var(20) > 1, 2,-30),ifelse(var(20) > 1, -18, -30)
guard.hittime = 12
guard.velocity = -3
guard.slidetime = 12
airguard.velocity = -1,-5
envshake.ampl = ifelse(var(20) > 1, -8, -12)
envshake.time = ifelse(var(20) > 1, 8, 16)
guard.dist = 320
fall.recover = 0
fall = 1
yaccel = 1.76

[state 3003, count down]
type = varadd
trigger1 = movehit
var(20) = -1
persistent = 0
ignorehitpause = 1

[state 3003, count down]
type = varadd
trigger1 = movehit
var(21) = 25
persistent = 0
ignorehitpause = 1

[state 3007, after image]
type = null
trigger1 = 1
time = 1
length = 20
timegap = 4
framegap = 3
persistent = 0

[state 3002, END]
type = changestate
trigger1 = moveguarded
trigger2 = var(20) < 1
value = 3009 

[state 3002, End block/miss]
type = changestate
triggerall = time > 4
triggerall = var(4) <= 0
trigger1 = vel y > 0
trigger1 = pos y > -vel y
trigger2 = backedgebodydist < 15
trigger3 = frontedgebodydist < 15
value = 3009

[state 3002, Ground]
type = changestate
triggerall = time > 4
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3003

[state 3002, Wall]
type = changestate
triggerall = time > 4
trigger1 = backedgebodydist < 15
value = 3004

[state 3002, Wall]
type = changestate
triggerall = time > 4
trigger1 = frontedgebodydist < 15
value = 3005

[state 3002, Roof]
type = changestate
triggerall = time > 4
trigger1 = screenpos y < -10
trigger1 = vel y < 0
value = 3006


;------------------------------------------------------------------------------------
;End
[statedef 3009]
type = A
movetype = I
physics = N
anim = 3019
movehitpersist = 1

[state 3009, afterimage]
type = afterimage
trigger1 = 1
time = 0


[state 3009, bounce]
type = velset
trigger1 = time = 0
x = -8
y = -35

[state 3009, playerpush]
type = playerpush
trigger1 = movehit
value = 0

[state 3009, refund]
type = poweradd
trigger1 = time = 0
value = ifelse(var(20) = 7, 0,375 * var(20))
ignorehitpause = 1 

[state 3009, gravity]
type = gravity
trigger1 = time > 0

[state 3009, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3010

;--------------------------------------------------------------------------------------
[statedef 3010]
type = C
movetype = I
physics = C
velset = 0,0
anim = 47

[state 3010, posset]
type = posset
trigger1 = time = 0
y = 0

[state 3010, over]
type = changestate
trigger1 = time = 24
value = 0
ctrl = 1 

;--------------------------------------------------------------------------------------


[statedef 3039]
type = A
movetype = A
physics = N
anim = 3039
ctrl = 0

[State 3040, Blink White]
type = PalFX
trigger1 = time >= 0 & time < 12
trigger1 = time%2
time = 1
add = 255,255,255 ;32,16,0
ignorehitpause

[state 3040, gravity]
type = gravity
trigger1 = 1

[state 3040, velset]
type = velset
trigger1 = time = 0
y = 50
x = 0

[state 3040, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3040

;----------------------------------------------------------------------------------------------



;Zig Zag of sheer speed
[statedef 3040]
type = S
movetype = A
physics = S
anim = 3040
ctrl= 0
velset = 0,0
facep2 = 1

[state 3040, voice]
type = playsnd
trigger1 = time = 2
value = 1100, 0
channel = 0
persistent = 0

[state 3040, voice]
type = playsnd
trigger1 = animtime = -1
value = 1101, 1
channel = 0
persistent = 0

[state 3040, posset]
type = posset
trigger1 = time = 0
y = 0

[state x, Minimum Super combo damage]
type = varset
trigger1 = time = 0
trigger1 = var(18) < 70
v = 18
value = 70
ignorehitpause = 1

[state 3040, no bg]
type = assertspecial
trigger1 = animelemtime(3) >= 0 && animelemtime(3) < 60
flag = nobg
ignorehitpause = 1
persistent = 1

[State 3040, Super Pause]
type = SuperPause
trigger1 = animelemtime(3) = 0
sound = S3000, 0
poweradd = -1000
pos = -10,-200
time = 60
movetime = 60

[state 3040, varset]
type = varset
trigger1 = time = 0
v = 20
value = 15

[state 3040, varset]
type = varset
trigger1 = time = 0
v = 21
value = 4


[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(3) =[0, 14]
anim = 3100
postype = back
sprpriority = -3
supermovetime = 60
removetime = 1
pausemovetime = 60
scale = (3-(time*0.15))*(1),(3-(time*0.15))*(1)
pos = 0,60-time*5
ownpal = 1


[state 3040, Super Portrait]
type = explod
trigger1 = animelemtime(3) = 15
anim = 3100
postype = back
vel = -0.1,0
sprpriority = -3
supermovetime = 60
removetime = 45
pausemovetime = 60
pos = 0,0
scale = 1,1
ownpal = 1

[state 3040, end]
type = changestate
trigger1 = animtime = 0
value = 3041

;-----------------------------------------------------------------------------------------------------
;LAUNCH
[statedef 3041]
type = S
movetype = A
physics = S
anim = 3041
facep2 = 1

[state 1100, sonic boom snd]
type = playsnd
trigger1 = time = 0
value = S1000,0
persistent = 0

[state 3041, playerpush]
type = playerpush
trigger1 = !moveguarded
value = 0
ignorehitpause = 1

[state 3041, nothitby]
type = null
trigger1 = var(20) > 15
value = ,AP

[state 3041, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,1
ignorehitpause = 1

[state 1141, Sonic Boom]
type = explod
trigger1 = time = 0
anim = 2000
id = 2000
postype = p1
pos = 240,-142
scale = const(size.xscale)*5,const(size.yscale)*5
sprpriority = 3
bindtime = 0
persistent = 0
trans = addalpha
alpha = 256,192

[state 1000, Intitial Dust]
type = explod
trigger1 = time = 0
anim = 2020
postype = p1
pos = 0,0
vel = 0,0
scale = const(size.xscale)*1.5,const(size.yscale)*1.5
persistent = 0


[state 41, after image]
type = afterimage
trigger1 = time = 0
time = -1
length = 8
timegap = 1
framegap = 1
palcolor = 256
palbright = 192,192,192
palcontrast = 256,256,256
trans = "none"

[State 1101, 1]
type = VelSet
trigger1 = 1
x = const(velocity.run.fwd.x)*4
y = 0


[State 3041, 2]
type = HitDef
trigger1 = var(20) != 1
trigger1 = !movecontact
attr = S, HA
animtype  = HEAVY
damage    = 14,28
getpower = 0
guardflag = MA
hitflag = MAF
pausetime = 0,24
guard.pausetime = 12,12
sparkno = 2
sparkxy = -50,-264
hitsound   = S5000,2
guardsound = S120, 0
ground.type = Low
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -0
air.velocity = -0,0
forcenofall = 1
guard.velocity = -24
guard.slidetime = 12
guard.hittime = 12
guard.dist = 720
kill = 0


[State 3041, 2]
type = HitDef
trigger1 = var(20) = 1
trigger1 = !movecontact
attr = S, HA
animtype  = HEAVY
damage    = 84,28
guardflag = MA
getpower = 0
pausetime = 18,18
guard.pausetime = 12,12
sparkno = 2
id =3041
sparkxy = -50,-264
hitsound   = 5,4
guardsound = S120, 0
ground.type = High
ground.slidetime = 24
ground.hittime  = 24
ground.velocity = -80,-20
air.velocity = -80,-20
forcenofall = 1
envshake.ampl = 24
envshake.time = 18
guard.velocity = -18
guard.slidetime = 12
guard.hittime = 12
guard.dist = 720
fall = 1
fall.recover = 0

[state 3041, stop]
type = changestate
trigger1= moveguarded
value = 3049
ignorehitpause = 1

[state 3041, stop]
type = changestate
triggerall = movehit
triggerall = var(20) > 1
trigger1 = time >= var(21)
trigger2 = p2bodydist x < -350
value = 3042

[state 3041, stop]
type = changestate
triggerall = time >= var(21)
trigger1 = var(20) <= 1
trigger2 = !movecontact

value = 3048

;-------------------------------------------------------------------------
;Brakes
[statedef 3042]
type = S
movetype = A
physics = S

[state 3041, nothitby]
type = null
trigger1 = var(20) > 13
value = ,AP

[state 3041, changeanim]
type = changeanim
triggerall = time = 0
trigger1 = var(20) > 13
value = 3050

[state 3041, changeanim]
type = changeanim
triggerall = time = 0
trigger1 = var(20) <= 13  && var(20) > 11
value = 3051

[state 3041, changeanim]
type = changeanim
triggerall = time = 0
trigger1 = var(20) <= 11  && var(20) > 9
value = 3052

[state 3041, changeanim]
type = changeanim
triggerall = time = 0
trigger1 =  var(20) <= 9  && var(20) > 7
value = 3053

[state 3041, changeanim]
type = changeanim
triggerall = time = 0
trigger1 =  var(20) <= 7  && var(20) > 5
value = 3054

[state 3041, changeanim]
type = changeanim
triggerall = time = 0
trigger1 =  var(20) <= 5 
value = 3055

[state 3041, screenbound]
type = screenbound
trigger1 = 1
value = 0
movecamera = 0,1
ignorehitpause = 1

[state 3042, velmul]
type = velmul
trigger1 = time = 0
x = 0.125

[state 1000, Intitial Dust]
type = explod
trigger1 = 1
anim = 2025
postype = p1
pos = 224,-8
vel = -16,-4
scale = 1,1
persistent = 4

[state 3042, varadd]
type = varadd
trigger1 = time = 0
var(20) = -1
ignorehitpause = 1


[state 3042, loop]
type = changestate
trigger1 = animtime = 0
value = 3041


;-------------------------------------------------------------------------
;Last
[statedef 3048]
type = S
movetype = A
physics = S
anim = 3044

[state 3042, playerpush]
type = playerpush
trigger1 = numtarget(3041)
value = 0
ignorehitpause = 1


[state 3042, velmul]
type = velmul
trigger1 = time = 0
x = 0.125

[state 1000, Intitial Dust]
type = explod
trigger1 = time < 12
anim = 2025
postype = p1
pos = 224,-8
vel = -16,-4
scale = 1,1
sprpriority = 3
persistent = 4

[state 3042, varadd]
type = varadd
trigger1 = time = 0
var(35) = -1

[state X, Combo Scaling]
type = varadd
trigger1 = movehit
v = 18
value = -3
persistent = 0
ignorehitpause = 1

[state 3009, afterimage]
type = afterimage
trigger1 = time = 3
time = 0


[state 3042, loop]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;-----------------------------------------------------------------------------
;Blocked
[statedef 3049]
type = A
movetype = I
physics = N
anim = 3043

[state 3009, afterimage]
type = afterimage
trigger1 = 1
time = 0

[state 3049, bounce]
type = velmul
trigger1 = time =0
x = -0.01

[state 3049, bounce]
type = velset
trigger1 = time = 0
y = -42

[state 3049, gravity]
type = veladd
trigger1 = time > 0
y = 1.76
persistent = 1

[state 3049, landing]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 3050


;------------------------------------------------------------
;landing lag
[statedef 3050]
type = C
movetype = I
physics = C
ctrl = 0
anim = 47

[state 3050, stop vel]
type = velset
trigger1 = time = 0
x = 0
y = 0

[state 3050, on ground]
type = posset
trigger1 = time = 0
y = 0 

[state 3050, done]
type = changestate
trigger1 = time = 8
value = 0
ctrl = 1


;------------------------------------------------------------------------------------------

;Helpers for Meter Management
;  Dust effect for tech grab
[statedef 4805]
type = U
movetype = I
anim = 9999

[state 4805, Intitial Dust]
type = explod
triggerall = root,stateno = [805,806]
trigger1 = animelemtime(10) > 0
trigger1 = numexplod(120) < 8
anim = 2025
id = 2025
postype = p1
pos = -222,0
vel = -16,-4
scale = 1,1
persistent = 4

[state 4805, end]
type = destroyself
trigger1 = time > 30


;Meter gain for getting sat on
[statedef 4660]
type = U
anim = 9999

[state 4660, metergain]
type = poweradd
triggerall = time = 0
trigger1 = enemynear,authorname = "Kazecat"
trigger1 = enemy,name = "Bertha Hippo" || enemy,name = "Jiggly 'Ana' Bunny" || enemy,name = "Violet 'Tyla' Bunny"
value = ifelse(enemynear,name = "Bertha Hippo", 1000, 500)
persistent = 0

[state 4660, destroyself]
type = destroyself
trigger1 = time > 300


;-----------------------------------------------------------------------------------------------------
;==========================================================================
;[Info]
;author = "Inktrebuchet" 
;versiondate = 12/13/2018                  
;goal = Detect enemy's projectile (helper). For use with AI.
;       敵の発射物（helper）を検出する。 AIで使用する場合。
;==========================================================================
;                Notes
;==========================================================================
;notes:
;-Enemy's projectile now has a PlayerID use PlayerID(helper(33333333),var(3)) as a redirect.
;
;base examples of trigger use: 
;
;;Enemy's projectile helper's distance from character.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), p2bodydist x 
;
;;Enemy's projectile helper's velocity.
;trigger1 = PlayerIDExist(helper(33333333),var(3))
;trigger1 = PlayerID(helper(33333333),var(3)), Vel X
;
;==========================================================================
;                Helper var usage.
;==========================================================================
; numhelper(33333333) Variable usage:
; This is a record of the variables that are used
;
; var(0) - highest playerid + 1
; var(3) - projectile player id while it exists
; 
;==========================================================================
[Statedef 33333333]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0, 0
 
;==========================================================================
;                Config Section
;==========================================================================
anim = 9741                   ; blank animation
 
;==========================================================================
 
[state 33333333, Clipboard] 
type = DisplayToClipboard
trigger1 = 1
text = "Highest Playerid = %d , Projectile helper's PlayerId = %d\nBy Inktrebuchet"
params = var(0)-1, var(3)
;==========================================================================
;                Detect Enemy's Projectile Helper
;==========================================================================
[State 33333333, 0]
type = Null
trigger1 = var(0) = 0
trigger1 = (var(0) := id)
ignorehitpause = 1
 
[state 33333333, 1] 
type = varadd
trigger1 = PlayerIdExist(var(0)) 
trigger2 = PlayerIdExist(var(0)+1) 
trigger3 = PlayerIdExist(var(0)+2) 
trigger4 = PlayerIdExist(var(0)+3) 
trigger5 = PlayerIdExist(var(0)+4) 
trigger6 = PlayerIdExist(var(0)+5) 
trigger7 = PlayerIdExist(var(0)+6) 
trigger8 = PlayerIdExist(var(0)+7) 
trigger9 = PlayerIdExist(var(0)+8) 
trigger10 = PlayerIdExist(var(0)+9) 
trigger11 = PlayerIdExist(var(0)+10) 
trigger12 = PlayerIdExist(var(0)+11) 
trigger13 = PlayerIdExist(var(0)+12) 
trigger14 = PlayerIdExist(var(0)+13) 
trigger15 = PlayerIdExist(var(0)+14) 
trigger16 = PlayerIdExist(var(0)+15) 
trigger17 = PlayerIdExist(var(0)+16) 
trigger18 = PlayerIdExist(var(0)+17) 
trigger19 = PlayerIdExist(var(0)+18) 
trigger20 = PlayerIdExist(var(0)+19) 
trigger21 = PlayerIdExist(var(0)+20) 
trigger22 = PlayerIdExist(var(0)+21) 
trigger23 = PlayerIdExist(var(0)+22) 
trigger24 = PlayerIdExist(var(0)+23) 
trigger25 = PlayerIdExist(var(0)+24) 
trigger26 = PlayerIdExist(var(0)+25) 
v = 0
value = 1
ignorehitpause = 1
 
[State 33333333, 2]
type = Null
triggerall = PlayerIdExist(Root,ID)
trigger1 = PlayerIdExist(var(0)-1)
trigger1 = cond(root,teamside = 1, PlayerID(var(0)-1),teamside = 2, PlayerID(var(0)-1),teamside = 1)
trigger1 = PlayerID(var(0)-1),hitdefattr = ASC, NP, SP, HP
trigger1 = var(3) := (var(0)-1)
trigger2 = PlayerIdExist(var(0)-2)
trigger2 = cond(root,teamside = 1, PlayerID(var(0)-2),teamside = 2, PlayerID(var(0)-2),teamside = 1)
trigger2 = PlayerID(var(0)-2),hitdefattr = ASC, NP, SP, HP
trigger2 = var(3) := (var(0)-2)
trigger3 = PlayerIdExist(var(0)-3)
trigger3 = cond(root,teamside = 1, PlayerID(var(0)-3),teamside = 2, PlayerID(var(0)-3),teamside = 1)
trigger3 = PlayerID(var(0)-3),hitdefattr = ASC, NP, SP, HP
trigger3 = var(3) := (var(0)-3)
trigger4 = PlayerIdExist(var(0)-4)
trigger4 = cond(root,teamside = 1, PlayerID(var(0)-4),teamside = 2, PlayerID(var(0)-4),teamside = 1)
trigger4 = PlayerID(var(0)-4),hitdefattr = ASC, NP, SP, HP
trigger4 = var(3) := (var(0)-4)
trigger5 = PlayerIdExist(var(0)-5)
trigger5 = cond(root,teamside = 1, PlayerID(var(0)-5),teamside = 2, PlayerID(var(0)-5),teamside = 1)
trigger5 = PlayerID(var(0)-5),hitdefattr = ASC, NP, SP, HP
trigger5 = var(3) := (var(0)-5)
trigger6 = PlayerIdExist(var(0)-6)
trigger6 = cond(root,teamside = 1, PlayerID(var(0)-6),teamside = 2, PlayerID(var(0)-6),teamside = 1)
trigger6 = PlayerID(var(0)-6),hitdefattr = ASC, NP, SP, HP
trigger6 = var(3) := (var(0)-6)
trigger7 = PlayerIdExist(var(0)-7)
trigger7 = cond(root,teamside = 1, PlayerID(var(0)-7),teamside = 2, PlayerID(var(0)-7),teamside = 1)
trigger7 = PlayerID(var(0)-7),hitdefattr = ASC, NP, SP, HP
trigger7 = var(3) := (var(0)-7)
trigger8 = PlayerIdExist(var(0)-8)
trigger8 = cond(root,teamside = 1, PlayerID(var(0)-8),teamside = 2, PlayerID(var(0)-8),teamside = 1)
trigger8 = PlayerID(var(0)-8),hitdefattr = ASC, NP, SP, HP
trigger8 = var(3) := (var(0)-8)
trigger9 = PlayerIdExist(var(0)-9)
trigger9 = cond(root,teamside = 1, PlayerID(var(0)-9),teamside = 2, PlayerID(var(0)-9),teamside = 1)
trigger9 = PlayerID(var(0)-9),hitdefattr = ASC, NP, SP, HP
trigger9 = var(3) := (var(0)-9)
trigger10 = PlayerIdExist(var(0)-10)
trigger10 = cond(root,teamside = 1, PlayerID(var(0)-10),teamside = 2, PlayerID(var(0)-10),teamside = 1)
trigger10 = PlayerID(var(0)-10),hitdefattr = ASC, NP, SP, HP
trigger10 = var(3) := (var(0)-10)
ignorehitpause = 1
 
[State 33333333, BindToRoot]
type = BindToRoot
trigger1 = PlayerIdExist(Root,ID)
time = 1
facing = 1
pos =0,-2
ignorehitpause = 1 




;-----------------------------------------------------------------------------------------------------

;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------

[statedef -2]




;Rapid Bunny is © Kazecat 2021
[state -2, copyright]
type = DisplayToClipboard 
trigger1 = numpartner
params = Frontedgebodydist, backedgebodydist, ScreenPos x, Partner,ScreenPos X, fvar(28)
text = "FrontEdge: %d, BackEdge: %d, Rapid Pos X: %d, Bertha Pos X: %d, Partner Dist: %d "
;text = "Rapid Bunny is © Kazecat 2021"

;Rapid Bunny is © Kazecat 2021
[state -2, copyright]
type = DisplayToClipboard 
trigger1 = !numpartner
params = pos x, pos y, p2dist x, p2dist y, var(18)
text = "Positions X:  %d, Y: %d, Distance X: %d, Y: %d, Combo Scale: %d"
;text = "Rapid Bunny is © Kazecat 2021"


;==============================================================================
;                           Win Quotes
;==============================================================================
[state -2, win quotes]
type = victoryquote
trigger1 = 1
value = 1+(random%7)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumbo Elephant"
value = 8+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ana 'Jiggly' Bunny"
value = 11+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Bertha Hippo"
value = 14+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Katrina Crocodile"
value = 17+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Enorma Pig"
value = 20+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Aroma Skunk"
value = 23+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Lardo Rat"
value = 26+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Zafta Giraffe"
value = 29+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Makuyama"
value = 32+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Pastilla Skunk"
value = 35+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Jumba Elephant"
value = 38+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Twiggi Bunny"
value = 41+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Violet 'Tyla' Bunny"
value = 44+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Julian Hippo"
value = 47+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Ra Lord"
value = 50+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Battu Tri-red"
value = 53+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Noah Sharker"
value = 56+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Rapid Bunny"
value = 59+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Akai R. Panda"
value = 62+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Andy Armadillo"
value = 65+(random%3)
ignorehitpause
persistent = 1

[state -2, win quotes]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Montana Moth"
value = 68+(random%3)
ignorehitpause
persistent = 1

[state -2, win quote]
type = victoryquote
triggerall = numenemy
trigger1 = enemy, name = "Texas Stanton"
value = 71+(random%3)
ignorehitpause
persistent = 1
;====================================================
;Inhibitors
;====================================================


[state -2, Run Check]
type = varset
trigger1 = stateno = 0
trigger2 = stateno = 52
trigger3 = stateno = 20
var(4) = 0
ignorehitpause = 1

[state -2, Elbow limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(6) = 2
ignorehitpause = 1

[state -2, Wall bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(7) = 2
ignorehitpause = 1

[state -2, Ground Bounce limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(8) = 2
ignorehitpause = 1

[state -2, Launcher limiter]
type = varset
triggerall = numenemy
trigger1 = (enemynear, movetype != H)
var(11) = 2
ignorehitpause = 1

[STATE -2, Dodge counter]
type = varset
trigger1 = stateno = 0
trigger2 = stateno = 5120
trigger3 = stateno = 20
var(13) = 0
ignorehitpause = 1

[state -2, Air Dodge Limiter]
type = varset
triggerall = numenemy
trigger1 = stateno = 52
trigger2 = stateno = 0
trigger3 = stateno = 5120
var(12) = 1
ignorehitpause = 1


[state -2, Meter gain for squashed]
type = helper
trigger1 = stateno = [660,669]
trigger1 = !numhelper(4660)
id = 4660
stateno = 4660
postype = p1
pos = 0,0
persistent = 1
ignorehitpause = 1

[state -2, Dust]
type = helper
trigger1 = stateno = [805,810]
trigger1 = !numhelper(4805)
id = 4805
stateno = 4805
postype = p1
pos = 0,0
persistent = 1
ignorehitpause = 1


;====================================================
;combo Scaling
;====================================================

[State -2, attack scaling]
type = attackMulSet
trigger1 = 1
value = fvar(10)
ignorehitpause = 1

[state -2, combo points]
type = varset
trigger1 = numenemy
trigger1 = (enemynear, movetype != H)
trigger2 = !numenemy
ignorehitpause = 1
v = 18
value = 100

[state -2, gradual lowering]
type= varset
trigger1 =  var(18) >= 100
fvar(10) = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 100 && var(18) >= 90
fvar(10) = 0.9
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 90 && var(18) >= 80
fvar(10) = 0.8
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 80 && var(18) >= 70
fvar(10) = 0.7
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 70 && var(18) >= 60
fvar(10) = 0.6
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 60 && var(18) >= 50
fvar(10) = 0.5
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 50 && var(18) >= 40
fvar(10) = 0.4
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 40 && var(18) >= 30
fvar(10) = 0.3
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 30 && var(18) >= 20
fvar(10) = 0.2
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 20 && var(18) >= 10
fvar(10) = 0.1
ignorehitpause = 1

[state -2, gradual lowering]
type= varset
trigger1 = var(18) < 10
fvar(10) = 0.05
ignorehitpause = 1


[state -2, Dizzy moan]
type = playsnd
trigger1 = time = 2
trigger1 = anim = 5300
value = 5010,4
channel = 0
persistent = 0




;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

[state -3, High energy Bunny]
type = poweradd
triggerall = movetype != H
triggerall = roundstate = 2
trigger1 = (gametime%60) = 0
value = 5

[state -3, Loves Bertha]
type = poweradd
triggerall = movetype != H
triggerall = roundstate = 2
triggerall = numpartner
trigger1 = partner,name = "Bertha Hippo"
trigger1 = (gametime%60)= 0
value = 5

;=======================AI Detect Projectile System==========================
[state -3, AI Detect Projectile System]
type = helper
trigger1 = ailevel ;M.U.G.E.N 1.0+
trigger1 = !numhelper(33333333)
name = "AI Detect Projectile System"
ID = 33333333
stateno = 33333333
postype = p1
ownpal = 1
keyctrl = 0
size.xscale = 1.0
size.yscale = 1.0
supermovetime = 2147483647
pausemovetime = 2147483647
ignorehitpause = 1

[state -3, Dizzy width]
type = null
trigger1 = anim = 5300
value = 100,100



[state -3, varset]
type = varset
trigger1 = numpartner
fvar(28) = ScreenPos X - partner,Screenpos X
persistent = 1

;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.
[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
trigger3 = stateno = 1211
value = 40, 0

[state -3, gravity]
type = gravity
trigger1 = stateno = 5620
trigger1 = time > 0

[state -3, pushblock is BS like that]
type = poweradd
trigger1 = enemynear,authorname = "Dcat Power"
trigger1 = enemynear,stateno = [720,729]
value = 5
persistent = 30
ignorehitpause = 0

[state -3, land]
type = changestate
triggerall = stateno = 5620
trigger1 = vel y > 0
trigger1 = pos y > -vel y
value = 52

[State -3, AssertSpecial]
type = AssertSpecial
trigger1 = ailevel
flag = nostandguard
flag2 = nocrouchguard
flag3 = noairguard
ignorehitpause = 1
